function createSafeFragment(e){var t=nodeNames.split("|"),o=e.createDocumentFragment();if(o.createElement)for(;t.length;)o.createElement(t.pop());return o}function fixDefaultChecked(e){rcheckableType.test(e.type)&&(e.defaultChecked=e.checked)}function getAll(e,t){var o,n,a=0,i=typeof e.getElementsByTagName!==strundefined?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==strundefined?e.querySelectorAll(t||"*"):void 0;if(!i)for(i=[],o=e.childNodes||e;null!=(n=o[a]);a++)!t||jQuery.nodeName(n,t)?i.push(n):jQuery.merge(i,getAll(n,t));return void 0===t||t&&jQuery.nodeName(e,t)?jQuery.merge([e],i):i}function setGlobalEval(e,t){for(var o,n=0;null!=(o=e[n]);n++)jQuery._data(o,"globalEval",!t||jQuery._data(t[n],"globalEval"))}!function(){function e(t){function e(){o.push([this,arguments]),n||e.execute()}var o=[],n=1,a=0,t=t;return e.execute=function(){if(!a){var e;for(a=1,n=0;e=o.shift();)t.apply(e[0],e[1]);a=0}},e.lock=function(){n=0},e}var a,t,l={},c=0,i=[],o=window.FD50={setup:function(e){t=e,o.init()},jquery:function(e){a||(a=e,o.init())},init:function(){c||a&&t&&(o.$=a.initialize(t),o.plugin.execute(),c=1)},plugin:e(function(e,t){t.apply(o,[a])}),module:e(function(e,t){a.module(e,t)}),installer:function(e,t,o){if(i[e]||(i[e]=[]),!t)return i[e];var n=l[e];if(n.registered)return n.install(t,o);i[e].push([t,o])},component:function(r,e){if(!r)return l;if(!e)return l[r];if("function"==typeof e)return(o=e).registered=!0,l[r]=o;function n(e,t,o){for(var n=0;n<t.length;n++){var a=t[n];e[a]=function(e,t,o){return function(){return(o||s).push(i(e,this,arguments)),t}}(a,e,o)}return e}function t(t,o){return function(){var e=[i(t,this,arguments)];return s.push(e),n({},o,e)}}var o,s=[],i=function(e,t,o){return{method:e,context:this,args:o}};return s.execute=function(){for(var e=l[r],t=0;t<s.length;t++){var o=s[t];if("[object Array]"===Object.prototype.toString.call(o))for(var n=o,a=e,i=0;i<n.length;i++)a=a[n[i].method].apply(a,n[i].args);else e[o.method].apply(e,o.args)}},(o=n(function(){o.run.apply(this.arguments)},["run","ready","template","dialog"])).className=r,o.options=e,o.queue=s,o.module=t("module",["done","always","fail","progress"]),o.require=t("require",["library","script","stylesheet","language","template","app","view","done","always","fail","progress"]),window[r]=l[r]=o,c&&a.Component.register(o),o}}}(),FD50.setup({environment:window.ezb.environment,source:"local",mode:"production"==window.ezb.environment?"compressed":"uncompressed",path:window.ezb.rootUrl+"/media/com_easyblog/scripts/vendors",cdn:"",extension:".js",cdnPath:"",rootPath:window.ezb.rootUrl,basePath:window.ezb.rootUrl,indexUrl:window.ezb.rootUrl+"/index.php",token:window.ezb.token,locale:{lang:window.ezb.locale}}),FD50.component("EasyBlog",{environment:window.ezb.environment,source:"local",mode:(window.ezb.environment,"compressed"),version:"2.0",momentLang:window.ezb.momentLang,ajaxUrl:window.ezb.ajaxUrl,scriptVersioning:window.ezb.scriptVersioning,scriptVersion:window.ezb.version}),jQuery.version="5.0",jQuery.long_version="5.0.10";var support={};!function(){function e(){var e,t,o,n=document.getElementsByTagName("body")[0];n&&n.style&&(e=document.createElement("div"),(t=document.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(t).appendChild(e),e.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",a=i=!1,s=!0,window.getComputedStyle&&(a="1%"!==(window.getComputedStyle(e,null)||{}).top,i="4px"===(window.getComputedStyle(e,null)||{width:"4px"}).width,(o=e.appendChild(document.createElement("div"))).style.cssText=e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",o.style.marginRight=o.style.width="0",e.style.width="1px",s=!parseFloat((window.getComputedStyle(o,null)||{}).marginRight),e.removeChild(o)),e.innerHTML="<table><tr><td></td><td>t</td></tr></table>",(o=e.getElementsByTagName("td"))[0].style.cssText="margin:0;border:0;padding:0;display:none",(r=0===o[0].offsetHeight)&&(o[0].style.display="",o[1].style.display="none",r=0===o[0].offsetHeight),n.removeChild(t))}var t,a,i,r,s,o=document.createElement("div");o.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(t=(t=o.getElementsByTagName("a")[0])&&t.style)&&(t.cssText="float:left;opacity:.5",support.opacity="0.5"===t.opacity,support.cssFloat=!!t.cssFloat,o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===o.style.backgroundClip,support.boxSizing=""===t.boxSizing||""===t.MozBoxSizing||""===t.WebkitBoxSizing,jQuery.extend(support,{reliableHiddenOffsets:function(){return null==r&&e(),r},boxSizingReliable:function(){return null==i&&e(),i},pixelPosition:function(){return null==a&&e(),a},reliableMarginRight:function(){return null==s&&e(),s}}))}();var strundefined="undefined",rcheckableType=/^(?:checkbox|radio)$/i,nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.uid=function(e,t){return(e||"")+Math.random().toString().replace(".","")+(t||"")},jQuery.globalNamespace=jQuery.uid("EasyBlog"),window[jQuery.globalNamespace]=jQuery,jQuery.run=function(e){return jQuery.isFunction(e)?e(jQuery):null},jQuery.initialize=function(e){var t,o;jQuery.initialized||(jQuery.buildFragment=function(e,t,o,n){for(var a,i,r,s,l,c,d,u=e.length,p=createSafeFragment(t),m=[],f=0;f<u;f++)if((i=e[f])||0===i)if("object"===jQuery.type(i))jQuery.merge(m,i.nodeType?[i]:i);else if(rhtml.test(i)){for(s=s||p.appendChild(t.createElement("div")),l=(rtagName.exec(i)||["",""])[1].toLowerCase(),d=wrapMap[l]||wrapMap._default,s.innerHTML=d[1]+i.replace(rxhtmlTag,"<$1></$2>")+d[2],a=d[0];a--;)s=s.lastChild;if(!support.leadingWhitespace&&rleadingWhitespace.test(i)&&m.push(t.createTextNode(rleadingWhitespace.exec(i)[0])),!support.tbody)for(a=(i="table"!==l||rtbody.test(i)?"<table>"!==d[1]||rtbody.test(i)?0:s:s.firstChild)&&i.childNodes.length;a--;)jQuery.nodeName(c=i.childNodes[a],"tbody")&&!c.childNodes.length&&i.removeChild(c);for(jQuery.merge(m,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=p.lastChild}else m.push(t.createTextNode(i));for(s&&p.removeChild(s),support.appendChecked||jQuery.grep(getAll(m,"input"),fixDefaultChecked),f=0;i=m[f++];)if((!n||-1===jQuery.inArray(i,n))&&(r=jQuery.contains(i.ownerDocument,i),s=getAll(p.appendChild(i),"script"),r&&setGlobalEval(s),o))for(a=0;i=s[a++];)rscriptType.test(i.type||"")&&o.push(i);return s=null,p},jQuery.uaMatch=function(e){e=e.toLowerCase();e=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:e[1]||"",version:e[2]||"0"}},jQuery.browser||(o={},(t=jQuery.uaMatch(navigator.userAgent)).browser&&(o[t.browser]=!0,o.version=t.version),o.chrome?o.webkit=!0:o.webkit&&(o.safari=!0),jQuery.browser=o),jQuery.extend(jQuery,e),"development"==jQuery.environment&&(window.F=jQuery),jQuery.initialized=!0,FD50.module.execute())},FD50.jquery(jQuery),"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery}),FD50.plugin("lodash",function(o){function ho(e,t){return e.set(t[0],t[1]),e}function go(e,t){return e.add(t),e}function vo(e,t,o){switch(o.length){case 0:return e.call(t);case 1:return e.call(t,o[0]);case 2:return e.call(t,o[0],o[1]);case 3:return e.call(t,o[0],o[1],o[2])}return e.apply(t,o)}function bo(e,t){for(var o=-1,n=null==e?0:e.length;++o<n&&!1!==t(e[o],o,e););return e}function yo(e,t){for(var o=-1,n=null==e?0:e.length,a=0,i=[];++o<n;){var r=e[o];t(r,o,e)&&(i[a++]=r)}return i}function ko(e,t){return!!(null==e?0:e.length)&&-1<Io(e,t,0)}function wo(e,t,o){for(var n=-1,a=null==e?0:e.length;++n<a;)if(o(t,e[n]))return!0;return!1}function Co(e,t){for(var o=-1,n=null==e?0:e.length,a=Array(n);++o<n;)a[o]=t(e[o],o,e);return a}function Bo(e,t){for(var o=-1,n=t.length,a=e.length;++o<n;)e[a+o]=t[o];return e}function xo(e,t,o,n){var a=-1,i=null==e?0:e.length;for(n&&i&&(o=e[++a]);++a<i;)o=t(o,e[a],a,e);return o}function Io(e,t,o){return t==t?function(e,t,o){var n=o-1,a=e.length;for(;++n<a;)if(e[n]===t)return n;return-1}(e,t,o):function(e,t,o,n){for(var a=e.length,i=o+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}(e,n,o)}function To(e,t,o,n){for(var a=o-1,i=e.length;++a<i;)if(n(e[a],t))return a;return-1}function n(e){return e!=e}function So(t){return function(e){return t(e)}}function Eo(e,t){return e.has(t)}function _o(e){var o=-1,n=Array(e.size);return e.forEach(function(e,t){n[++o]=[t,e]}),n}function Fo(t,o){return function(e){return t(o(e))}}function Mo(e){var t=-1,o=Array(e.size);return e.forEach(function(e){o[++t]=e}),o}function Po(e){return h.test(e)?e.match(f)||[]:e.split("")}var zo,Do="Expected a function",Lo="__lodash_hash_undefined__",Ao="__lodash_placeholder__",Ho=9007199254740991,Oo=4294967295,Uo=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],jo="[object Arguments]",$o="[object Array]",No="[object Boolean]",Ro="[object Date]",Wo="[object Error]",Vo="[object Function]",qo="[object GeneratorFunction]",Go="[object Map]",Qo="[object Number]",Xo="[object Object]",Ko="[object Promise]",Yo="[object RegExp]",Jo="[object Set]",Zo="[object String]",en="[object Symbol]",tn="[object WeakMap]",on="[object ArrayBuffer]",nn="[object DataView]",an="[object Float32Array]",rn="[object Float64Array]",sn="[object Int8Array]",ln="[object Int16Array]",cn="[object Int32Array]",dn="[object Uint8Array]",un="[object Uint8ClampedArray]",pn="[object Uint16Array]",mn="[object Uint32Array]",fn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,hn=/^\w*$/,gn=/^\./,vn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bn=/[\\^$.*+?()[\]{}|]/g,yn=/^\s+|\s+$/g,kn=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,wn=/\{\n\/\* \[wrapped with (.+)\] \*/,Cn=/,? & /,Bn=/\\(\\)?/g,xn=/\w*$/,In=/^[-+]0x[0-9a-f]+$/i,Tn=/^0b[01]+$/i,Sn=/^\[object .+?Constructor\]$/,En=/^0o[0-7]+$/i,_n=/^(?:0|[1-9]\d*)$/,e="\\ud800-\\udfff",t="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",a="\\ufe0e\\ufe0f",i="["+e+"]",r="["+t+"]",s="\\ud83c[\\udffb-\\udfff]",l="[^"+e+"]",c="(?:\\ud83c[\\udde6-\\uddff]){2}",d="[\\ud800-\\udbff][\\udc00-\\udfff]",u="\\u200d",p="(?:"+r+"|"+s+")"+"?",m="["+a+"]?",p=m+p+("(?:"+u+"(?:"+[l,c,d].join("|")+")"+m+p+")*"),i="(?:"+[l+r+"?",r,c,d,i].join("|")+")",f=RegExp(s+"(?="+s+")|"+i+p,"g"),h=RegExp("["+u+e+t+a+"]"),Fn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Mn={};Mn[an]=Mn[rn]=Mn[sn]=Mn[ln]=Mn[cn]=Mn[dn]=Mn[un]=Mn[pn]=Mn[mn]=!0,Mn[jo]=Mn[$o]=Mn[on]=Mn[No]=Mn[nn]=Mn[Ro]=Mn[Wo]=Mn[Vo]=Mn[Go]=Mn[Qo]=Mn[Xo]=Mn[Yo]=Mn[Jo]=Mn[Zo]=Mn[tn]=!1;var Pn={};Pn[jo]=Pn[$o]=Pn[on]=Pn[nn]=Pn[No]=Pn[Ro]=Pn[an]=Pn[rn]=Pn[sn]=Pn[ln]=Pn[cn]=Pn[Go]=Pn[Qo]=Pn[Xo]=Pn[Yo]=Pn[Jo]=Pn[Zo]=Pn[en]=Pn[dn]=Pn[un]=Pn[pn]=Pn[mn]=!0,Pn[Wo]=Pn[Vo]=Pn[tn]=!1;var zn=parseInt,e="object"==typeof global&&global&&global.Object===Object&&global,t="object"==typeof self&&self&&self.Object===Object&&self,Dn=e||t||Function("return this")(),a="object"==typeof exports&&exports&&!exports.nodeType&&exports,t=a&&"object"==typeof module&&module&&!module.nodeType&&module,Ln=t&&t.exports===a,g=Ln&&e.process,e=function(){try{return g&&g.binding&&g.binding("util")}catch(e){}}(),An=e&&e.isTypedArray,e=function e(t){function B(e){if(Ee(e)&&!uo(e)&&!(e instanceof x)){if(e instanceof f)return e;if(lt.call(e,"__wrapped__"))return ue(e)}return new f(e)}function i(){}function f(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=zo}function x(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Oo,this.__views__=[]}function o(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var n=e[t];this.set(n[0],n[1])}}function a(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var n=e[t];this.set(n[0],n[1])}}function r(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var n=e[t];this.set(n[0],n[1])}}function g(e){var t=-1,o=null==e?0:e.length;for(this.__data__=new r;++t<o;)this.add(e[t])}function v(e){e=this.__data__=new a(e);this.size=e.size}function n(e,t){var o,n=uo(e),a=!n&&co(e),i=!n&&!a&&po(e),r=!n&&!a&&!i&&mo(e),s=n||a||i||r,l=s?function(e,t){for(var o=-1,n=Array(e);++o<e;)n[o]=t(o);return n}(e.length,tt):[],c=l.length;for(o in e)!t&&!lt.call(e,o)||s&&("length"==o||i&&("offset"==o||"parent"==o)||r&&("buffer"==o||"byteLength"==o||"byteOffset"==o)||te(o,c))||l.push(o);return l}function b(e,t,o){var n=e[t];lt.call(e,t)&&Ce(n,o)&&(o!==zo||t in e)||c(e,t,o)}function s(e,t){for(var o=e.length;o--;)if(Ce(e[o][0],t))return o;return-1}function c(e,t,o){"__proto__"==t&&Bt?Bt(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}function y(o,n,a,e,t,i){var r,s=1&n,l=2&n,c=4&n;if((r=a?t?a(o,e,t,i):a(o):r)!==zo)return r;if(!Se(o))return o;var d,u,p,m=uo(o);if(m){if(r=function(e){var t=e.length,o=e.constructor(t);t&&"string"==typeof e[0]&&lt.call(e,"index")&&(o.index=e.index,o.input=e.input);return o}(o),!s)return $(o,r)}else{var f=Zt(o),e=f==Vo||f==qo;if(po(o))return function(e,t){if(t)return e.slice();t=e.length,t=ht?ht(t):new e.constructor(t);return e.copy(t),t}(o,s);if(f==Xo||f==jo||e&&!t){if(r=l||e?{}:"function"!=typeof(e=o).constructor||ae(e)?{}:Nt(gt(e)),!s)return l?(p=d=o,p=(u=r)&&N(p,Ue(p),u),N(d,Jt(d),p)):(d=u=o,p=(p=r)&&N(d,Oe(d),p),N(u,Yt(u),p))}else{if(!Pn[f])return t?o:{};r=function(e,t,o,n){var a=e.constructor;switch(t){case on:return j(e);case No:case Ro:return new a(+e);case nn:return function(e,t){t=t?j(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}(e,n);case an:case rn:case sn:case ln:case cn:case dn:case un:case pn:case mn:return function(e,t){t=t?j(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}(e,n);case Go:return function(e,t,o){return xo(t?o(_o(e),1):_o(e),ho,new e.constructor)}(e,n,o);case Qo:case Zo:return new a(e);case Yo:return function(e){var t=new e.constructor(e.source,xn.exec(e));return t.lastIndex=e.lastIndex,t}(e);case Jo:return function(e,t,o){return xo(t?o(Mo(e),1):Mo(e),go,new e.constructor)}(e,n,o);case en:return function(e){return jt?Ze(jt.call(e)):{}}(e)}}(o,f,y,s)}}s=(i=i||new v).get(o);if(s)return s;i.set(o,r);var h=m?zo:(c?l?X:Q:l?Ue:Oe)(o);return bo(h||o,function(e,t){h&&(e=o[t=e]),b(r,t,y(e,n,a,t,o,i))}),r}function l(e,n){var a=[];return Gt(e,function(e,t,o){n(e,t,o)&&a.push(e)}),a}function d(e,t,o,n,a){var i=-1,r=e.length;for(o=o||ee,a=a||[];++i<r;){var s=e[i];0<t&&o(s)?1<t?d(s,t-1,o,n,a):Bo(a,s):n||(a[a.length]=s)}return a}function u(e,t){return e&&Qt(e,t,Oe)}function p(t,e){return yo(e,function(e){return Ie(t[e])})}function m(e,t){for(var o=0,n=(t=U(t,e)).length;null!=e&&o<n;)e=e[ce(t[o++])];return o&&o==n?e:zo}function h(e,t,o){t=t(e);return uo(e)?t:Bo(t,o(e))}function k(e){return null==e?e===zo?"[object Undefined]":"[object Null]":Ct&&Ct in Ze(e)?function(e){var t=lt.call(e,Ct),o=e[Ct];try{e[Ct]=zo;var n=!0}catch(e){}var a=dt.call(e);n&&(t?e[Ct]=o:delete e[Ct]);return a}(e):dt.call(e)}function w(e,t){return null!=e&&lt.call(e,t)}function C(e,t){return null!=e&&t in Ze(e)}function I(e,t,o){var n,a;t=U(t,e),n=e;t=null==(e=(a=t).length<2?n:m(n,function(e,t,o){var n=-1,a=e.length;t<0&&(t=a<-t?0:a+t);(o=a<o?a:o)<0&&(o+=a);a=o<t?0:o-t>>>0,t>>>=0;var i=Xe(a);for(;++n<a;)i[n]=e[n+t];return i}(a,0,-1)))?e:e[ce(me(t))];return null==t?zo:vo(t,e,o)}function T(e){return Ee(e)&&k(e)==jo}function S(e,t,o,n,a){return e===t||(null==e||null==t||!Ee(e)&&!Ee(t)?e!=e&&t!=t:function(e,t,o,n,a,i){var r=uo(e),s=uo(t),l=r?$o:Zt(e),c=s?$o:Zt(t),d=(l=l==jo?Xo:l)==Xo,s=(c=c==jo?Xo:c)==Xo,c=l==c;if(c&&po(e)){if(!po(t))return!1;d=!(r=!0)}if(c&&!d)return i=i||new v,r||mo(e)?q(e,t,o,n,a,i):function(e,t,o,n,a,i,r){switch(o){case nn:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case on:return e.byteLength==t.byteLength&&i(new ft(e),new ft(t))?!0:!1;case No:case Ro:case Qo:return Ce(+e,+t);case Wo:return e.name==t.name&&e.message==t.message;case Yo:case Zo:return e==t+"";case Go:var s=_o;case Jo:var l=1&n;if(s=s||Mo,e.size!=t.size&&!l)return!1;l=r.get(e);if(l)return l==t;n|=2,r.set(e,t);s=q(s(e),s(t),n,a,i,r);return r.delete(e),s;case en:if(jt)return jt.call(e)==jt.call(t)}return!1}(e,t,l,o,n,a,i);if(!(1&o)){d=d&&lt.call(e,"__wrapped__"),s=s&&lt.call(t,"__wrapped__");if(d||s){d=d?e.value():e,s=s?t.value():t;return i=i||new v,a(d,s,o,n,i)}}return c&&(i=i||new v,function(e,t,o,n,a,i){var r=1&o,s=Q(e),l=s.length,c=Q(t).length;if(l!=c&&!r)return!1;var d=l;for(;d--;){var u=s[d];if(!(r?u in t:lt.call(t,u)))return!1}var p=i.get(e);if(p&&i.get(t))return p==t;var m=!0;i.set(e,t),i.set(t,e);var f=r;for(;++d<l;){u=s[d];var h,g=e[u],v=t[u];if(!((h=n?r?n(v,g,u,t,e,i):n(g,v,u,e,t,i):h)===zo?g===v||a(g,v,o,n,i):h)){m=!1;break}f=f||"constructor"==u}m&&!f&&(c=e.constructor,p=t.constructor,c!=p&&"constructor"in e&&"constructor"in t&&!("function"==typeof c&&c instanceof c&&"function"==typeof p&&p instanceof p)&&(m=!1));return i.delete(e),i.delete(t),m}(e,t,o,n,a,i))}(e,t,o,n,S,a))}function E(e){var t;return Se(e)&&(t=e,!(ct&&ct in t))&&(Ie(e)?ut:Sn).test(de(e))}function _(e){return"function"==typeof e?e:null==e?Ne:"object"==typeof e?uo(e)?function(o,n){if(ne(o)&&ie(n))return re(ce(o),n);return function(e){var t=Ae(e,o);return t===zo&&t===n?He(e,o):S(n,t,3)}}(e[0],e[1]):function(t){var o=function(e){var t=Oe(e),o=t.length;for(;o--;){var n=t[o],a=e[n];t[o]=[n,a,ie(a)]}return t}(t);if(1==o.length&&o[0][2])return re(o[0][0],o[0][1]);return function(e){return e===t||function(e,t,o,n){var a=o.length,i=a,r=!n;if(null==e)return!i;for(e=Ze(e);a--;){var s=o[a];if(r&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++a<i;){var l=(s=o[a])[0],c=e[l],d=s[1];if(r&&s[2]){if(c===zo&&!(l in e))return!1}else{var u,p=new v;if(!((u=n?n(c,d,l,e,t,p):u)===zo?S(d,c,3,n,p):u))return!1}}return!0}(e,t,o)}}(e):qe(e)}function F(e){if(!ae(e))return Tt(e);var t,o=[];for(t in Ze(e))lt.call(e,t)&&"constructor"!=t&&o.push(t);return o}function M(e){if(!Se(e))return function(e){var t=[];if(null!=e)for(var o in Ze(e))t.push(o);return t}(e);var t,o=ae(e),n=[];for(t in e)("constructor"!=t||!o&&lt.call(e,t))&&n.push(t);return n}function P(e,n){var a=-1,i=Be(e)?Xe(e.length):[];return Gt(e,function(e,t,o){i[++a]=n(e,t,o)}),i}function z(e,n,o){var a=-1;return n=Co(n.length?n:[Ne],So(K())),function(e,t){var o=e.length;for(e.sort(t);o--;)e[o]=e[o].value;return e}(P(e,function(t,e,o){return{criteria:Co(n,function(e){return e(t)}),index:++a,value:t}}),function(e,t){return function(e,t,o){var n=-1,a=e.criteria,i=t.criteria,r=a.length,s=o.length;for(;++n<r;){var l=function(e,t){if(e!==t){var o=e!==zo,n=null===e,a=e==e,i=Fe(e),r=t!==zo,s=null===t,l=t==t,c=Fe(t);if(!s&&!c&&!i&&t<e||i&&r&&l&&!s&&!c||n&&r&&l||!o&&l||!a)return 1;if(!n&&!i&&!c&&e<t||c&&o&&a&&!n&&!i||s&&o&&a||!r&&a||!l)return-1}return 0}(a[n],i[n]);if(l){if(s<=n)return l;var c=o[n];return l*("desc"==c?-1:1)}}return e.index-t.index}(e,t,o)})}function D(o,e){return function(e,t,o){var n=-1,a=t.length,i={};for(;++n<a;){var r=t[n],s=m(e,r);o(s,r)&&function(e,t,o,n){if(!Se(e))return;t=U(t,e);var a=-1,i=t.length,r=i-1,s=e;for(;null!=s&&++a<i;){var l,c=ce(t[a]),d=o;a!=r&&(l=s[c],(d=n?n(l,c,s):zo)===zo&&(d=Se(l)?l:te(t[a+1])?[]:{})),b(s,c,d),s=s[c]}}(i,U(r,e),s)}return i}(o,e,function(e,t){return He(o,t)})}function L(e,t){return ao(se(e,t,Ne),e+"")}function A(e){if("string"==typeof e)return e;if(uo(e))return Co(e,A)+"";if(Fe(e))return $t?$t.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function H(e,t){var o=e;return xo(t,function(e,t){return t.func.apply(t.thisArg,Bo([e],t.args))},o=e instanceof x?e.value():o)}function O(e){return xe(e)?e:[]}function U(e,t){return uo(e)?e:ne(e,t)?[e]:io(Le(e))}function j(e){var t=new e.constructor(e.byteLength);return new ft(t).set(new ft(e)),t}function $(e,t){var o=-1,n=e.length;for(t=t||Xe(n);++o<n;)t[o]=e[o];return t}function N(e,t,o,n){var a=!o;o=o||{};for(var i=-1,r=t.length;++i<r;){var s=t[i],l=n?n(o[s],e[s],s,o,e):zo;(a?c:b)(o,s,l=l===zo?e[s]:l)}return o}function R(n){return function(){var e=arguments;switch(e.length){case 0:return new n;case 1:return new n(e[0]);case 2:return new n(e[0],e[1]);case 3:return new n(e[0],e[1],e[2]);case 4:return new n(e[0],e[1],e[2],e[3]);case 5:return new n(e[0],e[1],e[2],e[3],e[4]);case 6:return new n(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new n(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var t=Nt(n.prototype),o=n.apply(t,e);return Se(o)?o:t}}function W(s,l,c,d,u,p,m,f,h,g){var v=128&l,b=1&l,y=2&l,k=24&l,w=512&l,C=y?zo:R(s);return function e(){for(var t,o=arguments.length,n=Xe(o),a=o;a--;)n[a]=arguments[a];if(k&&(t=e,t=function(e,t){for(var o=e.length,n=0;o--;)e[o]===t&&++n;return n}(n,r=(lt.call(B,"placeholder")?B:t).placeholder)),d&&(n=function(e,t,o,n){for(var a=-1,i=e.length,r=o.length,s=-1,l=t.length,c=St(i-r,0),d=Xe(l+c),u=!n;++s<l;)d[s]=t[s];for(;++a<r;)(u||a<i)&&(d[o[a]]=e[a]);for(;c--;)d[s++]=e[a++];return d}(n,d,u,k)),p&&(n=function(e,t,o,n){for(var a=-1,i=e.length,r=-1,s=o.length,l=-1,c=t.length,d=St(i-s,0),u=Xe(d+c),p=!n;++a<d;)u[a]=e[a];for(var m=a;++l<c;)u[m+l]=t[l];for(;++r<s;)(p||a<i)&&(u[m+o[r]]=e[a++]);return u}(n,p,m,k)),o-=t,k&&o<g){var i=function(e,t){for(var o=-1,n=e.length,a=0,i=[];++o<n;){var r=e[o];r!==t&&r!==Ao||(e[o]=Ao,i[a++]=o)}return i}(n,r);return function(e,t,o,n,a,i,r,s,l,c){var d=8&t;return t|=d?32:64,4&(t&=~(d?64:32))||(t&=-4),c=[e,t,a,d?i:zo,d?r:zo,d?zo:i,d?zo:r,s,l,c],o=o.apply(zo,c),function(e){var t=function(e){for(var t=e.name+"",o=Dt[t],n=lt.call(Dt,t)?o.length:0;n--;){var a=o[n],i=a.func;if(null==i||i==e)return a.name}return t}(e),o=B[t];return"function"==typeof o&&t in x.prototype&&(e===o||(o=Kt(o))&&e===o[0])}(e)&&oo(o,c),o.placeholder=n,function(e,t,o){return ao(e,function(e,t){var o=t.length;if(!o)return e;var n=o-1;return t[n]=(1<o?"& ":"")+t[n],t=t.join(2<o?", ":" "),e.replace(kn,"{\n/* [wrapped with "+t+"] */\n")}(t+="",function(o,n){return bo(Uo,function(e){var t="_."+e[0];n&e[1]&&!ko(o,t)&&o.push(t)}),o.sort()}(function(e){return(e=e.match(wn))?e[1].split(Cn):[]}(t),o)))}(o,e,t)}(s,l,W,e.placeholder,c,n,i,f,h,g-o)}var r=b?c:this,i=y?r[s]:s,o=n.length;return f?n=function(e,t){for(var o=e.length,n=Et(t.length,o),a=$(e);n--;){var i=t[n];e[n]=te(i,o)?a[i]:zo}return e}(n,f):w&&1<o&&n.reverse(),v&&h<o&&(n.length=h),(i=this&&this!==Dn&&this instanceof e?C||R(i):i).apply(r,n)}}function V(e,t,o,n){return e===zo||Ce(e,it[o])&&!lt.call(n,o)?t:e}function q(e,t,o,n,a,i){var r=1&o,s=e.length,l=t.length;if(s!=l&&!(r&&s<l))return!1;l=i.get(e);if(l&&i.get(t))return l==t;var c=-1,d=!0,u=2&o?new g:zo;for(i.set(e,t),i.set(t,e);++c<s;){var p,m=e[c],f=t[c];if((p=n?r?n(f,m,c,t,e,i):n(m,f,c,e,t,i):p)!==zo){if(p)continue;d=!1;break}if(u){if(!function(e,t){for(var o=-1,n=null==e?0:e.length;++o<n;)if(t(e[o],o,e))return 1}(t,function(e,t){return!Eo(u,t)&&(m===e||a(m,e,o,n,i))&&u.push(t)})){d=!1;break}}else if(m!==f&&!a(m,f,o,n,i)){d=!1;break}}return i.delete(e),i.delete(t),d}function G(e){return ao(se(e,zo,pe),e+"")}function Q(e){return h(e,Oe,Yt)}function X(e){return h(e,Ue,Jt)}function K(e,t){var o=(o=B.iteratee||Re)===Re?_:o;return arguments.length?o(e,t):o}function Y(e,t){var o,n=e.__data__;return("string"==(e=typeof(o=t))||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==o:null===o)?n["string"==typeof t?"string":"hash"]:n.map}function J(e,t){t=t,t=null==(e=e)?zo:e[t];return E(t)?t:zo}function Z(e,t,o){for(var n=-1,a=(t=U(t,e)).length,i=!1;++n<a;){var r=ce(t[n]);if(!(i=null!=e&&o(e,r)))break;e=e[r]}return i||++n!=a?i:!!(a=null==e?0:e.length)&&Te(a)&&te(r,a)&&(uo(e)||co(e))}function ee(e){return uo(e)||co(e)||!!(kt&&e&&e[kt])}function te(e,t){return!!(t=null==t?Ho:t)&&("number"==typeof e||_n.test(e))&&-1<e&&e%1==0&&e<t}function oe(e,t,o){if(Se(o)){var n=typeof t;return("number"==n?Be(o)&&te(t,o.length):"string"==n&&t in o)&&Ce(o[t],e)}}function ne(e,t){if(!uo(e)){var o=typeof e;return"number"==o||"symbol"==o||"boolean"==o||null==e||Fe(e)||(hn.test(e)||!fn.test(e)||null!=t&&e in Ze(t))}}function ae(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||it)}function ie(e){return e==e&&!Se(e)}function re(t,o){return function(e){return null!=e&&(e[t]===o&&(o!==zo||t in Ze(e)))}}function se(i,r,s){return r=St(r===zo?i.length-1:r,0),function(){for(var e=arguments,t=-1,o=St(e.length-r,0),n=Xe(o);++t<o;)n[t]=e[r+t];for(var t=-1,a=Xe(r+1);++t<r;)a[t]=e[t];return a[r]=s(n),vo(i,this,a)}}function le(o){var n=0,a=0;return function(){var e=_t(),t=16-(e-a);if(a=e,0<t){if(800<=++n)return arguments[0]}else n=0;return o.apply(zo,arguments)}}function ce(e){if("string"==typeof e||Fe(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function de(e){if(null!=e){try{return st.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ue(e){if(e instanceof x)return e.clone();var t=new f(e.__wrapped__,e.__chain__);return t.__actions__=$(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function pe(e){return(null==e?0:e.length)?d(e,1):[]}function me(e){var t=null==e?0:e.length;return t?e[t-1]:zo}function fe(e,t){return e&&e.length&&t&&t.length?function(e,t,o,n){var a=n?To:Io,i=-1,r=t.length,s=e;for(e===t&&(t=$(t)),o&&(s=Co(e,So(o)));++i<r;)for(var l=0,c=t[i],d=o?o(c):c;-1<(l=a(s,d,l,n));)s!==e&&yt.call(s,l,1),yt.call(e,l,1);return e}(e,t):e}function he(e){return null==e?e:Ft.call(e)}function ge(e){e=B(e);return e.__chain__=!0,e}function ve(e,t){return t(e)}function be(e,t){return(uo(e)?bo:Gt)(e,K(t,3))}function ye(n,o,e){function a(e){var t=l,o=c;return l=c=zo,f=e,u=n.apply(o,t)}function i(e){var t=e-m;return m===zo||o<=t||t<0||g&&d<=e-f}function r(){var e,t=ro();if(i(t))return s(t);p=no(r,(t=o-((e=t)-m),g?Et(t,d-(e-f)):t))}function s(e){return p=zo,v&&l?a(e):(l=c=zo,u)}function t(){var e=ro(),t=i(e);if(l=arguments,c=this,m=e,t){if(p===zo)return f=t=m,p=no(r,o),h?a(t):u;if(g)return p=no(r,o),a(m)}return p===zo&&(p=no(r,o)),u}var l,c,d,u,p,m,f=0,h=!1,g=!1,v=!0;if("function"!=typeof n)throw new ot(Do);return o=De(o)||0,Se(e)&&(h=!!e.leading,g="maxWait"in e,d=g?St(De(e.maxWait)||0,o):d,v="trailing"in e?!!e.trailing:v),t.cancel=function(){p!==zo&&Xt(p),f=0,l=m=c=p=zo},t.flush=function(){return p===zo?u:s(ro())},t}function ke(n,a){if("function"!=typeof n||null!=a&&"function"!=typeof a)throw new ot(Do);function i(){var e=arguments,t=a?a.apply(this,e):e[0],o=i.cache;return o.has(t)?o.get(t):(e=n.apply(this,e),i.cache=o.set(t,e)||o,e)}return i.cache=new(ke.Cache||r),i}function we(t){if("function"!=typeof t)throw new ot(Do);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Ce(e,t){return e===t||e!=e&&t!=t}function Be(e){return null!=e&&Te(e.length)&&!Ie(e)}function xe(e){return Ee(e)&&Be(e)}function Ie(e){if(!Se(e))return!1;e=k(e);return e==Vo||e==qo||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Te(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=Ho}function Se(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ee(e){return null!=e&&"object"==typeof e}function _e(e){return"string"==typeof e||!uo(e)&&Ee(e)&&k(e)==Zo}function Fe(e){return"symbol"==typeof e||Ee(e)&&k(e)==en}function Me(e){if(!e)return[];if(Be(e))return(_e(e)?Po:$)(e);if(wt&&e[wt])return function(e){for(var t,o=[];!(t=e.next()).done;)o.push(t.value);return o}(e[wt]());var t=Zt(e);return(t==Go?_o:t==Jo?Mo:je)(e)}function Pe(e){return e?(e=De(e))!==1/0&&e!==-1/0?e==e?e:0:17976931348623157e292*(e<0?-1:1):0===e?e:0}function ze(e){var t=Pe(e),e=t%1;return t==t?e?t-e:t:0}function De(e){if("number"==typeof e)return e;if(Fe(e))return NaN;if("string"!=typeof(e=Se(e)?Se(t="function"==typeof e.valueOf?e.valueOf():e)?t+"":t:e))return 0===e?e:+e;e=e.replace(yn,"");var t=Tn.test(e);return t||En.test(e)?zn(e.slice(2),t?2:8):In.test(e)?NaN:+e}function Le(e){return null==e?"":A(e)}function Ae(e,t,o){t=null==e?zo:m(e,t);return t===zo?o:t}function He(e,t){return null!=e&&Z(e,t,C)}function Oe(e){return(Be(e)?n:F)(e)}function Ue(e){return Be(e)?n(e,!0):M(e)}function je(e){return null==e?[]:Co(Oe(t=e),function(e){return t[e]});var t}function $e(e){return function(){return e}}function Ne(e){return e}function Re(e){return _("function"==typeof e?e:y(e,1))}function We(n,t,e){var o=Oe(t),a=p(t,o);null!=e||Se(t)&&(a.length||!o.length)||(e=t,t=n,n=this,a=p(t,Oe(t)));var i=!(Se(e)&&"chain"in e&&!e.chain),r=Ie(n);return bo(a,function(e){var o=t[e];n[e]=o,r&&(n.prototype[e]=function(){var e=this.__chain__;if(i||e){var t=n(this.__wrapped__);return(t.__actions__=$(this.__actions__)).push({func:o,args:arguments,thisArg:n}),t.__chain__=e,t}return o.apply(n,Bo([this.value()],arguments))})}),n}function Ve(){}function qe(e){return ne(e)?(o=ce(e),function(e){return null==e?zo:e[o]}):(t=e,function(e){return m(e,t)});var t,o}function Ge(){return[]}function Qe(){return!1}var Xe=(t=null==t?Dn:Hn.defaults(Dn.Object(),t,Hn.pick(Dn,Fn))).Array,Ke=t.Date,Ye=(t.Error,t.Function),Je=t.Math,Ze=t.Object,et=t.RegExp,tt=t.String,ot=t.TypeError,nt=Xe.prototype,at=Ye.prototype,it=Ze.prototype,rt=t["__core-js_shared__"],st=at.toString,lt=it.hasOwnProperty,ct=(It=/[^.]+$/.exec(rt&&rt.keys&&rt.keys.IE_PROTO||""))?"Symbol(src)_1."+It:"",dt=it.toString,ut=(st.call(Ze),Dn._,et("^"+st.call(lt).replace(bn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$")),pt=Ln?t.Buffer:zo,mt=t.Symbol,ft=t.Uint8Array,ht=pt?pt.allocUnsafe:zo,gt=Fo(Ze.getPrototypeOf,Ze),vt=Ze.create,bt=it.propertyIsEnumerable,yt=nt.splice,kt=mt?mt.isConcatSpreadable:zo,wt=mt?mt.iterator:zo,Ct=mt?mt.toStringTag:zo,Bt=function(){try{var e=J(Ze,"defineProperty");return e({},"",{}),e}catch(e){}}(),Ye=t.clearTimeout!==Dn.clearTimeout&&t.clearTimeout,at=Ke&&Ke.now!==Dn.Date.now&&Ke.now,rt=t.setTimeout!==Dn.setTimeout&&t.setTimeout,xt=(Je.ceil,Je.floor,Ze.getOwnPropertySymbols),It=pt?pt.isBuffer:zo,Tt=(t.isFinite,nt.join,Fo(Ze.keys,Ze)),St=Je.max,Et=Je.min,_t=Ke.now,Ft=(t.parseInt,Je.random,nt.reverse),et=J(t,"DataView"),Mt=J(t,"Map"),pt=J(t,"Promise"),Ke=J(t,"Set"),Je=J(t,"WeakMap"),Pt=J(Ze,"create"),zt=Je&&new Je,Dt={},Lt=de(et),At=de(Mt),Ht=de(pt),Ot=de(Ke),Ut=de(Je),t=mt?mt.prototype:zo,jt=t?t.valueOf:zo,$t=t?t.toString:zo,Nt=function(e){if(!Se(e))return{};if(vt)return vt(e);Rt.prototype=e;e=new Rt;return Rt.prototype=zo,e};function Rt(){}B.prototype=i.prototype,B.prototype.constructor=B,f.prototype=Nt(i.prototype),f.prototype.constructor=f,x.prototype=Nt(i.prototype),x.prototype.constructor=x,o.prototype.clear=function(){this.__data__=Pt?Pt(null):{},this.size=0},o.prototype.delete=function(e){return e=this.has(e)&&delete this.__data__[e],this.size-=e?1:0,e},o.prototype.get=function(e){var t=this.__data__;if(Pt){var o=t[e];return o===Lo?zo:o}return lt.call(t,e)?t[e]:zo},o.prototype.has=function(e){var t=this.__data__;return Pt?t[e]!==zo:lt.call(t,e)},o.prototype.set=function(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Pt&&t===zo?Lo:t,this},a.prototype.clear=function(){this.__data__=[],this.size=0},a.prototype.delete=function(e){var t=this.__data__;return!((e=s(t,e))<0)&&(e==t.length-1?t.pop():yt.call(t,e,1),--this.size,!0)},a.prototype.get=function(e){var t=this.__data__;return(e=s(t,e))<0?zo:t[e][1]},a.prototype.has=function(e){return-1<s(this.__data__,e)},a.prototype.set=function(e,t){var o=this.__data__,n=s(o,e);return n<0?(++this.size,o.push([e,t])):o[n][1]=t,this},r.prototype.clear=function(){this.size=0,this.__data__={hash:new o,map:new(Mt||a),string:new o}},r.prototype.delete=function(e){return e=Y(this,e).delete(e),this.size-=e?1:0,e},r.prototype.get=function(e){return Y(this,e).get(e)},r.prototype.has=function(e){return Y(this,e).has(e)},r.prototype.set=function(e,t){var o=Y(this,e),n=o.size;return o.set(e,t),this.size+=o.size==n?0:1,this},g.prototype.add=g.prototype.push=function(e){return this.__data__.set(e,Lo),this},g.prototype.has=function(e){return this.__data__.has(e)},v.prototype.clear=function(){this.__data__=new a,this.size=0},v.prototype.delete=function(e){var t=this.__data__,e=t.delete(e);return this.size=t.size,e},v.prototype.get=function(e){return this.__data__.get(e)},v.prototype.has=function(e){return this.__data__.has(e)},v.prototype.set=function(e,t){var o=this.__data__;if(o instanceof a){var n=o.__data__;if(!Mt||n.length<199)return n.push([e,t]),this.size=++o.size,this;o=this.__data__=new r(n)}return o.set(e,t),this.size=o.size,this};var Wt,Vt,qt,Gt=(Wt=u,function(e,t){if(null==e)return e;if(!Be(e))return Wt(e,t);for(var o=e.length,n=Vt?o:-1,a=Ze(e);(Vt?n--:++n<o)&&!1!==t(a[n],n,a););return e}),Qt=function(e,t,o){for(var n=-1,a=Ze(e),i=o(e),r=i.length;r--;){var s=i[qt?r:++n];if(!1===t(a[s],s,a))break}return e},mt=zt?function(e,t){return zt.set(e,t),e}:Ne,t=Bt?function(e,t){return Bt(e,"toString",{configurable:!0,enumerable:!1,value:$e(t),writable:!0})}:Ne,Xt=Ye||function(e){return Dn.clearTimeout(e)},Kt=zt?function(e){return zt.get(e)}:Ve,Yt=xt?function(t){return null==t?[]:(t=Ze(t),yo(xt(t),function(e){return bt.call(t,e)}))}:Ge,Jt=xt?function(e){for(var t=[];e;)Bo(t,Yt(e)),e=gt(e);return t}:Ge,Zt=k;(et&&Zt(new et(new ArrayBuffer(1)))!=nn||Mt&&Zt(new Mt)!=Go||pt&&Zt(pt.resolve())!=Ko||Ke&&Zt(new Ke)!=Jo||Je&&Zt(new Je)!=tn)&&(Zt=function(e){var t=k(e),e=t==Xo?e.constructor:zo,e=e?de(e):"";if(e)switch(e){case Lt:return nn;case At:return Go;case Ht:return Ko;case Ot:return Jo;case Ut:return tn}return t});var eo,to,oo=le(mt),no=rt||function(e,t){return Dn.setTimeout(e,t)},ao=le(t),io=(to=(eo=ke(eo=function(e){var a=[];return gn.test(e)&&a.push(""),e.replace(vn,function(e,t,o,n){a.push(o?n.replace(Bn,"$1"):t||e)}),a},function(e){return 500===to.size&&to.clear(),e})).cache,eo),Ke=L(function(e){var t=Co(e,O);return t.length&&t[0]===e[0]?function(e,t,o){for(var n=o?wo:ko,a=e[0].length,i=e.length,r=i,s=Xe(i),l=1/0,c=[];r--;){var d=e[r];r&&t&&(d=Co(d,So(t))),l=Et(d.length,l),s[r]=!o&&(t||120<=a&&120<=d.length)?new g(r&&d):zo}var d=e[0],u=-1,p=s[0];e:for(;++u<a&&c.length<l;){var m=d[u],f=t?t(m):m,m=o||0!==m?m:0;if(!(p?Eo(p,f):n(c,f,o))){for(r=i;--r;){var h=s[r];if(!(h?Eo(h,f):n(e[r],f,o)))continue e}p&&p.push(f),c.push(m)}}return c}(t):[]}),Je=L(fe),mt=L(function(e,t){return xe(e)?function(e,t,o,n){var a=-1,i=ko,r=!0,s=e.length,l=[],c=t.length;if(!s)return l;o&&(t=Co(t,So(o))),n?(i=wo,r=!1):200<=t.length&&(i=Eo,r=!1,t=new g(t));e:for(;++a<s;){var d=e[a],u=null==o?d:o(d),d=n||0!==d?d:0;if(r&&u==u){for(var p=c;p--;)if(t[p]===u)continue e;l.push(d)}else i(t,u,n)||l.push(d)}return l}(e,t):[]}),rt=(G(function(t){function e(e){return function(e,t){for(var o=-1,n=t.length,a=Xe(n),i=null==e;++o<n;)a[o]=i?zo:Ae(e,t[o]);return a}(e,t)}var o=t.length,n=o?t[0]:0,a=this.__wrapped__;return!(1<o||this.__actions__.length)&&a instanceof x&&te(n)?((a=a.slice(n,+n+(o?1:0))).__actions__.push({func:ve,args:[e],thisArg:zo}),new f(a,this.__chain__).thru(function(e){return o&&!e.length&&e.push(zo),e})):this.thru(e)}),L(function(e,t){if(null==e)return[];var o=t.length;return 1<o&&oe(e,t[0],t[1])?t=[]:2<o&&oe(t[0],t[1],t[2])&&(t=[t[0]]),z(e,d(t,1),[])})),ro=at||function(){return Dn.Date.now()},t=L(function(e,t,o){return function(e,t,o){if("function"!=typeof e)throw new ot(Do);return no(function(){e.apply(zo,o)},t)}(e,De(t)||0,o)});ke.Cache=r;var so,lo,co=T(function(){return arguments}())?T:function(e){return Ee(e)&&lt.call(e,"callee")&&!bt.call(e,"callee")},uo=Xe.isArray,po=It||Qe,mo=An?So(An):function(e){return Ee(e)&&Te(e.length)&&!!Mn[k(e)]},fo=(so=function(e,t,o,n){N(t,Ue(t),e,n)},L(function(e,t){var o=-1,n=t.length,a=1<n?t[n-1]:zo,i=2<n?t[2]:zo,a=3<so.length&&"function"==typeof a?(n--,a):zo;for(i&&oe(t[0],t[1],i)&&(a=n<3?zo:a,n=1),e=Ze(e);++o<n;){var r=t[o];r&&so(e,r,o,a)}return e})),at=L(function(e){return e.push(zo,V),vo(fo,zo,e)}),It=G(function(e,t){return null==e?{}:D(e,t)});return B.assignInWith=fo,B.chain=ge,B.constant=$e,B.debounce=ye,B.defaults=at,B.delay=t,B.filter=function(e,t){return(uo(e)?yo:l)(e,K(t,3))},B.flatten=pe,B.intersection=Ke,B.iteratee=Re,B.keys=Oe,B.keysIn=Ue,B.map=function(e,t){return(uo(e)?Co:P)(e,K(t,3))},B.memoize=ke,B.mixin=We,B.negate=we,B.pick=It,B.property=qe,B.pull=Je,B.pullAll=fe,B.reverse=he,B.sortBy=rt,B.tap=function(e,t){return t(e),e},B.throttle=function(e,t,o){var n=!0,a=!0;if("function"!=typeof e)throw new ot(Do);return Se(o)&&(n="leading"in o?!!o.leading:n,a="trailing"in o?!!o.trailing:a),ye(e,t,{leading:n,maxWait:t,trailing:a})},B.thru=ve,B.toArray=Me,B.values=je,B.without=mt,B.extendWith=fo,We(B,B),B.eq=Ce,B.forEach=be,B.get=Ae,B.has=function(e,t){return null!=e&&Z(e,t,w)},B.hasIn=He,B.identity=Ne,B.indexOf=function(e,t,o){var n=null==e?0:e.length;return n?(o=null==o?0:ze(o),Io(e,t,o=o<0?St(n+o,0):o)):-1},B.isArguments=co,B.isArray=uo,B.isArrayLike=Be,B.isArrayLikeObject=xe,B.isBoolean=function(e){return!0===e||!1===e||Ee(e)&&k(e)==No},B.isBuffer=po,B.isEmpty=function(e){if(null==e)return!0;if(Be(e)&&(uo(e)||"string"==typeof e||"function"==typeof e.splice||po(e)||mo(e)||co(e)))return!e.length;var t,o=Zt(e);if(o==Go||o==Jo)return!e.size;if(ae(e))return!F(e).length;for(t in e)if(lt.call(e,t))return!1;return!0},B.isFunction=Ie,B.isLength=Te,B.isObject=Se,B.isObjectLike=Ee,B.isString=_e,B.isSymbol=Fe,B.isTypedArray=mo,B.isUndefined=function(e){return e===zo},B.last=me,B.stubArray=Ge,B.stubFalse=Qe,B.noop=Ve,B.now=ro,B.runInContext=e,B.toFinite=Pe,B.toInteger=ze,B.toNumber=De,B.toString=Le,B.each=be,We(B,(lo={},u(B,function(e,t){lt.call(B.prototype,t)||(lo[t]=e)}),lo),{chain:!1}),B.VERSION="4.17.4",bo(["drop","take"],function(o,n){x.prototype[o]=function(e){e=e===zo?1:St(ze(e),0);var t=this.__filtered__&&!n?new x(this):this.clone();return t.__filtered__?t.__takeCount__=Et(e,t.__takeCount__):t.__views__.push({size:Et(e,Oo),type:o+(t.__dir__<0?"Right":"")}),t},x.prototype[o+"Right"]=function(e){return this.reverse()[o](e).reverse()}}),bo(["filter","map","takeWhile"],function(e,t){var o=t+1,n=1==o||3==o;x.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:K(e,3),type:o}),t.__filtered__=t.__filtered__||n,t}}),bo(["head","last"],function(e,t){var o="take"+(t?"Right":"");x.prototype[e]=function(){return this[o](1).value()[0]}}),bo(["initial","tail"],function(e,t){var o="drop"+(t?"":"Right");x.prototype[e]=function(){return this.__filtered__?new x(this):this[o](1)}}),x.prototype.compact=function(){return this.filter(Ne)},x.prototype.find=function(e){return this.filter(e).head()},x.prototype.findLast=function(e){return this.reverse().find(e)},x.prototype.invokeMap=L(function(t,o){return"function"==typeof t?new x(this):this.map(function(e){return I(e,t,o)})}),x.prototype.reject=function(e){return this.filter(we(K(e)))},x.prototype.slice=function(e,t){e=ze(e);var o=this;return o.__filtered__&&(0<e||t<0)?new x(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),t!==zo?(t=ze(t))<0?o.dropRight(-t):o.take(t-e):o)},x.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},x.prototype.toArray=function(){return this.take(Oo)},u(x.prototype,function(c,e){var d=/^(?:filter|find|map|reject)|While$/.test(e),u=/^(?:head|last)$/.test(e),p=B[u?"take"+("last"==e?"Right":""):e],m=u||/^find/.test(e);p&&(B.prototype[e]=function(){function e(e){return e=p.apply(B,Bo([e],o)),u&&r?e[0]:e}var t=this.__wrapped__,o=u?[1]:arguments,n=t instanceof x,a=o[0],i=n||uo(t);i&&d&&"function"==typeof a&&1!=a.length&&(n=i=!1);var r=this.__chain__,s=!!this.__actions__.length,a=m&&!r,s=n&&!s;if(m||!i)return a&&s?c.apply(this,o):(l=this.thru(e),a?u?l.value()[0]:l.value():l);var t=s?t:new x(this),l=c.apply(t,o);return l.__actions__.push({func:ve,args:[e],thisArg:zo}),new f(l,r)})}),bo(["pop","push","shift","sort","splice","unshift"],function(e){var o=nt[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",a=/^(?:pop|shift)$/.test(e);B.prototype[e]=function(){var t=arguments;if(!a||this.__chain__)return this[n](function(e){return o.apply(uo(e)?e:[],t)});var e=this.value();return o.apply(uo(e)?e:[],t)}}),u(x.prototype,function(e,t){var o,n=B[t];n&&(o=n.name+"",(Dt[o]||(Dt[o]=[])).push({name:t,func:n}))}),Dt[W(zo,2).name]=[{name:"wrapper",func:zo}],x.prototype.clone=function(){var e=new x(this.__wrapped__);return e.__actions__=$(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=$(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=$(this.__views__),e},x.prototype.reverse=function(){var e;return this.__filtered__?((e=new x(this)).__dir__=-1,e.__filtered__=!0):(e=this.clone()).__dir__*=-1,e},x.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,o=uo(e),n=t<0,a=o?e.length:0,i=function(e,t,o){var n=-1,a=o.length;for(;++n<a;){var i=o[n],r=i.size;switch(i.type){case"drop":e+=r;break;case"dropRight":t-=r;break;case"take":t=Et(t,e+r);break;case"takeRight":e=St(e,t-r)}}return{start:e,end:t}}(0,a,this.__views__),r=i.start,s=(i=i.end)-r,l=n?i:r-1,c=this.__iteratees__,d=c.length,u=0,p=Et(s,this.__takeCount__);if(!o||!n&&a==s&&p==s)return H(e,this.__actions__);var m=[];e:for(;s--&&u<p;){for(var f=-1,h=e[l+=t];++f<d;){var g=c[f],v=g.iteratee,g=g.type,v=v(h);if(2==g)h=v;else if(!v){if(1==g)continue e;break e}}m[u++]=h}return m},B.prototype.chain=function(){return ge(this)},B.prototype.commit=function(){return new f(this.value(),this.__chain__)},B.prototype.next=function(){this.__values__===zo&&(this.__values__=Me(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?zo:this.__values__[this.__index__++]}},B.prototype.plant=function(e){for(var t,o=this;o instanceof i;){var n=ue(o);n.__index__=0,n.__values__=zo,t?a.__wrapped__=n:t=n;var a=n,o=o.__wrapped__}return a.__wrapped__=e,t},B.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof x){e=e;return(e=(e=this.__actions__.length?new x(this):e).reverse()).__actions__.push({func:ve,args:[he],thisArg:zo}),new f(e,this.__chain__)}return this.thru(he)},B.prototype.toJSON=B.prototype.valueOf=B.prototype.value=function(){return H(this.__wrapped__,this.__actions__)},B.prototype.first=B.prototype.head,wt&&(B.prototype[wt]=function(){return this}),B},Hn=e();(Hn=o._=e()).pluck=Hn.map,o.each(Hn,function(e,t){Object.hasOwnProperty.call(Hn,e)&&!/VERSION/.test(name)&&(o[e]||(o[e]=t))})}),FD50.plugin("bootstrap",function(a){var n,e=a;function t(e,t){var o;return this.$element=n(e),this.$note=n('<div class="alert"></div>'),this.options=n.extend(!0,n.fn.notify.defaults,t),this.options.transition?("fade"==this.options.transition?this.$note.addClass("in"):this.$note).addClass(this.options.transition):this.$note.addClass("fade").addClass("in"),this.options.type?this.$note.addClass("alert-"+this.options.type):this.$note.addClass("alert-success"),this.options.message||""===this.$element.data("message")?"object"==typeof this.options.message&&(this.options.message.html?this.$note.html(this.options.message.html):this.options.message.text?this.$note.text(this.options.message.text):this.$note.html(this.options.message)):this.$note.html(this.$element.data("message")),this.options.closable&&(o=n('<a class="close pull-right" href="javascript: void(0);">&times;</a>')),n(o).on("click",n.proxy(onClose,this)),this.$note.prepend(o),this}!function(n){"use strict";n.fn.emulateTransitionEnd=function(e){var t=!1,o=this;n(this).one(n.support.transition.end,function(){t=!0});return setTimeout(function(){t||n(o).trigger(n.support.transition.end)},e),this},n(function(){n.support.transition=function(){var e,t=document.createElement("bootstrap"),o={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(e in o)if(void 0!==t.style[e])return{end:o[e]}}()})}(e),function(i){"use strict";function n(e){i(e).on("click",t,this.close)}var t='[data-bp-dismiss="alert"]';n.prototype.close=function(e){function t(){a.trigger("closed.bs.alert").remove()}var o=i(this),n=(n=o.attr("data-target"))||(n=o.attr("href"))&&n.replace(/.*(?=#[^\s]*$)/,""),a=i(n);e&&e.preventDefault(),(a=!a.length?o.hasClass("alert")?o:o.parent():a).trigger(e=i.Event("close.bs.alert")),e.isDefaultPrevented()||(a.removeClass("in"),i.support.transition&&a.hasClass("fade")?a.one(i.support.transition.end,t).emulateTransitionEnd(150):t())};var e=i.fn.alert;i.fn.alert=function(o){return this.each(function(){var e=i(this),t=e.data("bs.alert");t||e.data("bs.alert",t=new n(this)),"string"==typeof o&&t[o].call(e)})},i.fn.alert.Constructor=n,i.fn.alert.noConflict=function(){return i.fn.alert=e,this},i(document).on("click.bs.alert.data-api",t,n.prototype.close)}(e),function(n){"use strict";function a(e,t){this.$element=n(e),this.options=n.extend({},a.DEFAULTS,t)}a.DEFAULTS={loadingText:"loading..."},a.prototype.setState=function(e){var t="disabled",o=this.$element,n=o.is("input")?"val":"html",a=o.data();e+="Text",a.resetText||o.data("resetText",o[n]()),o[n](a[e]||this.options[e]),setTimeout(function(){"loadingText"==e?o.addClass(t).attr(t,t):o.removeClass(t).removeAttr(t)},0)},a.prototype.toggle=function(){var e,t=this.$element.closest('[data-bp-toggle="buttons"]'),o=!0;t.length&&("radio"===(e=this.$element.find("input")).prop("type")&&(e.prop("checked")&&this.$element.hasClass("active")?o=!1:t.find(".active").removeClass("active")),o&&e.prop("checked",!this.$element.hasClass("active")).trigger("change")),o&&this.$element.toggleClass("active")};var e=n.fn.button;n.fn.button=function(o){return this.each(function(){var e=n(this),t=e.data("bs.button");t||e.data("bs.button",t=new a(this,"object"==typeof o&&o)),"toggle"==o?t.toggle():o&&t.setState(o)})},n.fn.button.Constructor=a,n.fn.button.noConflict=function(){return n.fn.button=e,this},n(document).on("click.bs.button.data-api","[data-bp-toggle^=button]",function(e){var t=n(e.target);(t=!t.hasClass("btn")?t.closest(".btn"):t).button("toggle"),e.preventDefault()})}(e),function(s){"use strict";function i(e,t){this.$element=s(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=t,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",s.proxy(this.pause,this)).on("mouseleave",s.proxy(this.cycle,this))}i.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},i.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(s.proxy(this.next,this),this.options.interval)),this},i.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},i.prototype.to=function(e){var t=this,o=this.getActiveIndex();if(!(e>this.$items.length-1||e<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){t.to(e)}):o==e?this.pause().cycle():this.slide(o<e?"next":"prev",s(this.$items[e]))},i.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&s.support.transition.end&&(this.$element.trigger(s.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},i.prototype.next=function(){if(!this.sliding)return this.slide("next")},i.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},i.prototype.slide=function(e,t){var o=this.$element.find(".item.active"),n=t||o[e](),a=this.interval,i="next"==e?"left":"right",t="next"==e?"first":"last",r=this;if(!n.length){if(!this.options.wrap)return;n=this.$element.find(".item")[t]()}this.sliding=!0,a&&this.pause();t=s.Event("slide.bs.carousel",{relatedTarget:n[0],direction:i});if(!n.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid.bs.carousel",function(){var e=s(r.$indicators.children()[r.getActiveIndex()]);e&&e.addClass("active")})),s.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(t),t.isDefaultPrevented())return;n.addClass(e),n[0].offsetWidth,o.addClass(i),n.addClass(i),o.one(s.support.transition.end,function(){n.removeClass([e,i].join(" ")).addClass("active"),o.removeClass(["active",i].join(" ")),r.sliding=!1,setTimeout(function(){r.$element.trigger("slid.bs.carousel")},0)}).emulateTransitionEnd(600)}else{if(this.$element.trigger(t),t.isDefaultPrevented())return;o.removeClass("active"),n.addClass("active"),this.sliding=!1,this.$element.trigger("slid.bs.carousel")}return a&&this.cycle(),this}};var e=s.fn.carousel;s.fn.carousel=function(a){return this.each(function(){var e=s(this),t=e.data("bs.carousel"),o=s.extend({},i.DEFAULTS,e.data(),"object"==typeof a&&a),n="string"==typeof a?a:o.slide;t||e.data("bs.carousel",t=new i(this,o)),"number"==typeof a?t.to(a):n?t[n]():o.interval&&t.pause().cycle()})},s.fn.carousel.Constructor=i,s.fn.carousel.noConflict=function(){return s.fn.carousel=e,this},s(document).on("click.bs.carousel.data-api","[data-bp-slide], [data-bp-slide-to]",function(e){var t,o=s(this),n=s(o.attr("data-target")||(t=o.attr("href"))&&t.replace(/.*(?=#[^\s]+$)/,"")),a=s.extend({},n.data(),o.data());(t=o.attr("data-bp-slide-to"))&&(a.interval=!1),n.carousel(a),(t=o.attr("data-bp-slide-to"))&&n.data("bs.carousel").to(t),e.preventDefault()}),s(window).on("load",function(){s('[data-bp-ride="carousel"]').each(function(){var e=s(this);e.carousel(e.data())})})}(e),function(r){"use strict";function a(e,t){this.$element=r(e),this.options=r.extend({},a.DEFAULTS,t),this.transitioning=null,this.options.parent&&(this.$parent=r(this.options.parent)),this.options.toggle&&this.toggle()}a.DEFAULTS={toggle:!0},a.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},a.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e=r.Event("show.bs.collapse");if(this.$element.triggerHandler(e),!e.isDefaultPrevented()){e=this.$parent&&this.$parent.find("> .panel > .in");if(e&&e.length){var t=e.data("bs.collapse");if(t&&t.transitioning)return;e.collapse("hide"),t||e.data("bs.collapse",null)}var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0),this.transitioning=1;t=function(){this.$element.removeClass("collapsing").addClass("in")[o]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!r.support.transition)return t.call(this);e=r.camelCase(["scroll",o].join("-"));this.$element.one(r.support.transition.end,r.proxy(t,this)).emulateTransitionEnd(350)[o](this.$element[0][e])}}},a.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=r.Event("hide.bs.collapse");if(this.$element.triggerHandler(e),!e.isDefaultPrevented()){var t=this.dimension();this.$element[t](this.$element[t]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;e=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};if(!r.support.transition)return e.call(this);this.$element[t](0).one(r.support.transition.end,r.proxy(e,this)).emulateTransitionEnd(350)}}},a.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var e=r.fn.collapse;r.fn.collapse=function(n){return this.each(function(){var e=r(this),t=e.data("bs.collapse"),o=r.extend({},a.DEFAULTS,e.data(),"object"==typeof n&&n);t||e.data("bs.collapse",t=new a(this,o)),"string"==typeof n&&t[n]()})},r.fn.collapse.Constructor=a,r.fn.collapse.noConflict=function(){return r.fn.collapse=e,this},r(document).on("click.bs.collapse.data-api","[data-eb-toggle=collapse]",function(e){var t=r(this),o=t.attr("data-target")||e.preventDefault()||(i=t.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""),n=r(o),a=n.data("bs.collapse"),e=a?"toggle":t.data(),i=t.attr("data-parent"),o=i&&r(i);a&&a.transitioning||(o&&o.find('[data-eb-toggle=collapse][data-parent="'+i+'"]').not(t).addClass("collapsed"),t[n.hasClass("in")?"addClass":"removeClass"]("collapsed")),n.collapse(e)})}(e),function(a){"use strict";function i(){(!window["Foundry/Bootstrap"]||0<a(e).length)&&a(e).remove(),a(s).each(function(e){var t=r(a(this));t.hasClass("open")&&(t.triggerHandler(e=a.Event("hide.bs.dropdown")),e.isDefaultPrevented()||t.removeClass("open").trigger("hidden.bs.dropdown"))})}function r(e){var t=e.attr("data-target"),t=(t=t||(t=e.attr("href"))&&/#/.test(t)&&t.replace(/.*(?=#[^\s]*$)/,""))&&a(t);return t&&t.length?t:e.parent()}function n(e){a(e).on("click.bs.dropdown",this.toggle)}var e=".dropdown-backdrop",s="[data-bp-toggle=dropdown]";n.prototype.toggle=function(e){var t=a(this);if(!t.is(".disabled, :disabled")){var o=r(t),n=o.hasClass("open");if(i(),!n){if("ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click",i),o.triggerHandler(e=a.Event("show.bs.dropdown")),e.isDefaultPrevented())return;o.toggleClass("open").trigger("shown.bs.dropdown"),t.focus()}return!1}},n.prototype.keydown=function(e){if(/(38|40|27)/.test(e.keyCode)){var t=a(this);if(e.preventDefault(),e.stopPropagation(),!t.is(".disabled, :disabled")){var o=r(t),n=o.hasClass("open");if(!n||27==e.keyCode)return 27==e.which&&o.find(s).focus(),t.click();t=a("[role=menu] li:not(.divider):visible a",o);t.length&&(o=t.index(t.filter(":focus")),38==e.keyCode&&0<o&&o--,40==e.keyCode&&o<t.length-1&&o++,t.eq(o=!~o?0:o).focus())}}};var t=a.fn.dropdown;a.fn.dropdown=function(o){return this.each(function(){var e=a(this),t=e.data("bs.dropdown");t||e.data("bs.dropdown",t=new n(this)),"string"==typeof o&&t[o].call(e)})},a.fn.dropdown.Constructor=n,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=t,this},a(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown_ form, .dropdown-static",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",s,n.prototype.toggle).on("keydown.bs.dropdown.data-api",s+", [role=menu]",n.prototype.keydown)}(e),function(i){"use strict";function r(e,t){this.options=t,this.$element=i(e),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)}r.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},r.prototype.toggle=function(e){return this[this.isShown?"hide":"show"](e)},r.prototype.show=function(o){var n=this,e=i.Event("show.bs.modal",{relatedTarget:o});this.$element.triggerHandler(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-bp-dismiss="modal"]',i.proxy(this.hide,this)),this.backdrop(function(){var e=i.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show(),e&&n.$element[0].offsetWidth,n.$element.addClass("in").attr("aria-hidden",!1),n.enforceFocus();var t=i.Event("shown.bs.modal",{relatedTarget:o});e?n.$element.find(".modal-dialog").one(i.support.transition.end,function(){n.$element.focus().trigger(t)}).emulateTransitionEnd(300):n.$element.focus().trigger(t)}))},r.prototype.hide=function(e){e&&e.preventDefault(),e=i.Event("hide.bs.modal"),this.$element.triggerHandler(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),i(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),i.support.transition&&this.$element.hasClass("fade")?this.$element.one(i.support.transition.end,i.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},r.prototype.enforceFocus=function(){i(document).off("focusin.bs.modal").on("focusin.bs.modal",i.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.focus()},this))},r.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",i.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},r.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden.bs.modal")})},r.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},r.prototype.backdrop=function(e){var t,o=this.$element.hasClass("fade")?"fade":"";this.isShown&&this.options.backdrop?(t=i.support.transition&&o,this.$backdrop=i('<div class="modal-backdrop '+o+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",i.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),t&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),e&&(t?this.$backdrop.one(i.support.transition.end,e).emulateTransitionEnd(150):e())):!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),i.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(i.support.transition.end,e).emulateTransitionEnd(150):e()):e&&e()};var e=i.fn.modal;i.fn.modal=function(n,a){return this.each(function(){var e=i(this),t=e.data("bs.modal"),o=i.extend({},r.DEFAULTS,e.data(),"object"==typeof n&&n);t||e.data("bs.modal",t=new r(this,o)),"string"==typeof n?t[n](a):o.show&&t.show(a)})},i.fn.modal.Constructor=r,i.fn.modal.noConflict=function(){return i.fn.modal=e,this},i(document).on("click.bs.modal.data-api",'[data-bp-toggle="modal"]',function(e){var t=i(this),o=t.attr("href"),n=i(t.attr("data-target")||o&&o.replace(/.*(?=#[^\s]+$)/,"")),o=n.data("modal")?"toggle":i.extend({remote:!/#/.test(o)&&o},n.data(),t.data());e.preventDefault(),n.modal(o,this).one("hide",function(){t.is(":visible")&&t.focus()})}),i(document).on("show.bs.modal",".modal.bs",function(){i(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal.bs",function(){i(document.body).removeClass("modal-open")})}(e),function(d){"use strict";function n(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)}n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},n.prototype.init=function(e,t,o){this.enabled=!0,this.type=e,this.$element=d(t),this.options=this.getOptions(o);for(var n=this.options.trigger.split(" "),a=n.length;a--;){var i,r=n[a];"click"==r?this.$element.on("click."+this.type,this.options.selector,d.proxy(this.toggle,this)):"manual"!=r&&(i="hover"==r?"mouseleave":"blur",this.$element.on(("hover"==r?"mouseenter":"focus")+"."+this.type,this.options.selector,d.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,d.proxy(this.leave,this)))}this.options.selector?this._options=d.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(e){return(e=d.extend({},this.getDefaults(),this.$element.data(),e)).delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},n.prototype.getDelegateOptions=function(){var o={},n=this.getDefaults();return this._options&&d.each(this._options,function(e,t){n[e]!=t&&(o[e]=t)}),o},n.prototype.enter=function(e){var t=e instanceof this.constructor?e:d(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);if(clearTimeout(t.timeout),t.hoverState="in",!t.options.delay||!t.options.delay.show)return t.show();t.timeout=setTimeout(function(){"in"==t.hoverState&&t.show()},t.options.delay.show)},n.prototype.leave=function(e){var t=e instanceof this.constructor?e:d(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);if(clearTimeout(t.timeout),t.hoverState="out",!t.options.delay||!t.options.delay.hide)return t.hide();t.timeout=setTimeout(function(){"out"==t.hoverState&&t.hide()},t.options.delay.hide)},n.prototype.show=function(){var e,t,o,n,a,i,r,s,l,c=d.Event("show.bs."+this.type);this.hasContent()&&this.enabled&&(this.$element.triggerHandler(c),c.isDefaultPrevented()||(e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),s="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,(i=(a=/\s?auto?\s?/i).test(s))&&(s=s.replace(a,"")||"top"),e.detach().css({top:0,left:0,display:"block"}).addClass(s.split("-")[0]),this.options.container?e.appendTo(this.options.container):e.insertAfter(this.$element),t=this.getPosition(),o=e[0].offsetWidth,l=e[0].offsetHeight,i&&(r=this.$element.parent(),n=s,c=document.documentElement.scrollTop||document.body.scrollTop,a="body"==this.options.container?window.innerWidth:r.outerWidth(),i="body"==this.options.container?window.innerHeight:r.outerHeight(),r="body"==this.options.container?0:r.offset().left,s="bottom"==s&&t.top+t.height+l-c>i?"top":"top"==s&&t.top-c-l<0?"bottom":"right"==s&&t.right+o>a?"left":"left"==s&&t.left-o<r?"right":s,e.removeClass(n).addClass(s)),l=this.getCalculatedOffset(s,t,o,l),this.applyPlacement(l,s),this.$element.trigger("shown.bs."+this.type)))},n.prototype.applyPlacement=function(e,t){var o,n=this.tip(),a=n[0].offsetWidth,i=n[0].offsetHeight,r=parseInt(n.css("margin-top"),10),s=parseInt(n.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(s)&&(s=0),e.top=e.top+r,e.left=e.left+s,n.offset(e).addClass("in");var l=n[0].offsetWidth,r=n[0].offsetHeight;"top"==t&&r!=i&&(o=!0,e.top=e.top+i-r),0===["top","bottom"].indexOf(t.split("-")[0])&&(e.left<(s=0)&&(s=-2*e.left,e.left=0,n.offset(e),l=n[0].offsetWidth,r=n[0].offsetHeight),this.replaceArrow(s-a+l,l,"left")),0===["left","right"].indexOf(t.split("-")[0])&&this.replaceArrow(r-i,r,"top"),o&&n.offset(e)},n.prototype.replaceArrow=function(e,t,o){this.arrow().css(o,e?50*(1-e/t)+"%":"")},n.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},n.prototype.hide=function(){function e(){"in"!=t.hoverState&&o.detach()}var t=this,o=this.tip(),n=d.Event("hide.bs."+this.type);if(this.$element.triggerHandler(n),!n.isDefaultPrevented())return o.removeClass("in"),d.support.transition&&this.$tip.hasClass("fade")?o.one(d.support.transition.end,e).emulateTransitionEnd(150):e(),this.$element.trigger("hidden.bs."+this.type),this},n.prototype.fixTitle=function(){var e=this.$element;!e.attr("title")&&"string"==typeof e.attr("data-original-title")||e.attr("data-original-title",e.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(){var e=this.$element[0];return d.extend({},"function"==typeof e.getBoundingClientRect?e.getBoundingClientRect():{width:e.offsetWidth,height:e.offsetHeight},this.$element.offset())},n.prototype.getCalculatedOffset=function(e,t,o,n){return"left-top"==e?{top:t.top,left:t.left-o}:"left-bottom"==e?{top:t.top+t.height-n,left:t.left-o}:"right-top"==e?{top:t.top,left:t.left+t.width}:"right-bottom"==e?{top:t.top+t.height-n,left:t.left+t.width}:"top-left"==e?{top:t.top-n,left:t.left}:"top-right"==e?{top:t.top-n,left:t.left+t.width-o}:"bottom-left"==e?{top:t.top+t.height,left:t.left}:"bottom-right"==e?{top:t.top+t.height,left:t.left+t.width-o}:"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-o/2}:"top"==e?{top:t.top-n,left:t.left+t.width/2-o/2}:"left"==e?{top:t.top+t.height/2-n/2,left:t.left-o}:{top:t.top+t.height/2-n/2,left:t.left+t.width}},n.prototype.getTitle=function(){var e=this.$element,t=this.options;return e.attr("data-original-title")||("function"==typeof t.title?t.title.call(e[0]):t.title)},n.prototype.tip=function(){return this.$tip=this.$tip||d(this.options.template)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(e){e=e?d(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;e.tip().hasClass("in")?e.leave(e):e.enter(e)},n.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var e=d.fn.tooltip;d.fn.tooltip=function(o){return this.each(function(){var e=d(this),t=e.data("bs.tooltip");t||e.data("bs.tooltip",t=new n(this,"object"==typeof o&&o)),"string"==typeof o&&t[o]()})},d.fn.tooltip.Constructor=n,d.fn.tooltip.noConflict=function(){return d.fn.tooltip=e,this}}(e),function(n){"use strict";function a(e,t){this.init("popover",e,t)}if(!n.fn.tooltip)throw new Error("Popover requires tooltip.js");a.DEFAULTS=n.extend({},n.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div id="eb" class="eb-popover"><div class="arrow"></div><h3 class="eb-popover-title"></h3><div class="eb-popover-content"></div></div>'}),a.prototype=n.extend({},n.fn.tooltip.Constructor.prototype),(a.prototype.constructor=a).prototype.getDefaults=function(){return a.DEFAULTS},a.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),o=this.getContent();e.find(".eb-popover-title")[this.options.html?"html":"text"](t),e.find(".eb-popover-content")[this.options.html?"html":"text"](o),e.removeClass("fade top bottom left right in"),e.find(".eb-popover-title").html()||e.find(".eb-popover-title").hide()},a.prototype.hasContent=function(){return this.getTitle()||this.getContent()},a.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},a.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},a.prototype.tip=function(){return this.$tip||(this.$tip=n(this.options.template)),this.$tip};var e=n.fn.popover;n.fn.popover=function(o){return this.each(function(){var e=n(this),t=e.data("bs.popover");t||e.data("bs.popover",t=new a(this,"object"==typeof o&&o)),"string"==typeof o&&t[o]()})},n.fn.popover.Constructor=a,n.fn.popover.noConflict=function(){return n.fn.popover=e,this}}(e),function(r){"use strict";function n(e){this.element=r(e)}n.prototype.show=function(){var e,t,o=this.element,n=o.closest("ul:not(.dropdown-menu)"),a=(a=o.data("target"))||(a=o.attr("href"))&&a.replace(/.*(?=#[^\s]*$)/,"");o.parent("li").hasClass("active")||(e=n.find(".active:last a")[0],t=r.Event("show.bs.tab",{relatedTarget:e}),o.triggerHandler(t),t.isDefaultPrevented()||(a=r(a),this.activate(o.parent("li"),n),this.activate(a,a.parent(),function(){o.trigger({type:"shown.bs.tab",relatedTarget:e})})))},n.prototype.activate=function(e,t,o){function n(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),e.addClass("active"),i?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu")&&e.closest("li.dropdown").addClass("active"),o&&o()}var a=t.find("> .active"),i=o&&r.support.transition&&a.hasClass("fade");i?a.one(r.support.transition.end,n).emulateTransitionEnd(150):n(),a.removeClass("in")};var e=r.fn.tab;r.fn.tab=function(o){return this.each(function(){var e=r(this),t=e.data("bs.tab");t||e.data("bs.tab",t=new n(this)),"string"==typeof o&&t[o]()})},r.fn.tab.Constructor=n,r.fn.tab.noConflict=function(){return r.fn.tab=e,this},r(document).on("click.bs.tab.data-api",'[data-bp-toggle="tab"], [data-bp-toggle="pill"]',function(e){e.preventDefault(),r(this).tab("show")})}(e),a(document).on("click.button.data-bp-api","[data-bp-toggle-value]",function(){var e=a(this),t=(e.siblings("[data-bp-toggle-value]"),e.parents('[data-bp-toggle="radio-buttons"]'));t.hasClass("disabled")||0<t.length&&(e=e.data("bp-toggle-value"),t.find("input[type=hidden]").val(e).trigger("change"))}),a(document).on("change.data-bp-input",'[data-bp-toggle="radio-buttons"] input[type=hidden]',function(){var e=a(this),t=e.siblings("[data-bp-toggle-value]");e.val();t.removeClass("active").filter('[data-bp-toggle-value="'+e.val()+'"]').addClass("active")}),a(document).on("mouseover.tooltip.data-eb-api","[data-eb-provide=tooltip]",function(e){var t=a(this),o=t.parents("#eb").is(".w320, .w480"),n=void 0!==t.data("html")&&t.data("html");o||t.tooltip({delay:{show:200,hide:100},html:n,animation:!1,template:'<div id="eb" class="eb tooltip tooltip-eb"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',container:"body"}).tooltip("show")}),a(document).on("mouseover.popover.data-eb-api","[data-eb-provide=popover]",function(){a(this).popover({delay:{show:200,hide:100},animation:!1,trigger:"hover",container:"body"}).popover("show")}),n=a,onClose=function(){this.options.onClose(),n(this.$note).remove(),this.options.onClosed()},t.prototype.show=function(){this.options.fadeOut.enabled&&this.$note.delay(this.options.fadeOut.delay||3e3).fadeOut("slow",n.proxy(onClose,this)),this.$element.append(this.$note),this.$note.alert()},t.prototype.hide=function(){this.options.fadeOut.enabled?this.$note.delay(this.options.fadeOut.delay||3e3).fadeOut("slow",n.proxy(onClose,this)):onClose.call(this)},n.fn.notify=function(e){return new t(this,e)},n.fn.notify.defaults={type:"success",closable:!0,transition:"fade",fadeOut:{enabled:!0,delay:3e3},message:null,onClose:function(){},onClosed:function(){}}}),FD50.plugin("utils",function(d){function t(e){this.items=e,this.start=0,this.end=e.length-1,this.node=null,this.stopped=!1}function o(){this.lastId=0}var a,i,n,r,s,l;function c(e){this.threads=[],this.threadCount=0,this.threadLimit=e.threadLimit||1,this.threadDelay=e.threadDelay||0}function u(e){return{r:(e=parseInt(-1<e.indexOf("#")?e.substring(1):e,16))>>16,g:(65280&e)>>8,b:255&e}}function p(e){var t={h:0,s:0,b:0},o=Math.min(e.r,e.g,e.b),n=Math.max(e.r,e.g,e.b),o=n-o;return t.b=n,t.s=0!=n?255*o/n:0,0!=t.s?(e.r==n?t.h=(e.g-e.b)/o:e.g==n?t.h=2+(e.b-e.r)/o:t.h=4+(e.r-e.g)/o,t.h*=60):t.h=360,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t}function m(e){var t={},o=e.h,n=255*e.s/100,a=255*e.b/100;return 0==n?t.r=t.g=t.b=a:(a=o%60*((e=a)-(n=(255-n)*a/255))/60,(o=360==o?0:o)<60?(t.r=e,t.b=n,t.g=n+a):o<120?(t.g=e,t.b=n,t.r=e-a):o<180?(t.g=e,t.r=n,t.b=n+a):o<240?(t.b=e,t.r=n,t.g=e-a):o<300?(t.b=e,t.g=n,t.r=n+a):o<360?(t.r=e,t.g=n,t.b=e-a):(t.r=0,t.g=0,t.b=0)),{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}}function f(e){var o=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];return d.each(o,function(e,t){1==t.length&&(o[e]="0"+t)}),o.join("")}function h(e){return e.split(".")[0]}function g(e){this.fnList={},this.events={},this.mode=e}d.extend(t.prototype,{isLooping:function(){return!this.stopped&&(1<Math.abs(this.start-this.end)&&(this.node=Math.floor((this.start+this.end)/2),!0))},flip:function(e){e?this.end=this.node-1:this.start=this.node+1},stop:function(){this.stop=!0}}),d.Bloop=function(e){return new t(e)},a=d.isFunction,o.prototype.queue=function(t){var o=this,n=d.uid();return o.lastId=n,function(){if(o.lastId===n){var e=arguments,e=a(t)?t.apply(this,e):e;return a(o.fn)?o.fn.apply(this,e):e}}},d.Enqueue=function(e){var t=new o;a(e)&&(t.fn=e);e=d.proxy(t.queue,t);return e.reset=function(){t.lastId=0},e},i={error:"error",warning:"warn",success:"log",info:"info"},d.Exception=function(e){var t=arguments,o=1==t.length,n=3==t.length;return e=d.isPlainObject(e)?e:{type:o?"error":t[0],message:o?t[0]:t[1]},n&&d.extend(e,t[2]),"development"==d.environment&&console[i[e.type]](e.message,e),e},d.IE=function(){var e=navigator.userAgent;if(e.match(/MSIE 9/))return 9;if(e.match(/MSIE 10/))return 10;if(e.match(/rv:11/i))return 11;for(var t=3,o=document.createElement("div"),n=o.getElementsByTagName("i");o.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e",n[0];);return 4<t?t:void 0}(),d.Task=function(e){var t=d.extend(d.Deferred(),{data:{},list:[],add:function(e){e=d.extend(d.Deferred(),{name:e,item:void 0});return t.list.push(e),e},process:function(){return t._promise||(t._promise=d.when.apply(d,t.list).then(t.resolve,t.reject,t.progress)),t}},e);return t},d.extend(c.prototype,{add:function(e,t){d.isFunction(e)&&(e.type=t||"normal","deferred"==t&&(e.deferred=d.Deferred().always(d.proxy(this.next,this))),this.threads.push(e),this.run())},addDeferred:function(e){return this.add(e,"deferred")},next:function(){this.threadCount--,this.run()},run:function(){var t=this;setTimeout(function(){if(!(t.threads.length<1)&&t.threadCount<t.threadLimit){t.threadCount++;var e=t.threads.shift();try{e.call(e,e.deferred)}catch(e){console.error(e)}e.deferred||t.next()}},t.threadDelay)}}),d.Threads=function(e){return new c(e)},d.callback=function(e,t){if(d.isFunction(e)){var o=d.uid("cb");return window[o]=function(){return t||delete window[o],e.apply(null,arguments)},o}d.isString(e)&&"destroy"===e&&(o=t,delete window[o])},d.fn.switchClass=function(o,e){var e=e||"-",n=o.split(e)[0]+e,a=n.length;return this.each(function(){var e=d(this),t=d.map((e.attr("class")||"").split(" "),function(e){return e.slice(0,a)==n||""==e?null:e});t.push(o),e.attr("class",t.join(" "))})},d.fn.activateClass=function(e){return this.prevObject.removeClass(e),d(this).addClass(e)},d.fn.loading=function(){var e=this.attr("class"),t=this.data("loader");this.data("loading",!0),this.data("original",e),this.attr("class",t)},d.fn.doneLoading=function(){var e=this.data("original");this.attr("class",e),this.data("loading",!1)},d.fn.toggleLoading=function(){this.data("loading")||!1?this.doneLoading():this.loading()},d.fn.activateClass=function(e){return this.prevObject.removeClass(e),d(this).addClass(e)},d.extend(d,{hexToRgb:u,hexToHsb:function(e){return p(u(e))},rgbToHsb:p,hsbToRgb:m,rgbToHex:f,hsbToHex:function(e){return f(m(e))},fixHsb:function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}},fixRgb:function(e){return{r:Math.min(255,Math.max(0,e.r)),g:Math.min(255,Math.max(0,e.g)),b:Math.min(255,Math.max(0,e.b))}},fixHex:function(e){var t=6-e.length;if(3==t)for(var o,n=e.split(""),e="";o=n.shift();)e+=o+o;else for(;t--;)e="0"+e;return e.replace(/[^A-Fa-f0-9]/g,"0"),e}}),d.fn.htmlData=function(e,i){var r,i=void 0===i||i,s=new RegExp("^data-"+(e?e+"-":"")+"(.*)","i"),l={};return d.each(this[0].attributes,function(e,t){if(t.specified&&(r=t.name.match(s))&&r[1])if(i){var o,n=r[1].split("-"),a=l;for(max=n.length-1,e=0;e<=max;e++)o=n[e],e==max?a[o]=t.value:(a[o]||(a[o]={}),a=a[o])}else l[r[1]]=t.value}),l},d.fn.defineData=function(e,t){return void 0===this.data(e)&&this.data(e,t),this},d.deletes=function(o,e){d.each(e,function(e,t){delete o[t]})},d.fn.disabled=function(e){return void 0===e?this.is(":disabled")||this.hasClass("disabled"):this.prop("disabled",!!e).toggleClass("disabled",!!e)},d.fn.enabled=function(e){return void 0===e?!this.disabled():this.disabled(!e)},d.fn.tagName=function(){return(this[0]||{}).tagName},d.create=function(e){return d(document.createElement(e))},d.fn.editable=function(e){return d.isUndefined(e)?"true"===this.prop("contenteditable"):(this.prop("contenteditable",e),!1===e&&this.removeAttr("contenteditable"),this)},d.ns=function(e,t){return e.split(" ").join(t+" ")+t},d.getPointerPosition=function(e){return e.type.match("touch")?{x:e.originalEvent.changedTouches[0].pageX,y:e.originalEvent.changedTouches[0].pageY}:{x:e.pageX,y:e.pageY}},n="___eventable",r=["on","off","fire"],d.extend(g.prototype,{createEvent:function(e){return this.events[e]=d.Callbacks(this.mode)},on:function(e,t){if(!e||!d.isFunction(t))return this;var o=this.fnList;(o[e]||(o[e]=[])).push(t);e=h(e);return(this.events[e]||this.createEvent(e)).add(t),this},off:function(e){if(!e)return this;var o=h(e),n=this.events[o];if(!n)return this;function a(e){d.each(e,function(e,t){n.remove(t)})}return o!==e?d.each(this.fnList,function(e,t){-1<e.indexOf(o)&&a(t)}):a(this.fnList[e]),this},fire:function(e){var t=this.events[e];if(t)return t.fire.apply(t,d.makeArray(arguments).slice(1)),this},destroy:function(){for(name in this.events)this.events[name].disable()}}),d.eventable=function(e,t){var o=e[n];return o&&"destroy"===t?(o.destroy(),d.deletes(e,r),delete e[n]):(o=e[n]=new g(t),e.on=d.proxy(o.on,o),e.off=d.proxy(o.off,o),e.fire=d.proxy(o.fire,o),e)},d.fn.checked=function(o,n){return arguments.length<1?this.is(":checked"):(this.each(function(e){var t=d(this);"boolean"!=typeof o?(t.is("input[type=checkbox]")||t.is("input[type=radio]"))&&t.off("change.checked").on("change.checked",function(){try{return(t.is(":checked")?o:n).apply(t)}catch(e){}}):t.attr("checked",o).trigger("change")}),this)},d.fn.locate=function(e){var o="data";return d.each(this[0].attributes,function(e,t){if(t.specified&&"$"===t.value)return o=t.name,!1}),this.find("["+o+"-"+e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+"]")},s=["overflow","overflow-x","overflow-y"],d.fn.noscroll=function(e){return void 0===e&&(e=!0),this.each(function(){var o=d(this),n=o.data("noscroll");!n&&e&&(n={},d.each(s,function(e,t){n[t]=o.css(t)}),o.data("noscroll",n)),e?d.each(s,function(e,t){o.css(t,"hidden")}):n&&o.css(n)})},d.fn.visible=function(e){var t=d(this),o=d(window);if(!(t.length<1)){var n=o.scrollTop(),a=n+o.height(),o=t.offset().top,t=o+t.height();return(!0===e?o:t)<=a&&n<=(!0===e?t:o)}},d.fn.where=d.fn.filterBy=function(e,t,o){o=o||"=",t="[data-"+e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+o+t+"]";return this.filter(t)},d.fn.checked=function(o,n){return arguments.length<1?this.is(":checked"):(this.each(function(e){var t=d(this);"boolean"!=typeof o?(t.is("input[type=checkbox]")||t.is("input[type=radio]"))&&t.off("change.checked").on("change.checked",function(){try{return(t.is(":checked")?o:n).apply(t)}catch(e){}}):t.attr("checked",o).trigger("change")}),this)},d.fn.selectAll=function(){return this.each(function(){this.select()})},d.fn.unselect=function(){return this.each(function(){var e=this.value;this.value+=" ",this.value=e})},d.fn.toObject=d.fn.serializeObject=function(){var o={};return d.each(d(this).serializeArray(),function(e,t){o.hasOwnProperty(t.name)?(d.isArray(o[t.name])||(o[t.name]=[o[t.name]]),o[t.name].push(t.value)):o[t.name]=t.value}),o},d.fn.toJSON=d.fn.serializeJSON=function(){return JSON.stringify(d(this).serializeObject())},d.sanitizeHTML=function(e){return d(d.parseHTML(e,document,!0)).toHTML()},d.toHTML=function(e){return d("<div>").html(e).html()},d.fn.toHTML=function(){return d.toHTML(this.clone())},d.toXHTML=function(e,t){var o=e.innerHTML?String(e.innerHTML):e,n=o.match(/(<.+[^>])/g);if(n)for(var a=0;a<n.length;a+=1){var i,r=n[a];if(n[a]=n[a].replace(/([<|<\/].+?\w+).+[^>]/,function(e){return e}),i=n[a].match(/\=[a-zA-Z\.\:\[\]_\(\)\&\$\%#\@\!0-9\/]+[?\s+|?>]/g))for(var s=0,l=i.length;s<l;)n[a]=n[a].replace(i[s],i[s].replace(/(\=)([a-zA-Z\.\:\[\]_\(\)\&\$\%#\@\!0-9\/]+)?([\s+|?>])/g,function(){var e=Array.prototype.slice.call(arguments);return'="'+(t?e[2]:e[2].toLowerCase())+'"'+e[3]})),s+=1;o=o.replace(r,n[a])}return o},d.fn.xhtml=function(){return d.IE?d.toXHTML(this[0]):this.html()},d.buildHTML=function(e,t){if(e instanceof d)return e;var o,n=document;window.CloudFlare&&((o=d.buildHTML.iframe)&&o.contentDocument||((o=d.buildHTML.iframe=document.createElement("iframe")).style.display="none",document.body.appendChild(o)),n=o.contentDocument);var e=d.trim(e),a=[],e=d.buildFragment([e],n,a),i=d.merge([],e.childNodes);if(!t&&0<a.length){var r=n.createElement("script");r.text="try{"+d.callback(function(){d(a).remove()})+"();}catch(e){}";for(var s,l,c=i.length-1;(s=i[c--])&&("SCRIPT"===s.nodeName?l=i.push(r):1===s.nodeType&&(l=s.appendChild(r)),!l););l||i.push(r),a.push(r)}return d(i)},d.isDeferred=function(e){return e&&d.isFunction(e.always)},d.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},d.regExpEscape=function(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},(l=d.Ajax=function(e){e.autostart=!1;var t=d.ajax(e);return"function"==typeof t.send&&l.queue.addDeferred(function(e){t.send(),setTimeout(e.resolve,l.interval)}),t}).queue=d.Threads({threadLimit:1}),l.interval=1200,l.interval=0,d.cssUrl=function(e){return'url("'+encodeURI(e)+'")'},function(){d.fn.addTransitoryClass=function(e,t){var o=this.addClass(e);return setTimeout(function(){o.removeClass(e)},t||1),this};function o(e,t,o){var n=this;return setTimeout(function(){n[e+"Class"](t)},o||50),this}d.fn.addClassAfter=function(e,t){return o.call(this,"add",e,t)},d.fn.removeClassAfter=function(e,t){return o.call(this,"remove",e,t)};function n(e,t,o,n){var a=e?"-in":"-out";return this.addTransitoryClass(t.replace(/ /g,a+" ")+a,o||1e3)[(e?"add":"remove")+"ClassAfter"](t),n&&setTimeout(n,o),this}d.fn.addTransitionClass=function(e,t,o){return n.call(this,!0,e,t,o)},d.fn.removeTransitionClass=function(e,t,o){return n.call(this,!1,e,t,o)}}()}),FD50.plugin("uri",function(e){e.isUrl=function(e){return/^(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)};function f(e){"use strict";function s(e){return e=(e=decodeURIComponent(e)).replace("+"," ")}function r(e,t){for(var o,n,a,i=[],r=0;r<c.length;r++)o=c[r],n=s(o[0])===s(e),a=s(o[1])===s(t),(1!==arguments.length||n)&&(2!==arguments.length||n||a)||i.push(o);return c=i,this}function l(e,t,o){return 3===arguments.length&&-1!==o?(o=Math.min(o,c.length),c.splice(o,0,[e,t])):0<arguments.length&&c.push([e,t]),this}var c=function(e){var t,o,n,a,i,r=[];if(null==e||""===e)return r;for(o=(e=0===e.indexOf("?")?e.substring(1):e).toString().split(/[&;]/),t=0;t<o.length;t++)a=(i=(n=o[t]).split("="))[0],i=-1===n.indexOf("=")?null:null===i[1]?"":i[1],r.push([a,i]);return r}(e);return{getParamValue:function(e){for(var t,o=0;o<c.length;o++)if(t=c[o],s(e)===s(t[0]))return t[1]},getParamValues:function(e){for(var t,o=[],n=0;n<c.length;n++)t=c[n],s(e)===s(t[0])&&o.push(t[1]);return o},deleteParam:r,addParam:l,replaceParam:function(e,t,o){var n,a,i=-1;if(3===arguments.length){for(n=0;n<c.length;n++)if(a=c[n],s(a[0])===s(e)&&decodeURIComponent(a[1])===s(o)){i=n;break}r(e,o).addParam(e,t,i)}else{for(n=0;n<c.length;n++)if(a=c[n],s(a[0])===s(e)){i=n;break}r(e),l(e,t,i)}return this},toString:function(){for(var e,t="",o=0;o<c.length;o++)e=c[o],0<t.length&&(t+="&"),null===e[1]?t+=e[0]:t+=e.join("=");return 0<t.length?"?"+t:t}}}function h(o){"use strict";function n(e){return void 0!==e&&(p.protocol=e),p.protocol}function a(e){return null===(m=void 0!==e?e:m)?-1!==p.source.indexOf("//"):m}function i(e){return void 0!==e&&(p.userInfo=e),p.userInfo}function r(e){return void 0!==e&&(p.host=e),p.host}function s(e){return void 0!==e&&(p.port=e),p.port}function l(e){return void 0!==e&&(p.path=e),p.path}function c(e){return t=void 0!==e?new f(e):t}function d(e){return void 0!==e&&(p.anchor=e),p.anchor}function e(){function e(e){return null!==e&&""!==e}var t="";return e(n())?(t+=n(),n().indexOf(":")!==n().length-1&&(t+=":"),t+="//"):a()&&e(r())&&(t+="//"),e(i())&&e(r())&&(t+=i(),i().indexOf("@")!==i().length-1&&(t+="@")),e(r())&&(t+=r(),e(s())&&(t+=":"+s())),e(l())?t+=l():e(r())&&(e(c().toString())||e(d()))&&(t+="/"),e(c().toString())&&(0!==c().toString().indexOf("?")&&(t+="?"),t+=c().toString()),e(d())&&(0!==d().indexOf("#")&&(t+="#"),t+=d()),t}var u=/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi,p=function(e){for(var t=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],n="queryKey",o=/(?:^|&)([^&=]*)=?([^&]*)/g,a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e),i={},r=14;r--;)i[t[r]]=a[r]||"";return i[n]={},i[t[12]].replace(o,function(e,t,o){t&&(i[n][t]=o)}),i}(o||""),t=new f(p.query),m=null;return{protocol:n,hasAuthorityPrefix:a,userInfo:i,host:r,port:s,path:l,query:c,anchor:d,setProtocol:function(e){return n(e),this},setHasAuthorityPrefix:function(e){return a(e),this},setUserInfo:function(e){return i(e),this},setHost:function(e){return r(e),this},setPort:function(e){return s(e),this},setPath:function(e){return l(e),this},setQuery:function(e){return c(e),this},setAnchor:function(e){return d(e),this},getQueryParamValue:function(e){return c().getParamValue(e)},getQueryParamValues:function(e){return c().getParamValues(e)},deleteQueryParam:function(e,t){return 2===arguments.length?c().deleteParam(e,t):c().deleteParam(e),this},addQueryParam:function(e,t,o){return 3===arguments.length?c().addParam(e,t,o):c().addParam(e,t),this},replaceQueryParam:function(e,t,o){return 3===arguments.length?c().replaceParam(e,t,o):c().replaceParam(e,t),this},extract:function(e){var t=o.match(u)||[];return void 0===e?t:t[e]||""},toPath:function(e){if(void 0===e)return p.path;if("/"==e.substring(0,1))return p.path=e;var t,o=p.path.split("/"),n=e.split("/");for(""===o.slice(-1)[0]&&o.pop();t=n.shift();)switch(t){case"..":1<o.length&&o.pop();break;case".":break;default:o.push(t)}return p.path=o.join("/"),this},toString:e,clone:function(){return new h(e())}}}e.uri=function(e){return new h(e)}}),FD50.plugin("mvc",function($){function AE(e,t,o){return void 0!==e[t]?e[t]:o&&(e[t]={})}function BE(e){var t=typeof e;return e&&("function"==t||"object"==t)}var CE,zE,DE,oF,pF,qF,rF,DF,UF,VF,WF,XF,YF,ZF,_F,bG;function $F(e,t){return e.concat(VF(t))}function aG(e,a,t){for(var o in t=t||e,e)t[o]=WF(e[o])&&WF(a[o])&&_F.test(e[o])?function(o,n){return function(){var e,t=this._super;return this._super=a[o],e=n.apply(this,arguments),this._super=t,e}}(o,e[o]):e[o]}zE={undHash:/_|-/,colons:/::/,words:/([A-Z]+)([A-Z][a-z])/g,lowUp:/([a-z\d])([A-Z])/g,dash:/([a-z\d])([A-Z])/g,replacer:/\{([^\}]+)\}/g,dot:/\./},DE=$.String=$.extend($.String||{},{getObject:CE=function(e,t,o){var n,a,i,r=e?e.split(zE.dot):[],s=r.length,l=0;if(t=$.isArray(t)?t:[t||window],0==s)return t[0];for(;n=t[l++];){for(i=0;i<s-1&&BE(n);i++)n=AE(n,r[i],o);if(BE(n)&&void 0!==(a=AE(n,r[i],o)))return!1===o&&delete n[r[i]],a}},capitalize:function(e,t){return e.charAt(0).toUpperCase()+e.substr(1)},camelize:function(e){return(e=DE.classize(e)).charAt(0).toLowerCase()+e.substr(1)},classize:function(e,t){for(var o=e.split(zE.undHash),n=0;n<o.length;n++)o[n]=DE.capitalize(o[n]);return o.join(t||"")},niceName:function(e){return DE.classize(e," ")},underscore:function(e){return e.replace(zE.colons,"/").replace(zE.words,"$1_$2").replace(zE.lowUp,"$1_$2").replace(zE.dash,"_").toLowerCase()},sub:function(e,o,n){var a=[];return a.push(e.replace(zE.replacer,function(e,t){e=CE(e,o,"boolean"==typeof n?!n:n)||CE(t,o,"boolean"==typeof n?!n:n),t=typeof e;return"object"!=t&&"function"!=t||null===t?""+e:(a.push(e),"")})),a.length<=1?a[0]:a},_regs:zE}),$.extend($,DE),$.String.rsplit=function(e,t){for(var o,n=t.exec(e),a=[];null!==n;)o=n.index,t.lastIndex,0!==o&&(a.push(e.substring(0,o)),e=e.slice(o)),a.push(n[0]),e=e.slice(n[0].length),n=t.exec(e);return""!==e&&a.push(e),a},oF=/^\d+$/,pF=/([^\[\]]+)|(\[\])/g,qF=/\+/g,rF=/([^?#]*)(#.*)?$/,$.String=$.extend($.String||{},{deparam:function(e){if(!e||!rF.test(e))return{};for(var t={},o=e.split("&"),n=0;n<o.length;n++){var a=t,i=o[n].split("=");2!=i.length&&(i=[i[0],i.slice(1).join("=")]);for(var r=decodeURIComponent(i[0].replace(qF," ")),i=decodeURIComponent(i[1].replace(qF," ")),s=r.match(pF),l=0;l<s.length-1;l++){var c=s[l];a[c]||(a[c]=oF.test(s[l+1])||"[]"==s[l+1]?[]:{}),a=a[c]}lastPart=s[s.length-1],"[]"==lastPart?a.push(i):a[lastPart]=i}return t}}),DF=$.cleanData,$.cleanData=function(e){for(var t,o=0;void 0!==(t=e[o]);o++)$(t).triggerHandler("destroyed");DF(e)},$.cookie=function(e,t,o){if(void 0===t){var n=null;if(document.cookie&&""!=document.cookie)for(var a=document.cookie.split(";"),i=0;i<a.length;i++){var r=jQuery.trim(a[i]);if(r.substring(0,e.length+1)==e+"="){n=decodeURIComponent(r.substring(e.length+1));break}}if(jQuery.evalJSON&&n&&n.match(/^\s*\{/))try{n=jQuery.evalJSON(n)}catch(e){}return n}o=o||{},null===t&&(t="",o.expires=-1),"object"==typeof t&&jQuery.toJSON&&(t=jQuery.toJSON(t));var s="";o.expires&&("number"==typeof o.expires||o.expires.toUTCString)&&("number"==typeof o.expires?(c=new Date).setTime(c.getTime()+24*o.expires*60*60*1e3):c=o.expires,s="; expires="+c.toUTCString());var l=o.path?"; path="+o.path:"",c=o.domain?"; domain="+o.domain:"",o=o.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),s,l,c,o].join("")},UF=!1,VF=$.makeArray,WF=$.isFunction,XF=$.isArray,YF=$.extend,ZF=$.String.getObject,_F=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,bG="prototype",clss=$.Class=function(){arguments.length&&clss.extend.apply(clss,arguments)},YF(clss,{proxy:function(i){var r,s=VF(arguments);return i=s.shift(),XF(i)||(i=[i]),r=this,function(){for(var e,t,o=$F(s,arguments),n=i.length,a=0;a<n;a++)(t=i[a])&&((e="string"==typeof t)&&r._set_called&&(r.called=t),o=(e?r[t]:t).apply(r,o||[]),a<n-1&&(o=!XF(o)||o._use_call?[o]:o));return o}},newInstance:function(){var e,t=this.rawInstance();return t.setup&&(e=t.setup.apply(t,arguments)),t.init&&t.init.apply(t,XF(e)?e:arguments),t},setup:function(e,t){return this.defaults=YF(!0,{},e.defaults,this.defaults),arguments},rawInstance:function(){UF=!0;var e=new this;return UF=!1,e},extend:function(e,t,o){function n(){if(!UF)return this.constructor!==n&&arguments.length?arguments.callee.extend.apply(arguments.callee,arguments):this.Class.newInstance.apply(this.Class,arguments)}"string"!=typeof e&&(o=t,t=e,e=null),o||(o=t,t=null),o=o||{};var a,i,r,s=this[bG];for(a in UF=!0,i=new this,UF=!1,aG(o,s,i),this)this.hasOwnProperty(a)&&(n[a]=this[a]);aG(t,this,n),e&&(t&&t.root&&(r=t.root,$.isString(r)&&(r=ZF(r,window,!0))),l=(s=e.split(/\./)).pop(),s=ZF(s.join("."),r||window,!0),YF(!0,n,(r=s)[l]),s[l]=n),YF(n,{prototype:i,namespace:r,shortName:l,constructor:n,fullName:e});var l=(n[bG].Class=n[bG].constructor=n).setup.apply(n,$F([this],arguments));return n.init&&n.init.apply(n,l||$F([this],arguments)),n}}),clss.callback=clss[bG].callback=clss[bG].proxy=clss.proxy,function(){function s(e,t,o,n,a){return n?function(e,t,o,n,a){0===t.indexOf(">")&&(t=(e.data("directSelector")+" "||"")+t);var i=e.delegate&&e.undelegate?e:$(B(e)?[e]:e);return a?i.delegate(t,o,a,n):i.delegate(t,o,n),function(){i.undelegate(t,o,n),i=e=o=n=t=null}}(e,n,t,o,a):(r=t,s=o,a=a,c=(i=e).bind&&i.unbind?i:$(B(i)?[i]:i),0===r.indexOf(">")&&(r=r.substr(1),l=function(e){e.target===i&&s.apply(this,arguments)}),a?c.bind(r,a,l||s):c.bind(r,l||s),function(){c.unbind(r,l||s),i=r=s=l=null});var i,r,s,l,c}function l(e,t){var o="string"==typeof t?e[t]:t;return C(o)&&B(o[1])&&(o=o[1]),function(){return e.called=t,o.apply(e,[this.nodeName?$(this):this].concat(n.call(arguments,0)))}}function y(e){return c.underscore(e.replace($.globalNamespace+".","").replace(o,"_").replace(a,""))}function k(e,t){return $.data(e,"controllers",t)}var w=$.makeArray,C=$.isArray,B=$.isFunction,x=$.isString,h=$.extend,c=$.String,g=$.each,t=c.getObject,I="prototype",v="constructor",n=Array[I].slice,o=/\./g,a=/_?controllers?/gi,i=/^\S(.*)\s(.*)/,d=/\{([^\}]+)\}/g,u=/\{([^\.]+[\.][^\.]+)\}/g,p=/^(?:(.*?)\s)?([\w\.\:>]+)$/,r=$.globalNamespace+".Controller";$.Controller=function(e){var t=w(arguments),o={root:r},t=2<t.length?(o=$.extend(o,t[1]),t[2]):t[1];return o.namespace&&(e=o.namespace+"."+e),$.Controller.Class(e,o,t)};var T=r+".Class";$.Class(T,{setup:function(e,t){if(this._super.apply(this,arguments),this.shortName&&this.fullName!=T){for(var o=this.elements||[],n=0,a=this.defaults;element=o[n++];){var i=element.indexOf("{"),r=element.indexOf("}"),s=(element.length,element.slice(0,i)),l=element.slice(r+1),c=element.slice(i+1,r).split("|"),d=0,r=s.match(/^\^(\S*)\s(.*)/),u="";for(r&&(u=r[1]+"-",s=r[2]);t=c[d++];){var p="{"+$.camelize(u+t)+"}";$.has(a,p)||(a[p]=s+t+l)}}this._fullName=y(this.fullName),this._shortName=y(this.shortName);var m,f,h=this;x(this.pluginName)&&(f=this._fullName,v=this.pluginName,$.fn[v]||($.fn[v]=function(o){var n=w(arguments);if($.isString(o)&&"controller"===o){var e=k(this[0]);return e&&e[f]}return this.each(function(){var e=k(this),t=e&&e[f];t?$.isString(o)?(e=t[o],$.isFunction(e)&&e.apply(t,n.slice(1))):t.update.apply(t,n):h.newInstance.apply(h,[this].concat(n))})}));var g,v=w(arguments),b=this[I],v=v[3<v.length?3:2];for(m in B(v)&&(this.protoFactory=v,b=this.protoFactory.call(this,null)),this.actions={},b)"constructor"!=m&&this._isAction(m)&&(g=b[m],(B(g)||C(g)&&B(g[1]))&&(this.actions[m]=this._action(m)));$.module("$:/Controllers/"+this.fullName).resolve(this)}},hookup:function(e){return new this(e)},_isAction:function(e){return!!i.test(e)||(-1<$.inArray(e,this.listensTo)||$.event.special[e]||m[e])},_action:function(e,o){if(d.lastIndex=0,!o&&d.test(e))return null;var n,a,t=e=e.replace("{self} ","");o&&(r=!1,u.test(e)&&(a="",t=e.replace(u,function(e,t){t=t.split(".");return n=o["{"+t[0]+"}"]||{},a=$.isControllerInstance(n)?(n[t[1]]||{}).selector:a}).match(p),r=!!a,t=[n.element].concat(t||[])),r||(t=c.sub(e,[o,window])));var i=C(t),r=(i?t[1]:t).match(p),e=r[2];return{processor:m[e]||f,parts:r,delegate:i?t[0]:void 0}},processors:{},listensTo:[],defaults:{},hostname:"parent"},{setup:function(e,t){var o,n=this,a=n[v],i=(n[I],a._fullName);n.instanceId=$.uid(i+"_");var r,s,l,c,d=n.options=h(!0,{},a.defaults,a.defaultOptions,t),u=n.element=$(e);for(r in a.protoFactory&&(o=a.protoFactory.apply(a,[n,d,u]),h(!0,n,o)),(k(e)||k(e,{}))[i]=n,u.data("directSelector")||(p=$.uid("DS"),u.addClass(p).data("directSelector","."+p)),n.selectors={},d)r.match(/^\{.+\}$/)&&(s=r.replace(/^\{|\}$/g,""),l=d[r],x(l)?(c=n[s],n[s]=n.selectors[s]=function(t,n,e){n=/^(\.|\#)$/.test(n)?n+e:n;function a(e){var o=(a.baseElement||t.element).find(n);return $.isString(e)&&(o=o.filter(e)),$.isPlainObject(e)&&$.each(e,function(e,t){o=o.filterBy(e,t)}),o}return a.selector=n,a.css=function(){var t,e,o=a.cssRule;return o||(t=u.data("directSelector"),e=$.map(n.split(","),function(e){return t+" "+e}),(o=a.cssRule=$.cssRule(e)).important=!0),arguments.length?o.css.apply(o,arguments):o},a.inside=function(e){return $(e).find(n)},a.of=function(e){return $(e).parents(n).eq(0)},a.under=function(e){var t=[];return a().each(function(){$(this).parents().filter(e).length&&t.push(this)}),$(t)},$.isPlainObject(c)&&$.extend(a,c),a}(n,l,s)):n[s]=l);var p=d.view,m=n.view;n.view=function(){return m.apply(this,arguments)},g(p||{},function(o,e){n.view[o]=function(e){var t=w(arguments);return $.isBoolean(e)?t=t.slice(1):e=!1,n.view.apply(n,[e,o].concat(t))}}),$.extend(n,d.controller),n.pluginInstances={},n.called="init",n._bind();var f=n.init||$.noop;return n.init=function(){return n.init=f,result=f.apply(n,arguments),n.trigger("init."+a.fullName.toLowerCase(),[n]),result},[u,d].concat(w(arguments).slice(2))},on:function(e){var t=w(arguments),o=this.element,n=t.length;return 2==n?this._binder(o,e,t[1]):3==n&&x(t[1])?this._binder(o,e,t[2],t[1]):this._binder(t[1],e,t[2])},_bind:function(){var n=this,a=n[v],i=a.actions,r=n._bindings=[],s=n.element;g(i||{},function(e,t){var o;i.hasOwnProperty(e)&&(o=a.actions[e]||a._action(e,n.options),$.isControllerInstance(o.delegate)&&(o.delegate=o.delegate.element),r.push(o.processor(o.delegate||s,o.parts[2],o.parts[1],e,n)))});var t=l(this,"destroy");return s.bind("destroyed",t),r.push(function(e){$(e).unbind("destroyed",t)}),r.length},_binder:function(e,t,o,n){return"string"==typeof o&&(o=l(this,o)),this._bindings.push(s(e,t,o,n)),this._bindings.length},_unbind:function(){var o=this.element[0];g(this._bindings,function(e,t){t(o)}),this._bindings=[]},trigger:function(e){var t=this.element;if(t){var o=$.Event(e);return t.trigger.apply(t,[o].concat($.makeArray(arguments).slice(1))),o}},delegate:function(e,t,o,n){return"string"==typeof e&&(n=o,o=t,t=e,e=this.element),this._binder(e,o,n,t)},update:function(e){h(this.options,e),this._unbind(),this._bind()},destroy:function(){if(!this._destroyed){var e=this[v]._fullName;for(pname in this.pluginInstances)this.removePlugin(pname);this._destroyed=!0,this.element.removeClass(e),this._unbind(),delete this._actions,delete this.element.data("controllers")[e],$(this).triggerHandler("destroyed"),this.element=$()}},find:function(e){return this.element.find(e)},view:function(){var e,t=w(arguments),o=t,n=!1,a=this[v].component||$,i=this.options.view||{};return"boolean"==typeof t[0]&&(n=t[0],o=t.slice(1)),null==(o[0]=i[o[0]])?n?"":$(""):(e=a.View.apply(a,o),n?e:$($.parseHTML($.trim(e))))},getPlugin:function(e){return this.pluginInstances[e]},addSubscriber:function(e){var e=$.isArray(e)?e:[e||{}],o=this,n=this.Class.hostname,a={};return a["{"+n+"}"]=o,$.map(e,function(e,t){return!!$.isControllerInstance(e)&&(e.options[n]===this?e:(e[n]=o,e.update(a)))}),e},addPlugin:function(e,t,o){if(e){(t||o)&&!$.isPlainObject(t)||(o=t,t=[this.Class.root,this.Class.fullName,$.String.capitalize(e)].join(".")),$.isString(t)&&(t=$.getController(t));var n=$.isControllerInstance(t);if(B(t)||n){var a=(this.Class.pluginExtendsInstance?this.options:this.options.plugin||{})[e];o=$.extend(!0,{element:this.element},o,a);a=n?"instance":$.isController(t)?"controller":"function";this.trigger("addPlugin",[e,t,o,a]);var i,r=this.Class.hostname;switch(o["{"+r+"}"]=this,a){case"instance":(i=t).update(o),t[r]=this;break;case"controller":i=o.element.addController(t,o);break;case"function":i=t(this,o)}if(i)return this.pluginInstances[e]=i,this.Class.pluginExtendsInstance&&(this[e]=i),"function"!=a&&((n={})["{"+e+"}"]=i,this.update(n)),this.trigger("registerPlugin",[e,i,o,a]),i}}},removePlugin:function(e){var t=this.getPlugin(e);if(t)return this.trigger("removePlugin",[e,t]),delete this.pluginInstances[e],$.isFunction(t.destroy)?t.destroy():null},invokePlugin:function(e,t,o){var n=this.getPlugin(e);if(n&&$.isFunction(n[t]))return this.trigger("invokePlugin",[e,n,o]),n[t].apply(this,o)},getMessageGroup:function(){var e=$.isFunction(this.messageGroup)?this.messageGroup():this.element.find("[data-message-group]");return e=e.length<1?$("<div data-message-group></div>").prependTo(this.element):e},setMessage:function(e,t){var o,n,a={type:"warning",message:"",parent:this.getMessageGroup(),element:$('<div class="alert fade in"><button type="button" class="close" data-bs-dismiss="alert"></button></div>')},i={},r=$.isDeferred(e),i=$.isPlainObject(e)&&!r?e:{message:e,type:t||"warning"},s=$.extend({},a,i),l=s.element;return $.isDeferred(e)?(o=arguments.callee,n=this,e.done(function(e,t){s.message=e,s.type=t||"warning",o.call(n,s),l.show()})):(l.addClass("alert-"+s.type).append(s.message),$("html").has(l).length<1&&l.appendTo(s.parent)),l},clearMessage:function(){this.getMessageGroup().empty()},_set_called:!0});var m=$.Controller.Class.processors,f=function(e,t,o,n,a){var i,r=a[n];return C(r)&&B(r[1])&&(i=r[0]),s(e,t,l(a,n),o,i)};g("change click contextmenu dblclick keydown keyup keypress mousedown mousemove mouseout mouseover mouseup reset resize scroll select submit focusin focusout mouseenter mouseleave".split(" "),function(e,t){m[t]=f});function b(e){return e.replace("$.Controller",r)}function S(e){if(x(e)&&(e=b(e),e=t(e)||t(r+"."+e)),E(e))return e}function E(e){return B(e)&&e.hasOwnProperty("_fullName")}function _(e){return $.map(e,function(e){return(C(e)?_:S)(e)})}$.getController=S,$.isController=function(e){return!!S(e)},$.isControllerInstance=function(e){return e&&e[v]&&E(e[v])},$.isControllerOf=function(e,t){if(!t)return!1;C(t)||(t=[t]);for(var o=0;o<t.length;o++)if(e instanceof S(t[o]))return!0;return!1},$.fn.extend({controllers:function(){var n=_(w(arguments)),a=[];return this.each(function(){var o=$.data(this,"controllers");g(o||{},function(e,t){o.hasOwnProperty(e)&&(n.length&&!$.isControllerOf(t,n)||a.push(t))})}),a},controller:function(e,t){return void 0===t?this.controllers(e)[0]:(this.addController.apply(this,arguments),this)},hasController:function(e){e=(S(e)||{})._fullName||(x(e)?y(b(e)):"");return!!e&&($(this).data("controllers")||{}).hasOwnProperty(e)},addController:function(t,o,n){var a=S(t);if(a){var i=[];return this.each(function(){var e;1===this.nodeType&&"SCRIPT"!=this.nodeName&&((e=$(this).controller(t))?i.push(e):(e=new a(this,o),B(n)&&n.apply(e,[$(this),e]),i.push(e)))}),1<i.length?i:i[0]}},removeController:function(t){return this.each(function(){for(var e=$(this).controllers(t);e.length;)e.shift().destroy()}),this},addControllerWhenAvailable:function(e){var t=this,o=arguments,n=$.Deferred();return $.isController(e)&&(e=e.fullName),x(e)?($.module("$:/Controllers/"+e).pipe(function(){var e=t.addController.apply(t,o);n.resolveWith(e,[t,e])},n.reject,n.fail),n):n.reject()},implement:function(){return this.addController.apply(this,arguments),this}}),function(){for(var e,t=["is","find"],o={};e=t.shift();)o[e]=$.fn[e],$.fn[e]=function(t){return function(e){return o[t].apply(this,(e||{}).hasOwnProperty("of")?[e.selector]:arguments)}}(e)}()}(),function(){function u(e){return e.replace(/^\/\//,"").replace(/[\/\.]/g,"_")}function p(e,t){if(!e.match(/[^\s]/))throw"$.View ERROR: There is no template or an empty template at "+t}var l=$.makeArray,o=1,m=$.View=function(e,a,i,r){"function"==typeof i&&(r=i,i=void 0);var t=d(a);if(t.length){var s=$.Deferred();return t.push(n(e,!0)),$.when.apply($,t).then(function(e){var t=l(arguments),o=t.pop()[0];if(c(a))a=f(e);else for(var n in a)c(a[n])&&(a[n]=f(t.shift()));o=o(a,i),s.resolve(o),r&&r(o)}),s.promise()}var o,t="function"==typeof r,s=n(e,t);return t?(o=s).done(function(e){r(e(a,i))}):s.done(function(e){o=e(a,i)}),o},n=function(e,t){return $.ajax({url:e,dataType:"view",async:t})},c=function(e){return e&&$.isFunction(e.always)},d=function(e){var t,o=[];if(c(e))return[e];for(t in e)c(e[t])&&o.push(e[t]);return o},f=function(e){return $.isArray(e)&&3===e.length&&"success"===e[1]?e[0]:e};$.ajaxTransport("view",function(e,o){function n(e){return e=c.renderer(i,e),m.cache&&(m.cached[i]=e),{view:e}}var a,i,r,t,s=o.url,l=s.match(/\.[\w\d]+$/);(l=(a=document.getElementById(s))?"."+a.type.match(/\/(x\-)?(.+)/)[2]:l)||(l=m.ext,s+=m.ext),i=u(s),s.match(/^\/\//)&&(t=s.substr(2),s="undefined"==typeof steal?"/"+t:steal.root.mapJoin(t)+"");var c=m.types[l],d=$.template()[o.url];return{send:function(e,t){return d?(c=m.types["."+d.type],t(200,"success",n(d.content))):m.cached[i]?t(200,"success",{view:m.cached[i]}):void(a?t(200,"success",n(a.innerHTML)):r=$.ajax({async:o.async,url:s,dataType:"text",error:function(){p("",s),t(404)},success:function(e){p(e,s),t(200,"success",n(e))}}))},abort:function(){r&&r.abort()}}}),$.extend(m,{hookups:{},hookup:function(e){var t=++o;return m.hookups[t]=e,t},cached:{},cache:!0,register:function(e){this.types["."+e.suffix]=e,window.steal&&steal.type(e.suffix+" view js",function(e,t,o){var n=m.types["."+e.type],a=u(e.rootSrc+"");e.text=n.script(a,e.text),t()})},types:{},ext:".ejs",registerScript:function(e,t,o){return"$.View.preload('"+t+"',"+m.types["."+e].script(t,o)+");"},preload:function(e,o){m.cached[e]=function(e,t){return o.call(e,e,t)}}}),window.steal&&steal.type("view js",function(e,t,o){var n=m.types["."+e.type],a=u(e.rootSrc+"");e.text="steal('"+(n.plugin||"jquery/view/"+e.type)+"').then(function($){$.View.preload('"+a+"',"+e.text+");\n})",t()});var r={val:!0,text:!0},a=function(a){var i=$.fn[a];$.fn[a]=function(){var t,e,o=l(arguments),n=this;if(c(o[0]))return o[0].done(function(e){s.call(n,[e],i)}),this;if(h(o)){if(e=v(o))return t=o[e],o[e]=function(e){s.call(n,[e],i),t.call(n,e)},m.apply(m,o),this;if(e=m.apply(m,o),c(e))return e.done(function(e){s.call(n,[e],i)}),this;o=[e]}return r[a]?i.apply(this,o):s.call(this,o,i)}},s=function(e,t){var o,n;for(n in m.hookups)break;return n&&e[0]&&g(e[0])&&(o=m.hookups,m.hookups={},e[0]=$(e[0])),t=t.apply(this,e),o&&b(e[0],o),t},h=function(e){var t=typeof e[1];return"string"==typeof e[0]&&("object"==t||"function"==t)&&!i(e[1])},i=function(e){return e.nodeType||e.jquery},g=function(e){return!!i(e)||"string"==typeof e&&("<"===(e=$.trim(e)).substr(0,1)&&">"===e.substr(e.length-1,1)&&3<=e.length)},v=function(e){return"function"==typeof e[3]?3:"function"==typeof e[2]&&2},b=function(e,t){for(var o,n,a,i=0,r=(o=(e=e.filter(function(){return 3!=this.nodeType})).add("[data-view-id]",e)).length;i<r;i++)o[i].getAttribute&&(n=o[i].getAttribute("data-view-id"))&&(a=t[n])&&(a(o[i],n),delete t[n],o[i].removeAttribute("data-view-id"));$.extend(m.hookups,t)};$.fn.hookup=function(){var e=m.hookups;return m.hookups={},b(this,e),this},$.each(["prepend","append","after","before","text","html","replaceWith","val"],function(e,t){a(t)})}(),function(){var myEval=function(script){eval(script)},rSplit=$.String.rsplit,extend=$.extend,isArray=$.isArray,returnReg=/\r\n/g,retReg=/\r/g,newReg=/\n/g,nReg=/\n/,slashReg=/\\/g,quoteReg=/"/g,singleQuoteReg=/'/g,tabReg=/\t/g,leftBracket=/\{/g,rightBracket=/\}/g,quickFunc=/\s*\(([\$\w]+)\)\s*->([^\n]*)/,clean=function(e){return e.replace(slashReg,"\\\\").replace(newReg,"\\n").replace(quoteReg,'\\"').replace(tabReg,"\\t")},escapeHTML=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(quoteReg,"&#34;").replace(singleQuoteReg,"&#39;")},$View=$.View,bracketNum=function(e){var t=e.match(leftBracket),e=e.match(rightBracket);return(t?t.length:0)-(e?e.length:0)},EJS=function(e){if(this.constructor!=EJS){var o=new EJS(e);return function(e,t){return o.render(e,t)}}"function"!=typeof e?(extend(this,EJS.options,e),this.template=compile(this.text,this.type,this.name)):this.template={fn:e}};$&&($.EJS=EJS),EJS.prototype.render=function(e,t){e=e||{},this._extra_helpers=t;t=new EJS.Helpers(e,t||{});return this.template.fn.call(e,e,t)},extend(EJS,{text:function(n){if("string"==typeof n)return n;if(null==n)return"";var e=(n.hookup?function(e,t){n.hookup.call(n,e,t)}:"function"==typeof n&&n)||isArray(n)&&function(e,t){for(var o=0;o<n.length;o++)n[o].hookup?n[o].hookup(e,t):n[o](e,t)};return e?"data-view-id='"+$View.hookup(e)+"'":n.toString?n.toString():""},clean:function(e){return"string"==typeof e?escapeHTML(e):"number"==typeof e?e:EJS.text(e)},options:{type:"[",ext:".ejs"}});var scan=function(e,t,o){for(var n=rSplit(t,nReg),a=0;a<n.length;a++)scanline(e,n[a],o)},scanline=function(e,t,o){e.lines++;for(var n,a=rSplit(t,e.splitter),i=0;i<a.length;i++)null!==(n=a[i])&&o(n,e)},makeScanner=function(e,t){var o={};return extend(o,{left:e+"%",right:"%"+t,dLeft:e+"%%",dRight:"%%"+t,eeLeft:e+"%==",eLeft:e+"%=",cmnt:e+"%#",cleanLeft:e+"%~",scan:scan,lines:0}),o.splitter=new RegExp("("+[o.dLeft,o.dRight,o.eeLeft,o.eLeft,o.cmnt,o.left,o.right+"\n",o.right,"\n"].join(")|(").replace(/\[/g,"\\[").replace(/\]/g,"\\]")+")"),o},compile=function(e,t,o){e=e.replace(returnReg,"\n").replace(retReg,"\n"),t=t||"[";function a(e){c.push(n,'"',clean(e),'");')}function i(){d=""}var n="___v1ew.push(",r=n,s="var ___v1ew = [];",l="return ___v1ew.join('')",c=new EJS.Buffer([s],[]),d="",u=null,p="));",m=[];scan(makeScanner(t,"["===t?"]":">"),e||"",function(e,t){if(null===u)switch(e){case"\n":a(d+="\n"),c.cr(),i();break;case t.left:case t.eLeft:case t.eeLeft:case t.cmnt:u=e,0<d.length&&a(d),i();break;case t.dLeft:d+=t.left;break;default:d+=e}else switch(e){case t.right:switch(u){case t.left:var o=bracketNum(d),n=m.length&&-1==o?m.pop():";";n===p&&c.push(l),c.push(d,n),1===o&&m.push(";");break;case t.eLeft:(o=bracketNum(d))&&m.push(p),quickFunc.test(d)&&(d="function(__){var "+(n=d.match(quickFunc))[1]+"=$(__);"+n[2]+"}"),c.push(r,$.globalNamespace+".EJS.clean(",d,o?s:p);break;case t.eeLeft:(o=bracketNum(d))&&m.push(p),c.push(r,$.globalNamespace+".EJS.text(",d,o?s:p)}u=null,i();break;case t.dRight:d+=t.right;break;default:d+=e}}),0<d.length&&c.push(n,'"',clean(d)+'");');e={out:"try { with(_VIEW) { with (_CONTEXT) {"+c.close()+" "+l+"}}}catch(e){e.lineNumber=null;throw e;}"};return myEval.call(e,"this.fn = (function(_CONTEXT,_VIEW){ var $ = "+$.globalNamespace+";"+e.out+"});"),e};EJS.Buffer=function(e,t){this.line=[],this.script=[],this.post=t,this.push.apply(this,e)},EJS.Buffer.prototype={push:function(){this.line.push.apply(this.line,arguments)},cr:function(){this.script.push(this.line.join(""),"\n"),this.line=[]},close:function(){return 0<this.line.length&&(this.script.push(this.line.join("")),this.line=[]),this.post.length&&this.push.apply(this,this.post),this.script.push(";"),this.script.join("")}},EJS.Helpers=function(e,t){this._data=e,this._extras=t,extend(this,t)},EJS.Helpers.prototype={plugin:function(e){var t=$.makeArray(arguments),o=t.shift();return function(e){e=$(e);e[o].apply(e,t)}},view:function(e,t,o){return o=o||this._extras,t=t||this._data,$View(e,t,o)}},$View.register({suffix:"ejs",script:function(e,t){return $.globalNamespace+".EJS(function(_CONTEXT,_VIEW) { "+new EJS({text:t,name:e}).template.out+" })"},renderer:function(e,t){return EJS({text:t,name:e})}})}(),function(){function s(e){return"object"==typeof e&&null!==e&&e}function l(n,a,i){return n instanceof $.Observe?r([n],i._namespace):n=new(m(n)?$.Observe.List:$.Observe)(n),n.bind("change"+i._namespace,function(e,t){var o=$.makeArray(arguments),e=o.shift();o[0]="*"===a?i.indexOf(n)+"."+o[0]:a+"."+o[0],$.event.trigger(e,o,i)}),n}function r(e,t){for(var o,n=0;n<e.length;n++)(o=e[n])&&o.unbind&&o.unbind("change"+t)}function c(){if(!a)return a=[],!0}function d(e,t,o){return!e._init&&(a?void a.push({t:e,ev:t,args:o}):$.event.trigger(t,o,e,!0))}function u(){var e,t=a.length,o=a.slice(0);a=null,i++;for(var n=0;n<t;n++)e=o[n],$.event.trigger({type:e.ev,batchNum:i},e.args,e.t)}function p(e,o,n){return e.each(function(e,t){n[e]=s(t)&&"function"==typeof t[o]?t[o]():t}),n}var m=$.isArray,f=$.makeArray,e=$.each,o=0,a=null,i=0;$.Class($.globalNamespace+".Observe",{init:function(e){this._data={},this._namespace=".observe"+ ++o,this._init=!0,this.attrs(e),delete this._init},attr:function(e,t){return void 0===t?this._get(e):(this._set(e,t),this)},each:function(){return e.apply(null,[this.__get()].concat(f(arguments)))},removeAttr:function(e){var t=m(e)?e:e.split("."),o=t.shift(),e=this._data[o];return t.length?e.removeAttr(t):(delete this._data[o],d(this,"change",[o,"remove",void 0,e]),e)},_get:function(e){var t=m(e)?e:(""+e).split("."),e=this.__get(t.shift());return t.length?e?e._get(t):void 0:e},__get:function(e){return e?this._data[e]:this._data},_set:function(e,t){var o=m(e)?e:(""+e).split("."),n=o.shift(),e=this.__get(n);if(s(e)&&o.length)e._set(o,t);else{if(o.length)throw"jQuery.Observe: set a property on an object that does not exist";t!==e&&(o=this.__get().hasOwnProperty(n)?"set":"add",this.__set(n,s(t)?l(t,n,this):t),d(this,"change",[n,o,t,e]),e&&r([e],this._namespace))}},__set:function(e,t){this._data[e]=t,e in this.constructor.prototype||(this[e]=t)},bind:function(e,t){return $.fn.bind.apply($([this]),arguments),this},unbind:function(e,t){return $.fn.unbind.apply($([this]),arguments),this},serialize:function(){return p(this,"serialize",{})},attrs:function(e,t){if(void 0===e)return p(this,"attrs",{});e=$.extend(!0,{},e);var o,n=c();for(o in this._data){var a=this._data[o],i=e[o];void 0!==i?(s(a)&&s(i)?a.attrs(i,t):a!=i&&this._set(o,i),delete e[o]):t&&this.removeAttr(o)}for(o in e)i=e[o],this._set(o,i);n&&u()}});function h(e){return e[0]&&$.isArray(e[0])?e[0]:f(e)}var t=$.Observe($.globalNamespace+".Observe.List",{init:function(e,t){this.length=0,this._namespace=".list"+ ++o,this._init=!0,this.bind("change",this.proxy("_changes")),this.push.apply(this,f(e||[])),$.extend(this,t),this.comparator&&this.sort(),delete this._init},_changes:function(e,t,o,n,a){if(this.comparator&&/^\d+./.test(t)){var i=+/^\d+/.exec(t)[0],r=this[i],s=this.sortedIndex(r);if(s!==i)return[].splice.call(this,i,1),[].splice.call(this,s,0,r),d(this,"move",[r,s,i]),e.stopImmediatePropagation(),void d(this,"change",[t.replace(/^\d+/,s),o,n,a])}-1===t.indexOf(".")&&("add"===o?d(this,o,[n,+t]):"remove"===o&&d(this,o,[a,+t]))},sortedIndex:function(e){for(var t=e.attr(this.comparator),o=0,n=0;n<this.length;n++)if(e!==this[n]){if(t<=this[n].attr(this.comparator))return n+o}else o=-1;return n+o},__get:function(e){return e?this[e]:this},__set:function(e,t){this[e]=t},serialize:function(){return p(this,"serialize",[])},splice:function(e,t){for(var o=f(arguments),n=2;n<o.length;n++){var a=o[n];s(a)&&(o[n]=l(a,"*",this))}void 0===t&&(t=o[1]=this.length-e);var i=[].splice.apply(this,o);return 0<t&&(d(this,"change",[""+e,"remove",void 0,i]),r(i,this._namespace)),2<o.length&&d(this,"change",[""+e,"add",o.slice(2),i]),i},attrs:function(e,t){if(void 0===e)return p(this,"attrs",[]);e=e.slice(0);for(var o=Math.min(e.length,this.length),n=c(),a=0;a<o;a++){var i=this[a],r=e[a];s(i)&&s(r)?i.attrs(r,t):i!=r&&this._set(a,r)}e.length>this.length?this.push(e.slice(this.length)):e.length<this.length&&t&&this.splice(e.length),n&&u()},sort:function(e,t){var o=this.comparator;[].sort.apply(this,o?[function(e,t){return(e=e[o])===(t=t[o])?0:e<t?-1:1}]:[]);t||d(this,"reset")}});e({push:"length",unshift:0},function(i,r){t.prototype[i]=function(){for(var e=h(arguments),t=r?this.length:0,o=0;o<e.length;o++){var n=e[o];s(n)&&(e[o]=l(n,"*",this))}if(1==e.length&&this.comparator){var a=this.sortedIndex(e[0]);return this.splice(a,0,e[0]),this.length}a=[][i].apply(this,e);return this.comparator&&1<e.length?(this.sort(null,!0),d(this,"reset",[e])):d(this,"change",[""+t,"add",e,void 0]),a}}),e({pop:"length",shift:0},function(o,n){t.prototype[o]=function(){var e=h(arguments),t=n&&this.length?this.length-1:0,e=[][o].apply(this,e);return d(this,"change",[""+t,"remove",void 0,[e]]),e&&e.unbind&&e.unbind("change"+this._namespace),e}}),t.prototype.indexOf=[].indexOf||function(e){return $.inArray(e,this)},$.O=function(e,t){return new(m(e)||e instanceof $.Observe.List?$.Observe.List:$.Observe)(e,t)}}()}),FD50.plugin("joomla",function(o){o.Joomla=function(e,t){if(o.isFunction(t))window.Joomla[e]=t;else{e=window.Joomla[e];if(o.isFunction(e))return e.apply(window,t)}}}),FD50.plugin("module",function(a){function t(e){var t=this,o=a.Callbacks("once memory");a.extend(this,a.Deferred(),{name:e,status:"pending",ready:function(e){!0===e&&o.fire.call(t,a),a.isFunction(e)&&o.add(e)}}),t.then(function(){t.exports=this,t.status="resolved"},function(){t.status="rejected"});var n=t.done;t.done=function(){t.required=!0;var e=t.factory;return e&&"ready"===t.status&&e.call(t,a),t.done=n,t.done.apply(this,arguments)}}function n(e,t){var o;if("string"==typeof e){if(o=n.get(e),void 0===t)return o;if(a.isFunction(t))return"resolved"==o.status||(o.factory=t,o.status="ready",o.ready("true"),o.required&&(o.status="executing",t.call(o,a))),o}a.isArray(e)&&(e=a.map(e,function(e){var t=n.get(a.isString(e)?e:e.name);if(t)return"pending"===t.status&&(t.status="ready"),a.isPlainObject(e)?e:void 0}),a.each(e,function(e,t){n(t.name,t.factory)}))}a.module=(a.extend(n,{registry:{},get:function(e){if(e)return a.isModule(e)&&(e=e.replace("module://","")),n.registry[e]||n.create(e)},create:function(e){return n.registry[e]=new t(e)},remove:function(e){delete n.registry[e]}}),n),a.isModule=function(e){return a.isString(e)?!!e.match("module://"):e&&e instanceof t}}),FD50.plugin("script",function(n){n.Script=function(e){var t=document.createElement("script");return t.text=n.isString(e)?e:n.callback(e)+"();",n(t)},n.script=function(){function t(e){(e=n.extend(this,e)).manager=n.Deferred(),n.extend(e,e.manager.promise()),e.load()}var o=document.getElementsByTagName("head")[0];document.getElementsByTagName("base")[0];return n.extend(t.prototype,{timeout:7e3,retry:3,retryCount:1,type:"text/javascript",async:!1,charset:"UTF-8",verbose:!1,head:o,insert:function(){var e=this.node;this.head.appendChild(e)},remove:function(){var e=this.node;setTimeout(function(){e.onload=e.onerror=e.onreadystatechange=null;try{o.removeChild(e)}catch(e){}},1e3)},load:function(){var e,t=this;t.endTime=void 0,t.startTime=new Date,t.node=e=document.createElement("script"),t.insert(),t._ready=n.proxy(t.ready,t),t._error=n.proxy(t.error,t),e.attachEvent&&!n.browser.opera?(e.attachEvent("onreadystatechange",t._ready),e.attachEvent("onerror",t._error)):(e.addEventListener("load",t._ready,!1),e.addEventListener("error",t._error,!1)),n(e).attr({type:t.type,async:t.async,charset:t.charset,src:t.url}),t.monitor()},monitor:function(){var e=this;e.retryCount>e.retry?e._error():setTimeout(function(){"resolved"!==e.state()&&(e.verbose&&console.warn("$.script: Load timeout. [Retry: "+e.retryCount+"]",e),e.remove(),e.retryCount++,e.load())},e.timeout*e.retryCount)},ready:function(e){var t=this,o=t.node;"load"!==e.type&&!/loaded|complete/.test(o.readyState)||(t.complete.call(t,e),t.manager.resolve(t))},error:function(e){var t=this;t.verbose&&console.error("$.script: Unable to load ",t),t.complete.call(t,e),t.remove(),t.manager.reject(t)},complete:function(e){var t=this,o=t.node;t.endTime=new Date,o.detachEvent&&!n.browser.opera?(o.detachEvent("onreadystatechange",t._ready),o.detachEvent("onerror",t._error)):(o.removeEventListener("load",t._ready,!1),o.removeEventListener("error",t._error,!1))}}),function(e){if(void 0!==e)return new t(e="string"==typeof e?{url:e}:e)}}()}),FD50.plugin("template",function(n){function a(e,t){return void 0===e?a.templates:"string"==typeof t?(o=n.isPlainObject(t)?t:n.extend({},i,{name:e,content:t}),a.templates[e]=o):(o=a.templates[e]||{}).content||"";var o}var i;n.template=(i={content:"",type:"ejs"},n.extend(a,{templates:{},remove:function(e){delete a.templates[e]}}),a)}),FD50.plugin("require",function(r){function a(){var o=this,e=r.makeArray(arguments),e=r.isPlainObject(e[0])?(n=e[0],e.slice(1)):e,n=r.extend({},a.defaultOptions,o.options,n,{batch:o});r.each(e,function(e,t){t=new a.task(t,n);o.addTask(t),t.start()})}function o(){var e=r.makeArray(arguments),e=r.isPlainObject(e[0])?(t=e[0],e.slice(1)):e,t=r.extend({},o.defaultOptions,this.options,t,{batch:this}),t=new o.task(e,t);this.addTask(t),t.start()}function i(){var n=this,e=r.makeArray(arguments),e=r.isPlainObject(e[0])?(a=e[0],e.slice(1)):e,a=r.extend({},i.defaultOptions,n.options,a,{batch:n});r.each(e,function(e,t){var o=new i.task(t,a),t=i.images[o.url],o=t||o;n.addTask(o),t||(i.images[o.url]=o).start()})}r.require=function(){function n(e){return e=new o(e),n.batches[e.id]=e}var e=function(e){return r.uri(e).setAnchor("").setQuery("").toPath("../").toString()};r.extend(n,{defaultOptions:{path:(e=r.path||r("[require-path]").attr("require-path")||e(r("script:last").attr("src"))||e(window.location.href),e=/^(\/|\.)/.test(e)?r.uri(window.location.href).toPath(e).toString():e),timeout:1e4,retry:3,verbose:"development"==r.environment},setup:function(e){r.extend(n.defaultOptions,e)},batches:{},status:function(i){return r.each(n.batches,function(e,t){var o={pending:0,resolved:0,rejected:0,ready:0,total:0},n=[];r.each(t.tasks,function(e,t){state=t.module&&"ready"==t.module.status?"ready":t.state(),o[state]++,o.total++,n.push({state:state,content:"["+state+"] "+t.name})});var a=t.id+": "+t.state()+" ["+o.resolved+"/"+o.total+"]";i&&o[i]<1||(r.IE?(console.log('$.require.batches["'+t.id+'"]'),r.each(n,function(e,t){console.log(t.content)}),console.log("")):(console.groupCollapsed(a),console.log('$.require.batches["'+t.id+'"]',t),r.each(n,function(e,t){var o=t.state,n=t.content;if(!i||o==i)switch(o){case"pending":console.warn(n);break;case"rejected":console.error(n);break;default:console.info(n)}}),console.groupEnd(a)))}),"$.require.status(pending|resolved|rejected|ready);"},loaders:{},addLoader:function(e,t){n[e]=t,o.prototype[e]=function(){return this.autoFinalize(),t.apply(this,arguments),this},n.loaders[e]=n[e]=t},removeLoader:function(e){delete o.prototype[e],delete n[e]}});var a=0,o=function(e){var t=r.Callbacks("once memory"),o=!1;return r.extend(this,{id:++a,tasks:[],options:r.extend({},n.defaultOptions,e),autoFinalizeDuration:300,finalized:!1,required:function(e){return!0===e&&(o=t.fire()),r.isFunction(e)&&t.add(e),o}})};return r.extend(o.prototype,{addTask:function(e){r.isDeferred(e)&&(this.finalized||(this.tasks.push(e),e.batch=this))},autoFinalize:function(){var e=this,t=e.autoFinalizeDuration;!1!==t&&(clearTimeout(e.autoFinalizeTimer),e.autoFinalizeTimer=setTimeout(function(){e.finalize()},t))},finalize:function(){var e,t,o,n,a=this;a.finalized||(a.finalized=!0,e=a.manager=r.when.apply(null,a.tasks),t=e.promise(),o=r.Callbacks(),r.extend(a,t,{progress:o.add,notify:o.fire,done:function(){return a.required(!0),a.done=t.done,a.done.apply(a,arguments)}}),n=a.options.verbose,e.progress(function(e,t){n&&"rejected"==e&&console.warn("Require: Task "+t.name+" failed to load.",t)}).fail(function(){n&&console.warn("Require: Batch "+a.id+" failed.",a)}),setTimeout(function(){r.each(a.tasks,function(e,t){t.then(function(){a.notify("resolved",t)},function(){a.notify("rejected",t)},function(){a.notify("progress",t)})})},1))},expand:function(e,t){var e=r.makeArray(e),o=t||{},n=[],n=r.isPlainObject(e[0])?(o=r.extend(e[0],t),e.slice(1)):e;return{options:o,names:n}}}),r.each(["done","fail","progress","always","then"],function(e,t){o.prototype[t]=function(){return this.finalize(),this[t].apply(this,arguments)}}),n}(),r.require.addLoader("script",function(){var e=r.uri(r.indexUrl).host();e!==r.uri(document.location.href).host()&&e.match("xn--")&&(r.support.cors=!0);function i(){var o,n=this,e=r.makeArray(arguments),e=r.isPlainObject(e[0])?(a=e[0],e.slice(1)):e,a=r.extend({},i.defaultOptions,n.options,a,{batch:n});r.each(e,function(e,t){t=new i.task(t,a,o);n.addTask(t),a.serial&&void 0!==o?o.always(t.start):t.start(),o=t})}!0===document.createElement("script").async||"MozAppearance"in document.documentElement.style||window.opera;return r.extend(i,{defaultOptions:{path:"",extension:"compressed"==r.mode?"min.js":"js",serial:!1,async:!1,xhr:!1},setup:function(){r.extend(i.defaultOptions,options)},scripts:{},task:function(e,t,o){var n=r.extend(this,r.Deferred());n.name=e,n.options=t,n.taskBefore=o,r.isArray(e)&&(n.name=e[0]+"@"+e[1],n.moduleName=e[0],e[2]||(n.defineModule=!0,r.module.registry[n.moduleName]&&console.warn("$.require.script: "+n.moduleName+" exists! Using existing module instead."),n.options.xhr=!0),e=e[1],n.module=r.module(n.moduleName)),r.isUrl(e)?n.url=e:/^(\/|\.)/.test(e)?n.url=r.uri(n.options.path).toPath(e).toString():(n.url=r.uri(n.options.path).toPath("./"+e+"."+n.options.extension).toString(),n.module=r.module(e))}}),r.extend(i.task.prototype,{start:function(){var e=this.module;e&&"pending"!==e.status?this.waitForModule():this.load()},waitForModule:function(){var e=this,t=e.module;t.then(e.resolve,e.reject,e.notify),e.batch.required(function(){t.done(e.resolve)})},load:function(){var e,o=this,n=o.taskBefore;o.script=i.scripts[o.url]||(e=o.options.xhr?r.ajax({url:o.url,dataType:"text"}):r.script({url:o.url,type:"text/javascript",async:o.options.async,timeout:o.batch.options.timeout,retry:o.batch.options.retry,verbose:o.batch.options.verbose}),i.scripts[o.url]=e),o.script.done(function(e){function t(){o.module?o.waitForModule():o.resolve()}o.options.xhr&&(o.defineModule&&(o.module=r.module(o.moduleName,function(){r.globalEval(e),this.resolveWith(e)})),!o.options.async||n)?n.done(function(){r.globalEval(e),t()}):t()}).fail(function(){o.reject()})}}),i}()),r.require.addLoader("template",(r.extend(a,{defaultOptions:{path:"",extension:"htm"},setup:function(){r.extend(a.defaultOptions,options)},task:function(e,t){var o=r.extend(this,r.Deferred());o.name=e,o.options=t,r.isArray(e)&&(o.name=e[0],e=e[1]),r.isUrl(e)?o.url=e:/^(\/|\.)/.test(e)?o.url=r.uri(o.options.path).toPath(e).toString():o.url=r.uri(o.options.path).toPath("./"+e+"."+o.options.extension).toString()},loaders:{},loader:function(t){return r.isArray(t)?r.map(t,function(e){return a.loader(e)}):r.isPlainObject(t)?r.map(t,function(e,t){return a.loader(t).resolve(e)}):a.loaders[t]||(a.loaders[t]=r.Deferred().done(function(e){r.template(t,e)}))}}),r.extend(a.task.prototype,{start:function(){var e=this,t=a.loaders[e.name];return t||((t=a.loader(e.name)).xhr=r.Ajax({url:e.url,dataType:"text"}).then(t.resolve,t.reject).then(e.resolve,e.reject)),e.loader=t,e}}),a)),r.require.addLoader("language",(r.extend(o,{defaultOptions:{path:""},setup:function(){r.extend(o.defaultOptions,options)},loaders:{},task:function(e,t){var o=r.extend(this,r.Deferred());o.name=e.join(","),o.options=t,o.url=t.path,o.names=e},loader:function(t){return r.isArray(t)?r.map(t,function(e){return o.loader(e)}):r.isPlainObject(t)?r.map(t,function(e,t){return o.loader(t).resolve(e)}):o.loaders[t]||(o.loaders[t]=r.Deferred().done(function(e){r.language.add(t,e)}))}}),r.extend(o.task.prototype,{start:function(){var t=this,e=r.map(t.names,function(e){var t=o.loader(e);return t.push(t),/resolved|rejected/.test(t.state())?null:e});return t.fail(function(){r.each(e,function(e,t){o.loader(t).reject()})}),r.when.apply(null,[]).then(t.resolve,t.reject),e.length<1||(t.xhr=r.Ajax({url:t.url,type:"POST",data:{keys:e}}).done(function(e){r.isPlainObject(e)?o.loader(e):t.reject()}).fail(function(){t.reject()})),t}}),o)),r.require.addLoader("library",function(){var e=r.makeArray(arguments),t={},e=r.isPlainObject(e[0])?(t=e[0],e.slice(1)):e;return r.extend(t,{path:r.scriptPath}),this.script.apply(this,[t].concat(e))}),r.require.addLoader("image",(r.extend(i,{defaultOptions:{path:""},setup:function(){r.extend(i.defaultOptions,options)},images:{},task:function(e,t){var o=r.extend(this,r.Deferred());o.name=e,o.options=t,r.isUrl(e)?o.url=e:/^(\/|\.)/.test(e)?o.url=r.uri(o.options.path).toPath(e).toString():o.url=r.uri(o.options.path).toPath("./"+e).toString(),o.options.url=o.url}}),r.extend(i.task.prototype,{start:function(){var e=this;e.image=r(new Image).load(function(){e.resolve()}).error(function(){e.reject()}).attr("src",e.options.url)}}),i))}),FD50.plugin("iframe-transport",function(d){d.ajaxPrefilter(function(e,t,o){if(e.iframe)return"iframe"}),d.ajaxTransport("iframe",function(e,t,o){function r(){l&&c.replaceWith(function(e){return i.get(e)}),n.remove(),a.attr("src","javascript:false;").remove()}var n=null,a=null,s="iframe-"+d.now(),i=d(e.files).filter(":file:enabled"),l=0<i.length,c=null;return e.dataTypes.shift(),n=d("<form enctype='multipart/form-data' method='post'></form>").hide().attr({action:e.url,target:s}),"string"==typeof e.data&&0<e.data.length&&d.error("data must not be serialized"),d.each(e.data||{},function(o,e){d.isPlainObject(e)&&(o=e.name,e=e.value),d.isArray(e)||(e=[e]),d.each(e,function(e,t){d("<input type='hidden' />").attr({name:o,value:t}).appendTo(n)})}),d("<input type='hidden' value='IFrame' name='X-Requested-With' />").appendTo(n),l&&(c=i.after(function(e){return d(this).clone().prop("disabled",!0)}).next(),i.appendTo(n)),{send:function(e,i){(a=d("<iframe src='javascript:false;' name='"+s+"' id='"+s+"' style='display:none'></iframe>")).bind("load",function(){a.unbind("load").bind("load",function(){var e=this.contentWindow?this.contentWindow.document:this.contentDocument||this.document,t=e.documentElement||e.body,o=t.getElementsByTagName("textarea")[0],n=o?o.getAttribute("data-type"):null,a=o?o.getAttribute("data-status"):200,e=o?o.getAttribute("data-statusText"):"OK",t={html:t.innerHTML,text:n?o.value:t?t.textContent||t.innerText:null};r(),i(a,e,t,n?"Content-Type: "+n:null)}),n[0].submit()}),d("body").append(n,a)},abort:function(){null!==a&&(a.unbind("load").attr("src","javascript:false;"),r())}}})}),FD50.plugin("server",function($){var self=$.server=function(n){var a=$.Deferred(),e=$.extend(!0,{},self.defaultOptions,n,{success:function(){}}),e=a.xhr=$.Ajax(e).done(function(e){if("string"==typeof e)try{e=$.parseJSON(e)}catch(e){a.rejectWith(a,["Unable to parse Ajax commands.","error"])}var o;$.isArray(e)?(o=function(e){var t=e.type,t=self.parsers[t]||n[t];if($.isFunction(t))return t.apply(a,e.data)},e=$.map(e,function(e){return"notify"!=e.type?e:void o(e)}),$.each(e,function(e,t){o(t)})):a.rejectWith(a,["Invalid ajax commands.","error"]),"pending"===a.state()&&a.resolveWith(a)}).fail(function(e,t,o){a.rejectWith(a,[o,t])});return a.abort=e.abort,a};self.defaultOptions={type:"POST",data:{tmpl:"component",format:"ajax",no_html:1},cache:!1,contentType:"application/x-www-form-urlencoded",dataType:"json"},self.parsers={script:function(){var data=$.makeArray(arguments);if("string"!=typeof data[0]){var chain=window,chainBroken=!1;$.each(data,function(e,t){"Foundry"===t.property&&(t.property=$.globalNamespace),"Foundry"===t.method&&(t.method=$.globalNamespace);try{switch(t.type){case"get":chain=chain[t.property];break;case"set":chain[t.property]=t.value,chainBroken=!0;break;case"call":chain=chain[t.method].apply(chain,t.args)}}catch(e){chainBroken=!0}})}else try{eval(data[0])}catch(err){}},resolve:function(){this.resolveWith(this,arguments)},reject:function(){this.rejectWith(this,arguments)},notify:function(){this.notifyWith(this,arguments)},redirect:function(e){window.location=e}}}),FD50.plugin("component",function(r){var n=!1,s=r.Component=function(e,t){return arguments.length<1?s.registry:arguments.length<2?s.registry[e]:s.register(e,t)};s.registry={},s.proxy=function(e,t,o){e[t]=o,r.isFunction(o)&&(e[t]=r.proxy(o,e))},s.register=function(e,t){var o;r.isFunction(e)&&(e=(o=e).className,t=o.options);var n=s.registry[e]=window[e]=function(e){return r.isFunction(e)?e(r):component};if(r.each(s.prototype,function(e,t){s.proxy(n,e,t)}),n.$=r,n.options=t,n.className=e,n.identifier="easyblog",n.componentName="com_easyblog",n.prefix=n.identifier+"/",n.version=t.version,n.safeVersion=n.version.replace(/\./g,""),n.scriptVersion=t.scriptVersion,n.environment=t.environment||r.environment,n.mode=t.mode||r.mode,n.debug="development"===n.environment,n.console=s.console(n),n.language=t.language||r.locale.lang||"en",n.ajaxUrl=t.ajaxUrl||r.basePath+"/?option="+n.componentName,n.scriptPath=t.scriptPath||r.rootPath+"/media/"+n.componentName+"/scripts/",n.viewPath=t.viewPath||n.ajaxUrl+"&tmpl=component&no_html=1&controller=themes&task=getAjaxTemplate",n.scriptVersioning=t.scriptVersioning||!1,n.tasks=[],FD50.component(e,n),o)if(n.debug)o.queue.execute();else{for(var a,i=FD50.installer(e);a=i.shift();)n.install.apply(n,a);r.when(n.install("definitions"),n.install("scripts")).done(function(){o.queue.execute()})}},s.extend=function(o,n){s.prototype[o]=n,r.each(s.registry,function(e,t){s.proxy(t,o,n)})},r.template("component/console",'<div id="[%== component.identifier %]-console" class="foundry-console" style="display: none; z-index: 999999;"><div class="console-header"><div class="console-title">[%= component.className %] [%= component.version %]</div><div class="console-remove-button">x</div></div><div class="console-log-item-group"></div><style type="text/css">.foundry-console{position:fixed;width:50%;height:50%;bottom:0;left:0;background:white;box-shadow: 0 0 5px 0;margin-left: 25px;}.console-log-item-group{width: 100%;height: 100%;overflow-y:scroll;}.console-header{position: absolute;background:red;color:white;font-weight:bold;top:-24px;left: 0;line-height:24px;width:100%}.console-remove-button{text-align:center;cursor: pointer;display:block;width: 24px;float:right}.console-remove-button:hover{color: yellow}.console-title{padding: 0 5px;float:left}.console-log-item{padding: 5px}.console-log-item + .console-log-item{border-top: 1px solid #ccc}</style></div>'),s.console=function(e){return a=e,o.selector="#"+a.identifier+"-console",o.init=function(){return(i=r(o.selector)).length<1&&(i=r(r.View("component/console",{component:a})).appendTo("body")).find(".console-remove-button").click(function(){i.hide()}),o.element=i,arguments.callee},o.methods={log:function(e,t,o){t=t||"info";var n=i.find(".console-log-item-group"),e=r(document.createElement("div")).addClass("console-log-item type-"+t).attr("data-code",o).html(e);n.append(e),n[0].scrollTop=n[0].scrollHeight,a.debug&&i.show()},toggle:function(){i.toggle()},reset:function(){i.find(".console-log-item-group").empty()}},r.each(o.methods,function(e,t){o[e]=function(){return o.init(),t.apply(o,arguments)}}),o;function o(e){return arguments.length<1?o.toggle():o[e]&&o[e].apply(o,arguments)}var a,i};var t=r(document),e=s.prototype;r.extend(e,{run:function(e){return r.isFunction(e)?e(r):this},ready:(t.ready(function(){e.ready=e.run}),function(e){r.isFunction(e)&&t.ready(function(){e(r)})}),install:function(e,t){var o=this,n=o.tasks[e]||(o.tasks[e]=r.Deferred());if(!t)return n;function a(){return t(r,o),n.resolve()}if("definitions"==e)return a();r.when(o.install("definitions")).done(a)},token:function(){return window.ezb.csrfToken||Joomla.getOptions("csrf.token",window.ezb.token)},template:function(e){var t=this;return null==e?r.grep(r.template(),function(e){return 0==e.indexOf(t.prefix)}):(arguments[0]=t.prefix+e,r.template.apply(null,arguments))},require:function(e){var a=this,e=e||{},o=r.require(e),i={};return r.each(["library","script","language","template","done"],function(e,t){i[t]=o[t]}),o.library=function(){return i.script.apply(this,arguments),o},o.script=function(){var n=this.expand(arguments,{path:a.scriptPath}),e=r.map(n.names,function(e){if(r.isArray(e)||r.isUrl(e)||/^(\/|\.)/.test(e))return e;var t=n.options.extension||"production"==a.options.environment?"min.js":"js",o=a.scriptVersioning?"?"+a.scriptVersion+"=1":"";return[[a.prefix+e,r.uri(n.options.path).toPath("./"+e+"."+t+o).toString(),!0]]});return i.script.apply(o,[n.options].concat(e)),o},o.template=function(){var e=this.expand(arguments,{path:a.scriptPath});return i.template.apply(o,[e.options].concat(r.map(e.names,function(e){return[[a.prefix+e,e]]}))),o},o.done=function(t){return i.done.call(o,function(){void 0===window.ezb.csrfToken?!1===n?n=EasyBlog.ajax("site/controllers/base/csrf").done(function(e){window.ezb.csrfToken=e,a.ready(t)}):n.done(function(){a.ready(t)}):a.ready(t)})},o},module:function(e,t){if(!r.isArray(e)){e=this.prefix+e;return t?r.module.apply(null,[e,function(){t.call(this,r)}]):r.module(e)}}}),r.Component.extend("ajax",function(e,t,o){var n=this,a=new Date,i={url:n.ajaxUrl+"&_ts="+a.getTime(),data:r.extend(t,{option:n.componentName,namespace:e})};if((i=r.extend(!0,i,n.options.ajax)).data[n.token()]=1,i.data.hasOwnProperty("args")&&(i.data.args=r.toJSON(i.data.args)),r.isPlainObject(o)){if(o.type){switch(o.type){case"jsonp":o.dataType="jsonp",o.crossDomain=!0,i.data.transport="jsonp";break;case"iframe":o.iframe=!0,o.processData=!1,o.files=i.data.files,delete i.data.files,i.data.transport="iframe"}delete o.type}r.extend(i,o)}r.isFunction(o)&&(i.success=o);e=r.server(i);return e.progress(function(e,t,o){n.debug&&"debug"==t&&n.console.log(e,t,o)}),e}),r.Component.extend("Controller",function(){var e,t=r.makeArray(arguments),o=t[0];return 1==t.length?r.String.getObject(o):(t=2<t.length?(e=t[1],t[2]):(e={},t[1]),r.extend(e,{root:this.className+".Controller",component:this}),r.Controller.apply(this,[o,e,t]))}),r.Component.extend("View",function(e){return arguments.length<1?this.template():(arguments[0]=this.prefix+e,r.View.apply(this,arguments))}),FD50.module.execute(),r.each(FD50.component(),function(e,t){t.registered||r.Component.register(t)})}),FD50.plugin("static",function($){$.module(["autosize.input","dialog","image"]),FD50.module("autosize.input",function(a){function e(){function n(e,t){var o=this;o.input=a(e),o.options=a.extend(n.defaultOptions,t),o.mirror=a('<span class="autosize-input" style="position:absolute; top:-999px; left:0; white-space:pre;"/>'),a.each(["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],function(e,t){o.mirror[0].style[t]=o.input.css(t)}),a("body").append(o.mirror),o.input.bind("keydown keyup input",function(e){o.update()}),o.update()}n.defaultOptions={space:30},n.validTypes=["text","password","search","url","tel","email"],n.prototype.update=function(){var e=this.input,t=this.mirror,o=(o=e.val())||e.attr("placeholder");o!==t.text()&&(t.text(o),t=t.width()+this.options.space,e.width(t))},a.fn.autosizeInput=function(t){return this.each(function(){var e;"INPUT"==this.tagName&&-1<a.inArray(this.type,n.validTypes)&&((e=a(this)).data("autosizeInputInstance")||e.data("autosizeInputInstance",new n(this,t)))})},a(function(){a("input[data-autosize-input]").autosizeInput()})}e(),this.resolveWith(e)}),function(){var moduleFactory=function($){var module=this,exports=function(){var dialogHtml='<div id="eb" class="eb-dialog has-footer type-html active"><div class="eb-dialog-modal"><div class="eb-dialog-header"><div class="eb-dialog-header__grid"><div class="eb-dialog-back-button t-hidden"><i class="fdi fa fa-arrow-left"></i></div><div class="eb-dialog-header__cell"><span class="eb-dialog-title"></span></div><div class="eb-dialog-close-button"><span aria-hidden="true"><i class="fdi fa fa-times"></i></span></div></div></div><div class="eb-dialog-body"><div class="eb-dialog-container"><div class="eb-dialog-content"></div><div class="o-loader"></div><div class="o-empty"><div class="o-empty__content"><i class="o-empty__icon fa fa-exclamation-triangle"></i><div class="o-empty__text"><span class="eb-dialog-error-message"></span></div></div></div></div></div><div class="eb-dialog-footer"><div><div class="eb-dialog-footer-content"></div></div></div></div></div>',dialog_=".eb-dialog",dialogModal_=".eb-dialog-modal",dialogContent_=".eb-dialog-content",dialogHeader_=".eb-dialog-header",dialogFooter_=".eb-dialog-footer",dialogFooterContent_=".eb-dialog-footer-content",dialogCloseButton_=".eb-dialog-close-button",dialogBackButton_=".eb-dialog-back-button",dialogTitle_=".eb-dialog-title",dialogErrorMessage_=".eb-dialog-error-message",divider="eb-dialog-header--divider",isFailed="is-failed",isLoading="is-loading",rxBraces=/\{|\}/gi,self=EasyBlog.dialog=function(e){if(void 0===e)return self;$.isString(e)&&(e={content:e});var t=self.open;return(t=window.parentEasyBlogDialog?window.parentEasyBlogDialog.open:t).apply(self,[e]),self};$.extend(self,{defaultOptions:{title:"",content:"",buttons:"",buttonAlignment:"default",classname:"",width:"auto",height:"auto",back:!1,escapeKey:!0},open:function(t){var o=$(dialog_);o.length<1&&(dialogHtml=$(dialogHtml),$("body").addClass("has-eb-dialog"),window.ezb.mobile&&dialogHtml.addClass("is-mobile"),window.ezb.ios&&dialogHtml.addClass("is-iphone"),o=dialogHtml.appendTo("body"));t=$.extend({},self.defaultOptions,t);$(dialogTitle_).html(t.title);var e=$(dialogHeader_);e.removeClass(divider),t.title&&e.addClass(divider);var n=$(dialogFooterContent_);n.html(t.buttons),o.toggleClass("has-footer",!!t.buttons),n.toggleClass("eb-dialog-footer-content--space-evenly","center"==t.buttonAlignment),$(dialogBackButton_).addClass("t-hidden"),t.back&&$(dialogBackButton_).removeClass("t-hidden"),self.setBindings(t);var a=$(dialogContent_).empty(),i=t.content,r=self.getContentType(i);o.switchClass("si-theme--"+window.ezb.appearance),o.switchClass("type-"+r);var s=$(dialogModal_),l=t.width,c=t.height;switch($.isNumeric(c)&&(n=$(dialogFooter_),c+=e.height()+n.height()),s.css({width:l,height:c}),o.addClassAfter("active"),r){case"html":a.html(i),o.trigger("init");break;case"iframe":var d=$("<iframe>"),u=$("<div />").html(i).text();d.appendTo(a).one("load",function(){try{d[0].contentWindow.parentEasyBlogDialog=self}catch(e){}}).attr("src",u);break;case"deferred":return o.switchClass(isLoading),void i.done(function(e){$.isPlainObject(e)?self.reopen($.extend(!0,t,e)):$.isString(e)?(t.content=e,self.reopen(t)):o.switchClass(isFailed)}).fail(function(e){o.switchClass(isFailed);var t=$(dialogErrorMessage_);$.isString(e)&&t.html(e),$.isPlainObject(e)&&e.message&&t.html(e.message)}).always(function(){o.removeClass(isLoading)});case"dialog":u=self.parseXMLOptions(i);return void self.open($.extend(!0,t,u))}},reopen:function(e){self.close(),self.open(e)},close:function(){$("body").removeClass("has-eb-dialog"),self.unsetBindings(),$(dialog_).remove()},getContentType:function(e){return/<dialog>(.*?)/.test(e)?"dialog":$.isUrl(e)?"iframe":$.isDeferred(e)?"deferred":"html"},parseXMLOptions:function(xml){var xmlOptions=$.buildHTML(xml),newOptions={};return $.each(xmlOptions.children(),function(i,node){var node=$(node),key=$.String.camelize(this.nodeName.toLowerCase()),val=node.html(),type=node.attr("type");switch(type){case"json":try{val=$.parseJSON(val)}catch(e){}break;case"javascript":try{val=eval("(function($){ return "+$.trim(val)+" })("+$.globalNamespace+")")}catch(e){}break;case"text":val=node.text()}$.isNumeric(val)&&(val=parseFloat(val)),newOptions.buttonAlignment="default","BUTTONS"==this.nodeName&&(newOptions.buttonAlignment=node.attr("alignment")||"default"),newOptions[key]=val}),newOptions},bindings:{},setBindings:function(e){self.unsetBindings();var a,i,t=e.selectors,o=e.bindings;t&&o&&(a={parent:self},i=$(dialog_),$.each(t,function(e,t){e=e.replace(rxBraces,"");(a[e]=function(){return i.find(t)}).selector=t}),$.each(o,function(e,t){var o=e.split(" "),n=o[0].replace(rxBraces,""),e=o[1]+".eb.dialog",o=a[n];"init"==n&&i.on(n,function(){var e=[this].concat(arguments);t.apply(a,e)}),o&&(o=o.selector,i.on(e,o,function(){t.apply(a,[this].concat(arguments))}),self.bindings[e]=t)})),e.escapeKey&&$(document).on("keydown.eb.dialog",function(e){27==e.keyCode&&self.close()})},unsetBindings:function(){var o=$(dialog_);$.each(self.bindings,function(e,t){o.off(e)}),$(document).off("keydown.eb.dialog")}}),$(document).on("click",dialogCloseButton_,function(){self.close()}).on("click",dialog_,function(e){var t=$(dialog_);e.target==t[0]&&self.close()})};exports(),module.resolveWith(exports)};FD50.module("dialog",moduleFactory)}(),FD50.module("image",function(i){function e(){i.fn.image=function(e){e=i.Image[e];return e&&e.apply(this[0],i.makeArray(arguments).slice(1))},i.Image={get:function(e){var o="IMG"===this.nodeName,n=i(o?this:new Image),a=i.Deferred();return n.on("load",function(){var e;o||n.appendTo("body");var t={width:t=n.width(),height:e=n.height(),aspectRatio:t=t/e,orientation:e=1==t?"square":t<1?"tall":"wide"};n.css({position:"absolute",left:"-99999px"}).data(t).addClass("orientation-"+e).removeAttr("style"),o||n.detach(),a.resolve(n,t)}).on("error",function(){a.reject()}).attr("src",e),a},aspectRatio:function(e,t){return i.isPlainObject(e)&&(t=(e=e.width).height),e/t},orientation:function(e,t){return i.isPlainObject(e)&&(t=(e=e.width).height),e===t?"square":t<e?"wide":"tall"},resizeProportionate:function(e,t,o,n,a){var i=e,r=t,s=o/e,i=e*s,r=t*s;return("outer"==a?r<n:n<r)&&(i=e*(s=n/t),r=t*s),{top:(n-r)/2,left:(o-i)/2,width:i,height:r}},resizeWithin:function(e,t,o,n){return i.Image.resizeProportionate(e,t,o,n,"inner")},resizeToFill:function(e,t,o,n){return i.Image.resizeProportionate(e,t,o,n,"outer")}}}e(),this.resolveWith(e)})}),FD50.installer("EasyBlog","definitions",function(e){e.module(["easyblog/shared/foundry","easyblog/shared/gallery","easyblog/composer/blocks","easyblog/composer/blocks/dimensions","easyblog/composer/blocks/droppable","easyblog/composer/blocks/font","easyblog/composer/blocks/guide","easyblog/composer/blocks/handlers/accordion","easyblog/composer/blocks/handlers/alerts","easyblog/composer/blocks/handlers/apple","easyblog/composer/blocks/handlers/audio","easyblog/composer/blocks/handlers/behance","easyblog/composer/blocks/handlers/buttons","easyblog/composer/blocks/handlers/code","easyblog/composer/blocks/handlers/codepen","easyblog/composer/blocks/handlers/columns","easyblog/composer/blocks/handlers/compare","easyblog/composer/blocks/handlers/comparison","easyblog/composer/blocks/handlers/dailymotion","easyblog/composer/blocks/handlers/easysocial","easyblog/composer/blocks/handlers/facebook","easyblog/composer/blocks/handlers/file","easyblog/composer/blocks/handlers/gallery","easyblog/composer/blocks/handlers/giphy","easyblog/composer/blocks/handlers/gist","easyblog/composer/blocks/handlers/heading","easyblog/composer/blocks/handlers/html","easyblog/composer/blocks/handlers/image","easyblog/composer/blocks/handlers/instagram","easyblog/composer/blocks/handlers/links","easyblog/composer/blocks/handlers/lottie","easyblog/composer/blocks/handlers/metacafe","easyblog/composer/blocks/handlers/module","easyblog/composer/blocks/handlers/notes","easyblog/composer/blocks/handlers/pagebreak","easyblog/composer/blocks/handlers/pdf","easyblog/composer/blocks/handlers/pinterest","easyblog/composer/blocks/handlers/polls","easyblog/composer/blocks/handlers/post","easyblog/composer/blocks/handlers/quotes","easyblog/composer/blocks/handlers/readmore","easyblog/composer/blocks/handlers/rule","easyblog/composer/blocks/handlers/section","easyblog/composer/blocks/handlers/sendy","easyblog/composer/blocks/handlers/slideshare","easyblog/composer/blocks/handlers/soundcloud","easyblog/composer/blocks/handlers/spotify","easyblog/composer/blocks/handlers/table","easyblog/composer/blocks/handlers/tabs","easyblog/composer/blocks/handlers/ted","easyblog/composer/blocks/handlers/text","easyblog/composer/blocks/handlers/thumbnails","easyblog/composer/blocks/handlers/tiktok","easyblog/composer/blocks/handlers/tweet","easyblog/composer/blocks/handlers/twitch","easyblog/composer/blocks/handlers/video","easyblog/composer/blocks/handlers/vimeo","easyblog/composer/blocks/handlers/youtube","easyblog/composer/blocks/mobile","easyblog/composer/blocks/nestable","easyblog/composer/blocks/panel","easyblog/composer/blocks/removal","easyblog/composer/blocks/resizable","easyblog/composer/blocks/scrollable","easyblog/composer/blocks/search","easyblog/composer/blocks/text","easyblog/composer/blocks/toolbar","easyblog/composer/blocks/tree","easyblog/composer/category","easyblog/composer/composer","easyblog/composer/document","easyblog/composer/document/cover","easyblog/composer/document/maps","easyblog/composer/document/osm","easyblog/composer/document/overlay","easyblog/composer/document/permalink","easyblog/composer/document/toolbar","easyblog/composer/googleimport","easyblog/composer/layout/elements","easyblog/composer/media","easyblog/composer/media/editor","easyblog/composer/media/uploader","easyblog/composer/mobile","easyblog/composer/panels","easyblog/composer/panels/association","easyblog/composer/panels/authorship","easyblog/composer/panels/autopost","easyblog/composer/panels/category","easyblog/composer/panels/post","easyblog/composer/panels/seo","easyblog/composer/perfectscrollbar","easyblog/composer/posts","easyblog/composer/revisions","easyblog/composer/shortcuts","easyblog/composer/tags","easyblog/composer/templates","easyblog/composer/vendors/colorpicker","easyblog/composer/vendors/cropper","easyblog/composer/vendors/dragselect","easyblog/composer/vendors/expanding","easyblog/composer/vendors/nearest","easyblog/composer/vendors/nouislider","easyblog/composer/vendors/selectionchange"])}),FD50.installer("EasyBlog","scripts",function(e){EasyBlog.module("shared/foundry",function(a){a(document).on("change.form.toggler","[data-eb-toggler-checkbox]",function(){var e=a(this),t=e.is(":checked"),e=e.parents("[data-eb-toggler]");0<e.length&&e.find("input[type=hidden]").val(t?1:0).trigger("change")}),a(document).on("change.form.toggler.value","[data-eb-toggler-checkbox] ~ input[type=hidden]",function(){var e=a(this),t=1==e.val(),o=e.siblings("[data-eb-toggler-checkbox]"),e=o.is(":checked");!t||e?!t&&e&&o.prop("checked",!1):o.prop("checked",!0)}),jQuery(document).on("fd.easyblog.toggler.disabled",function(e,t,o){EasyBlog.dialog({width:400,height:140,title:t,content:o})}),a(document).on("click","[data-eb-toggler]",function(e){var t=a(this),o=t.data("disabled"),n=t.data("disabledDesc");o&&0<n.length&&(t=t.data("disabledTitle"),fd.trigger("easyblog","toggler.disabled",[t,n]))}),jQuery(document).on("fd.easyblog.article.browse",function(e,t,o,n){window.insertArticle=function(e,t){o.val(t),n.val(e),EasyBlog.dialog().close()},EasyBlog.dialog({content:EasyBlog.ajax("admin/views/articles/browse")})}),jQuery(document).on("fd.easyblog.user.browse",function(e,t,o,n){window.insertUser=function(e,t){o.val(t),n.val(e),EasyBlog.dialog().close()},EasyBlog.dialog({content:EasyBlog.ajax("admin/views/bloggers/browse")})}),jQuery(document).on("fd.easyblog.textcopy.copied",function(e,t){(t=a(t)).attr("data-original-title",t.data("copied")).tooltip("show")}),jQuery(document).on("fd.easyblog.textcopy.mouseout",function(e,t){a(t).attr("data-original-title",a(t).data("copy")).tooltip("show")}),jQuery(document).on("fd.easyblog.ratings.click",function(e,t,o){const n=t.closest("[data-rating-form]");var a=n.data("type"),t=n.data("id");EasyBlog.ajax("site/views/ratings/vote",{value:o,type:a,id:t}).done(function(e,t){n.addClass("voted"),n.find("[data-rating-text]").html(t),n.find("[data-rating-total]").text(e)})}),this.resolve()}),EasyBlog.module("shared/gallery",function(e){var t=this;EasyBlog.require().script("site/vendors/swiper").done(function(s){var l=".eb-gallery-viewport",o=EasyBlog.ImageGallery={setLayout:function(e){e.find(".eb-gallery-item").each(function(e){var t=s(this),o="rtl"==window.ezb.direction?"right":"left";t.css(o,100*e+"%")}),e.data("autoplay")&&this.autoplay.start(e)},autoplay:{start:function(e){var t=1e3*e.data("interval");o.autoplay.stop(e);t=setTimeout(function(){o.next(e),o.autoplay.start(e)},t);e.data("timer",t)},stop:function(e){e=e.data("timer");clearTimeout(e)}},checkAutoplay:function(e){var t=1e3*e.data("interval");this.stopMonitoringAutoplay(e),setTimeout(function(){o.next(e),o.startMonitoringAutoplay(e)},t)},go:function(e,t){},next:function(e){var t=o.getActiveIndex(e);o.go(e,t+1)},prev:function(e){var t=o.getActiveIndex(e);o.go(e,t-1)},setActiveIndex:function(e,t){o.getMenuItems(e).removeClass("active").eq(t).addClass("active")},getActiveIndex:function(e){e=o.getMenuItems(e).filter(".active").index();return e=e<0?0:e},getMenuItems:function(e){return e.find(".eb-gallery-menu-item")}};s(document).ready(function(e){s(".ebd-block[data-type=gallery]:not([data-eb-composer-block-menu]").each(function(){var e=s(this),t=e.data("uid"),o=e.closest(".ebd-block[data-type=gallery][data-uid="+t+"]"),n=e.find("[data-eb-gallery-container]"),a=e.find(".eb-gallery-menu"),i=e.find(".eb-gallery-button.eb-gallery-next-button"),r=e.find(".eb-gallery-button.eb-gallery-prev-button"),t=n.find(l).data("eb-gallery-initial-slide"),e=0;0<t&&(e=t);e=new Swiper(s(n),{pagination:{el:a,clickable:!0},navigation:{nextEl:i,prevEl:r},initialSlide:e});o.data("swiper",e)})}),t.resolve()})}),EasyBlog.module("composer/blocks",function(l){var e=this,a="is-new",i="is-editable",o="is-receiving",r="is-dropping",c="is-releasing",d="is-refocusing",u="is-highlighting",p="is-sorting",m="is-sort-item",f="is-nested",h="is-dragging-block",g="is-dropping-block",v="is-inserting-block",b="is-selected",y="is-highlighting-block";EasyBlog.require().library("ui/draggable","ui/position","image","scrollTo").script("composer/blocks/panel","composer/blocks/guide","composer/blocks/nestable","composer/blocks/droppable","composer/blocks/resizable","composer/blocks/scrollable","composer/blocks/font","composer/blocks/dimensions","composer/blocks/text","composer/blocks/removal","composer/blocks/tree","composer/blocks/search","composer/blocks/mobile","composer/blocks/toolbar").done(function(){EasyBlog.Controller("Composer.Blocks",{hostname:"blocks",pluginExtendsInstance:!0,elements:["[data-eb-composer-{blocks}]","[data-eb-composer-block-{menu|menu-group|meta}]","[data-eb-composer-{editor}]","[data-ebd-block-{viewport|content}]"],defaultOptions:l.extend({"{view}":"[data-eb-composer-blocks]","{editableContent}":EBD.editableContent,"{immediateBlockViewport}":EBD.immediateBlockViewport,"{immediateBlockContent}":EBD.immediateBlockContent,"{blockActions}":EBD.blockActions,"{sidebar}":"[data-eb-composer-blocks]","{mechswitch}":".mechswitch","{toolbarButton}":"[data-toolbar-blocks]","{blockSection}":"[data-eb-composer-block-section]","{blockSectionHeader}":"[data-eb-composer-blocks] [data-eb-composer-block-section-header]","{blockSectionContent}":"[data-eb-composer-block-section-content]","{searchInput}":"[data-eb-blocks-search]"},EBD.selectors)},function(s,e,t,n){return{init:function(){var e=["panel","guide","nestable","droppable","resizable","scrollable","font","dimensions","text","removal","tree","search","mobile","media","toolbar"];"legacy"==(n=s.composer).getDoctype()&&(e=["panel","tree","dimensions","media"]),l.each(e,function(e,t){s.addPlugin(t)});l.each(["post","image","video","file","audio","pdf","gallery"],function(e,t){s.loadBlockHandler(t)})},ps:null,browser:{highlightSearch:function(){s.searchInput().focus()},isOpen:function(){return n.manager().hasClass("is-composer-blocks-open")},isClosed:function(){return!n.browser.isOpen()},open:function(){n.manager().addClass("is-composer-blocks-open"),s.toolbarButton().addClass("is-active"),s.browser.highlightSearch()},close:function(){n.manager().removeClass("is-composer-blocks-open"),s.toolbarButton().removeClass("is-active")},toggle:function(){s.browser.isOpen()?s.browser.close():s.browser.open()}},getAllBlocks:function(){return s.root().find(EBD.block)},getFirstBlock:function(){var e=s.getAllBlocks();return l(e[0])},getCurrentBlock:function(){return s.root().find(EBD.block+".active")},getNextBlock:function(){var e=s.getCurrentBlock().next();return!(e.length<=0)&&e},getPreviousBlock:function(){var e=s.getCurrentBlock().prev();return!(e.length<=0)&&e},getParentBlock:function(e){return e.is(EBD.nestedBlock)?l(e).parents(EBD.block).eq(0):l()},getAllParentBlocks:function(e){return e.parentsUntil(EBD.root).filter(EBD.block)},getBlockTree:function(e){return s.getAllParentBlocks(e).add(s.root())},getRootBlocks:function(){return s.root().find(EBD.childBlock)},getChildBlocks:function(e){return e.is(EBD.root)?e.find(EBD.childBlock):e.find(EBD.nestedBlock+":not(.ebd-block[data-uid="+e.data("uid")+"] "+EBD.nest+" "+EBD.nest+" "+EBD.nestedBlock+")")},getAllChildBlocks:function(e){return e.find(EBD.block)},getBlocksByType:function(e){return s.root().find(EBD.block+"[data-type="+e+"]")},getBlock:function(e){return t.find(EBD.block+"[data-uid="+e+"]")},getBlockUid:function(e){return e.attr("data-uid")||s.setBlockUid(e)},getBlockTemplateId:function(e){return e.attr("data-template-id")},isBlockTemplate:function(e){return!!e.attr("data-template-id")},setBlockUid:function(e){return e.attr("data-uid")||(t=l.uid(),e.attr("data-uid",t),t);var t},updateBlockUid:function(e){e.removeAttr("data-uid"),s.setBlockUid(e)},getBlockType:function(e){return l(e).attr("data-type")},metas:{},getBlockMeta:function(o,e){if(e){e=s.meta().where("id",e).val();if(e)return JSON.parse(e)}return o instanceof l&&(o=s.getBlockType(o)),s.metas[o]||function(){var t=s.meta().where("type",o).val();if(t){try{var e=JSON.parse(t)}catch(e){console.log("exception",o,t)}return s.metas[o]=e}return null}()},getBlockViewport:function(e){return s.immediateBlockViewport.inside(e)},getBlockContent:function(e){return s.immediateBlockContent.inside(e)},getBlockActions:function(e){return s.blockActions.inside(e)},setBlockContent:function(e,t){s.immediateBlockContent.inside(e).html(t.html())},getBlockFragment:function(e){function o(e){var t=s.getBlockType(e),o=s.getBlockHandler(t),t=s.createBlockContainer(t),o=o.toHTML(e);return e.is(EBD.nested)&&e.addClass(f),t.append(o),t}e=o(e);return e.find(EBD.nestedBlock).each(function(){var e=l(this),t=o(e);e.replaceWith(t)}),e},getBlockHTML:function(e){return s.getBlockFragment(e).toHTML()},getBlockText:function(e){},getBlockNest:function(e){return e.closest(EBD.nest)},getBlockNestType:function(e){return s.getBlockNest(e).data("type")},isBlock:function(e){return e.is(EBD.block)},isNestedBlock:function(e){return e.is(EBD.nestedBlock)},isRootBlock:function(e){return!s.isNestedBlock(e)},isStandaloneBlock:function(e){return e.is(EBD.standaloneBlock)},restoreInlineBlockData:function(n){var a=n.next();a.each(function(e){var t,o=l(this);o.is("textarea[data-block]")&&(t=a.val(),t=JSON.parse(t),s.dataset[s.getBlockUid(n)]=t,o.remove())})},initBlock:function(t){var o=arguments,n=s.getBlockType(t);s.setBlockUid(t),s.restoreInlineBlockData(t),s.loadBlockHandler(n).done(function(e){if(t.hasClass(a)){s.trigger("composerBlockBeforeAdd",o);try{e.reset(t),e.reconstruct(t)}catch(e){EasyBlog.debug&&console.error("Error initializing new block of type '%s'.",n,e)}s.trigger("composerBlockAdd",o),s.release(t),t.removeClass(a).addClass(i),s.trigger("composerBlockInit",o)}else if(!t.hasClass(i)){try{e.reconstruct(t)}catch(e){EasyBlog.debug&&console.error("Error initializing existing block of type '%s'.",n,e)}t.addClass(i),s.trigger("composerBlockInit",o)}}),s.getChildBlocks(t).each(function(){var e=l(this);s.initBlock(e)})},createBlockContainer:function(e){s.getBlockMeta(e);var t=l(l("[data-eb-block-template]").clone().html());return t.attr("data-type",e),t},createBlock:function(e,t){e=s.getBlockMeta(e,t);if(e){t=l(e.block);return s.setBlockUid(t),s.trigger("composerBlockCreate",[t,e]),t}},createBlockFromMenu:function(e){var t=e.attr("data-type"),e=e.attr("data-id");return block=s.createBlock(t,e).addClass(a),block},createBlockFromMediaFile:function(e){var t=e.data("type");return s.getBlockHandler(t).constructFromMediaFile(e)},constructBlock:function(e,t){t=s.getBlockHandler(e).construct(t);return s.setBlockUid(t),s.trigger("composerBlockConstruct",[t]),t},constructNestedBlock:function(e,t){t=s.constructBlock(e,t);return t.addClass(f),t},constructIsolatedBlock:function(e,t){t=s.constructBlock(e,t);return t.addClass(f).addClass(isIsolated),t},createBlockNest:function(){return l('<div class="ebd-nest" data-type="block">')},createContentNest:function(e){var t=l('<div class="ebd-nest" data-type="content">');return(e=l.extend({editable:!0},e)).editable&&t.editable(!0),t},exportBlock:function(e,t){var o=void 0===t?s.getBlockUid(e):"",n=s.getBlockType(e),a=s.getBlockHandler(n),n={uid:o,type:n,html:"",data:{},blocks:[],nested:e.is(EBD.nestedBlock),isolated:e.is(EBD.isolatedBlock),style:e.attr("style")};EasyBlog.debug&&s.verifyBlockHandler(a,["toData","toText","toHTML"]),a.toData&&(n.data=a.toData(e)||{}),a.toText&&(n.text=a.toText(e)||""),a.toHTML&&(n.html=a.toHTML(e)||""),a.toEditableHTML?n.editableHtml=a.toEditableHTML(e)||"":(i=blocks.getBlockContent(e),n.editableHtml=i.html());var i=s.getBlockTemplateId(e);return!t&&i&&(n.data.template_id=i),s.trigger("composerBlockExport",[e,n]),n},addBlock:function(e,t){t=t||"append";s.root()[t](e),s.initBlock(e)},addBlockAfter:function(e,t){t.after(e),s.initBlock(e)},removeBlock:function(e,t){t=t||{},s.trigger("composerBlockBeforeRemove",[e,t]),e.find(EBD.nestedBlock).each(function(){var e=l(this);s.removeBlock(e,t)}),e.remove(),s.trigger("composerBlockRemove",[e,t])},scrollIntoView:function(e){n.viewport();n.viewportContent().stop(!0).scrollIntoView(e)},scrollTo:function(e,t){t=t||500;var o=n.viewport();n.viewportContent().stop(!0).scrollTo(e,t,{axis:"y",offset:{top:(o.height()-e.height())/-2,left:0}})},blockHandlers:{},loadBlockHandler:l.memoize(function(o){if(!o)return l.Deferred().reject(l.Exception("Invalid block type given."));var n=s.getBlockMeta(o);if(!n)return l.Deferred().reject(l.Exception("Block of type '"+o+"' is not installed!"));var a=l.Deferred();return EasyBlog.require().script("composer/blocks/handlers/"+o).done(function(){var e="handler/"+o,t="EasyBlog.Controller.Composer.Blocks.Handlers."+l.String.capitalize(o),t=s.addPlugin(e,t,{meta:n});s.blockHandlers[o]=t,EasyBlog.debug&&s.verifyBlockHandler(t),a.resolve(t,n)}).fail(function(){s.loadBlockHandler.reset(o),a.reject(l.Exception("Could not load block handler for "+o+"."))}),a}),getBlockHandler:function(e){return e instanceof l&&(e=s.getBlockType(e)),s.blockHandlers[e]},verifyBlockHandler:function(e,t){for(var o,t=t||["activate","deactivate","construct","reconstruct","deconstruct","refocus","reset","populate","toHTML","toData","toText"],n=[];o=t.shift();)l.isFunction(e[o])||n.push(o);0<n.length&&console.warn("Block handler of type '%s' is missing the following method: %s.",e.options.meta.type,n.join(", "))},activateBlock:function(o){var e;s.workarea().hasClass("is-removing")||(n.manager().hasClass("is-sidebar-open")||window.ezb.mobile||n.document.toolbar.toggleSidebar(),s.deactivateBlock(),s.browser.close(),s.menu().removeClass(b),e=s.getBlockType(o),s.loadBlockHandler(e).done(function(e){var t=[o,e];s.trigger("composerBlockBeforeActivate",t),s.initBlock(o),e.activate&&e.activate(o),e.refocus(o),s.trigger("composerBlockActivate",t)}).fail(function(e){s.trigger("composerBlockActivateError",[e])}))},deactivateBlock:function(e){var t;(e=e||s.getCurrentBlock()).length&&((t=s.getBlockHandler(e))&&t.deactivate&&t.deactivate(e),s.trigger("composerBlockDeactivate",[e,t]))},getBlocksBrowserState:function(){var e=s.blockSection(),n={};return e.each(function(e,t){var o=(t=l(t)).data("id");n[o]=t.hasClass("is-open")?"open":"close"}),n},updateTemplateData:function(e,t){s.updateTemplateId(e,t.id),s.updateBlockTitle(e,t.title)},updateTemplateId:function(e,t){e.attr("data-template-id",t)},getBlockTitle:function(e){return s.isBlockTemplate(e)?e.attr("data-block-title"):s.getBlockMeta(e).title},updateBlockTitle:function(e,t){e.attr("data-block-title",t),s.trigger("composerBlockUpdateTitle",[e,t])},"{blockSectionHeader} click":function(e){e.parent(s.blockSection.selector).toggleClass("is-open");e=s.getBlocksBrowserState();EasyBlog.ajax("site/views/composer/saveUserBlocksParams",{preferences:e})},"{menu} mouseover":function(e){var t,o;e.data("uiDraggable")||((t=e.clone()).find(s.meta.selector).remove(),o=l("html").attr("dir"),e.draggable({helper:function(){return t.css({width:e.outerWidth(),height:e.outerHeight()})},cursorAt:"ltr"==o?{right:165}:{left:165},appendTo:n.document.ghosts(),connectToSortable:EBD.root}))},selectBlock:function(e){s.menu().removeClass(b);var t=n.manager().hasClass(g);n.manager().hasClass(v)?s.addToNextPosition(e):(e.addClass(b),n.manager().addClass(g),s.trigger("composerBlockMenuSelected",[e]),t||n.blocks.droppable.populateDropzones())},addToNextPosition:function(e){var t=s.getCurrentBlock(),e=e;e.is(s.menu)&&(block=s.createBlockFromMenu(e)),t.after(block),s.drop(block),s.release(block),s.out(block),n.manager().removeClass(v),n.blocks.browser.close()},"{menu} touchend":function(e){},"{menu} touchstart":function(e){},"{menu} click":function(e){s.selectBlock(e)},"{menu} dragstart":function(e){s.drag(e),n.manager().addClass(h),s.view().parent().removeClass("open"),n.views.hide("blocks")},"{menu} dragstop":function(e){s.release(e),n.manager().removeClass(h)},"{menu} dblclick":function(e){},drag:function(e){s.workarea().addClass(p),e.is(s.menu)||(e.addClass(m),s.browser.close(),n.editor.selection.remove(),s.trigger("composerBlockDrag",[e]))},drop:function(e){e.is(s.menu)||(s.trigger("composerBlockBeforeDrop",[e]),e.addClass(r),s.trigger("composerBlockDrop",[e]),s.activateBlock(e))},release:function(e){s.workarea().removeClass(p),e.is(s.menu)||(e.removeClass(r).addClass(c).removeClassAfter(c+" "+m),s.trigger("composerBlockBeforeRelease",[e]),setTimeout(function(){s.trigger("composerBlockRelease",[e])},1e3))},over:function(e){e.addClass(o),e.hasClass(f)&&s.nest.of(e).addClass(o),s.block.of(e).addClass(o)},out:function(e){e.removeClass(o),e.hasClass(f)&&s.nest.of(e).removeClass(o),s.block.of(e).removeClass(o)},highlight:function(e){s.root().addClass(y),e.addClass(u)},unhighlight:function(e){s.root().removeClass(y),e.removeClass(u)},dataset:{},"{block} click":function(e,t){t.clickHandled||s.refocusing||s.workarea().hasClass("is-resizing")||(t.clickHandled=!0,e.is(s.menu)||e.hasClass("active")||s.activateBlock(e))},data:function(e,t,o){if(void 0===e)return s.dataset;var n=parseInt(e);isNaN(n)?n=s.getBlockUid(e):e=s.getBlock(n);var a=s.getBlockHandler(s.getBlockType(e)),i=blocks.getBlockMeta(e),r=s.dataset[n];return null==s.getBlockType(e)?s.dataset:(s.dataset[n]=a.normalize?a.normalize(r):l.extend({},i.data,r),0==arguments.length||1==arguments.length||2==arguments.length&&l.isString(t)?s.getData(e,t):s.setData.apply(s,arguments))},getData:function(e,t){var o=s.dataset;if(void 0===e)return o;var n=parseInt(e);isNaN(n)?n=s.getBlockUid(e):e=s.getBlock(e);n=o[n];return void 0===t?n:n[t]},duplicateChildBlocksData:function(n,e){e=s.getChildBlocks(e);e&&l.each(e,function(e,t){var t=l(t),o=s.getBlockUid(t),t=s.data(t),o=n.find("[data-uid="+o+"]");s.updateBlockUid(o);t=l.extend(!0,{},t);s.setBlockData(o,t)})},setBlockData:function(e,t){uid=s.getBlockUid(e),s.dataset[uid]=t},setData:function(e,t,o){if(void 0===e)return s.dataset;var n=parseInt(e);return isNaN(n)?n=s.getBlockUid(e):e=s.getBlock(e),l.isPlainObject(t)&&void 0===o?l.extend(s.dataset[n],t):s.dataset[n][t]=o},getMechanics:function(){return n.settings.get("blocks.mechanics")},setMechanics:function(e){n.settings.set("blocks.mechanics",e),s.trigger("composerBlockMechanicsChange",e)},"{mechswitch} click":function(e){s.mechswitch().removeClass("btn-primary"),e.addClass("btn-primary"),s.setMechanics(e.attr("data-value"))},"{block} mouseover":function(e,t){t.hovered||(t.hovered=!0,s.trigger("composerBlockHoverIn",[e]))},"{block} mouseout":function(e,t){s.trigger("composerBlockHoverOut",[e])},"{self} composerDocumentInit":function(){s.getAllBlocks().each(function(){var e=l(this);s.getBlockType(e);s.initBlock(e)})},"{self} composerDocumentBlur":function(){s.refocusing?s.refocusing=!1:s.deactivateBlock()},"{self} click":function(e,t){s.view().parent().hasClass("open")&&((t=l(t.target)).is("[data-toolbar-blocks]")||0<t.parents("[data-eb-composer-blocks]").length||s.view().parent().removeClass("open"))},"{self} keyup":function(e,t){s.view().parent().hasClass("open")&&27==t.keyCode&&s.view().parent().removeClass("open")},"{self} composerReady":function(){"ebd"===(n=EasyBlog.Composer).getDoctype()&&n.perfectscrollbar.initPs(s.view()[0].querySelector("[data-eb-composer-blocks-group-container]"))},"{self} onPerfectScrollbarAfterInit":function(e,t,o){s.ps||(s.ps=o)},"{self} onBlocksAfterSearch":function(e,t){s.composer.perfectscrollbar.updatePs(s.ps,s.view().find("[data-eb-composer-blocks-group-container]")[0])},"{editableContent} focusin":function(e,t){t.focusHandled||s.refocusing||n.document.isLegacy()||(s.refocusing=!0,t.focusHandled=!0,setTimeout(function(){s.workarea();var e=n.editor.selection.get().focusNode;if(e){e=s.block.of(e);if(e.length){if(!e.hasClass(d)){e.addClass(d);try{e.hasClass("active")?s.getBlockHandler(e).refocus(e):s.activateBlock(e)}catch(e){}e.removeClass(d),setTimeout(function(){s.refocusing=!1},100)}}else s.refocusing=!1}else s.refocusing=!1},1))}}}),e.resolve()})}),EasyBlog.module("composer/blocks/dimensions",function(e){function l(e){return e.toString().match("%")?"%":"px"}var t=this;EasyBlog.require().script("composer/vendors/nouislider").done(function(s){EasyBlog.Controller("Composer.Blocks.Dimensions",{elements:["[data-eb-block-dimensions-{field}]","[data-eb-block-dimensions-field-container] [data-eb-{numslider-toggle|numslider-widget|numslider-value|numslider-input|numslider-units|numslider-unit|numslider-current-unit}]"],defaultOptions:s.extend({},EBD.selectors)},function(r,e,t,o,n,i){return{init:function(){n=r.blocks,o=n.composer,i=s()},"{self} composerBlockActivate":function(e,t,o){i=o,r.populate(o)},isResizableNestedBlock:function(e){return!!n.isNestedBlock(e)&&"content"==n.getBlockNestType(e)},allowDimensionsFieldset:function(e){return r.isResizableNestedBlock(e)&&r.getDimensionsSettings(e).enabled},getDimensionsSettings:function(e){return n.getBlockMeta(e).dimensions},getDimensionsFieldset:function(){return o.panels.fieldset.get("dimensions")},shouldRespectMinContentSize:function(e){return r.isResizableNestedBlock(e)&&r.getDimensionsSettings(e).respectMinContentSize},isInherited:function(e){return!e||/auto|inherit/.test(e)},hasInheritedSize:function(e,t){t=e[0].style[t];return r.isInherited(t)},hasInheritedWidth:function(e){return r.hasInheritedSize(e,"width")},hasInheritedHeight:function(e){return r.hasInheritedSize(e,"height")},getSize:function(e,t){var o=e[0].style[t];return r.isInherited(o)?e.css(t):o},getWidth:function(e){return r.getSize(e,"width")},getHeight:function(e){return r.getSize(e,"height")},getComputedWidth:function(e){return e.width()},getComputedHeight:function(e){return e.height()},setWidth:function(e,t){e.css("width",t)},setHeight:function(e,t){e.css("height",t)},updateWidth:function(e,t){r.setWidth(e,t),r.populateWidth(e)},updateHeight:function(e,t){r.setHeight(e,t),r.populateHeight(e)},getFluidWidth:function(e){var t=s(n.getBlockNest(e)[0]||e.parent()[0]);return Math.round(e.width()/t.width()*100)+"%"},toFluidWidth:function(e){var t;n.isRootBlock(e)||(t=r.getFluidWidth(e),r.updateWidth(e,t))},toFluidHeight:function(e){r.updateHeight(e,"")},toFixedWidth:function(e,t){r.updateWidth(e,e.width())},toFixedHeight:function(e,t){r.updateHeight(e,e.height())},toAutoWidth:function(e){r.updateWidth(e,"auto")},toAutoHeight:function(e){r.updateHeight(e,"")},setUnit:function(e,t,o){"width"===t&&("%"==(t=r.getUnit(e,t))&&"px"==o&&r.toFixedWidth(e),"px"==t&&"%"==o&&r.toFluidWidth(e))},getUnit:function(e,t){return l(r.getSize(e,t))},updateUnit:function(e,t,o){r.setUnit(e,t,o),"width"==t&&r.populateWidth(e),"height"==t&&r.populateHeight(e)},populate:function(e){var t=r.getDimensionsFieldset(),o=r.allowDimensionsFieldset(e);t.toggle(o),o&&(r.populateWidth(e),r.populateHeight(e))},populateWidth:function(e){var t=r.getWidth(e),e=!r.hasInheritedWidth(e);r.populateField("width",t,e)},populateHeight:function(e){var t=r.getHeight(e),e=!r.hasInheritedHeight(e);r.populateField("height",t,e)},populateField:function(e,t,o){var n,a=r.field().where("name",e),i=parseFloat(t),t=l(t);r.numsliderToggle.inside(a).prop("checked",o),r.numsliderInput.inside(a).data("number",i).val(i),r.numsliderCurrentUnit.inside(a).html(t),r.numsliderUnit.inside(a).where("unit",'"'+t+'"').activateClass("active"),a.data("unit",t),r.resizingFromSlider!==e&&("px"==t&&(n={start:i,step:1,range:{min:0,max:800},pips:{mode:"values",density:4,values:[0,200,400,600,800,1e3]}}),"%"==t&&(n={start:i,step:1,range:{min:0,max:100},pips:{mode:"positions",values:[0,20,40,60,80,100],density:5}}),r.numsliderWidget.inside(a).find(".noUi-pips").remove().end().noUiSlider(n,!0).noUiSlider_pips(n.pips))},handleNumsliderWidget:function(e,t){var o=r.workarea(),n=r.field.of(e),e=n.data("name"),n=n.data("unit"),n=Math.round(t)+n;r.resizingFromSlider=e,clearTimeout(r.resizingTimer),o.addClass("is-resizing"),"width"==e&&r.updateWidth(i,n),"height"==e&&r.updateHeight(i,n),r.resizingTimer=setTimeout(function(){o.removeClass("is-resizing")},15),r.resizingFromSlider=null},"{numsliderWidget} nouislide":function(e,t,o){r.handleNumsliderWidget(e,o)},"{numsliderWidget} set":function(e,t,o){r.handleNumsliderWidget(e,o)},"{numsliderInput} input":function(e){e.off("blur.numslider");var t,o=r.field.of(e),n=o.data("name"),a=s.trim(e.val()),o=a+r.numsliderUnit.inside(o).data("unit");if(0==a||!s.isNumeric(a)){a=e.data("number");return t=a,void e.on("blur.numslider",function(){e.val(t)})}"width"==n&&r.updateWidth(i,o),"height"==n&&r.updateHeight(i,o)},"{numsliderUnit} click":function(e){var t=r.field.of(e).data("name"),e=e.data("unit");r.setUnit(i,t,e)},"{numsliderToggle} change":function(e){var t=r.field.of(e).data("name");e.is(":checked")||("width"==t&&r.toAutoWidth(i),"height"==t&&r.toAutoHeight(i))},"{self} composerBlockResize":function(e,t,o){r.populate(o)},"{self} composerBlockNestOut":function(e,t,o){o.css({width:"",height:""})}}}),t.resolve()})}),EasyBlog.module("composer/blocks/droppable",function(e){var t=this,u="is-nested";EasyBlog.require().library("ui/draggable","ui/droppable").done(function(a){EasyBlog.Controller("Composer.Blocks.Droppable",{defaultOptions:a.extend({"{dropzones}":"[data-ebd-dropzone]","{dropzonePlaceholder}":"[data-ebd-dropzone-placeholder]","{mediaFile}":"[data-eb-mm-file]"},EBD.selectors)},function(l,e,t,c,d,n){return{init:function(){d=l.blocks,c=d.composer,n=a(),l.dropzonePlaceholder=l.dropzonePlaceholder().detach().removeClass("hide")[0]},"{self} composerReady":function(){l.isPostTemplateLocked()||(l.draggableOptions={connectWith:EBD.dropzone,helper:"clone",appendTo:c.document.ghosts(),placeholder:"ebd-block is-placeholder",refreshPositions:!0,handle:EBD.immediateBlockSortHandle},l.droppableOptions={accept:[EBD.block,".eb-mm-file"].join(","),tolerance:"pointer"},l.enable())},enable:function(){d.getAllBlocks().draggable(l.draggableOptions)},disable:function(){l.block(".ui-draggable").draggable("destroy")},selectedBlock:null,"{self} composerBlockMove":function(e,t,o){l.selectedBlock=o},"{self} composerBlockMenuSelected":function(e,t,o){l.selectedBlock=o},isPostTemplateLocked:function(){return!!a("[data-eb-composer-views]").data("post-template-is-locked")},"{self} composerBlockInit":function(e,t,o){var n;l.isPostTemplateLocked()?o.find("[data-ebd-block-toolbar]").css("cursor","auto"):"image"!=d.getBlockType(o)?o.draggable(l.draggableOptions):(n=a.extend(!0,{},l.draggableOptions,{cursorAt:{top:0,left:0}}),o.draggable(n))},"{self} onPerfectScrollbarAfterInit":function(e,t,o){l.ps||(l.ps=o)},populateDropzones:function(){var e=c.viewportContent().scrollTop()/c.viewportContent()[0].scrollHeight*100;l.nest().each(function(){var o=a(this),e=o.data("type");"block"==e&&(o.prepend(l.createNestedDropzone()),o.find(EBD.childBlock).each(function(){a(this).after(l.createNestedDropzone())})),"content"==e&&(e=d.nestable.availablePositions(o),a.each(e,function(e,t){o.prepend(l.createNestedDropzone(t))}))});var t=d.getRootBlocks();t.each(function(e){var t=a(this);0==e&&t.before(l.createDropzone()),t.hasClass("is-sort-item")||t.after(l.createDropzone())}),t.length<1&&l.root().append(l.createDropzone()),l.dropzone().droppable(l.droppableOptions),c.perfectscrollbar.updatePs(l.ps,c.viewportContent);t=c.viewportContent()[0].scrollHeight;newPos=t*e/100,c.viewportContent().scrollTop(newPos)},createDropzone:function(){return a(l.dropzonePlaceholder).clone()},createNestedDropzone:function(e){var t=l.createDropzone().addClass("is-nested");return e&&t.addClass("nest-"+e).data("position",e),t},destroyDropzones:function(){var e=c.viewportContent().scrollTop()/c.viewportContent()[0].scrollHeight*100;l.dropzone().remove(),c.perfectscrollbar.updatePs(l.ps,c.viewportContent);var t=c.viewportContent()[0].scrollHeight;newPos=t*e/100,c.viewportContent().scrollTop(newPos)},"{block} dragstart":function(e,t,o){t.stopPropagation(),o.helper.addClass("is-helper").css({width:e.width(),height:e.height()}),d.drag(e),n=e,l.populateDropzones(),c.manager().addClass("is-resizing")},"{blocks.menu} dragstart":function(e,t,o){c.manager().hasClass("is-dropping-block")||l.populateDropzones(),n=e,c.manager().addClass("is-resizing")},"{mediaFile} dragstart":function(e,t,o){l.populateDropzones(),n=a(),c.manager().addClass("is-resizing")},"{dropzone} click":function(e,t){var o;c.manager().hasClass("is-dragging-block")||(l.isDropping=!0,(o=l.selectedBlock).removeClass("hide").removeClass("is-sort-item"),l.dropBlock(e,o),setTimeout(function(){l.isDropping=!1,l.dropStop(),l.selectedMenu=null,l.selectedBlock=null,c.manager().removeClass("is-dropping-block"),c.manager().removeClass("is-moving-block")},0))},"{dropzone} mouseenter":function(e,t){e.addClass("is-receiving")},"{dropzone} mouseleave":function(e,t){e.removeClass("is-receiving")},"{dropzone} dropover":function(e,t,o){d.over(e);var n=(l.lastDropzone=e).data("position");o.helper.addClass("is-sending"),n&&l.nest.of(e).data("snappedPosition",n)},"{dropzone} dropout":function(e,t,o){l.lastDropzone=null,d.out(e),o.helper.removeClass("is-sending")},isDropping:!1,lastDropzone:null,dropBlock:function(e,t){var o=t,n=t.is(d.menu);n&&(o=d.createBlockFromMenu(t));var a=t.is(l.mediaFile);a&&(o=d.createBlockFromMediaFile(t));var i=c.manager().hasClass("is-moving-block"),r=c.manager().hasClass("is-dropping-block");(i||r)&&(t=d.getBlockNest(e),s=e.data("position"),t.data("snappedPosition",s));var s=e.hasClass(u);return e.replaceWith(o),(n||a||i||r)&&(d.drop(o),d.release(o),d.out(o),s&&o.addClass(u)),c.manager().removeClass("is-dropping-block"),o},dropStop:function(){setTimeout(function(){c.manager().hasClass("is-dropping-block")||l.destroyDropzones()},1),c.manager().removeClass("is-resizing")},"{dropzone} drop":function(e,t,o){var n;l.isDropping||(l.isDropping=!0,o=o.draggable,n=e.hasClass(u),block=l.dropBlock(e,o),setTimeout(function(){l.isDropping=!1,n&&block.addClass(u)},0))},"{block} dragstop":function(e,t,o){e.removeClass("hide"),d.drop(e),d.release(e),d.out(e),l.dropStop()},"{blocks.menu} dragstop":function(e,t,o){if(l.isDropping||!l.lastDropzone)return d.deactivateBlock(),void l.dropStop();o=o.helper;l.dropBlock(l.lastDropzone,o),l.dropStop()},"{mediaFile} dragstop":function(e,t,o){!l.isDropping&&l.lastDropzone&&(o=o.helper,l.dropBlock(l.lastDropzone,o)),l.dropStop()},"{self} composerDocumentScroll":function(e,t){var o=n.data("ui-draggable");a.ui.ddmanager.prepareOffsets(o,t)},"{dropzone} dropdeactivate":function(e,t,o){d.out(e)}}}),t.resolve()})}),EasyBlog.module("composer/blocks/font",function(l){var e=this;EasyBlog.require().script("composer/vendors/colorpicker","composer/vendors/nouislider").done(function(){EasyBlog.Controller("Composer.Blocks.Font",{elements:[".eb-composer-fieldset[data-name=font] [data-eb-{font-color-menu|font-family-menu|font-size-menu|font-color-content|font-color-picker|font-family-content|font-size-content|font-color-caption|font-family-caption|font-size-caption|font-family-option|font-format-option}]",".eb-composer-fieldset[data-name=font] [data-eb-{numslider-toggle|numslider-widget|numslider-value|numslider-input|numslider-units|numslider-unit|numslider-current-unit}]",".eb-composer-fieldset[data-name=font] [data-eb-{colorpicker|colorpicker-toggle}]"],defaultOptions:l.extend({fontSizeUnits:{px:{start:12,step:2,range:{min:8,max:72},pips:{mode:"values",density:4,values:[8,12,18,24,48,72]}},"%":{start:100,step:10,range:{min:0,max:200},pips:{mode:"positions",values:[0,50,100],density:10}}}},EBD.selectors)},function(r,t,a,s,o,i){return{init:function(){o=r.blocks,s=o.composer,i=l(),r.initFontFormatting(),r.initFontColor()},"{self} composerBlockActivate":function(e,t,o){i=o,r.populate(o)},populate:function(e){var t=o.getBlockMeta(e).properties.fonts;if(s.panels.fieldset.get("font").toggle(t),"buttons"==e.data("type"))return s.panels.fieldset.get("font","alignment").toggle(!0),void r.populateFontFormatting(e);t&&(r.populateFontColor(e),r.populateFontFamily(e),r.populateFontSize(e),r.populateFontFormatting(e))},hideFontFieldset:function(){s.panels.fieldset.get("font").hide()},initFontColor:function(){r.fontColorPicker().colorpicker()},populateFontColor:function(e){e=e.css("color");r.updateFontColorUI(e,!0)},setFontColor:function(e,t){e.css("color",t),r.updateFontColorUI(t)},updateFontColorUI:function(e,t){r.updatingFontColorUI=!0,e=e||(i.css("color")||"#000"),r.fontColorCaption().css("backgroundColor",e),!0===t&&r.fontColorPicker().colorpicker("setColor",e),r.updatingFontColorUI=!1},removeFontColor:function(e){r.setFontColor(e,"")},populateFontFamily:function(e){e=e[0].style.fontFamily;r.updateFontFamilyUI(e)},setFontFamily:function(e,t){r.unpreviewFontFamily(e);var o=l.Event("composerBlockFontFamilyChange");o.fontFamily=t,a.trigger(o,[t,e]),r.updateFontFamilyUI(o.fontFamily),o.isDefaultPrevented()||e.css("fontFamily",o.fontFamily)},updateFontFamilyUI:function(e){e=e.replace(/"/g,"'");var t=r.fontFamilyOption().removeClass("active").where("value",'"'+e+'"').addClass("active"),e=0<t.length?t.html():e.split(",")[0];r.fontFamilyCaption().html(e)},previewFontFamily:function(e,t){var o=e.data("originalFontFamily")||i[0].style.fontFamily,n=l.Event("composerBlockFontFamilyPreview");n.originalFontFamily=o,n.fontFamily=t,a.trigger(n,[t,o,e]),e.data("originalFontFamily",n.originalFontFamily),n.isDefaultPrevented()||e.css("fontFamily",n.fontFamily)},unpreviewFontFamily:function(e){var t=e.data("originalFontFamily"),o=l.Event("composerBlockFontFamilyUnpreview");o.originalFontFamily=t,a.trigger(o,[t,e]),e.removeData("originalFontFamily"),o.isDefaultPrevented()||e.css("fontFamily",o.originalFontFamily)},populateFontSize:function(e){e=e.css("fontSize");r.updateFontSizeUI(e)},setFontSize:function(e,t){l.isNumeric(t)&&(t+=r.getFontSizeUnit()),e.css("fontSize",t),r.updateFontSizeUI(t||e.css("fontSize")),t?r.setLineHeight(e,"120%"):r.removeLineHeight(e)},updateFontSizeUI:function(e){r.updatingFontSizeUI=!0;var t=Math.abs(e.replace(/\%|px/gi,""));unit=e.match("%")?"%":"px",r.getFontSizeUnit()!==unit&&r.setFontSizeUnit(unit),r.fontSizeCaption().html(e),r.numsliderCurrentUnit().html(unit),r.numsliderUnit().removeClass("active").where("unit",'"'+unit+'"').addClass("active"),r.numsliderWidget().val(t),r.numsliderInput().val(t),r.updatingFontSizeUI=!1},removeFontSize:function(e){r.setFontSize(e,"")},getFontSizeUnit:function(){return r.fontSizeContent().data("unit")||"%"},setFontSizeUnit:function(e){r.fontSizeContent().data("unit",e);e=t.fontSizeUnits[e];r.numsliderWidget().find(".noUi-pips").remove().end().noUiSlider(e,!0)},setLineHeight:function(e,t){e.css("lineHeight",t)},removeLineHeight:function(e){r.setLineHeight(e,"")},fontFormatting:{bold:{key:"fontWeight",val:"bold"},italic:{key:"fontStyle",val:"italic"},underline:{key:"textDecoration",val:"underline"},strikethrough:{key:"textDecoration",val:"line-through"},alignleft:{key:"textAlign",val:"left"},alignright:{key:"textAlign",val:"right"},aligncenter:{key:"textAlign",val:"center"},justify:{key:"textAlign",val:"justify"}},initFontFormatting:function(){r.fontFormatOption().on("touchstart click mousedown mouseup",function(e){e.preventDefault()}).on("touchstart click",function(e){var t=l(this),o=t.data("format");r.setFontFormatting(i,o,t.hasClass("active"))})},populateFontFormatting:function(e){var o,n,t,a,i=e[0];i&&(o=i.style,n=r.fontFormatOption().each(function(){var e=l(this),t=e.data("format");/orderedlist|unorderedlist|indent|outdent/.test(t)?e.removeClass("active"):(t=r.fontFormatting[t],t=o[t.key]==t.val,e.toggleClass("active",t))}),(t="text"==e.data("type"))&&(i=s.editor.selection.getCurrent(),a=l(i).parentsUntil(e).filter("ul, ol").eq(0),l.each({orderedlist:"ol",unorderedlist:"ul"},function(e,t){t=a.is(t);n.where("format",e).toggleClass("active",t)})),s.panels.fieldset.get("font").find(".eb-font-formatting.section-list").toggle(t))},setFontFormatting:function(e,t,o){var n=s.editor;switch(t){case"orderedlist":case"unorderedlist":n.list.toggle(t);break;case"indent":n.indent.increase();break;case"outdent":n.indent.decrease();break;default:var a=r.fontFormatting[t];e.css(a.key,o?"":a.val)}r.populateFontFormatting(e)},removeFontFormatting:function(e,t){r.setFontFormatting(e,t,!0)},"{colorpicker} colorpickerChange":function(e,t,o){r.updatingFontColorUI||(r.colorpickerToggle().prop("checked",!0),r.setFontColor(i,o))},"{colorpickerToggle} change":function(e){e.checked()||r.removeFontColor(i)},"{fontFamilyOption} mouseover":function(e){e=e.data("value");r.previewFontFamily(i,e)},"{fontFamilyOption} mouseout":function(){r.unpreviewFontFamily(i)},"{fontFamilyOption} click":function(e){e=e.data("value");r.setFontFamily(i,e)},"{numsliderWidget} nouislide":function(e,t,o){r.numsliderInput().val(Math.abs(o))},"{numsliderWidget} set":function(e,t,o){r.updatingFontSizeUI||r.setFontSize(i,Math.abs(o))},"{numsliderInput} input":function(e){r.updatingFontSizeUI||(e=Math.abs(l.trim(e.val())),r.setFontSize(i,e))},"{numsliderUnit} click":function(e){e=e.data("unit");r.setFontSizeUnit(e)},"{numsliderToggle} click":function(e){r.removeFontSize(i)},"{self} composerBlockRemove":function(e,t,o,n){n.skipFontTrigger||r.hideFontFieldset()},"{self} composerBlockDeactivate":function(e,t,o){r.hideFontFieldset()}}}),e.resolve()})}),EasyBlog.module("composer/blocks/guide",function(e){EasyBlog.Controller("Composer.Blocks.Guide",{defaultOptions:e.extend({},EBD.selectors)},function(i,e,t,o,r,n){return{init:function(){r=i.blocks,i.blocks.composer},"{self} composerBlockHoverIn":function(e,t,o){o.addClass("hover")},"{self} composerBlockHoverOut":function(e,t,o){o.removeClass("hover")},"{self} composerBlockDrop":function(e,t,o){},"{self} composerBlockActivate":function(e,t,o,n){o.addClass("active");var a=o.is(EBD.nestedBlock);a&&(i.nest.of(o).addClass("active"),r.getAllParentBlocks(o).addClass("has-active-child")),i.workarea().toggleClass("has-active-nest",a),o.addClass("is-glowing"),setTimeout(function(){o.removeTransitionClass("is-glowing",2e3)},10)},"{self} composerBlockDeactivate":function(e,t,o){i.block().removeClass("active has-active-child"),i.nest().removeClass("active")}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/accordion",function(l){var e=this;EasyBlog.require().library("accordion").done(function(){EasyBlog.Controller("Composer.Blocks.Handlers.Accordion",{defaultOptions:{"{accordionWrapper}":".eb-accordion","{tabHeader}":".nav-tabs","{tabHeaderListItem}":".nav-tabs > li","{tabHeaderListItemContent}":".nav-tabs > li a","{sectionContent}":".section-content","{sectionAns}":"> .section-content > .section-ans","{sectionHeader}":"[data-section-title]","{titleItem}":"[data-tab-header-item]","{control}":"[data-accordion-control]","{controlItemContent}":"[data-accordion-control] [data-listbox-item-content]"}},function(i,t,e,o,r,n,s){return{accordions:[],init:function(){r=i.blocks,r.composer,t.meta,s=l()},activate:function(e){s=e,i.populate(e)},deactivate:function(e){},construct:function(e){e=l.extend({},t.data,e);return content},reconstruct:function(e){var t;r.data(e);e.hasClass("is-new")&&(t=l.uid("acc-"),r.data(e).id=t,r.getBlockContent(e).find("[data-eb-accordion]").addClass(t)),l.each(e.find("[data-accordion-wrapper]"),function(e,t){(t=l(t)).parent().removeAttr("style")}),setTimeout(function(){i.accordions[r.data(e).id]=new Collapsible({node:document.querySelectorAll("."+r.data(e).id+" .block"),eventNode:".ac-q"})},100)},"{self} composerBlockDuplicate":function(e,t,o,n){var a,i;"accordion"==r.getBlockType(o)&&(r.updateBlockUid(o),a=r.data(n),data=r.data(o),l.extend(data,a),i=l.uid("acc-"),data.id=i,r.duplicateChildBlocksData(o,n),clonedContent=r.getBlockContent(o),(o=clonedContent.find("[data-eb-accordion]")).removeClass(a.id),o.addClass(i))},deconstruct:function(n){return l.each(n.find("[data-accordion-wrapper]"),function(e,t){var o=(t=l(t)).parent();o.removeAttr("contenteditable"),o.removeAttr("style"),t.children().appendTo(o),t.remove(),i.sectionContent.inside(n).eq(e).removeClass("is-active"),i.sectionHeader.inside(n).eq(e).removeAttr("contenteditable")}),n},refocus:function(e){i.sectionAns.inside(e).filter(".active").focus()},reset:function(e){},recover:function(e){},populate:function(e){e=r.data(e);i.control().listbox().listbox("populate",e.tabs,function(e,t){e.listboxitem("content",t)})},revert:function(e){},toHTML:function(e){e=e.clone(),e=i.deconstruct(e);return r.getBlockContent(e).html()},toData:function(e){return r.data(e)},toText:function(e){e=e.clone();return i.deconstruct(e).text()},section:{create:function(e){l.uid("ac-");var t=l('<div class="block ac section-content is-active" data-tabs-content></div>',{class:"ac section-content"}),o=l("<div></div>",{class:"ac-a section-ans"}),n=l("<div></div>",{class:"ebd-nest","data-type":"block","data-accordion-wrapper":""}),a=r.constructNestedBlock("text");r.initBlock(a),n.wrapInner(a),o.wrapInner(n),t.html('<h2 class="block__title ac-q" tabindex="0" contenteditable="true" data-section-title></h2>'),t.append(o),i.accordionWrapper.inside(s).append(t)},remove:function(e){e=i.accordionWrapper.inside(s).filter(":first").children(".section-content").eq(e);e.find(".section-ans").find(EBD.nestedBlock).each(function(){var e=l(this);r.removeBlock(e,{skipPanelTrigger:!0,skipFontTrigger:!0})}),e.remove()},focus:function(e){}},"{control} listboxBeforeAddItem":function(e,t,o){i.section.create();o=o.listboxitem("toData");i.sectionContent.inside(s).filter(":last").find("h2").html(o.content)},"{control} listboxAfterAddItem":function(e,t,o){r.data(s).tabs=i.control().listbox("toData");var n=i.accordionWrapper.inside(s),a=n.html();n.html(a),i.accordions[r.data(s).id]=new Collapsible({node:document.querySelectorAll("."+r.data(s).id+" .block"),eventNode:".ac-q"})},"{control} listboxBeforeRemoveItem":function(e,t,o){o=o.index();i.section.remove(o)},"{control} listboxAfterRemoveItem":function(e,t,o){r.data(s).tabs=i.control().listbox("toData")},"{control} listboxAfterToggleDefault":function(e,t,o){r.data(s).tabs=i.control().listbox("toData")},"{controlItemContent} keypress":function(e,t){"13"==(t.keyCode||t.which)&&t.preventDefault()}}}),e.resolve()})}),EasyBlog.module("composer/blocks/handlers/alerts",function(s){var e=this;EasyBlog.require().done(function(){EasyBlog.Controller("Composer.Blocks.Handlers.Alerts",{defaultOptions:{data:{type:"warning",content:"Enter an important note here"},"{note}":".o-alert","{oldNote}":".alert","{fontStyle}":"[data-eb-composer-block-section][data-name=font]","{alertSelection}":"[data-eb-composer-block-alert-type] [data-type]"}},function(n,t,e,o,a,i,r){return{init:function(){a=n.blocks,o=a.composer,i=t.meta,r=s(),t.data.content=s(i.content).html()},activate:function(e){r=e,n.fontStyle().addClass("t-hidden"),n.populate(e)},deactivate:function(e){n.fontStyle().removeClass("t-hidden")},construct:function(e){e=s.extend({},t.data,e),s(i.content).switchClass("o-alert--"+e.type).html(e.content)},reconstruct:function(e){},deconstruct:function(e){var t=a.getBlockContent(e);return n.note.inside(t).editable(!1),e},refocus:function(e){var t=a.getBlockContent(e),t=n.note.inside(t);t.focus(),e.hasClass("is-new")&&o.editor.caret.setEnd(t[0])},toText:function(e){e=a.getBlockContent(e);return n.note.inside(e).text()},toData:function(e){return a.data(e)},toHTML:function(e){e=e.clone(),e=n.deconstruct(e);return a.getBlockContent(e).html()},reset:function(e){a.getBlockContent(e).html(n.construct())},populate:function(e){e=a.data(e);n.alertSelection().where("type",e.type).activateClass("selected")},setAlertType:function(e){var t=a.getBlockContent(r),o=t.find(n.note);(o=o.length<1?t.find(n.oldNote):o).switchClass("o-alert o-alert--"+e)},previewType:function(e){var t=a.getBlockContent(r),o=n.note.inside(t),t=o.attr("class");a.getData(r);r.hasClass("is-preview")||(r.data("originalClass",t),r.addClass("is-preview")),n.setAlertType(e);o=[r,n,o];n.trigger("composerBlockNotePreviewType",o),n.trigger("composerBlockChange",o)},previewTimer:null,"{alertSelection} mouseover":function(e){},"{alertSelection} mouseout":function(e){},"{alertSelection} click":function(e){var t=e.data("type"),o=a.data(r);n.alertSelection().removeClass("selected"),s(e).addClass("selected"),r.removeClass("is-preview"),r.removeData("originalClass"),n.setAlertType(t),o.type=t,n.populate(r)}}}),e.resolve()})}),EasyBlog.module("composer/blocks/handlers/apple",function(c){EasyBlog.Controller("Composer.Blocks.Handlers.Apple",{defaultOptions:{"{wrapper}":"[data-apple-wrapper]","{embedButton}":"[data-apple-embed]","{errorMessage}":"[data-apple-error]","{input}":"[data-apple-input]","{fieldInput}":"[data-apple-field-input]","{update}":"[data-apple-update]"}},function(i,e,t,r,s,a,l){return{init:function(){s=i.blocks,r=s.composer,a=e.meta,l=c()},toData:function(e){return s.data(e)},toText:function(e){},toEditableHTML:function(e){return""},toHTML:function(e){},activate:function(e){var t=s.data(e);l=e,i.populate(t)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){var t=s.data(e),o=e.data("overlay"),n=s.getBlockContent(e);t.src&&!o?(n.empty(),i.createIframe(e,t.src,t.type)):n.html(a.html)},deconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){i.fieldInput().val(""),e.url&&i.fieldInput().val(e.url)},type:null,isValidUrl:function(e){if(!e)return!1;var t=/^https:\/\/music\.apple\.com\/(.*)\/playlist\/(.*)$/;return t.test(e)?(i.type="playlist",!0):(t=/^https:\/\/music\.apple\.com\/(.*)\/album\/(.*)\/(.*)\?i\=(.*)$/).test(e)?(i.type="song",!0):(t=/^https:\/\/music\.apple\.com\/(.*)\/album\/(.*)\/(.*)$/).test(e)?(i.type="album",!0):(t=/^https:\/\/podcasts\.apple\.com\/(.*)\/podcast\/(.*)\/(.*)\?i\=(.*)$/).test(e)?(i.type="podcast",!0):!!(t=/^https:\/\/podcasts\.apple\.com\/(.*)\/podcast\/(.*)\/(.*)$/).test(e)&&(i.type="podcastList",!0)},getHeight:function(e){return"song"==e?"150":"podcast"==e?"175":"450"},embed:function(e){var t,o,n,a;i.errorMessage().addClass("t-hidden"),i.isValidUrl(e)?(t=s.data(l),a=s.getBlockContent(l),o=i.wrapper.inside(a),i.fieldInput().val(e),t.url=e,n=i.type,t.type=n,a=i.getHeight(t.type),t.height=a,e=i.formatSrc(e),t.src=e,i.createIframe(l,e,n),o.addClass("t-hidden")):i.errorMessage().removeClass("t-hidden")},createIframe:function(e,t,o){var n=c.create("iframe");n.attr("src",t),n.attr("frameborder","0"),n.attr("height",i.getHeight(o)),n.attr("allow","autoplay *; encrypted-media *; fullscreen *"),n.attr("sandbox","allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation"),n.css({width:"100%","max-width":"660px",overflow:"hidden",background:"transparent"}),i.setOverlay(e,n,o)},formatSrc:function(e){return e="https://embed."+(e=e.replace("https://",""))},setOverlay:function(e,t,o){var n,a=e.data("overlay");a?(a.element().empty(),a.element().append(t)):(a=r.document.overlay.create(e),n=s.getBlockContent(e),a.placeholder().css("height",i.getHeight(o)+"px").appendTo(n),a.element().append(t),a.attach()),e.data("overlay",a)},"{embedButton} click":function(e,t){e=e.closest("[data-apple-form]").find("[data-apple-input]").val();i.embed(e)},"{update} click":function(e,t){var o=i.fieldInput().val();i.embed(o)}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/audio",function(e){var t=this;EasyBlog.require().library("audiojs").done(function(u){EasyBlog.Controller("Composer.Blocks.Handlers.Audio",{elements:["[data-eb-{file-error}]"],defaultOptions:{"{browseButton}":".eb-composer-placeholder-audio [data-eb-mm-browse-button]","{audio}":"audio","{placeholder}":"[data-eb-composer-audio-placeholder]","{infoBox}":"[data-audio-infobox]","{artist}":"[data-audio-artist]","{track}":"[data-audio-track]","{trackSeparator}":"[data-audio-track-separator]","{download}":"[data-audio-download]","{displayArtist}":"[data-audio-fieldset-artist]","{displayTrack}":"[data-audio-fieldset-track]","{displayDownload}":"[data-audio-fieldset-download]","{autoplay}":"[data-audio-fieldset-autoplay]","{loop}":"[data-audio-fieldset-loop]"}},function(l,e,t,c,d,o,a,n){return{init:function(){d=l.blocks,c=d.composer,o=e.meta,a=u(),n=EasyBlog.MediaManager},toText:function(e){},toData:function(e){var t=d.data(e),e=d.getBlockContent(e);return t.download=l.download.inside(e).attr("href"),t.artist=l.artist.inside(e).text(),t.track=l.track.inside(e).text(),t},toHTML:function(e){e.clone()},toLegacyShortcode:function(e,t){e={uri:e.uri};return"[embed=audio]"+JSON.stringify(e)+"[/embed]"},activate:function(e){a=e,l.populate(e)},deactivate:function(e){},construct:function(e){var t=d.createBlockContainer("audio"),o=d.data(t);u.extend(o,e);return t},constructFromMediaFile:function(e){var e=e.data("key"),e=n.getUri(e),t=d.createBlockContainer("audio");d.getBlockContent(t),d.data(t);return t.addClass("is-loading"),n.getMedia(e).done(function(e){e=e.meta;l.createPlayer(t,e.url,e.title)}).fail(function(){}).always(function(){t.removeClass("is-loading")}),t},reconstruct:function(e){var t=l.placeholder.inside(e),o=d.data(e);o.url&&l.createPlayer(e,o.url,o.track),0<t.length&&EasyBlog.MediaManager.uploader.register(t)},deconstruct:function(e){},refocus:function(e){},reset:function(e){d.getBlockContent(e)},populate:function(e){d.data(e);l.updateFieldset(e)},updateFieldset:function(e){e=d.data(e);l.autoplay().val(e.autoplay?"1":"0").trigger("change"),l.loop().val(e.loop?"1":"0").trigger("change"),l.displayArtist().val(e.showArtist?"1":"0").trigger("change"),l.displayDownload().val(e.showDownload?"1":"0").trigger("change"),l.displayTrack().val(e.showTrack?"1":"0").trigger("change")},getPlayerTemplate:function(){return u(o.player)},createPlayer:function(e,t,o){var n=d.data(e),a=d.getBlockContent(e),i=l.getPlayerTemplate(),r=n.uid||(n.uid=u.uid("audio-")),t=n.url||t,s=o||"",o=n.artist;n.url=t,n.track=s,n.artist=o,n.uid=r,l.audio.inside(i).attr("id",r).attr("src",t),l.artist.inside(i).html(n.artist).editable(!0),l.track.inside(i).html(n.track).editable(!0),l.download.inside(i).attr("href",t).attr("target","blank").on("click",function(e){e.preventDefault()}),a.html(i),u.audiojs.events.ready(function(){u.audiojs.create(a.find("audio"))}),n.showDownload||l.download.inside(a).addClass("hide"),n.showArtist||l.artist.inside(a).addClass("hide"),n.showTrack||l.track.inside(a).addClass("hide"),l.updateInfoBox(e)},updateInfoBox:function(e){var t=d.data(e),e=d.getBlockContent(e),e=l.infoBox.inside(e);t.showDownload||t.showTrack||t.showArtist?e.removeClass("disabled"):e.addClass("disabled")},"{displayDownload} change":function(e,t){d.getBlockContent(a);e=1==e.val();d.data(a).showDownload=e,l.updateInfoBox(a),e?l.download.inside(a).removeClass("hide"):l.download.inside(a).addClass("hide")},"{displayArtist} change":function(e,t){var o=d.getBlockContent(a),e=1==e.val(),o=l.artist.inside(o);d.data(a).showArtist=e,l.updateInfoBox(a),e?o.removeClass("hide"):o.addClass("hide")},"{displayTrack} change":function(e,t){var o=d.getBlockContent(a),n=1==e.val(),e=l.track.inside(o),o=l.trackSeparator.inside(o);if(d.data(a).showTrack=n,l.updateInfoBox(a),!n)return o.addClass("hide"),void e.addClass("hide");o.removeClass("hide"),e.removeClass("hide")},"{autoplay} change":function(e,t){var o=d.data(a),e=1==e.val();o.autoplay=e},"{loop} change":function(e,t){var o=d.data(a),e=1==e.val();o.loop=e},"{placeholder} mediaUploaderFilesAdded":function(e,t,o,n){EasyBlog.MediaManager.uploader.addItem(n[0],e)},"{placeholder} mediaUploaderFileUploaded":function(e,t,o,n,a){var i=a.response.media.meta,r=d.block.of(e);setTimeout(function(){l.createPlayer(r,i.url,n.name),r.hasClass("active")&&l.populate(r)},600)},"{browseButton} mediaSelect":function(e,t,o){var n,a=d.block.of(e);"audio"==o.meta.type&&(n=o.meta,(e=c.document).isLegacy()?(content=l.toLegacyShortcode(o,a),e.insertContent(content)):l.createPlayer(a,n.url,n.title))},"{placeholder} mediaUploaderFileError":function(e,t,o,n){n.code==u.plupload2.FILE_EXTENSION_ERROR&&l.fileError.inside(a).removeClass("hide")},"{self} mediaInsert":function(e,t,o,n,a,i){var r,s;"audio"==o.meta.type&&(s=(r=c.document).isLegacy(),a=u.extend(a,{url:o.meta.url,track:a.title,autoplay:a.autoplay,loop:a.loop,showDownload:a.showDownload,showArtist:a.showArtist,showTrack:a.showTrack}),s?(content=l.toLegacyShortcode(o,n),r.insertContent(content)):(n=d.constructBlock("audio",a),d.addBlock(n),i||d.activateBlock(n)))}}}),t.resolve()})}),EasyBlog.module("composer/blocks/handlers/behance",function(l){EasyBlog.Controller("Composer.Blocks.Handlers.Behance",{defaultOptions:l.extend({"{form}":"> [data-behance-form]","{insert}":"[data-behance-insert]","{source}":"[data-behance-source]","{loader}":"> [data-behance-loader]","{preview}":"> [data-behance-preview]","{errorMessage}":"[data-behance-error]","{fsSource}":"[data-fs-behance-source]","{fsUpdate}":"[data-fs-behance-update]"},EBD.selectors)},function(r,e,t,a,s,i,o){return{init:function(){s=r.blocks,a=s.composer,i=e.meta,o=l()},toData:function(e){return s.data(e)},toText:function(e){return s.data(e).url},toEditableHTML:function(e){return""},toHTML:function(e){return s.data(e).embed},activate:function(e){o=e,r.populate(e)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){var t=s.data(e),o=e.data("overlay"),n=s.getBlockContent(e);t.embed&&!o&&(n.empty(),r.setOverlay(e,t.embed)),t.embed||n.html(l(i.html)),e.find(r.source.selector).off("paste").on("paste",function(e){e.stopPropagation()})},deconstruct:function(e){var t=s.getBlockContent(e);return r.form.inside(t).remove(),r.loader.inside(t).remove(),e},refocus:function(e){},reset:function(e){},populate:function(e){e=s.data(e);e.url&&r.fsSource().val(e.url)},loading:function(){var e=s.getBlockContent(o);if(!r.isLoading)return r.loader.inside(e).removeClass("hidden"),r.form.inside(e).addClass("hidden"),void(r.isLoading=!0);r.loader.inside(e).addClass("hidden"),r.form.inside(e).removeClass("hidden"),r.isLoading=!1},setOverlay:function(e,t){var o=s.getBlockContent(e),n=e.data("overlay");n?(n.element().empty(),n.element().append(t)):((n=a.document.overlay.create(e)).placeholder().css("height","450px").appendTo(o),n.element().append(t),n.attach()),e.data("overlay",n)},isUrlValid:function(e){if(""==e)return!1;return/^https:\/\/www\.behance\.net\/gallery\/(.*)\/(.*)$/.test(e)},getOembedUrl:function(e){return"http://www.behance.net/services/oembed?url="+e},crawl:function(t,o){var n=s.getBlockContent(t),a=s.data(t),i=r.getOembedUrl(o);if(!r.isUrlValid(o))return r.errorMessage().removeClass("hide"),!1;var e=t.data("overlay");e&&e.element().empty(),r.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:i}).done(function(e){r.loading();e=e[i];a.url=o,a.embed=e.oembed.html,r.setOverlay(t,a.embed),r.form.inside(n).addClass("hidden")}).fail(function(e){r.loading(),r.errorMessage().removeClass("hide").html(e)})},"{insert} click":function(e){o.length<1&&(t=r.block.of(e),s.activateBlock(t));var t=s.getBlockContent(o),t=r.source.inside(t).val();r.fsSource().val(t),r.crawl(o,t)},"{fsUpdate} click":function(){s.getBlockContent(o);var e=r.fsSource().val();r.crawl(o,e)}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/buttons",function(s){EasyBlog.Controller("Composer.Blocks.Handlers.Buttons",{defaultOptions:{buttonClasses:"btn-default btn-info btn-primary btn-success btn-warning btn-danger","{button}":"> a.btn","{textWrapper}":"> span","{buttonSize}":"[data-eb-composer-block-button-size]","{buttonHyperlink}":"[data-button-link]","{buttonNofollow}":"[data-button-nofollow]","{buttonTarget}":"[data-button-target]","{buttonSwatchItem}":"[data-eb-composer-button-swatch-item]"}},function(n,o,e,t,a,i,r){return{init:function(){a=n.blocks,a.composer,o.meta,r=s()},selectionState:{},toData:function(e){return a.data(e)},toText:function(e){var t=a.getBlockContent(e);n.button.inside(t);return text=a.data(e).link,text},toHTML:function(e){e=e.clone(),e=n.deconstruct(e);return a.getBlockContent(e).html()},activate:function(e){r=e,n.toggleFontSettings(!1),n.populate(e)},deactivate:function(e){n.toggleFontSettings(!0)},construct:function(e){},reconstruct:function(e){e=a.getBlockContent(e);n.button.inside(e).on("click",function(e){e.stopPropagation(),e.preventDefault()})},deconstruct:function(e){var t=a.getBlockContent(e),t=n.button.inside(t);return n.textWrapper.inside(t).removeAttr("contenteditable").editable(!1),e},refocus:function(e){},reset:function(e){},populate:function(e){e=a.data(e);n.buttonSwatchItem().removeClass("active").where("style",e.style).addClass("active"),n.buttonSize().val(e.size),n.buttonHyperlink().val(e.link),n.buttonNofollow().val(e.nofollow).trigger("change"),n.buttonTarget().val(e.target)},toggleFontSettings:function(t){["[data-eb-font]","[data-font-format-group-basic]"].forEach(function(e){!0===t?s(e).show():s(e).hide()})},updateButtonSize:function(e){var t=a.getBlockContent(r);n.button.inside(t).removeClass("btn-sm btn-xs btn-lg btn-xlg").addClass(e),a.data(r).size=e},"{buttonSwatchItem} click":function(e){var t=e.data("style"),e=a.getBlockContent(r);n.buttonSwatchItem().removeClass("active").where("style",t).addClass("active"),n.button.inside(e).removeClass(o.buttonClasses).addClass(t),a.data(r).style=t},"{buttonSize} change":function(e){e=e.val();n.updateButtonSize(e)},"{buttonHyperlink} keyup":s.debounce(function(e){var t=a.getBlockContent(r);a.data(r).link=e.val(),n.button.inside(t).attr("href",e.val())},250),"{buttonNofollow} change":function(e){var t=e.is(":checked"),o=a.getBlockContent(r),e=n.button.inside(o),o=a.data(r);o.nofollow=t?1:0,o.nofollow?e.attr("rel",o.nofollow?"nofollow":""):e.removeAttr("rel")},"{buttonTarget} change":function(e){var t=a.getBlockContent(r);a.data(r).target=e.val(),n.button.inside(t).attr("target",e.val())}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/code",function(p){var e="ace.min.js";"development"===window.ezb.environment&&(e="ace.js");var m=p.rootPath+"/media/com_easyblog/scripts/vendors/"+e;window.FD50_PSEUDO={module:function(e,t){t.call(p.Deferred(),p)}},EasyBlog.Controller("Composer.Blocks.Handlers.Code",{defaultOptions:{"{pre}":"> pre","{readOnly}":"[data-code-readonly]","{showGutter}":"[data-code-gutter]","{fontsize}":"[data-code-fontsize]","{themeSelection}":"[data-code-theme]","{modeSelection}":"[data-code-mode]","{iframeHeight}":"[data-code-height]",theme:"github",mode:"javascript",css:{position:"fixed",width:"100%",height:"100%",top:0,bottom:0,left:0,right:0,margin:0,padding:0}}},function(d,u,e,i,r,t,o){return{init:function(){r=d.blocks,i=r.composer,u.meta,o=p()},toText:function(e){},toData:function(e){var t=r.data(e);e.data("uid");return instance=d.editor.instances[e.data("uid")],contents=instance.editor.getSession().getValue(),t.code=contents,t},toEditableHTML:function(e){e=e.clone(),e=r.getBlockContent(e);return e.find("[data-ebd-overlay-placeholder]").remove(),e.html()},toHTML:function(e){var t=r.data(e);e.data("uid");instance=d.editor.instances[e.data("uid")],contents=instance.editor.getSession().getValue();e=e.clone(),e=d.deconstruct(e),e=r.getBlockContent(e),e=d.pre.inside(e);return e.html(contents),e.attr("data-mode",t.mode),e.html()},activate:function(e){o=e,d.populate(e)},deactivate:function(){},construct:function(e){p.extend({},u.data,e)},reconstruct:function(e){var t,o=r.getBlockContent(e),n=r.data(e);e.data("overlay")||((t=i.document.overlay.create(e)).placeholder().css("height",n.height+"px").prependTo(o),t.attach(),e.data("overlay",t)),d.editor.get(e)},"{self} composerBlockDuplicate":function(e,t,o,n){var a;"code"==r.getBlockType(o)&&(o.removeAttr("data-uid"),r.setBlockUid(o),a=r.data(n),data=r.data(o),p.extend(data,a),instance=d.editor.instances[n.data("uid")],contents=instance.editor.getSession().getValue(),data.code=contents,r.getBlockContent(o).find("[data-ebd-overlay-placeholder]").remove())},deconstruct:function(e){return e},reset:function(e){},refocus:function(){},populate:function(e){e=r.data(e);d.modeSelection().val(e.mode),d.themeSelection().val(e.theme),d.showGutter().val(e.show_gutter?1:0),d.showGutter().trigger("change"),d.iframeHeight().val(e.height)},getEditor:function(e){d.editor.get(o).done(e)},switchMode:function(n){var a=r.data(o);d.getEditor(function(e,t,o){t.setMode("ace/mode/"+n),a.mode=n})},switchTheme:function(n){var a=r.data(o);d.getEditor(function(e,t,o){e.setTheme(n),a.theme=n})},switchInvisible:function(n){var a=r.data(current);d.getEditor(function(e,t,o){e.setShowInvisibles(n),a.show_invisible=n})},toggleGutter:function(n){var a=r.data(o);d.getEditor(function(e,t,o){e.renderer.setShowGutter(n),a.show_gutter=n})},updateFontSize:function(n){var a=r.data(o);d.getEditor(function(e,t,o){e.setFontSize(n),a.fontsize=n})},updateHeight:function(e){data=r.data(o),data.height=e;e=o.data("overlay");e.placeholder().css("height",data.height+"px"),e.element().find("iframe").css("height",data.height+"px")},editor:{instances:{},get:function(e){return d.editor.instances[e.data("uid")]||d.editor.create(e)},create:function(e){var o=e.data("uid"),t=r.getBlockContent(e),s=d.pre.inside(t),l=d.editor.instances[o]=p.Deferred(),c=r.data(e),n=l.overlay=e.data("overlay");n||((n=i.document.overlay.create(e)).placeholder().css("height",c.height+"px").prependTo(t),n.attach(),e.data("overlay",n));var a=p.create("iframe"),e=p.rootPath+"/media/index.html";return a.css("height",c.height+"px").attr("src",e).one("load",function(){var i=a[0].contentWindow,e=i.document,t=e.head,e=e.body,r=s.clone().css(u.css).appendTo(e)[0];i.eval("window.FD50 = window.parent.FD50_PSEUDO;"),p.script({url:m,head:t}).done(function(){var e=i.ace.edit(r),t=c.theme||s.data("theme")||u.theme,o=c.mode||s.data("mode")||u.mode,n=c.fontsize||s.data("fontsize")||u.fontsize,a=c.show_gutter||s.data("gutter")||u.show_gutter;e.setTheme(t),e.setFontSize(n),e.renderer.setShowGutter(a),c.code&&e.setValue(c.code),p(r).css("height","100%"),e.resize();a=e.getSession();a.setMode("ace/mode/"+o),l.editor=e,l.resolve(e,a,s)}).fail(function(){l.reject(p.Exception("ACE Editor could not be loaded.")),delete d.instances[o]})}),n.element().append(a),l}},"{showGutter} change":function(e,t){e=1==e.val();d.toggleGutter(e)},"{fontsize} change":function(e,t){e=parseInt(p(e).val());d.updateFontSize(e)},"{modeSelection} change":function(e,t){e=p(e).val();d.switchMode(e)},"{iframeHeight} keyup":p.debounce(function(e,t){e=e.val();d.updateHeight(e)},250),"{themeSelection} change":function(e,t){e=p(e).val();d.switchTheme(e)}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/codepen",function(l){EasyBlog.Controller("Composer.Blocks.Handlers.Codepen",{defaultOptions:{"{form}":"> [data-codepen-form]","{insert}":"[data-codepen-insert]","{source}":"[data-codepen-source]","{loader}":"> [data-codepen-loader]","{preview}":"> [data-codepen-preview]","{fsSource}":"[data-fs-codepen-source]","{fsUpdate}":"[data-fs-codepen-update]","{errorMessage}":"[data-codepen-error]"}},function(r,e,t,a,s,i,o){return{init:function(){s=r.blocks,a=s.composer,i=e.meta,o=l()},toText:function(e){return s.data(e).url},toData:function(e){return s.data(e)},toEditableHTML:function(e){return""},toHTML:function(e){return s.data(e).embed},activate:function(e){o=e,r.populate(e)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){var t=s.data(e),o=e.data("overlay"),n=s.getBlockContent(e);t.embed&&!o&&(n.empty(),r.setOverlay(e,t.embed)),t.embed||n.html(l(i.html))},deconstruct:function(e){var t=s.getBlockContent(e);return r.form.inside(t).remove(),r.loader.inside(t).remove(),e},refocus:function(e){},reset:function(e){},populate:function(e){e=s.data(e);r.fsSource().val(e.url)},loading:function(){var e=s.getBlockContent(o);r.isLoading?(r.loader.inside(e).addClass("hidden"),r.form.inside(e).removeClass("hidden"),r.isLoading=!1):(r.loader.inside(e).removeClass("hidden"),r.form.inside(e).addClass("hidden"),r.isLoading=!0)},setOverlay:function(e,t){var o,n=e.data("overlay");n?(n.element().empty(),n.element().append(t)):(n=a.document.overlay.create(e),o=s.getBlockContent(e),n.placeholder().css("height","300px").appendTo(o),n.element().append(t),n.attach()),e.data("overlay",n)},getUrl:function(e){return"https://codepen.io/api/oembed?format=json&url="+e},isUrlValid:function(e){if(""==e)return!1;return/^https:\/\/codepen\.io\/(.*)\/pen\/(.*)$/.test(e)},crawl:function(t,o){var n=r.getUrl(o),a=s.data(t),e=s.getBlockContent(t);if(!r.isUrlValid(o))return r.errorMessage().removeClass("hide"),!1;var i=t.data("overlay");i&&i.element().empty(),r.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:n}).done(function(e){e=e[n];a.url=o,a.embed=e.oembed.html,r.setOverlay(t,a.embed)}).fail(function(e){r.errorMessage().removeClass("hide").html(e)}).always(function(){r.loading(),r.form.inside(e).addClass("hidden")})},"{insert} click":function(e){o.length<1&&(t=r.block.of(e),s.activateBlock(t));s.data(o);var t=s.getBlockContent(o),t=r.source.inside(t).val();r.fsSource().val(t),r.crawl(o,t)},"{fsUpdate} click":function(){var e=r.fsSource().val();s.data(o);r.crawl(o,e)}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/columns",function(l){EasyBlog.Controller("Composer.Blocks.Handlers.Columns",{defaultOptions:{"{columnsHeader}":".row","{columns}":".row > div","{wrapper}":"> div[data-col-wrapper]","{columnRange}":"[data-eb-composer-block-column-range]","{control}":"[data-columns-control]","{controlWidth}":"[data-select-width]","{dropdown}":".eb-composer-manage-tab-name > select ","{listboxItem}":"[data-listbox-item]"}},function(i,t,e,o,r,n,s){return{init:function(){r=i.blocks,r.composer,t.meta,s=l()},matchWrapperHeight:function(e){var t=0;i.wrapper.inside(e).css("height","").each(function(){t=Math.max(t,l(this).height())}).css("height",t)},removeWrapperHeight:function(e){i.wrapper.inside(e).css("height","")},"{blocks.root} sortactivate":function(){r.getBlocksByType("columns").each(function(){var e=r.getBlockContent(l(this));i.matchWrapperHeight(e)})},"{blocks.root} sortdeactivate":function(){r.getBlocksByType("columns").each(function(){var e=r.getBlockContent(l(this));i.removeWrapperHeight(e)})},"{wrapper} sortchange":function(e,t,o){e=e.closest(EBD.block);i.matchWrapperHeight(e)},"{wrapper} sortout":function(e,t,o){e=e.closest(EBD.block);i.matchWrapperHeight(e)},activate:function(e){s=e,i.populate(e)},deactivate:function(e){},construct:function(e){e=l.extend({},t.data,e);return content},reconstruct:function(e){},deconstruct:function(e){return r.getBlockContent(e).find("> .row > .col > [data-col-wrapper]").each(function(){var e=l(this),t=e.parent();e.children().appendTo(t),t.removeAttr("contenteditable"),e.remove()}),e},refocus:function(e){var t=r.getBlockContent(e);(e.data("lastFocused")||i.columns.inside(t).filter(":first")).focus()},reset:function(e){},populate:function(e){var t=r.data(e),o=e.attr("data-uid");i.control().listbox().listbox("populate",t.columns);r.getBlockContent(e);l('div[data-uid="'+o+'"]').find("div.ebd-block-content:eq(0) > div").children().each(function(e,t){e=i.listboxItem().eq(e),e=i.controlWidth.inside(e),t=l(t).attr("data-size");e.val(t)})},toHTML:function(e){e=e.clone(),e=i.deconstruct(e);return r.getBlockContent(e).html()},toData:function(e){return r.data(e)},toText:function(e){return r.getBlockContent(e).clone().text()},column:{activate:function(e){var t=r.getBlockContent(s);i.columns.inside(t).eq(e).addClass("active-column")},deactivate:function(e){var t=r.getBlockContent(s);i.columns.inside(t).eq(e).removeClass("active-column")},create:function(e){var t=r.getBlockContent(s),o=(i.columns.inside(t),"col-12 col-md-"+e),n=r.createBlockNest();n.attr("data-col-wrapper","").addClass("ui-sortable");var a=r.constructNestedBlock("text");n.append(a);a=l("<div></div>");a.addClass(o).attr("data-size",e).append(n),i.columnsHeader.inside(t).append(a)},remove:function(e){var t=r.getBlockContent(s);i.columns.inside(t).eq(e).remove();var o=i.columns.inside(t).length,n=Math.ceil(12/o),e=!1;5==o&&(n=2,e=!0);n="col-12 col-md-"+n;i.columnsHeader.inside(t).find("div.col").removeClass().addClass(n),e&&(i.columns.inside(t).first().addClass("col-md-offset-1"),i.columns.inside(t).last().addClass("col-md-offset-0"))},change:function(e,t){var o=r.getBlockContent(s),n=r.data(s),a=s.attr("data-uid"),a=l('div[data-uid="'+a+'"]').find("div.ebd-block-content:eq(0) > div").children().length;4<t&&3==a&&i.columns.inside(o).last().addClass("col col-md-2"),4==t&&4==a&&i.columns.inside(o).last().addClass("col col-md-2"),4<t&&(4==a||5==a)||(6!=a?(i.columns.inside(o).first().removeClass("col-md-offset-1"),i.columns.inside(o).last().removeClass("col-md-offset-0"),a="col-12 col-md-"+t,i.columns.inside(o).eq(e),n.columns[e].size=t,i.columns.inside(o).eq(e).attr("data-size",t).removeClass().addClass(a)):i.dropdown().val("2"))}},"{listboxItem} mouseover":function(e,t){e=e.index();i.column.activate(e)},"{listboxItem} mouseout":function(e,t){e=e.index();i.column.deactivate(e)},"{control} listboxBeforeAddItem":function(e,t,o){},"{control} listboxAfterAddItem":function(e,t,o){r.data(s).columns=i.control().listbox("toData"),i.column.create(1)},"{control} listboxBeforeRemoveItem":function(e,t,o){o=o.index();i.column.remove(o)},"{control} listboxAfterRemoveItem":function(e,t,o){r.data(s).columns=i.control().listbox("toData")},"{controlWidth} change":function(e,t){var o=e.parents(i.listboxItem.selector).index(),e=e.val();i.column.change(o,e)},"{self} composerBlockDuplicate":function(e,t,o,n){var a;"columns"==r.getBlockType(o)&&(r.updateBlockUid(o),a=r.data(n),data=r.data(o),l.extend(data,a),r.duplicateChildBlocksData(o,n))}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/compare",function(d){var e=this;EasyBlog.require().library("imgareaselect").done(function(){EasyBlog.Controller("Composer.Blocks.Handlers.Compare",{defaultOptions:{image:"[data-type=compare] img"}},function(l,e,c,t,o,n,a){return{init:function(){o=l.blocks,o.composer,e.meta,a=d()},toData:function(e){return o.getData(e)},activate:function(e){a=e,l.populate(e),a.find("img").on("click.compare dragstart.compare",function(e){e.preventDefault(),e.stopPropagation()}).on("mousedown.compare",function(e){var t,o,n,a,i,r,s;l.drawing||(e.stopPropagation(),e.preventDefault(),t=d(this),o=t.parents(".ebd-block:first"),images=o.find("img"),console.log(o),l.drawing=!0,c.addClass("active"),n=parseInt(t.css("top")),a=parseInt(t.css("left")),i=t.width()-t.parent().width(),h=t.height()-t.parent().height(),r=e.pageX,s=e.pageY,d(document).on("mousemove.compare mouseup.compare",function(e){var t,o;l.drawing&&(t=-1*(r-e.pageX),o=-1*(s-e.pageY),t=0==i?0:a+(t||0),o=0==h?0:n+(o||0),images.css({top:n=o,left:a=t}),r=e.pageX,s=e.pageY)}).on("mouseup.compare",function(){d(document).off("mousemove.compare mouseup.compare"),o.removeClass("active"),l.drawing=!1}))})},construct:function(e){},reconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){},drawing:!1,"{image} mousedown":function(e){}}}),e.resolve()})}),EasyBlog.module("composer/blocks/handlers/comparison",function(e){var t=this;EasyBlog.require().script("shared/comparison").done(function(a){EasyBlog.Controller("Composer.Blocks.Handlers.Comparison",{defaultOptions:{"{wrapper}":"[data-eb-comparison-wrapper]","{rightButtonPlaceholder}":"[data-right-browse-placeholder]","{rightButtonTemplate}":"[data-eb-comparison-template] > [data-eb-comparison-browse=right]","{leftButtonPlaceholder}":"[data-left-browse-placeholder]","{leftButtonTemplate}":"[data-eb-comparison-template] > [data-eb-comparison-browse=left]","{leftLabel}":"[data-left-label]","{rightLabel}":"[data-right-label]","{leftImage}":"[data-left-image]","{rightImage}":"[data-right-image]","{leftToggler}":"[data-field-left-label]","{leftTextField}":"#left_text","{rightToggler}":"[data-field-right-label]","{rightTextField}":"#right_text","{browseMedia}":"[data-eb-comparison-browse]"}},function(r,e,t,o,s,n,l){return{init:function(){s=r.blocks,s.composer,e.meta,l=a()},activate:function(e){l=e,r.populate(e)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){s.data(e)},refocus:function(){},deconstruct:function(e){return r.browseMedia.inside(e).remove(),e},reset:function(e){},populate:function(e){e=s.data(e);r.wrapper().comparison(),r.initializeBrowseButtons(),r.leftToggler().val(e.left?1:0).trigger("change"),r.rightToggler().val(e.right?1:0).trigger("change"),r.leftTextField().val(e.left_text).trigger("keyup"),r.rightTextField().val(e.right_text).trigger("keyup")},toHTML:function(e){e=e.clone(),e=r.deconstruct(e);return s.getBlockContent(e).html()},toData:function(e){return s.data(e)},toText:function(e){return s.getBlockContent(e).clone().text()},initializeBrowseButtons:function(){var e,t=s.getBlockContent(l),o=r.rightButtonPlaceholder.inside(t).html(),t=r.leftButtonPlaceholder.inside(t).html();o.length<=0&&(e=r.rightButtonTemplate().clone(),r.rightButtonPlaceholder().html(e[0])),t.length<=0&&(e=r.leftButtonTemplate().clone(),r.leftButtonPlaceholder().html(e[0]))},"{leftToggler} change":function(e,t){var o=s.data(l),n=0!=e.val(),e=s.getBlockContent(l);(o.left=n)?r.leftLabel.inside(e).html(r.leftTextField().val()).removeClass("t-hidden"):r.leftLabel.inside(e).html("").addClass("t-hidden")},"{rightToggler} change":function(e,t){var o=s.data(l),n=0!=e.val(),e=s.getBlockContent(l);(o.right=n)?r.rightLabel.inside(e).html(r.rightTextField().val()).removeClass("t-hidden"):r.rightLabel.inside(e).html("").addClass("t-hidden")},"{leftTextField} keyup":a.debounce(function(e){var t=s.data(l),o=e.val(),e=s.getBlockContent(l);t.left_text=o,r.leftLabel.inside(e).html(o)}),"{rightTextField} keyup":a.debounce(function(e){var t=s.data(l),o=s.getBlockContent(l),e=e.val();t.right_text=e,r.rightLabel.inside(o).html(e)}),"{browseMedia} mediaSelect":function(e,t,o,n){var a,i;"image"==o.meta.type&&(a=s.getBlockContent(l),e=(i=e.data("eb-comparison-browse"))+"Image",(o=o.meta.variations[n.variation]).width<480||o.height<480||("left"==i&&r[e].inside(a).css("background-image","url("+n.url+")"),"right"==i&&r[e].inside(a).attr("src",n.url)))}}}),t.resolve()})}),EasyBlog.module("composer/blocks/handlers/dailymotion",function(o){EasyBlog.Controller("Composer.Blocks.Handlers.Dailymotion",{elements:["[data-dailymotion-fieldset-{url|fluid|width-fieldset|height-fieldset|width|height|update-url}]"],defaultOptions:o.extend({"{form}":"> [data-dailymotion-form]","{insert}":"[data-dailymotion-insert]","{source}":"[data-dailymotion-source]","{loader}":"> [data-dailymotion-loader]","{player}":"iframe","{wrapper}":"[data-dailymotion-wrapper]"},EBD.selectors)},function(i,e,t,n,r,a,s){return{init:function(){r=i.blocks,n=r.composer,a=e.meta,s=o()},toData:function(e){var t=r.data(e),e=i.getOverlay(e);if(!e)return t;e=i.player.inside(e.element());return t.source=e.attr("src"),t},toText:function(e){var t=r.data(e),e=i.getOverlay(e);if(!e)return t;e=i.player.inside(e.element());return t.source=e.attr("src"),t.source},toHTML:function(e){r.data(e);e=e.data("overlay");if(e)return e.element().html()},activate:function(e){r.getBlockContent(e),r.data(e);s=e,i.populate(e)},deactivate:function(e){},construct:function(e){},getWrapper:function(e){return o(a.wrapper)},reconstruct:function(e){var t=r.data(e),o=e.data("overlay"),n=r.getBlockContent(e);t.source&&!o?i.setOverlay(e):0==t.source.length&&t.url?(n.html(a.html),i.crawl(t.url,e)):n.html(a.html),e.find(i.source.selector).off("paste").on("paste",function(e){e.stopPropagation()})},deconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){i.updateFieldset(e)},updateFieldset:function(e){e=r.data(e);i.url().val(e.url),i.width().val(e.width),i.height().val(e.height),i.fluid().val(e.fluid?"1":"0").trigger("change")},getOverlay:function(e){var t=e.data("overlay"),o=(r.data(e),r.getBlockContent(e));return t||(t=n.document.overlay.create(e),e=i.getWrapper(),t.placeholder().appendTo(e),o.empty().append(e),t.attach()),t},setWrapperLayout:function(e){var t=i.wrapper.inside(e),e=r.data(e);e.fluid?t.addClass("is-responsive").css({width:"",height:""}):(t.hasClass("is-responsive")&&(e.width=t.width(),e.height=t.outerHeight()),i.width().val(e.width),i.height().val(e.height),t.css({width:e.width,height:e.height}).removeClass("is-responsive"))},setOverlay:function(e){var t=r.data(e),o=i.getOverlay(e);0<o.element().length&&o.element().empty(),i.setWrapperLayout(e),o.element().append(t.embed),o.refresh(),e.data("overlay",o)},isUrlValid:function(e){if(""==e)return!1;return/^(http|https):\/\/www\.dailymotion\.com\/video\/(.*)$/.test(e)},loading:function(){var e=r.getBlockContent(s),t=i.loader.inside(e),e=i.form.inside(e);i.isLoading?(t.addClass("hidden"),e.removeClass("hidden"),i.isLoading=!1):(t.removeClass("hidden"),e.addClass("hidden"),i.isLoading=!0)},crawl:function(t,o){var n=r.data(o),e=r.getBlockContent(o),a=o.data("overlay");a&&a.element().empty(),i.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:t}).done(function(e){e=e[t];n.url=t,n.author={name:e.oembed.author_name,url:e.oembed.author_url},n.embed=e.oembed.html,n.width=e.oembed.width,n.height=e.oembed.height,i.setOverlay(o),i.updateFieldset(o)}).fail(function(e){i.errorMessage().removeClass("hide").html(e)}).always(function(){i.loading(),i.form.inside(e).addClass("hidden")})},"{insert} click":function(e){s.length<1&&(t=i.block.of(e),r.activateBlock(t));var t=r.getBlockContent(s),t=i.source.inside(t).val();r.data(s);i.isUrlValid(t)?i.crawl(t,s):i.errorMessage().removeClass("hide")},"{fluid} change":function(e,t){var o=1==e.val(),e=r.data(s);e.fluid=o,e.url&&(i.widthFieldset().toggleClass("hide",o),i.heightFieldset().toggleClass("hide",o),i.setWrapperLayout(s),i.getOverlay(s).refresh())},"{width} keyup":o.debounce(function(e,t){var o=r.data(s),e=e.val();0!=e&&(o.width=e,i.getOverlay(s),i.wrapper.inside(s).css("width",e),i.getOverlay(s).refresh())},250),"{height} keyup":o.debounce(function(e,t){var o=r.data(s),e=e.val();0!=e&&(o.height=e,i.wrapper.inside(s).css("height",e),i.getOverlay(s).refresh())},250),"{updateUrl} click":function(e,t){var o=i.url().val(),n=(r.data(s),r.getBlockContent(s));i.isUrlValid(o)?i.crawl(o,s):i.errorMessage.inside(n).removeClass("hide")}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/easysocial",function(o){EasyBlog.Controller("Composer.Blocks.Handlers.Easysocial",{elements:["[data-easysocial-fieldset-{url|fluid|width-fieldset|height-fieldset|width|height|update-url|nocookie}]"],defaultOptions:o.extend({"{related}":"[data-easysocial-fieldset-related]","{form}":"> [data-easysocial-form]","{insert}":"[data-easysocial-insert]","{source}":"[data-easysocial-source]","{loader}":"> [data-easysocial-loader]","{errorMessage}":"[data-easysocial-error]","{player}":"iframe","{wrapper}":"[data-easysocial-wrapper]"},EBD.selectors)},function(i,e,t,n,r,a,s){return{init:function(){r=i.blocks,n=r.composer,a=e.meta,s=o()},toData:function(e){var t=r.data(e),e=e.data("overlay");if(!e)return t;e=i.player.inside(e.element());return t.source=e.attr("src"),t},toText:function(e){return r.data(e).source},toEditableHTML:function(e){return""},toHTML:function(e){r.data(e);e=e.data("overlay");if(e)return e.element().html()},activate:function(e){r.getBlockContent(e),r.data(e);s=e,i.populate(s)},deactivate:function(e){},construct:function(e){},getWrapper:function(e){return o(a.wrapper)},reconstruct:function(e){var t=r.data(e),o=e.data("overlay"),n=r.getBlockContent(e);t.source&&!o?i.setOverlay(e):0==t.source.length&&t.url?(n.html(a.html),i.crawl(t.url,e)):n.html(a.html),e.find(i.source.selector).off("paste").on("paste",function(e){e.stopPropagation()})},deconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){r.data(e);i.updateFieldset(e)},updateFieldset:function(e){e=r.data(e);i.url().val(e.url),i.width().val(e.width),i.height().val(e.height),i.fluid().val(e.fluid?"1":"0").trigger("change"),i.related().val(e.related?"any":"same").trigger("change"),i.nocookie().val(1==e.nocookie?"1":"0").trigger("change")},getOverlay:function(e){var t=e.data("overlay"),o=(r.data(e),r.getBlockContent(e));return t||(t=n.document.overlay.create(e),e=i.getWrapper(),t.placeholder().appendTo(e),o.empty().append(e),t.attach()),t},setWrapperLayout:function(e){var t=i.wrapper.inside(e),e=r.data(e);e.fluid?t.addClass("is-responsive").css({width:"",height:""}):(t.hasClass("is-responsive")&&(e.width=t.width(),e.height=t.outerHeight()),i.width().val(e.width),i.height().val(e.height),t.css({width:e.width,height:e.height}).removeClass("is-responsive"))},setOverlay:function(e){var t=r.data(e),o=i.getOverlay(e);0<o.element().length&&o.element().empty(),i.setWrapperLayout(e),o.element().append(t.embed),o.refresh(),e.data("overlay",o)},isUrlValid:function(e){return""!=e},loading:function(){var e=r.getBlockContent(s),t=i.loader.inside(e),e=i.form.inside(e);i.isLoading?(t.addClass("hidden"),e.removeClass("hidden"),i.isLoading=!1):(t.removeClass("hidden"),e.addClass("hidden"),i.isLoading=!0)},hideForm:function(e){e=r.getBlockContent(e);i.form.inside(e).addClass("hidden"),i.loader.inside(e).removeClass("hidden")},showForm:function(e){e=r.getBlockContent(e);i.form.inside(e).removeClass("hidden"),i.loader.inside(e).addClass("hidden")},crawl:function(o,n){var a=r.data(n),e=(r.getBlockContent(n),n.data("overlay"));e&&e.element().empty(),i.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:o}).done(function(e,t){e=e[o];if(e.oembed.error)return i.showForm(n),void i.errorMessage().removeClass("hide").html(t);a.url=o,a.author={name:e.oembed.author_name,url:e.oembed.author_url},a.embed=e.oembed.html,a.embed_nocookie=e.oembed.html_nocookie,a.embed_original=e.oembed.html,a.width=e.oembed.width,a.height=e.oembed.height,i.setOverlay(n),i.updateFieldset(n)}).fail(function(e){i.errorMessage().removeClass("hide").html(e)}).always(function(){i.loading()})},"{insert} click":function(e){var t;s.length<1?(t=i.block.of(e),r.activateBlock(t)):(t=r.getBlockContent(s),t=i.source.inside(t).val(),r.data(s),i.isUrlValid(t)?i.crawl(t,s):i.errorMessage().removeClass("hide"))},"{related} change":function(e,t){var o=r.data(s),n="any"==e.val(),a=s.data("overlay");o.related=n,a&&(a=(e=i.player.inside(a.element())).attr("src"),n||(a=a.replace("?feature=oembed","?feature=oembed&rel=0"),e.attr("src",a)),n&&(a=a.replace("&rel=0",""),e.attr("src",a)),o.source=a)},"{fluid} change":function(e,t){var o=1==e.val(),e=r.data(s);e.fluid=o,e.url&&(i.setWrapperLayout(s),i.widthFieldset().toggleClass("hide",o),i.heightFieldset().toggleClass("hide",o),i.getOverlay(s).refresh())},"{width} keyup":o.debounce(function(e,t){var o=r.data(s),e=e.val();o.url&&0!=e&&(o.width=e,i.getOverlay(s),i.wrapper.inside(s).css("width",e),i.getOverlay(s).refresh())},250),"{height} keyup":o.debounce(function(e,t){var o=r.data(s),e=e.val();0!=e&&(o.height=e,i.wrapper.inside(s).css("height",e),i.getOverlay(s).refresh())},250),"{updateUrl} click":function(e,t){var o=i.url().val(),n=(r.data(s),r.getBlockContent(s));i.isUrlValid(o)?i.crawl(o,s):i.errorMessage.inside(n).removeClass("hide")},"{nocookie} change":function(e,t){var o=r.data(s),e=1==e.val();o.nocookie=e,o.url&&(o.embed=e?o.embed_nocookie:o.embed_original,o.related||(o.embed=o.embed.replace("?feature=oembed","?feature=oembed&rel=0")),i.setOverlay(s))}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/facebook",function(o){EasyBlog.Controller("Composer.Blocks.Handlers.Facebook",{defaultOptions:{"{form}":"> [data-fb-form]","{embed}":"[data-fb-embed]","{source}":"[data-fb-source]","{preview}":"[data-fb-preview]","{input}":"[data-fb-source-input]","{update}":"[data-fb-update]","{errorMessage}":"[data-fb-error]"}},function(a,e,t,i,r,s,l){return{init:function(){r=a.blocks,i=r.composer,s=e.meta,l=o()},toData:function(e){return r.data(e)},toText:function(e){return r.data(e).source},toEditableHTML:function(e){return""},toHTML:function(e){r.data(e);e=e.data("overlay");if(e)return e.element().html()},activate:function(e){r.getBlockContent(e),r.data(e);l=e,a.populate(e)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){var t=r.data(e),o=e.data("overlay"),n=r.getBlockContent(e);t.source&&!o?(n.empty(),a.createIframe(e,t.source)):n.html(s.html),e.find(a.source.selector).off("paste").on("paste",function(e){e.stopPropagation()})},deconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){e=r.data(e);a.populateUrl(e.source)},setOverlay:function(e,t){var o,n=e.data("overlay");n?(n.element().empty(),n.element().append(t)):(n=i.document.overlay.create(e),o=r.getBlockContent(e),n.placeholder().css("height","400px").appendTo(o),n.element().append(t),n.attach()),e.data("overlay",n)},isUrlValid:function(e){return""!=e&&(!!/^https:\/\/(www|web)\.facebook\.com\/(.*)\/(.*)$/.test(e)||!!/^https:\/\/fb\.watch\/(.*)\/$/.test(e))},createIframe:function(e,t){var o=document.createElement("iframe");r.getBlockContent(e);r.data(e).source=t;var n=e.data("overlay");return n&&n.element().empty(),o.setAttribute("width","auto"),o.setAttribute("height","400"),o.setAttribute("src","https://www.facebook.com/plugins/post.php?href="+encodeURIComponent(t)+"&height=400"),o.setAttribute("scrolling","no"),o.setAttribute("frameborder","0"),o.setAttribute("allowTransparency","true"),a.setOverlay(e,o),o},"{embed} click":function(e,t){l.length<1&&(n=a.block.of(button),r.activateBlock(n));var o=r.getBlockContent(l),n=a.source.inside(o).val();r.data(l);a.isUrlValid(n)?(a.populateUrl(n),a.createIframe(l,n),a.form.inside(o).addClass("t-hidden")):a.errorMessage().removeClass("t-hidden")},populateUrl:function(e){a.input().val(e)},"{update} click":function(e,t){var o=r.getBlockContent(l),n=a.input().val();r.data(l);a.isUrlValid(n)?(a.createIframe(l,n),a.form.inside(o).addClass("t-hidden")):a.errorMessage.inside(o).removeClass("t-hidden")}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/file",function(u){EasyBlog.Controller("Composer.Blocks.Handlers.File",{defaultOptions:{"{browseButton}":".eb-composer-placeholder-file [data-eb-mm-browse-button]","{fileError}":"[data-eb-file-error]","{placeholder}":"[data-eb-composer-file-placeholder]","{player}":"[data-file-preview]","{dropElement}":"[data-plupload-drop-element]","{showIcon}":"[data-file-fieldset-icon]","{showSize}":"[data-file-fieldset-size]","{changeButton}":"[data-panel-file-source-change-button]","{fileSourceIcon}":"[data-panel-file-source-icon]","{fileSourceName}":"[data-panel-file-source-name]","{fileSourceSize}":"[data-panel-file-source-size]","{fileName}":"[data-file-name]","{fileIconWrapper}":"[data-file-icon-wrapper]","{fileIcon}":"[data-file-icon]","{fileSize}":"[data-file-size]","{fileUrl}":"[data-file-url]","{sourceChangeButton}":"[data-eb-file-source-change-button]"}},function(c,e,t,s,d,o,i,n){return{init:function(){d=c.blocks,s=d.composer,o=e.meta,i=u(),n=EasyBlog.MediaManager},toData:function(e){var t=d.data(e),e=d.getBlockContent(e);c.getPreviewTemplate();return t.name=e.find(c.fileName).text(),t},toText:function(e){},toHTML:function(e){if(!d.data(e).url)return"";e=e.clone(),e=c.deconstruct(e);return d.getBlockContent(e).html()},constructFromMediaFile:function(e){var e=e.data("key"),e=n.getUri(e),o=d.createBlockContainer("file");d.getBlockContent(o),d.data(o);return o.addClass("is-loading"),n.getMedia(e).done(function(e){var t=e.meta,e=JSON.parse(t.params);c.createPreview(o,t.url,t.title,t.type,t.size,e.extension)}).fail(function(){}).always(function(){o.removeClass("is-loading")}),o},toLegacyHTML:function(e,t){return u("<a>").attr({href:e.url}).html(e.title).prop("outerHTML")},activate:function(e){i=e,c.populate(e)},deactivate:function(e){},construct:function(e){var t=d.createBlockContainer("file"),e=u.extend(d.data(t),e);return t},reconstruct:function(e){var t=d.data(e),o=c.placeholder.inside(e),n=c.dropElement.inside(o);t.url&&c.createPreview(e,t.url,t.name,t.type,t.size,t.extension),0<n.length&&EasyBlog.MediaManager.uploader.register(o)},deconstruct:function(e){var t=d.getBlockContent(e);return c.fileName.inside(t).editable(!1),e},refocus:function(e){},reset:function(e){},populate:function(e){var t=d.data(e),o=1==t.showicon?1:0,e=1==t.showsize?1:0;c.showIcon().val(o).trigger("change"),c.showSize().val(e).trigger("change"),d.panel.fieldgroup.get("file").toggleClass("is-new",!t.url),c.updateFileSource()},getPreviewTemplate:function(){u(o.preview);return u(o.preview)},getVideoExtensions:function(){return["mp4","swf","flv","mov","f4v","3gp","m4v","webm","ogv"]},getImageExtensions:function(){return["jpg","png","gif","bmp","jpeg","webp","jfif"]},getAudioExtensions:function(){return["mp3","m4a","aac","ogg","wav","wma"]},getCodeExtensions:function(){return["c","cgi","pl","class","cpp","cs","h","java","js","json","php","py","sh","html","css","r","xml","sql"]},getIcon:function(e){var t="pptx"==e?"fdi fas fa-file-powerpoint":"docx"==e?"fdi fas fa-file-word":"csv"==e?"fdi fas fa-file-csv":"zip"==e?"fdi fas fa-file-archive":"pdf"==e?"fdi fas fa-file-pdf":"fdi fa fa-file";return-1!==u.inArray(e,c.getAudioExtensions())&&(t="fdi fas fa-file-audio"),-1!==u.inArray(e,c.getCodeExtensions())&&(t="fdi fas fa-file-code"),-1!==u.inArray(e,c.getImageExtensions())&&(t="fdi fas fa-file-image"),t=-1!==u.inArray(e,c.getVideoExtensions())?"fdi fas fa-file-video":t},updateFileSource:function(){var e=d.data(i),t=c.getIcon(e.extension),o=e.name,e=u.plupload2.formatSize(e.size);c.fileSourceIcon().removeClass().addClass(t),c.fileSourceName().html(o),c.fileSourceSize().html(e)},createPreview:function(e,t,o,n,a,i){var r=d.getBlockContent(e),s=c.getPreviewTemplate(),l=d.data(e);EasyBlog.ajax("site/views/composer/abs2rel",{url:t}).done(function(e){l.url=e,l.name=o,l.type=n,l.size=a,l.extension=i,s.attr("id",l.uid),c.fileName.inside(s).text(l.name);e=u.plupload2.formatSize(l.size);c.fileSize.inside(s).text(e),c.fileUrl.inside(s).attr("href",l.url).on("click",function(e){e.preventDefault()}),c.updateFileSource(),d.panel.fieldgroup.get("file").removeClass("is-new");e=c.getIcon(i);c.fileIcon.inside(s).addClass(e),r.html(s),l.showicon||c.fileIconWrapper.inside(s).addClass("hide"),l.showsize||c.fileSize.inside(s).parent("div").addClass("hide")})},"{showIcon} change":function(e,t){var o=d.getBlockContent(i),n=d.data(i);n.showicon=1==e.val(),n.showicon?c.fileIconWrapper.inside(o).removeClass("hide"):c.fileIconWrapper.inside(o).addClass("hide")},"{showSize} change":function(e,t){var o=d.getBlockContent(i),n=d.data(i);n.showsize=1==e.val(),n.showsize?c.fileSize.inside(o).parent("div").removeClass("hide"):c.fileSize.inside(o).parent("div").addClass("hide")},"{placeholder} mediaUploaderFilesAdded":function(e,t,o,n){EasyBlog.MediaManager.uploader.addItem(n[0],e)},"{placeholder} mediaUploaderFileUploaded":function(e,t,o,n,a){var i=a.response.media.meta,r=d.block.of(e),s=JSON.parse(i.params);setTimeout(function(){c.createPreview(r,i.url,i.title,i.type,i.size,s.extension)},600)},"{placeholder} mediaUploaderFileError":function(e,t,o,n){n.code==u.plupload2.FILE_EXTENSION_ERROR&&c.fileError.inside(i).removeClass("hide")},"{placeholder} mediaUploaderError":function(e,t,o,n){},"{self} mediaInfoDisplay":function(e,t,o,n){"file"==n.meta.type&&u(o).find("[data-file-url]").on("click",function(e){e.preventDefault()})},onMediaSelect:function(e,t){var o,n,a=!1;"pdf"!=t.meta.type&&"file"!=t.meta.type&&"image"!=t.meta.type||(a=!0,"pdf"==t.meta.type&&t.data.previewer&&(a=!1,e=d.constructBlock("pdf",{name:t.data.title,url:t.meta.url,height:t.data.height}),d.addBlockAfter(e,i),d.activateBlock(e),d.removeBlock(i))),a&&(o=t.meta,a=(n=s.document).isLegacy(),t=JSON.parse(o.params),a?(content=c.toLegacyHTML(e),n.insertContent(content)):c.createPreview(e,o.url,o.title,o.type,o.size,t.extension))},"{changeButton} mediaSelect":function(e,t,o){var n=d.getBlockContent(i);d.data(i);n.empty(),c.onMediaSelect(i,o)},"{browseButton} mediaSelect":function(e,t,o){e=d.block.of(e);c.onMediaSelect(e,o)},"{self} mediaInsert":function(e,t,o,n,a,i){var r;"file"==o.meta.type&&((r=s.document).isLegacy()?(content=c.toLegacyHTML(o.meta,n),r.insertContent(content)):(n=d.constructBlock("file",{name:a.title,type:o.meta.extension,size:o.meta.size,url:o.meta.url,showicon:a.showicon,showsize:a.showsize}),d.addBlock(n),i||d.activateBlock(n)))}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/gallery",function(i){function r(e,t){t=Math.pow(10,t);return Math.round(e*t)/t}function f(e){if(i.isNumeric(e))return e;e=e.split(":");return e[0]/e[1]}var e=this,s="view-selectratio",l="view-customratio";EasyBlog.require().script("site/vendors/swiper").done(function(m){EasyBlog.Controller("Composer.Blocks.Handlers.Gallery",{elements:["[data-eb-gallery-{items-fieldset|list|list-item-group|list-item|list-item-icon|list-item-title|list-item-primary-label|list-item-delete-button|list-item-primary-button}]","[data-eb-gallery-{size-fieldset|strategy-field|strategy-menu-item}]","[data-eb-gallery-{ratio-button|ratio-label|ratio-customize-button|ratio-cancel-button|ratio-use-custom-button|ratio-cancel-custom-button|ratio-selection|ratio-input}]"],defaultOptions:{"{galleryUploadPlaceholder}":".eb-gallery-upload-placeholder","{galleryContainer}":".eb-gallery","{galleryViewport}":".eb-gallery-viewport","{galleryItem}":".eb-gallery-item:not(.is-placeholder)","{galleryStage}":".eb-gallery-stage","{galleryNextButton}":".eb-gallery-next-button","{galleryPrevButton}":".eb-gallery-prev-button","{galleryMenu}":".eb-gallery-menu","{galleryMenuItem}":".eb-gallery-menu-item","{galleryImage}":".ebd-block[data-type=image]","{galleryItemPlaceholder}":".eb-gallery-item.is-placeholder","{galleryMenuItemPlaceholder}":".eb-gallery-menu-item.is-placeholder","{galleryBrowseButton}":"[data-eb-gallery-browse]","{galleryProgressBar}":"[data-eb-mm-upload-progress-bar]"}},function(c,e,t,a,d,o,u,n,p){return{init:function(){d=c.blocks,a=d.composer,o=e.meta,u=m(),d.dimensions,mediaManager=EasyBlog.MediaManager,mediaUploader=mediaManager.uploader,p=d.getBlockHandler("image")},normalize:function(e){return m.extend({},o.data,e)},activate:function(e){u=e,c.populate(e);e=c.listItemGroup();e.hasClass("ui-sortable")||e.sortable({items:c.listItem.selector,tolerance:"pointer",refreshPositions:!0,update:function(e,t){var o=[],n=[];activeId=0,c.listItem().each(function(){var e=m(this),t=e.attr("data-id");e.hasClass("active")&&(activeId=t);t=c.galleryItem().where("id",t);o.push(t[0]),n.push(t[0])});var a=c.galleryViewport.inside(u),i=c.galleryContainer.inside(u),r=(c.galleryItemPlaceholder.inside(u),c.galleryMenuItemPlaceholder.inside(u));m.each(o.reverse(),function(e,t){a.prepend(t)}),m.each(n,function(e,t){var o=m(t).attr("data-id");c.galleryMenuItem.inside(u).where("id",o).remove();t=c.getGalleryMenuItemTemplate(o);t.attr("data-id",o).insertBefore(r),activeId&&o==activeId&&t.addClass("active")}),EasyBlog.ImageGallery.setLayout(i)}})},deactivate:function(e){},construct:function(e){return d.createBlock("gallery")},constructGallery:function(n,e){var t=c.galleryContainer.inside(n);c.galleryItemPlaceholder.inside(n),c.galleryMenuItemPlaceholder.inside(n),d.data(n);void 0===p&&(p=d.getBlockHandler("image"));var a=0;m.each(e,function(e,t){var o=m.uid("g");c.createGalleryItem(n,t,o),0==a&&c.setPrimary(o),a++}),EasyBlog.ImageGallery.setLayout(t)},createGalleryItem:function(e,t,o){var n=c.galleryContainer.inside(e),a=c.galleryItemPlaceholder.inside(e),i=c.galleryMenuItemPlaceholder.inside(e),r=d.data(e),s=t.meta,l=t.uri;void 0===p&&(p=d.getBlockHandler("image"));t=c.getGalleryItemTemplate();t.attr("data-id",o),t.insertBefore(a),c.getGalleryMenuItemTemplate(o).attr("data-id",o).insertBefore(i),n.removeClass("is-empty");n=c.createGalleryImage(e,s);t.html(n);l=mediaManager.getVariation(l,"icon");r.items[o]={title:s.title,iconUrl:l.url},p.normalizeImageSize(n),e.is(u)&&c.populateList(e)},reconstruct:function(e){e.editable(!1);var t=c.galleryUploadPlaceholder.inside(e);t.find("[data-plupload-browse-button]").attr("style",function(e,t){return t&&t.replace(/z\-index[^;]+;?/g,"")});mediaUploader.register(t);c.populateDataItems(e)},deconstruct:function(e){var t=d.data(e),o=d.getBlockContent(e),n=c.galleryContainer.inside(e);c.galleryItemPlaceholder.inside(n).remove(),c.galleryMenuItemPlaceholder.inside(n).remove();var a=c.galleryItem.inside(n),i=a.where("id",t.primary);a.removeClass("active"),i.addClass("active"),c.galleryMenuItem.inside(n).removeClass("active").where("id",t.primary).addClass("active"),EasyBlog.ImageGallery.setLayout(n);i=c.getGalleryItemIndex(e,i),i=0!=(i=i<0?0:i)?i:0;return c.galleryViewport.inside(n).attr("data-eb-gallery-initial-slide",i),o.html(n),e},refocus:function(e){},reset:function(e){},populate:function(e){c.populateDataItems(e),c.populateRatio(e),c.populateResizeStrategy(e),c.populateList(e)},populateDataItems:function(e){var o=d.data(e);m.each(o.itemsKeyArray,function(e,t){o.items[t]=o.itemsArray[e]}),c.uploadedItems=o.itemsArray.length},toData:function(e){var t,o=d.data(e);for(t in o.itemsArray=[],o.itemsKeyArray=[],o.items)o.items.hasOwnProperty(t)&&(o.itemsArray.push(o.items[t]),o.itemsKeyArray.push(t));return o},toText:function(e){},toHTML:function(e){e=e.clone(),e=c.deconstruct(e);return d.getBlockContent(e).html()},toLegacyHTML:function(e){var n=[];return m.each(e,function(e,t){var o=JSON.parse(t.meta.params),o={namespace:t.uri,caption_text:o.caption_text,alt_text:o.alt_text};n.push(o)}),"[embed=gallery]"+JSON.stringify(n)+"[/embed]"},getGalleryItemTemplate:function(){return m(o.galleryItem)},getGalleryMenuItemTemplate:function(e){var t=m(o.galleryMenuItem);return t.data("id",e),t},createGalleryListItem:function(){return m(o.galleryListItem)},createGalleryPlaceholder:function(){return m(o.galleryPlaceholder)},createGalleryImage:function(e,t){var o=d.data(e),n=JSON.parse(t.params),a=t.uri,i=mediaManager.getVariation(a,o.imageVariation),r=i.width,s=i.height,l=r/s,e=void 0!==n.extension?n.extension:"",o={uri:a,url:i.url,key:i.key,mode:"advanced",mode_lock:!0,fluid:!0,width:"100%",width_lock:!0,height:"100%",height_lock:!0,ratio:f(o.ratio),strategy:o.strategy,element_ratio:l,extension:e,natural_width:r,natural_height:s,natural_ratio:l,caption_enabled:!0,caption_text:n.caption_text,alt_text:n.alt_text,link_enabled:!1,style_enabled:!1,popup_enabled:!1,variation:o.imageVariation};return"webp"==e&&void 0!==t.fallbackItem&&(o.fallbackItem=t.fallbackItem.meta),d.constructNestedBlock("image",o).addClass("is-isolated")},"{galleryUploadPlaceholder} mediaUploaderFilesAdded":function(e,t,o,n){var i=d.block.of(e),r=c.galleryContainer.inside(i),s=c.galleryItemPlaceholder.inside(i),l=c.galleryMenuItemPlaceholder.inside(i);e.addClass("state-uploading"),c.addedItems=n.length,m.each(n,function(e,t){var o=t.id,n=m.uid("g"),a=c.getGalleryItemTemplate();a.attr("data-file-id",o).attr("data-id",n);o=c.createGalleryPlaceholder();a.html(o),a.insertBefore(s),c.galleryMenuItem.inside(i).removeClass("active"),c.getGalleryMenuItemTemplate(n).attr("data-id",n).insertBefore(l).addClass("active"),mediaUploader.addItem(t,o),r.removeClass("is-empty")}),EasyBlog.ImageGallery.setLayout(r)},uploadedItems:0,addedItems:0,"{galleryUploadPlaceholder} mediaUploaderBeforeUpload":function(){a.trigger("composerSubmitLock")},"{galleryUploadPlaceholder} mediaUploaderUploadComplete":function(){a.trigger("composerSubmitUnlock")},"{galleryUploadPlaceholder} mediaUploaderFileUploaded":function(n,e,t,a,i){void 0===p&&(p=d.getBlockHandler("image"));var r=a.id,s=i.response.media.meta,l=d.block.of(n),i=d.data(l);setTimeout(function(){var e=c.galleryItem().where("fileId",r).removeAttr("data-file-id"),t=e.attr("data-id");mediaUploader.removeItem(a,e);var o=c.createGalleryImage(l,s);e.html(o);e=s.uri,e=mediaManager.getVariation(e,"icon");i.items[t]={title:s.title,iconUrl:e.url},p.normalizeImageSize(o),l.is(u)&&c.populateList(l),0==c.uploadedItems&&c.setPrimary(t),c.uploadedItems+=1;t=c.uploadedItems/c.addedItems*100;n.find(c.galleryProgressBar).css("width",t+"%"),100==t&&setTimeout(function(){n.find(c.galleryProgressBar).css("width","0%"),c.uploadedItems=0,c.addedItems=0,n.removeClass("state-uploading")},1e3)},600)},setPrimary:function(e){var t=c.galleryItem().where("id",e),o=c.galleryMenuItem().where("id",e),t=d.block.of(t);d.data(t).primary=e,c.populateList(t),c.galleryMenuItem.inside(t).removeClass("active"),o.addClass("active")},setRatio:function(e,t){var o;d.data(e).ratio=t,c.galleryStage.inside(e).css("padding-top",r(1/f(t)*100,o||3)+"%"),c.galleryImage.inside(e).each(function(){var e=m(this);p.setImageRatio(e,f(t))})},updateRatio:function(e,t){c.setRatio(e,t),c.populateRatio(e)},populateRatio:function(e){e=d.data(e).ratio;c.ratioLabel().html(e)},"{ratioButton} click":function(e){c.sizeFieldset().switchClass(s)},"{ratioCustomizeButton} click":function(e){c.sizeFieldset().switchClass(l)},"{ratioCancelButton} click":function(e){c.sizeFieldset().removeClass(s)},"{ratioCancelCustomButton} click":function(e){c.sizeFieldset().switchClass(s)},"{ratioOkCustomButton} click":function(e){c.sizeFieldset().removeClass(l)},"{ratioUseCustomButton} click":function(e){var t=function(e){if(e=i.trim(e),/\:/.test(e)){var t=e.split(":");return parseInt(t[0])+":"+parseInt(t[1])}return parseFloat(e)||0}(c.ratioInput().val());0!=t&&(c.updateRatio(u,t),c.ratioSelection().removeClass("active"),c.sizeFieldset().removeClass(l))},"{ratioSelection} click":function(e){c.ratioSelection().removeClass("active"),e.addClass("active"),c.sizeFieldset().removeClass(s);e=e.data("value");c.updateRatio(u,e)},setResizeStrategy:function(e,o){d.data(e).strategy=o,c.galleryImage.inside(e).each(function(e){var t=m(this);(p=void 0===p?d.getBlockHandler("image"):p).resizeToViewport(t,o)})},updateResizeStrategy:function(e,t){c.setResizeStrategy(e,t),c.populateResizeStrategy(e)},populateResizeStrategy:function(e){e=d.data(e).strategy;c.strategyMenuItem().removeClass("active").where("strategy",e).addClass("active")},"{strategyMenuItem} click":function(e){e=e.data("strategy");c.updateResizeStrategy(u,e)},listItems:{},populateList:function(e){var a=d.data(e),e=c.galleryItem.inside(e),i=[];e.each(function(){var e,t=m(this),o=t.attr("data-id"),n=a.items[o];n&&c.galleryImage.inside(t).length&&((e=c.listItems[o])||((e=c.createGalleryListItem()).attr("data-id",o),c.listItemTitle.inside(e).text(n.title),c.listItemIcon.inside(e).attr("src",n.iconUrl),c.listItems[o]=e),o=o==a.primary,e.toggleClass("is-primary",o).toggleClass("active",t.hasClass("active")),i.push(e))}),c.itemsFieldset().toggleClass("is-empty",!i.length),c.listItemGroup().empty().append(i),c.swiper.init()},"{listItem} click":function(e){var t=e.data("id");c.listItem().removeClass("active"),e.addClass("active");e=c.galleryItem().where("id",t),t=c.getGalleryItemIndex(u,e),e=c.galleryContainer.of(e);EasyBlog.ImageGallery.go(e,t),c.swiper.init(),c.swiper.slideTo(t)},getGalleryItemIndex:function(e,t){return c.galleryViewport.of(t).find(c.galleryItem.selector).index(t)},swiper:{init:function(){var e=u.attr("data-uid"),t=c.galleryContainer.inside(u).closest(".ebd-block[data-type=gallery][data-uid="+e+"]"),o=t.find("[data-eb-gallery-container]"),n=t.find(".eb-gallery-menu"),a=t.find(".eb-gallery-button.eb-gallery-next-button"),i=t.find(".eb-gallery-button.eb-gallery-prev-button"),r=t.data("swiper"),e=o.find(".eb-gallery-viewport").data("eb-gallery-initial-slide"),e=0<e?e:0;if(r)return r.update(),r;r=new Swiper(m(o),{pagination:{el:n,clickable:!0},navigation:{nextEl:a,prevEl:i},initialSlide:e});t.data("swiper",r)},slideTo:function(e){c.swiper.init().slideTo(e,!1,!1)}},"{listItemDeleteButton} click":function(e){var t,o,n,a=c.listItem(".active");a.length&&(o=a.data("id"),(n=(t=c.galleryItem().where("id",o)).prev()).length&&(n=n.next()),a=d.block.of(t),t.remove(),c.galleryMenuItem().where("id",o).remove(),o=c.galleryContainer.inside(a),n=c.getGalleryItemIndex(n),EasyBlog.ImageGallery.setLayout(o),EasyBlog.ImageGallery.go(o,n),c.populateList(a))},"{listItemPrimaryButton} click":function(e){var t=c.listItem(".active");t.length&&(t=t.data("id"),c.setPrimary(t))},hasThumbnails:function(e){return!1},"{galleryBrowseButton} mediaSelect":function(e,t,o,n){"image"==o.meta.type&&c.constructGallery(u,[o])},"{self} mediaInsertGallery":function(e,t,o){var n;a.document.isLegacy()?(n=c.toLegacyHTML(o),a.document.insertContent(n)):(n=d.constructBlock("gallery",o),d.addBlock(n),c.constructGallery(n,o))},"{self} composerBlockDuplicate":function(e,t,a,o){var i;"gallery"==d.getBlockType(a)&&(a.removeAttr("data-uid"),d.setBlockUid(a),o=d.data(o),o=m.extend(!0,{},o),d.setBlockData(a,o),i=d.data(a),m.each(i.itemsKeyArray,function(e,t){var o=i.items[t],n=m.uid("g");t==i.primary&&(i.primary=n),delete i.items[t],delete i.itemsArray[t],delete i.itemsKeyArray[e],i.items[n]=o,i.itemsArray[n]=o,i.itemsKeyArray[e]=n,a.find("[data-id="+t+"]").attr("data-id",n)}))}}}),e.resolve()})}),EasyBlog.module("composer/blocks/handlers/giphy",function(c){EasyBlog.Controller("Composer.Blocks.Handlers.Giphy",{defaultOptions:{"{browseButton}":"[data-giphy-browse]","{browser}":"[data-giphy-browser]","{item}":"[data-giphy-item]","{gifsTab}":"[data-giphy-gifs-tab]","{stickersTab}":"[data-giphy-stickers-tab]","{container}":"[data-giphy-container]","{search}":"[data-giphy-search]","{trending}":"[data-giphy-trending]","{gifsList}":"[data-gifs-list]","{stickersList}":"[data-stickers-list]","{imgElement}":"[data-giphy-item-preview] img","{aElement}":"[data-giphy-item-preview] a","{alignment}":"[data-giphy-alignment-fieldset]","{alignmentItem}":"[data-alignment-item]"}},function(r,e,t,a,s,l,i){return{init:function(){s=r.blocks,a=s.composer,l=e.meta,i=c()},toData:function(e){return s.data(e)},toText:function(e){},toEditableHTML:function(e){return""},toHTML:function(e){},activate:function(e){s.getBlockContent(e);var t=s.data(e);i=e,r.populate(t)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){var t=s.data(e);t.url&&r.setGiphyItem(t.url,t.alignment,e)},deconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){var t;r.initialized.gifs||(t=r.browser().find("[data-gifs-list]"),r.initialized.gifs=!0,r.loadGiphy("","gifs",t)),r.updateAlignmentFieldset(void 0,e.alignment),r.alignment().addClass("t-d--none"),e.url&&r.alignment().removeClass("t-d--none")},initialized:{gifs:!1,stickers:!1},loadGiphy:function(e,o,n){var a=s.data(i);r.container().addClass("is-loading"),r.container().removeClass("is-empty"),n.html(""),EasyBlog.ajax("site/views/giphy/search",{query:e,type:o}).done(function(e,t){r.container().removeClass("is-loading"),e?(a.currentView==o&&n.removeClass("t-d--none"),n.html(t)):r.container().addClass("is-empty")})},"{gifsTab} click":function(e,t){var o=s.data(i);o.currentView="gifs",r.show(e,"gifs"),r.search().val(o.currentQuery.gifs),r.hide("stickers")},"{stickersTab} click":function(e,t){var o=s.data(i);o.currentView="stickers",r.initialized.stickers||(r.initialized.stickers=!0,r.loadGiphy("","stickers",r.stickersList())),r.show(e,"stickers"),r.search().val(o.currentQuery.stickers),r.hide("gifs")},show:function(e,t){var o=r.browser().find("[data-"+t+"-list]"),t=r.browser().find("[data-"+t+"-panel]");e.addClass("active"),t.addClass("active"),o.removeClass("t-d--none")},hide:function(e){var t=r.browser().find("[data-giphy-"+e+"-tab]"),o=r.browser().find("[data-"+e+"-panel]"),e=r.browser().find("[data-"+e+"-list]");t.removeClass("active"),o.removeClass("active"),e.addClass("t-d--none")},setAlignment:function(e,t){var o=s.data(i);/left|right/.test(t)&&(e.css("float",t),i.css("text-align","")),/center/.test(t)&&(e.css("float",""),i.css("text-align","center")),o.alignment=t},updateAlignmentFieldset:function(e,t){t=t||"center",e=void 0===e?r.alignment().find('[data-alignment-item][data-type="'+t+'"]'):e,r.alignmentItem().removeClass("active"),e.addClass("active")},"{alignmentItem} click":function(e,t){var o=s.getBlockContent(i).find("[data-giphy-item-preview]"),n=e.data("type");r.updateAlignmentFieldset(e,n),r.setAlignment(o,n)},"{item} click":function(e,t){var o=s.data(i),e=e.data("original");o.url=e,r.setGiphyItem(e,"center",i),r.updateAlignmentFieldset(void 0,"center"),r.alignment().removeClass("t-d--none")},"{browseButton} click":function(e,t){var o=a.manager(),n=o.find("[data-eb-composer-toggle-sidebar]");o.addClass("is-sidebar-open"),n.addClass("is-active")},setGiphyItem:function(e,t,o){var n=s.getBlockContent(o),a=c(l.preview),o=r.imgElement.inside(a),i=r.aElement.inside(a);o.attr("src",e),n.empty().append(a),i.addClass("is-loading"),o.off("load").on("load",function(){i.removeClass("is-loading")}),r.setAlignment(a.find("[data-giphy-item-preview]"),t)},"{search} keyup":c.debounce(function(e,t){var o=s.data(i),n=e.val(),a=r.trending(),e=o.currentView;o.currentQuery[e]=n;o=r.browser().find("[data-"+e+"-list]");o.addClass("t-d--none"),a.removeClass("t-d--none"),""!=n&&a.addClass("t-d--none"),r.loadGiphy(n,e,o)},500)}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/gist",function(l){EasyBlog.Controller("Composer.Blocks.Handlers.Gist",{defaultOptions:l.extend({"{form}":"> [data-gist-form]","{insert}":"[data-gist-insert]","{source}":"[data-gist-source]","{preview}":"[data-gist-preview]","{fsSource}":"[data-fs-gist-source]","{fsRefreshButton}":"[data-fs-gist-refresh]","{errorMessage}":"[data-gist-error]"},EBD.selectors)},function(a,e,t,i,r,s,o){return{init:function(){r=a.blocks,i=r.composer,s=e.meta,o=l()},toData:function(e){return r.data(e)},toText:function(e){return r.data(e).source},toEditableHTML:function(e){return""},toHTML:function(e){r.data(e);e=e.data("overlay");if(e)return e.element().html()},activate:function(e){r.getBlockContent(e),r.data(e);o=e,a.populate(e)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){var t=r.data(e),o=e.data("overlay"),n=r.getBlockContent(e);t.source&&!o?(n.empty(),a.createIframe(e,t.source)):n.html(s.html),e.find(a.source.selector).off("paste").on("paste",function(e){e.stopPropagation()})},deconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){e=r.data(e);a.fsSource().val(e.source)},setOverlay:function(e,t){var o,n=e.data("overlay");n?(n.element().empty(),n.element().append(t)):(n=i.document.overlay.create(e),o=r.getBlockContent(e),n.placeholder().css("height","400px").appendTo(o),n.element().append(t),n.attach()),e.data("overlay",n)},isUrlValid:function(e){if(""==e)return!1;return/^https:\/\/gist\.github\.com\/(.*)\/(.*)$/.test(e)},createIframe:function(e,t){var o=document.createElement("iframe"),n=r.getBlockContent(e);r.data(e).source=t,o.setAttribute("width","100%"),o.id="gistFrame",a.setOverlay(e,o);e='<html><body onload="parent.'+l.callback(function(e){e+="px",n.find("iframe").css("height",e)})+'(document.body.scrollHeight);"><script type="text/javascript" src="'+t+'.js"><\/script></body></html>',t=o.document;return o.contentDocument?t=o.contentDocument:o.contentWindow&&(t=o.contentWindow.document),t.open(),t.writeln(e),t.close(),o},"{insert} click":function(e){o.length<1&&(t=a.block.of(e),r.activateBlock(t));var e=r.getBlockContent(o),t=a.source.inside(e).val();r.data(o);a.isUrlValid(t)?(a.fsSource().val(t),a.createIframe(o,t),a.form.inside(e).addClass("hidden")):a.errorMessage().removeClass("hide")},"{fsRefreshButton} click":function(){var e=r.getBlockContent(o),t=a.fsSource().val();r.data(o);a.isUrlValid(t)?(a.createIframe(o,t),a.form.inside(e).addClass("hidden")):a.errorMessage.inside(e).removeClass("hide")}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/heading",function(a){EasyBlog.Controller("Composer.Blocks.Handlers.Heading",{defaultOptions:{"{headingElement}":"h1, h2, h3, h4, h5, h6","{levelSelection}":"[data-eb-composer-block-heading-level] [data-level]"}},function(i,e,t,o,r,n,s){return{init:function(){r=i.blocks,r.composer,n=e.meta,s=a()},activate:function(e){var t;s=e,content=i.getContent(e),content=a.trim(content),content==n.data.default&&(t=r.getBlockContent(e),i.headingElement.inside(t).html("<br>").focus()),i.toggleFontSizeMenu(!1),i.populate(e)},deactivate:function(e){content=i.getContent(e),content=a.trim(content),0!=content.length&&" "!=content||(e=r.getBlockContent(e),i.headingElement.inside(e).html(n.data.default)),i.toggleFontSizeMenu(!0)},construct:function(e){return a.create(e.level).html(e.content)},reconstruct:function(e){},deconstruct:function(e,t){return t&&(e=e.clone()),i.headingElement.inside(e).editable(!1),e},refocus:function(e){},reset:function(e){e.html(n.content)},populate:function(e){e=i.level(e);i.levelSelection().where("level",e).activateClass("active")},toggleFontSizeMenu:function(e){var t=a("[data-eb-font-size-menu]");1==e?t.show():t.hide()},toData:function(e){return r.getData(e)},toHTML:function(e){e=r.getBlockContent(e);return i.deconstruct(e,!0).html()},toText:function(e){return e.text()},heading:{inside:function(e){return e.children(":first")}},getHeading:function(e){e=r.getBlockContent(e);return i.headingElement.inside(e)},level:function(e,t){var o=r.getBlockContent(e),n=i.headingElement.inside(o),a=n.tagName();return t&&a!==t&&(o.html(i.construct({level:t,content:n.html()})),i.headingElement.inside(e).editable(!0),a=t),a},getContent:function(e){var t=i.getHeading(e),e=t.text();return e=""==e?t.text():e},updateFontFamily:function(e,t){i.getHeading(e).css("fontFamily",t)},setLevel:function(e,t){t=i.level(e,t),t=i.headingElement.inside(e),t=[e,i,t];i.trigger("composerBlockHeadingSetLevel",t),i.trigger("composerBlockChange",t)},previewLevel:function(e,t){clearTimeout(i.previewTimer);var o=i.headingElement.inside(e),n=o.tagName();e.defineData("originalLevel",n).addClass("is-preview"),i.level(e,t);o=[e,i,o];i.trigger("composerBlockHeadingPreviewLevel",o),i.trigger("composerBlockChange",o)},previewTimer:null,"{levelSelection} mouseover":function(e){e.data("level")},"{levelSelection} mouseout":function(e){clearTimeout(i.previewTimer),i.previewTimer=setTimeout(function(){var e=s.data("originalLevel");e&&i.setLevel(s,e)},50)},"{levelSelection} click":function(e){e=e.data("level");i.setLevel(s,e),i.refocus(s)},"{self} composerBlockFontFamilyUnpreview":function(e,t,o,n){s.data("uid")==n.data("uid")&&i.updateFontFamily(s,o)},"{self} composerBlockFontFamilyPreview":function(e,t,o,n,a){s.data("uid")==a.data("uid")&&i.updateFontFamily(s,o)},"{self} composerBlockFontFamilyChange":function(e,t,o,n){s.data("uid")==n.data("uid")&&i.updateFontFamily(s,o)},"{self} composerBlockHeadingSetLevel":function(e,t,o,n,a){clearTimeout(i.previewTimer),o.removeClass("is-preview").removeData("originalLevel"),o.is(s)&&i.populate(o)},"{self} composerBlockDuplicate":function(e,t,o,n){"heading"!=r.getBlockType(o)||(n=n.attr("style"))&&o.attr("style",n)}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/html",function(e){var t=this;EasyBlog.require().library("ace").done(function(l){EasyBlog.Controller("Composer.Blocks.Handlers.Html",{defaultOptions:{"{pre}":"[data-eb-composer-blocks-html-pre]","{imageWidth}":"[data-html-width]","{imageWidthTextField}":"#imageWidth","{imageHeight}":"[data-html-height]","{imageHeightTextField}":"#imageHeight"}},function(a,e,t,n,i,r,s){return{init:function(){i=a.blocks,n=i.composer,r=e.meta,s=l(),syncing=!1,sessionSync=!1},activate:function(e){s=e,a.populate(e)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){},deconstruct:function(e){},refocus:function(e){},reset:function(e){},toText:function(e){i.data(e);e=e.clone();return i.getBlockContent(e).text()},toData:function(e){return i.data(e)},toHTML:function(e){i.data(e);e=e.clone(),e=i.getBlockContent(e);return a.editor().getSession().setValue(e.html()),e.html()},editor:function(){var e=n.find(a.pre)[0];null==e&&(e=l.create("pre")[0]);e=ace.edit(e);e.setTheme("ace/theme/github");var o=e.getSession();return o.setMode("ace/mode/html"),sessionSync||(o.on("change",l.debounce(function(){var e=i.data(s),t=o.getValue();""==(e.original=t)||(t=l("<div>"+t+"</div>")).find(".ebd-block").length&&(t.find(".ebd-block").removeClass("ebd-block"),t=l(t).html(),e.original=t,o.setValue(t)),a.sync(e.original)},500)),sessionSync=!0),e},populate:function(e){var t=a.editor().getSession(),o=i.getBlockContent(e),n=l.trim(o.html());""==n&&(n=r.html);o=i.data(e);o.original?t.setValue(o.original):t.setValue(n),a.populateFieldsetValue(e),s=e},populateFieldsetValue:function(e){e=i.data(e);a.imageWidth().val(e.imageWidth),a.imageHeight().val(e.imageHeight)},"{imageWidthTextField} keyup":l.debounce(function(e){var t=i.data(s),e=e.val();i.getBlockContent(s);t.imageWidth=e}),"{imageHeightTextField} keyup":l.debounce(function(e){var t=i.data(s),e=e.val();i.getBlockContent(s);t.imageHeight=e}),sync:function(e){var t;syncing||(syncing=!0,t=i.getBlockContent(s),0<e.length&&t.html(e),syncing=!1)},reset:function(e){}}}),t.resolve()})}),EasyBlog.module("composer/blocks/handlers/image",function(p){function g(e){return e.toString().match("%")?"%":"px"}function o(e,t){t=Math.pow(10,t);return Math.round(e*t)/t}function v(e){if(p.isNumeric(e))return e;if(null==e)return"1:1";e=e.toString().split(":");return e[0]+":"+e[1]}function b(e,t){return o(1/v(e)*100,t||3)+"%"}function m(e,t){return o(100*e,t||3)+"%"}function y(e,t){return e.css("width",t)}function k(e,t){return e.css("padding-top",t)}function w(e,t){return e.css("height",t)}var e=this,i=/fit|fill/,C="is-fluid",n="is-loading",B=p.Image.resizeWithin,x=p.Image.resizeToFill;EasyBlog.require().library("plupload2","imgareaselect").done(function(){EasyBlog.Controller("Composer.Blocks.Handlers.Image",{elements:["[data-eb-composer-image-{placeholder|browse-button}]","[data-eb-image-{url-fieldset|url-field|url-field-text|url-field-update-button}]","[data-eb-image-{source-fieldset|source-field|source-thumbnail|source-title|source-size|source-url|source-change-button}]","[data-eb-image-{variation-field|variation-list-container|variation-new-button|variation-create-button|variation-rebuild-button|variation-delete-button|variation-cancel-button|variation-cancel-failed-button}]","[data-eb-image-source-fieldset] [data-eb-mm-{variation-list|variation-list-item-group|variation-item}]","[data-eb-image-{variation-name|variation-width|variation-height}]","[data-eb-image-{ratio-button|ratio-label|ratio-customize-button|ratio-cancel-button|ratio-use-custom-button|ratio-cancel-custom-button|ratio-selection|ratio-preview|ratio-input}]","[data-eb-image-{map|map-container|map-figure|map-viewport|map-preview|map-picker}]","[data-eb-image-{strategy-menu-item|strategy-menu-content}]","[data-eb-image-{resize-input-field|resize-ratio-lock|resize-reset-button}]","[data-eb-image-{style-toggle|style-selection}]","[data-eb-image-{caption-toggle|caption-text-field|caption-alignment}]","[data-eb-image-{alt-toggle|alt-text-field}]","[data-eb-image-{popup-toggle|popup-fieldset|popup-field|popup-thumbnail|popup-title|popup-size|popup-url|popup-change-button}]","[data-eb-image-{popup-variation-field|popup-variation-list-container}]","^popup [data-eb-image-popup-fieldset] [data-eb-mm-{variation-list|variation-list-item-group|variation-item}]"],defaultOptions:p.extend({uploader:{runtimes:"html5,flash",url:"/echo/json",max_file_size:"10mb",filters:[{title:"Image files",extensions:"jpg,gif,png"}]},"{browseButton}":".eb-composer-placeholder-image [data-eb-mm-browse-button]","{urlButton}":".eb-composer-placeholder-image [data-eb-insert-url-button]","{imagePlaceholder}":"[data-eb-composer-image-placeholder]","{imageContainer}":".eb-image","{imageFigure}":".eb-image-figure","{imageViewport}":".eb-image-viewport","{imageElement}":".eb-image-figure img","{imagePopupButton}":".eb-image-popup-button","{imageCaption}":".eb-image-caption","{imageCaptionText}":"[data-image-caption-text]","{imageHint}":".eb-image-hint","{pictureElement}":".eb-image-figure picture","{fieldsets}":"[data-eb-image-fieldset]","{imageSizeFieldset}":"[data-eb-image-fieldset-size]","{responsive}":"[data-eb-image-responsive]","{width}":"[data-eb-image-width]","{height}":"[data-eb-image-height]","{lockRatio}":"[data-eb-image-lock-ratio]","{alignmentFieldset}":"[data-eb-image-alignment]","{alignmentItem}":"[data-eb-image-alignment-selection] [data-alignment-item]","{previewImage}":"[data-eb-preview-imageurl]","{link}":"[data-eb-image-link]","{linkUrl}":"[data-eb-image-link-url]","{imageUrlForm}":"[data-eb-image-url-form]","{imageUrlTextbox}":"[data-eb-image-url-textbox]","{imageUrlAdd}":"[data-eb-image-url-add]","{imageUrlCancel}":"[data-eb-image-url-cancel]"},EBD.selectors)},function(f,e,t,l,h,s,c,d,o){function u(e){return"image"==h.getBlockType(e)}return{init:function(){h=f.blocks,l=h.composer,s=e.meta,c=p(),d=EasyBlog.MediaManager,o=l.panels.fieldset},deactivate:function(e){},activate:function(e){(c=e).hasClass("is-new")&&e.css("text-align","center"),f.populate(e)},construct:function(e){var t=h.createBlockContainer("image"),e=p.extend(h.data(t),e),o=h.getBlockContent(t).empty(),e=f.constructImage(e);return o.append(e),t.css("text-align","center"),t},constructFromMediaFile:function(e){var e=e.data("key"),e=d.getUri(e),o=h.createBlockContainer("image"),n=h.getBlockContent(o),a=h.data(o);return o.css("text-align","center"),o.addClass("is-loading"),d.getMedia(e).done(function(e){var t=e.meta,e=d.getVariation(t.uri,"thumbnail");a.uri=t.uri,a.url=e.url,a.simple="simple",a.ratio_lock=!0,a.variation=e.key;e=f.constructImage(a);n.html(e),o.hasClass("active")&&f.populate(o)}).fail(function(){var e=p(s.html);e.addClass("state-failed"),n.html(e)}).always(function(){o.removeClass("is-loading")}),o},constructImage:function(e){var t,o,n,a=p(s.imageContainer),i=f.imageFigure.inside(a),r=f.imageElement.inside(a);return r.attr("src",e.url),e.fluid&&a.addClass(C),a.addClass("style-"+e.style),"webp"==e.extension&&(t=r.closest("a"),o=p("<picture></picture>"),n=p("<source>"),t.append(o),n.attr("srcset",e.url),n.attr("type","image/webp"),r.attr("src",e.fallbackItem.url),o.append(n),n.after(r)),e.alignment&&(/left|right/.test(e.alignment)&&a.css("float",e.alignment),/center/.test(e.alignment)&&a.css("float","")),e.caption_text&&(a.append(s.imageCaption),f.imageCaptionText.inside(a).html(e.caption_text)),e.popup_url&&((r=p(s.imagePopupButton)).attr("href",e.popup_url),i.append(r)),a},toData:function(e){return h.data(e)},toHTML:function(e){if(!f.hasImage(e))return"";e=e.clone(),e=f.deconstruct(e);return h.getBlockContent(e).html()},toLegacyHTML:function(e){var t=f.toData(e),e=p("<img>").attr({src:t.url,width:t.width,height:t.height});return t.caption_text&&e.addClass("easyblog-image-caption").attr("title",t.caption_text),t.alt_text&&e.attr("alt",t.alt_text),t.popup_url&&e.attr("data-popup",t.popup_url),t.style&&e.attr("data-style",t.style),t.alignment&&e.attr("align",t.alignment),(t.link_url?p("<a>").attr({href:t.link_url,title:t.link_title,target:t.link_target}).append(e):e).prop("outerHTML")},toText:function(e){return f.imageCaptionText.inside(e).text()+"\n"+f.imageElement.inside(e).attr("alt")},reconstruct:function(e){e=f.imagePlaceholder.inside(e);0<e.length&&EasyBlog.MediaManager.uploader.register(e)},hasImage:function(e){return 0<f.imageContainer.inside(e).length},"{imagePlaceholder} mediaUploaderFilesAdded":function(e,t,o,n){EasyBlog.MediaManager.uploader.addItem(n[0],e)},"{imagePlaceholder} mediaUploaderFileUploaded":function(e,t,o,n,a){a=a.response.media.meta,e=h.block.of(e);f.updateImageSource(e,a)},"{sourceChangeButton} mediaSelectStart":function(e){var t=c.data("uid");e.data("uid",t)},"{sourceChangeButton} mediaSelect":function(e,t,o){var n,a,i;"image"==o.meta.type&&(n=c.data("uid"),a=e.data("uid"),e=o.meta,(o=l.document).isLegacy()?(content=f.toLegacyHTML(i),o.insertContent(content)):n!=a?(i=h.getBlock(a),f.setImageSource(i,e)):f.updateImageSource(c,e))},"{previewImage} click":function(e){var t=f.sourceUrl().text();window.open(t)},"{browseButton} mediaSelect":function(e,t,o,n){var a=h.block.of(e);"image"==o.meta.type&&(e=h.data(a),e=p.extend(e,n),(e=l.document).isLegacy()?(content=f.toLegacyHTML(a),e.insertContent(content)):(f.setImageSource(a,o),h.activateBlock(a)))},"{self} mediaInsert":function(e,t,o,n,a,i){if("image"==o.meta.type){var r=l.document,s=r.isLegacy();if(f.normalizeImageSize(n),s){s=h.data(n);return a=p.extend(s,a),content=f.toLegacyHTML(n),void r.insertContent(content)}a=f.formatImageData(a,o.meta);n=h.constructBlock("image",a);h.addBlock(n),i||(h.activateBlock(n),a=a.link,f.triggerLinkChange(a))}},deconstruct:function(e){return f.imageCaptionText.inside(e).editable(!1),e},refocus:function(e){},reset:function(e){},populate:function(e){var t=f.hasImage(e);h.panel.fieldgroup.get("image").toggleClass("is-new",!t),t&&(f.populateImageUrl(e),f.populateImageSource(e),f.populateImageSize(e),f.populateImageAlignment(e),f.populateImageCaption(e),f.populateImageAlt(e),f.populateImageLink(e),f.populateImageStyle(e),f.populateImageResponsive(e))},showImageHint:function(e,t){f.imageHint.inside(e).remove();var o=p(s.imageHint);o.find(".eb-hint-text").html(t),f.imageViewport.inside(e).append(o),o.removeClassAfter("is-new",1e3),setTimeout(function(){o.remove()},2500)},setImageSource:function(e,t){var o=h.data(e),o=f.formatImageData(o,t),t=f.constructImage(o);h.getBlockContent(e).empty().append(t),f.setImageAlignment(e,o.alignment)},formatImageData:function(e,t){var o=e.variation,n="";void 0!==t.params&&(o=(void 0!==(a=JSON.parse(t.params)).variation?a:e).variation,n=void 0!==a.extension?a.extension:"");var a=d.getVariation(t.uri,o);return e.variation=a.key,e.url=a.url,e.uri=t.uri,e.natural_width=a.width,e.natural_height=a.height,e.natural_ratio=a.width/a.height,e.extension=n||"","webp"==e.extension&&(e.fallbackItem=t.fallbackItem.meta,e.fallbackItem.variation=d.getVariation(e.fallbackItem.uri,o),e.fallbackItem.url=e.fallbackItem.variation.url),e},updateImageSource:function(e,t){f.setImageSource(e,t),f.populate(e)},getSourceThumbnailImage:function(e){return p("<img>").attr("src",e)[0]},populateImageUrl:function(e){var t=h.data(e),e=f.urlFieldset();e.removeClass("t-hidden"),t.isurl?f.urlFieldText().val(t.url):e.addClass("t-hidden")},populateImageSource:function(o){var e=h.data(o),t=f.sourceFieldset();t.removeClass("hidden"),e.isurl?t.addClass("hidden"):(e=e.uri,(t=f.sourceFieldset()).addClass(n),d.getMedia(e).done(function(e){var t=e.meta;f.sourceThumbnail().css("background-image","url("+t.preview+")"),f.sourceTitle().text(t.title);e=p(e.variations);f.variationListContainer().empty().append(e),f.populateImageVariation(o)}).fail(function(){t.addClass("is-failed")}).always(function(){t.removeClass(n)}))},populateImageVariation:function(t){var o=h.data(t),t=o.uri,o=o.variation;const n=d.getVariation(t,o);if(n){const a=f.variationItem().where("key",'"'+o+'"').activateClass("active");f.sourceSize().text(p.plupload2.formatSize(n.size||""));let e=n.url;!e||n.url.includes("http://")||n.url.includes("https://")||(e=window.ezb.rootUrl+"/"+e),f.sourceUrl().text(e);t=a.hasClass("is-system"),o=a.hasClass("is-missing");f.variationField().toggleClass("can-delete",!t).toggleClass("is-missing",o)}else console.error("Variation could not be retrieved because media meta does not exist in library!")},setImageVariation:function(e,t){var o=h.data(e),n=o.uri,a=d.getVariation(n,t);void 0!==a&&(o.url=a.url,f.imageElement.inside(e).attr("src",a.url),"webp"==o.extension&&(n=f.pictureElement.inside(e),o.fallbackItem.variation=d.getVariation(o.fallbackItem.uri,t),o.fallbackItem.url=a.url,n.find("source").attr("srcset",a.url),f.imageElement.inside(e).attr("src",o.fallbackItem.url)),f.showImageHint(e,p.String.capitalize(a.name)+'<br/><span style="font-weight: normal;">'+a.width+"x"+a.height+"</span>"),o.variation=t,o.ratio_lock,f.isInsideThumbnailBlock(e)||(f.setImageWidth(e,a.width),f.setImageHeight(e,a.height)),f.width().val(a.width),f.height().val(a.height))},isInsideThumbnailBlock:function(e){return 0<e.parent().parent(".eb-thumb").length},updateImageVariation:function(e,t){f.setImageVariation(e,t),f.populateImageVariation(e)},"{variationItem} click":function(e){e=e.data("key");f.updateImageVariation(c,e)},"{variationNewButton} click":function(e){f.variationField().addClass("show-create-form");var t=h.data(c).uri,o=d.getVariation(t,"system/original"),n=o.width,t=o.height,o=n/t;f.variationWidth().val(n).data("value",n).data("ratio",o),f.variationHeight().val(t).data("value",t).data("ratio",o)},"{variationCancelButton} click":function(e){f.variationField().removeClass("show-create-form")},"{variationCreateButton} click":function(e){var t,o,n=f.variationField(),a=p.trim(f.variationName().val()),i=f.variationWidth().val(),r=f.variationHeight().val();""!=p.trim(a)&&(n.addClass("is-creating"),t=c,o=h.data(t).uri,d.createVariation(o,a,i,r).done(function(e){e=p(e.variations);f.variationListContainer().empty().append(e),f.populateImageVariation(t),n.removeClass("show-create-form")}).fail(function(){n.removeClass("is-creating").addClass("is-failed")}).always(function(){n.removeClass("is-creating")}))},"{variationCancelFailedButton} click":function(){f.variationField().removeClass("is-failed")},"{variationRebuildButton} click":function(e){var o=h.data(c).uri,t=f.variationItem(".active").data("key"),n=d.getVariation(o,t).name,t=d.getKey(o);EasyBlog.ajax("site/views/mediamanager/rebuildVariation",{name:n,key:t}).done(function(e){var t=p(e.variations);f.variationListContainer().empty().append(t),f.populateImageVariation(c),d.setMedia(o,e)})},"{variationDeleteButton} click":function(e){var t=h.data(c).uri,o=f.variationItem(".active").data("key"),o=d.getVariation(t,o).name;d.removeVariation(t,o).done(function(e){e=p(e.variations);f.variationListContainer().empty().append(e);e=d.getVariation(t,"thumbnail");f.updateImageVariation(c,e.key)})},"{variationWidth} input":function(e){var t=e.data("ratio"),e=Math.round(parseFloat(e.val()));p.isNumeric(e)&&(t=Math.round(e/t),f.variationHeight().val(t))},"{variationHeight} input":function(e){var t=e.data("ratio"),e=Math.round(parseFloat(e.val()));p.isNumeric(e)&&(t=Math.round(e*t),f.variationWidth().val(t))},"{variationWidth} focus":function(e){e.select()},"{variationHeight} focus":function(e){e.select()},"{variationWidth} blur":function(e){var t,o,n=e.data("ratio"),a=Math.round(parseFloat(e.val()));e.val(a),p.isNumeric(a)||(t=f.variationHeight(),o=Math.round(parseFloat(t.val())),p.isNumeric(o)?(a=Math.round(o*n),e.val(a),t.val(o)):f.resetVariationFields())},"{variationHeight} blur":function(e){var t,o,n=e.data("ratio"),a=Math.round(parseFloat(e.val()));e.val(a),p.isNumeric(a)||(t=f.variationWidth(),o=Math.round(parseFloat(t.val())),p.isNumeric(o)?(a=Math.round(o/n),t.val(o),e.val(a)):f.resetVariationFields())},resetVariationFields:function(){var e=f.variationWidth(),t=f.variationHeight();e.val(e.data("width")),t.val(t.data("height"))},populateImageSize:function(n){function a(){var e=h.data(n),t=parseInt(f.getImageWidth(n)),o=parseInt(f.getImageHeight(n));f.width().val(t),f.height().val(o),e.width_lock&&e.height_lock?f.fieldsets("[data-type=simple]").addClass("t-hidden"):f.fieldsets("[data-type=simple]").removeClass("t-hidden"),f.lockRatio().prop("checked",e.ratio_lock)}var e=f.imageElement.inside(n);e[0].complete?(a(),h.data(n),f.imageSizeFieldset().removeClass("is-loading")):(e=e.attr("src"),f.imageSizeFieldset().addClass("is-loading"),p.Image.get(e).done(function(e,t){var o=h.data(n);o.natural_ratio=o.width/o.height,a()}).always(function(){f.imageSizeFieldset().removeClass("is-loading")}))},setImageSize:function(e,t,o){"width"==t&&f.setImageWidth(e,o),"height"==t&&f.setImageHeight(e,o)},updateImageSize:function(e,t,o){f.setImageSize(e,t,o),f.populateImageSize(e)},isFluidImage:function(e){return f.imageContainer.inside(e).hasClass(C)},isFixedImage:function(e){return!f.isFluidImage(e)},toFixedImage:function(e){var t=h.data(e),o=f.imageElement.inside(e),n=o.width(),o=o.height();f.setImageWidth(e,n),t.ratio_lock||f.setImageHeight(e,o)},toFluidImage:function(e){var t,o=h.data(e),n=f.imageContainer.inside(e),a=f.imageElement.inside(e);h.isRootBlock(e)&&(n=n.width(),t=e.width(),t=Math.round(n/t*100)+"%"),h.isNestedBlock(e)&&(t="100%");a=a.height();f.setImageWidth(e,t),o.ratio_lock||f.setImageHeight(e,a)},normalizeImageSize:function(e){var t,o=h.data(e),n=f.isFluidImage(e);h.isRootBlock(e)&&(t=f.imageFigure.inside(e).width()),h.isNestedBlock(e)&&(t=f.imageFigure.inside(e).width()),f.setImageWidth(e,t),!n&&"advanced"!=o.mode||f.toFluidImage(e)},resetImageSize:function(e){h.data(e).mode="simple";f.imageContainer.inside(e),f.imageFigure.inside(e),f.imageElement.inside(e);h.isNestedBlock(e)&&f.setImageWidth(e,e.css("width"))},getImageWidth:function(e){var t=f.imageFigure.inside(e),o=t[0].style;if(h.isRootBlock(e)){var n=f.imageContainer.inside(e)[0].style.width;if(/%/.test(n))return n}if(h.isNestedBlock(e)){e=e[0].style.width;if(/%/.test(e))return e}return o.width||t.css("width")},getImageHeight:function(e){e=f.imageFigure.inside(e);return e[0].style.height||e.css("height")},setImageWidth:function(e,t){var o=h.getData(e),n=g(t),a=parseFloat(t),i="%"==n,r="px"==n,s="simple"==o.mode,l="advanced"==o.mode,c=f.imageContainer.inside(e),d=f.imageElement.inside(e),u=(f.imageViewport.inside(e),f.imageFigure.inside(e)),p=(d.width(),d.height());i&&(o.fluid=!0,c.addClass(C)),r&&(o.fluid=!1,c.removeClass(C)),l&&f.toFixedElement(e),h.isRootBlock(e)&&(e.css("width",""),i&&(y(c,t),y(u,"100%"),s&&(y(d,"100%"),o.element_width="100%")),r&&(y(c,""),y(u,t),s&&(y(d,t),o.element_width=parseFloat(t)))),h.isNestedBlock(e)&&(i&&(y(e,t),y(u,""),s&&(y(d,"100%"),o.element_width="100%")),r&&(y(e,"auto"),y(u,t),s&&(y(d,t),o.element_width=parseFloat(t)))),o.width=i?t:a;var m=o.ratio,n=o.ratio_lock,c=o.natural_ratio;n?(c=s?c:m,i&&(w(u,""),k(u,b(c)),s&&(w(d,"100%"),o.element_height="100%"),o.height="100%"),r&&(w(u,a=a/v(c)),k(u,""),s&&(w(d,a),o.element_height=a),o.height=a,a=parseInt(o.height),f.height().val(a)),o.ratio=c,s&&(o.element_ratio=c)):(m=d.width()/p,i&&k(u,b(m)),r&&k(u,""),o.ratio=m,s&&(o.element_ratio=m)),l&&(f.toFluidElement(e),o=o.strategy,/fit|fill/.test(o)&&f.resizeToViewport(e,o));e=f.imageCaption.inside(e);i&&y(e,"100%"),r&&y(e,t)},setImageHeight:function(e,t){var o,n,a=h.data(e),t=parseFloat(t),i=a.ratio,r=a.ratio_lock,s=a.natural_ratio,l="simple"==a.mode,c="advanced"==a.mode,d=f.imageElement.inside(e),u=(f.imageViewport.inside(e),f.imageFigure.inside(e));f.isFluidImage(e)&&(r?(n=t*v(o=l?s:i),f.setImageWidth(e,n),f.toFluidImage(e),a.ratio=o,l&&(a.element_ratio=o)):(c&&f.toFixedElement(e),k(u,b(i=d.width()/t)),a.ratio=i,l&&(a.element_ratio=i),c&&(f.toFluidElement(e),c=a.strategy,/fit|fill/.test(c)&&f.resizeToViewport(e,c))),a.height="100%"),f.isFixedImage(e)&&(r?(n=t*v(o=l?s:i),f.setImageWidth(e,n),inputWidth=parseInt(n),f.width().val(inputWidth)):(w(u,t),w(d,t),a.height=t,a.element_width=parseFloat(t)))},"{imageCaptionText} input":function(e,t){e=e.text();f.captionTextField().val(e),h.data(c).caption_text=e},"{responsive} change":function(e,t){e=e.is(":checked");f.setImageResponsive(c,e)},"{self} composerBlockResizeStart":function(e,t,o,n){var a;u(o)&&f.hasImage(o)&&(a={width:(a=f.imageFigure.inside(o)).width(),height:a.outerHeight(),fluid:!1},o.data("initialImageSize",a))},"{self} composerBlockBeforeResize":function(e,t,o,n){function a(){var e=r.width+s;f.setImageWidth(o,e)}function i(){var e=r.height+l;f.setImageHeight(o,e)}var r,s,l;u(o)&&f.hasImage(o)&&(t.preventDefault(),r=o.data("initialImageSize"),t=n.originalSize,n=n.size,s=n.width-t.width,l=n.height-t.height,h.data(o).ratio_lock?(0==s?i:a)():(0!=s&&a(),0!=l&&i()),r.fluid&&f.toFluidImage(o),f.populateImageSize(o))},"{self} composerBlockResizeStop":function(e,t,o,n){u(o)&&f.hasImage(o)&&o.removeData("initialImageSize")},"{self} composerBlockNestIn":function(e,t,o){u(o)&&f.hasImage(o)&&(f.resetImageSize(o),f.populateImageSize(o))},"{self} composerBlockNestOut":function(e,t,o){u(o)&&f.hasImage(o)&&(f.resetImageSize(o),f.populateImageSize(o))},populateImageResponsive:function(e){var t=h.data(e).responsive;f.updateImageResponsive(e,t)},setImageResponsive:function(e,t){h.data(e).responsive=t,f.updateImageResponsive(e,t)},updateImageResponsive:function(e,t){f.imageFigure.inside(e).toggleClass("is-responsive",t)},setImageAlignment:function(e,t){var o=f.imageContainer.inside(e);/left|right/.test(t)&&(o.css("float",t),e.css("text-align","")),/center/.test(t)&&(o.css("float",""),e.css("text-align","center")),h.data(e).alignment=t},updateImageAlignment:function(e,t){f.setImageAlignment(e,t),f.populateImageAlignment(e)},populateImageAlignment:function(e){e=h.data(e).alignment;f.setActiveAlignment(e)},setActiveAlignment:function(e){e=f.alignmentItem().filter("[data-type="+e+"]");f.alignmentItem().removeClass("active"),e.addClass("active")},"{alignmentItem} click":function(e){e=e.data("type");f.setActiveAlignment(e),f.updateImageAlignment(c,e)},populateImageAdvancedFields:function(e){"advanced"===h.data(e).mode&&(f.populateImageResizeStrategy(e),f.populateImageResizeMap(e),f.populateImageResizeFields(e))},populateImageResizeStrategy:function(e){e=h.data(e).strategy;f.strategyMenuItem().where("strategy",e).activateClass("active"),f.strategyMenuContent().where("strategy",e).activateClass("active")},setImageRatio:function(e,t){var o,n,a=h.data(e);a.ratio=t,(a.ratio_lock=0!==t)&&(o="simple"==a.mode,n="advanced"==a.mode,o&&(a.element_ratio=t,f.normalizeImageSize(e)),n&&(a=a.strategy,i.test(a)?(f.normalizeImageSize(e),f.resizeToViewport(e,a)):(f.toFixedElement(e),f.normalizeImageSize(e),f.toFluidElement(e))))},setImageResizeStrategy:function(e,t){h.data(e).strategy=t,i.test(t)&&f.resizeToViewport(e,t)},updateImageResizeStrategy:function(e,t){f.setImageResizeStrategy(e,t),f.populateImageAdvancedFields(e)},resizeToViewport:function(e,t){var o=h.data(e),n=o.natural_width,a=o.natural_height,i=f.imageViewport.inside(e),r=i.width(),i=i.height(),t=("fit"==t?B:x)(n,a,r,i),n=o.element_width=m(t.width/r),a=o.element_height=m(t.height/i),i=o.element_top=m(t.top/i),r=o.element_left=m(t.left/r);f.imageElement.inside(e).css({width:n,height:a,top:i,left:r})},resizeToFillViewport:function(e){f.setImageResizeStrategy(e,"fill")},resizeToFitViewport:function(e){f.setImageResizeStrategy(e,"fit")},"{strategyMenuItem} click":function(e){e=e.data("strategy");f.updateImageResizeStrategy(c,e)},populateImageMode:function(e){var t=h.data(e),o=t.mode,t=t.mode_lock;h.isRootBlock(e)&&(o="simple",t=!0),f.imageSizeFieldset().toggleClass("mode-lock",t);t=f.imageSizePreset().removeClass("active").where("type",o).addClass("active"),t=p.trim(t.text());f.imageSizeCurrentPreset().html(t);o="preset-"+o;f.imageSizeFieldset().switchClass(o)},setImageMode:function(e,t){"simple"==t&&f.toSimpleImageMode(e),"advanced"==t&&f.toAdvancedImageMode(e)},toSimpleImageMode:function(e){var t=h.data(e);t.mode="simple",t.ratio=t.natural_ratio,t.ratio_lock=!0,t.element_width="",t.element_height="",t.element_top="",t.element_left="",f.imageElement.inside(e).css({width:"",height:"",top:"",left:""}),f.normalizeImageSize(e)},toAdvancedImageMode:function(e){var t=h.data(e);t.mode="advanced",t.ratio||(t.ratio=t.natural_ratio),t.element_ratio||(t.element_ratio=t.ratio),f.normalizeImageSize(e),f.resizeToFitViewport(e)},updateImageMode:function(e,t){f.setImageMode(e,t),f.populateImageSize(e)},"{imageSizePreset} click":function(e){e=e.data("type");f.updateImageMode(c,e)},populateImageResizeMap:function(e){var t,o,n,a,i=h.data(e);"custom"===i.strategy&&(n=(t=f.mapFigure()).width(),o=t.height(),e=(a=f.imageViewport()).width(),t=a.height(),a=f.mapViewport(),n=B(e,t,n,o),a.css(n),o=f.mapPreview(),n=f.createResizeHandleElements(a=["n","s","w","e","sw","se","nw","ne"]),a=f.createResizeHandleSelectors(a),o.hasClass("ui-resizable")&&o.resizable("destroy"),o.hasClass("ui-draggable")&&o.draggable("destroy"),o.css({backgroundImage:p.cssUrl(i.url),width:i.element_width,height:i.element_height,top:i.element_top,left:i.element_left}).empty().append(n).resizable({handles:a,aspectRatio:i.element_ratio_lock}).draggable())},createResizeHandleSelectors:function(e){var o=[];return p.each(e,function(e,t){o[t]="> .ui-resizable-"+t}),o},createResizeHandleElements:function(e){var o=[];return p.each(e,function(e,t){t=p('<div class="ui-resizable-handle ui-resizable-'+t+'"><div></div></div>')[0];o.push(t)}),o},getElementSizeFromMap:function(){var e=f.mapViewport(),t=e.width(),o=e.height(),n=f.mapPreview(),a=n.position(),i=a.top,e=a.left,a=n.width(),n=n.height();return{top:m(i/o),left:m(e/t),width:m(a/t),height:m(n/o)}},setElementSizeFromMap:function(e){var t=h.data(e),o=f.getElementSizeFromMap();f.imageElement.inside(e).css(o),f.setElementSizeOnBlockData(o,t)},updateElementSizeFromMap:function(e){f.setElementSizeFromMap(e),f.populateImageResizeFields(e)},setElementSizeOnBlockData:function(e,t){for(var o,n=["top","left","width","height"];o=n.shift();)t["element_"+o]=e[o]},toFixedElement:function(e){var t=f.imageElement.inside(e),o=t.position(),n=o.top,a=o.left,e=t.width(),o=t.height();t.css({width:e,height:o,top:n,left:a})},toFluidElement:function(e){var t=h.data(e),o=f.imageElement.inside(e),n=o.position(),a=n.top,i=n.left,r=o.width(),s=o.height(),n=f.imageViewport.inside(e),e=n.width(),n=n.height(),a=t.element_top=m(a/n),i=t.element_left=m(i/e),e=t.element_width=m(r/e),n=t.element_height=m(s/n);o.css({top:a,left:i,width:e,height:n})},"{mapPreview} resize":function(){f.updateElementSizeFromMap(c)},"{mapPreview} drag":function(){f.updateElementSizeFromMap(c)},populateImageResizeFields:function(e){for(var t,o=h.data(e),n=f.resizeInputField(),a=["width","height","top","left"];t=a.shift();){if(f.resizingFromInput==t)return;n.where("prop",t).val(o["element_"+t])}f.resizeRatioLock().prop("checked",o.element_ratio_lock)},setElementSize:function(e,t,o){return f["setElement"+p.capitalize(t)](e,o)},updateElementSize:function(e,t,o){f.setElementSize(e,t,o),f.populateImageAdvancedFields(e)},setElementWidth:function(e,t){var o,n=h.data(e),a=(parseFloat(t),g(t)),i=n.element_ratio,r=n.element_ratio_lock,s=f.imageViewport.inside(e),e=f.imageElement.inside(e);"%"==a&&(r?(r=n.element_width,o=t,s=m(e.width()*(parseFloat(o)/parseFloat(r))/i/s.height()),n.element_width=o,n.element_height=s,y(e,o),w(e,s)):(o=t,n.element_width=parseFloat(o),y(e,o)))},setElementHeight:function(e,t){var o,n=h.data(e),a=(parseFloat(t),g(t)),i=n.element_ratio,r=n.element_ratio_lock,s=f.imageViewport.inside(e),e=f.imageElement.inside(e);"%"==a&&(r?(r=n.element_height,o=t,s=m(e.height()*(parseFloat(o)/parseFloat(r))*i/s.width()),n.element_width=s,n.element_height=o,y(e,s),w(e,o)):w(e,n.element_height=o=t))},setElementTop:function(e,t){h.data(e).element_top=t,f.imageElement.inside(e).css("top",t)},setElementLeft:function(e,t){h.data(e).element_left=t,f.imageElement.inside(e).css("left",t)},setElementRatio:function(e,t){var o=h.data(e);o.element_ratio=t,f.setElementWidth(e,o.element_width)},updateElementRatio:function(e,t){f.setElementRatio(e,t),f.populateImageAdvancedFields(e)},resetElementSize:function(e){f.setImageResizeStrategy(e,"fit"),f.setImageResizeStrategy(e,"custom"),f.populateImageAdvancedFields(e)},lockElementRatio:function(e){var t=h.data(e);t.element_ratio_lock=!0;t=t.natural_ratio;f.updateElementRatio(e,t)},unlockElementRatio:function(e){h.data(e).element_ratio_lock=!1,f.populateImageAdvancedFields(e)},lockImageRatio:function(e){h.data(e).ratio_lock=!0,f.normalizeImageSize(e)},unlockImageRatio:function(e){h.data(e).ratio_lock=!1},"{lockRatio} change":function(e,t){e.is(":checked")?f.lockImageRatio(c):f.unlockImageRatio(c)},"{width} change":function(e,t){var o=c,o=h.data(o),e=parseInt(e.val());parseInt(o.width);f.setImageWidth(c,e)},"{height} change":function(e,t){var o=c,o=h.data(o),e=parseInt(e.val()),o=parseInt(o.height);f.setImageHeight(c,e=0==e||1==e?o:e)},populateImageAlt:function(e){var t=h.data(e),e=f.imageElement.inside(e).attr("alt");void 0!==e&&e.length;t=t.alt_text;f.altTextField().val(""),t&&f.altTextField().val(t)},populateImageCaption:function(e){var t=h.data(e),e=(f.imageCaption.inside(e).length,t.caption_text),t=t.caption_alignment;f.captionTextField().val(""),e&&f.captionTextField().val(e),t&&f.captionAlignment().val(t)},getImageCaption:function(e){return h.data(e).caption_text},setImageCaption:function(e,t){var o=f.imageCaption.inside(e);o.length||(o=p(s.imageCaption),f.imageContainer.inside(e).append(o)),f.imageCaptionText.inside(e).html(t),h.data(e).caption_text=t},setImageCaptionAlignment:function(e,t){var o=f.imageCaption.inside(e);o.length||(o=p(s.imageCaption),f.imageContainer.inside(e).append(o)),f.imageCaptionText.inside(e).css("text-align",t),h.data(e).caption_alignment=t},removeImageCaption:function(e){var t=f.imageCaption.inside(e);f.setImageCaption(e,""),t.remove()},disableImageCaption:function(e){f.removeImageCaption(e),f.populateImageCaption(e)},"{captionTextField} input":function(e,t){e=e.val();""!=e?f.setImageCaption(c,e):f.disableImageCaption(c)},"{captionAlignment} change":function(e,t){e=e.val();f.setImageCaptionAlignment(c,e)},setImageAlt:function(e,t){f.imageElement.inside(e).prop("alt",t),h.data(e).alt_text=t},removeImageAlt:function(e){f.imageElement.inside(e).removeAttr("alt")},"{altTextField} input":function(e,t){e=p.trim(e.val());""!=e?f.setImageAlt(c,e):f.removeImageAlt(c)},populateImageStyle:function(e){var t=h.data(e),e=t.style_enabled;o.toggle("image-style",e),f.styleSelection().where("value",t.style).activateClass("active")},setImageStyle:function(e,t){f.imageContainer.inside(e).switchClass("style-"+t),h.data(e).style=t},updateImageStyle:function(e,t){f.setImageStyle(e,t),f.populateImageStyle(e)},"{styleSelection} click":function(e,t){e=e.data("value");f.updateImageStyle(c,e)},populateImageLink:function(e){e=h.data(e);f.link().val(e.link),"none"!=e.link?("custom"!=e.link&&f.linkUrl().addClass("t-hidden"),"custom"!=e.link&&"custom_new"!=e.link||(f.linkUrl().removeClass("t-hidden"),f.linkUrl().val(e.link_url),f.linkUrl().trigger("input"))):f.linkUrl().addClass("t-hidden")},setImageLinkUrl:function(e,t){var o=h.data(e);o.link_url=t=p.trim(t);e=f.imageViewport.inside(e);t?(e.attr("href",t),"custom_new"==o.link&&e.attr("target","_blank")):e.removeAttr("href")},removeImageLink:function(e){h.data(e).link_url="";var t=f.imageViewport.inside(e);t.removeAttr("href"),t.removeAttr("target"),f.populateImageLink(e)},addImageLinkTarget:function(e){f.imageViewport.inside(e).attr("target","_blank")},removeImageLinkTarget:function(e){f.imageViewport.inside(e).removeAttr("target")},setImagePopup:function(t,o,e){var n=h.data(t);f.imagePopupButton.inside(t).remove();o=n.popup_uri=o||n.popup_uri||n.uri,e=n.popup_variation=e||n.popup_variation;if(!n.isurl)return d.getMedia(o).done(function(e){e.meta;e=d.getVariation(o,["system/original"]);n.popup_url=e.url,n.popup_variation=e.key,f.imagePopupButton.inside(t).attr("href",n.popup_url)});n.popup_url=o},removeImagePopup:function(e){var t=h.data(e);t.popup_url="",t.popup_uri="",t.popup_variation="",f.imagePopupButton.inside(e).remove()},triggerLinkChange:function(e){"custom"!=e&&"custom_new"!=e||f.linkUrl().removeClass("t-hidden"),"lightbox"==e&&f.setImagePopup(c),"custom"!=e&&"custom_new"!=e&&f.removeImageLink(c),"lightbox"!=e&&("custom"==e&&f.removeImageLinkTarget(c),"custom_new"==e&&f.addImageLinkTarget(c),f.removeImagePopup(c))},"{link} change":function(e,t){var o=h.data(c),e=e.val();o.link=e,f.triggerLinkChange(e),o.link_url&&"lightbox"!=e&&f.setImageLinkUrl(c,o.link_url)},"{linkUrl} input":function(e,t){e=e.val();f.setImageLinkUrl(c,e)},"{imageViewport} click":function(e,t){t.preventDefault()},"{imageUrlAdd} click":function(e,t){var o,n=f.imageUrlTextbox().val();n&&(h.getBlockContent(c),o=h.data(c),c.css("text-align","center"),o.uri=n,o.url=n,o.simple="simple",o.ratio_lock=!0,o.isurl=!0,o=f.constructImage(o),h.getBlockContent(c).empty().append(o),c.hasClass("active")&&f.populate(c))},"{urlButton} click":function(e,t){e.parents(f.imagePlaceholder()).addClass("inserting-url")},"{imageUrlCancel} click":function(e,t){e.parents(f.imagePlaceholder()).removeClass("inserting-url")},"{urlFieldUpdateButton} click":function(e,t){var o,n=f.urlFieldText().val();n&&((o=h.data(c)).uri=n,o.url=n,o=f.constructImage(o),h.getBlockContent(c).empty().append(o))},"{self} composerPaste":function(e,t,o){o=o.find("img");l.document.isLegacy()||p.each(o,function(e,t){t={uri:(t=p(t)).attr("src"),url:t.attr("src"),simple:"simple",ratio_lock:!0,isurl:!0},t=h.constructBlock("image",t);h.addBlock(t)})}}}),e.resolve()})}),EasyBlog.module("composer/blocks/handlers/instagram",function(l){EasyBlog.Controller("Composer.Blocks.Handlers.Instagram",{defaultOptions:l.extend({"{form}":"> [data-instagram-form]","{insert}":"[data-instagram-insert]","{source}":"[data-instagram-source]","{preview}":"[data-instagram-preview]","{fsSource}":"[data-fs-instagram-source]","{fsRefreshButton}":"[data-fs-instagram-refresh]","{errorMessage}":"[data-instagram-error]"},EBD.selectors)},function(a,e,t,i,r,s,n){return{init:function(){r=a.blocks,i=r.composer,s=e.meta,n=l()},toData:function(e){return r.data(e)},toText:function(e){return r.data(e).source},toEditableHTML:function(e){return""},toHTML:function(e){e=e.data("overlay");if(e)return e.element().html()},activate:function(e){n=e,a.populate(e)},deactivate:function(e){},construct:function(e){},deconstruct:function(e){var t=r.getBlockContent(e);return a.form.inside(t).remove(),e},reconstruct:function(e){var t=r.data(e),o=e.data("overlay"),n=r.getBlockContent(e);t.source&&!o?(n.empty(),a.createIframe(e,t.source)):n.html(s.html),e.find(a.source.selector).off("paste").on("paste",function(e){e.stopPropagation()})},refocus:function(e){},reset:function(e){},populate:function(e){e=r.data(e);a.fsSource().val(e.source)},createIframe:function(e,t){var o=l.create("iframe"),n=r.data(e);t=a.sanitizeUrl(t),n.source=t,o.attr("src",t),a.setOverlay(e,o)},sanitizeUrl:function(e){return(e=(e=e.replace("?modal=true","")).replace(/\/$/,"")).match(/\/embed/)||(e+="/embed/"),e},setOverlay:function(e,t){var o,n=e.data("overlay");n?(n.element().empty(),n.element().append(t)):(n=i.document.overlay.create(e),o=r.getBlockContent(e),n.placeholder().css("height","400px").appendTo(o),n.element().append(t),n.attach()),e.data("overlay",n)},isUrlValid:function(e){return""!=e&&(!!/^(?:http(?:s)?:\/\/)?www\.instagram\.com\/(tv|p)\/(.*)(?:\/)?$/.test(e)||(!!/^(?:http(?:s)?:\/\/)?www\.instagram\.com\/(.*)\/guide\/(.*)(?:\/)?$/.test(e)||/^(?:http(?:s)?:\/\/)?www\.instagram\.com\/reel\/(.*)(?:\/)?$/.test(e)))},"{insert} click":function(e,t){n.length<1&&(o=a.block.of(e),r.activateBlock(o));var e=r.getBlockContent(n),o=(o=a.source.inside(e).val()).replace("?utm_source=ig_web_copy_link","");a.isUrlValid(o)?(a.fsSource().val(o),a.createIframe(n,o),a.form.inside(e).addClass("hidden")):a.errorMessage().removeClass("hide")},"{fsRefreshButton} click":function(){var e=r.getBlockContent(n),t=a.fsSource().val();a.isUrlValid(t)?(a.createIframe(n,t),a.form.inside(e).addClass("hidden")):a.errorMessage().removeClass("hide")}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/links",function(c){EasyBlog.Controller("Composer.Blocks.Handlers.Links",{defaultOptions:{"{loader}":"> [data-link-loader]","{form}":"> [data-link-form]","{addLink}":"[data-link-add]","{linkInput}":"[data-link-input]","{errorMessage}":"[data-link-error]","{preview}":"> [data-link-preview]","{previewTitle}":"> [data-link-preview] [data-preview-title]","{previewContent}":"> [data-link-preview] [data-preview-content]","{previewLink}":"> [data-link-preview] [data-preview-link]","{previewImage}":"> [data-link-preview] [data-preview-image]","{imageWrapper}":"> [data-link-preview] [data-preview-image-wrapper]","{settings}":"[data-eb-composer-block-links-image]","{imageList}":"[data-eb-composer-block-links-image] [data-images]","{imagePlaceholder}":"[data-eb-composer-block-links-image] [data-image-placeholder]","{currentIndex}":"[data-eb-composer-block-links-image] [data-image-current-index]","{totalImages}":"[data-eb-composer-block-links-image] [data-images-total]","{previousImage}":"[data-eb-composer-block-links-image] [data-images-previous]","{nextImage}":"[data-eb-composer-block-links-image] [data-images-next]","{showImage}":"[data-links-image]","{noFollow}":"[data-links-nofollow]","{newWindow}":"[data-links-newwindow]"}},function(r,e,t,o,s,n,l){return{init:function(){s=r.blocks,s.composer,n=e.meta,l=c()},activate:function(e){l=e,r.populate(e)},deactivate:function(e){},construct:function(e){},toText:function(e){e=s.getBlockContent(e);return r.previewLink.inside(e).html()},toData:function(e){return s.data(e)},toHTML:function(e){if(!s.data(e).url)return"";e=e.clone(),e=r.deconstruct(e);return s.getBlockContent(e).html()},makeEditable:function(e){e=s.getBlockContent(e);r.previewTitle.inside(e).editable(!0).on("click",function(e){e.preventDefault()}),r.previewContent.inside(e).editable(!0),r.previewLink.inside(e).on("click",function(e){e.stopPropagation(),e.preventDefault()}),r.imageWrapper.inside(e).on("click",function(e){e.preventDefault()})},reconstruct:function(e){var t=s.data(e),o=s.getBlockContent(e);t.url||t.title||o.html(n.html),r.makeEditable(e)},deconstruct:function(e){var t=s.getBlockContent(e),o=s.data(e),n=r.preview.inside(t);return o.showImage||r.imageWrapper.inside(t).remove(),r.previewTitle.inside(t).editable(!1),r.previewContent.inside(t).editable(!1),r.loader.inside(t).remove(),r.form.inside(t).remove(),r.preview.inside(t).removeAttr("data-link-preview"),r.previewImage.inside(t).removeAttr("data-preview-image"),r.previewTitle.inside(t).removeAttr("data-preview-title"),r.previewContent.inside(t).removeAttr("data-preview-content"),t.html(n.html()),n.remove(),e},refocus:function(e){},reset:function(e){},populate:function(e){e=s.data(e);e.images&&0<e.images.length?r.populateImages(e.images,e.image):r.populateImages("",""),r.settings().removeClass("hide"),r.showImage().val(e.showImage?1:0),r.showImage().trigger("change"),r.noFollow().val(e.noFollow?1:0),r.noFollow().trigger("change"),r.newWindow().val(e.newWindow?1:0),r.newWindow().trigger("change")},populateImages:function(n,a){var e=c.inArray(a,n);if(r.currentIndex().html(e+1),r.totalImages().html(n.length),r.imageList().children("img").remove(),!n)return!1;c.each(n,function(e,t){var o=c(new Image);o.attr("src",t),r.imagePlaceholder().addClass("hidden"),o.addClass("hidden"),e==c.inArray(a,n)&&o.removeClass("hidden"),r.imageList().append(o)})},updatePreview:function(){var e=s.getBlockContent(l),t=s.data(l);r.previewTitle.inside(e).html(t.title).attr("href",t.url),r.previewContent.inside(e).html(t.content);var o=r.previewLink.inside(e);o.html(t.url),o.attr("href",t.url),t.noFollow&&o.attr("rel","nofollow"),t.newWindow?o.attr("target","_blank"):o.removeAttr("target"),r.previewImage.inside(e).attr("src",t.image),r.imageWrapper.inside(e).attr("href",t.url)},getSuggestions:function(e,t,o){EasyBlog.ajax("site/views/crawler/crawl",{url:e}).done(o).fail(function(e){r.showForm(t),r.errorMessage().html(e).removeClass("hide")})},hideForm:function(e){e=s.getBlockContent(e);r.form.inside(e).addClass("hidden"),r.loader.inside(e).removeClass("hidden")},showForm:function(e){e=s.getBlockContent(e);r.form.inside(e).removeClass("hidden"),r.loader.inside(e).addClass("hidden")},"{showImage} change":function(e,t){var o=s.getBlockContent(l),n=s.data(l);0==e.val()?(n.showImage=!1,r.imageWrapper.inside(o).addClass("hide")):(n.showImage=!0,r.imageWrapper.inside(o).removeClass("hide"))},"{newWindow} change":function(e,t){var o=s.getBlockContent(l),n=s.data(l);n.newWindow=1==e.val();var a=r.previewLink.inside(o),e=r.previewTitle.inside(o),o=r.imageWrapper.inside(o);if(n.newWindow)return a.attr("target","_blank"),e.attr("target","_blank"),void o.attr("target","_blank");a.removeAttr("target"),e.removeAttr("target"),o.removeAttr("target")},"{noFollow} change":function(e,t){var o=s.getBlockContent(l),n=s.data(l);n.noFollow=0!=e.val();var a=r.previewLink.inside(o),e=r.previewTitle.inside(o),o=r.imageWrapper.inside(o);if(n.noFollow)return a.attr("rel","nofollow"),e.attr("rel","nofollow"),void o.attr("rel","nofollow");a.removeAttr("rel"),e.removeAttr("rel"),o.removeAttr("rel")},"{previousImage} click":function(e,t){var o=r.imageList().children("img"),n=r.imageList().children("img:not(.hidden)"),a=c(n).prev("img"),i=parseInt(r.currentIndex().html()),n=s.data(l);0<a.length&&(n.image=a.attr("src"),r.updatePreview(),c(o).addClass("hidden"),c(a).removeClass("hidden"),a=i-1,r.currentIndex().html(a)),r.nextImage().disabled(!1),i-1==1?c(e).disabled(!0):c(e).disabled(!1)},"{nextImage} click":function(e,t){var o=r.imageList().children("img"),n=r.imageList().children("img:not(.hidden)"),a=c(n).next("img"),i=parseInt(r.currentIndex().html()),n=s.data(l);0<a.length&&(n.image=a.attr("src"),r.updatePreview(),c(o).addClass("hidden"),c(a).removeClass("hidden"),r.currentIndex().html(i+1)),r.previousImage().disabled(!1),i+1==o.length?c(e).disabled(!0):c(e).disabled(!1)},"{linkInput} keydown":function(e,t){13==t.keyCode&&r.addLink().click()},"{addLink} click":function(e){var t=s.getBlockContent(l),o=r.linkInput.inside(t).val(),n=s.data(l);o?(r.hideForm(l),r.getSuggestions(o,l,function(e){e=e[o];n.title=e.title,n.content=e.description,n.url=o,n.images=e.images,n.image=e.images[0],n.showImage=!0,0===n.images.length&&(n.showImage=!1),r.updatePreview(),r.loader.inside(t).addClass("hidden"),r.preview.inside(t).removeClass("hidden"),r.makeEditable(),r.populate(l)})):r.errorMessage().removeClass("hide")}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/lottie",function(c){EasyBlog.Controller("Composer.Blocks.Handlers.Lottie",{defaultOptions:{"{wrapper}":"[data-lottie-wrapper]","{form}":"[data-lottie-form]","{filename}":"[data-lottie-filename]","{errorMessage}":"[data-lottie-error]","{input}":"[data-lottie-input]","{fileInput}":"[data-lottie-file-input]","{fieldInput}":"[data-lottie-field-input]","{loopFieldset}":"[data-lottie-loop]","{autoplayFieldset}":"[data-lottie-autoplay]","{hoverFieldset}":"[data-lottie-hover]","{embedButton}":"[data-lottie-embed]","{updateButton}":"[data-lottie-update]","{player}":"lottie-player","{preview}":"[data-lottie-responsive]","{settingsSection}":"[data-lottie-settings-section]","{urlSection}":"[data-lottie-url-section]"}},function(r,e,t,o,s,n,l){return{init:function(){s=r.blocks,s.composer,n=e.meta,l=c()},toData:function(e){return s.data(e)},toText:function(e){},toEditableHTML:function(e){return""},toHTML:function(e){},activate:function(e){var t=s.data(e);l=e,r.populate(t)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){if(!s.data(e).url){const t=s.getBlockContent(e);t.html(n.html)}},deconstruct:function(e){},refocus:function(e){},reset:function(e){},updateCheckbox:function(e,t,o){e.closest("[data-eb-toggler]").find("[data-eb-toggler-checkbox]").prop("checked",!!(void 0===t?o:t))},populate:function(e){r.fieldInput().val(""),r.urlSection().addClass("t-hidden"),r.settingsSection().addClass("t-hidden");var t=e.url;t&&(r.isValidUrl(t)&&r.fieldInput().val(t),r.urlSection().removeClass("t-hidden"),r.settingsSection().removeClass("t-hidden"),r.updateCheckbox(r.loopFieldset(),e.loop,!0),r.updateCheckbox(r.autoplayFieldset(),e.autoplay,!0),r.updateCheckbox(r.hoverFieldset(),e.hover,!1))},isValidUrl:function(e){if(!e)return!1;return/^https:\/\/(.*)\.lottiefiles\.com\/(packages|private_files)\/(.*)\.json$/.test(e)},"{embedButton} click":function(e,t){var o=r.input().val();r.validate(o)&&r.embed(o)},"{updateButton} click":function(e,t){var o=r.fieldInput().val();r.validate(o)&&r.embed(o)},validate:function(e){return!!r.isValidUrl(e)||(r.errorMessage().removeClass("t-hidden"),!1)},embed:function(e){r.errorMessage().addClass("t-hidden"),r.fieldInput().val(e);var t=s.getBlockContent(l);const o=r.wrapper.inside(t);o.addClass("t-hidden");let n=s.data(l);n.url=e,r.setLottiePlayer(n)},removeLottiePlayer:function(){var e=s.getBlockContent(l);r.preview.inside(e).remove()},setLottiePlayer:function(e){r.removeLottiePlayer();var t=c(n.preview),o=r.player.inside(t);s.getBlockContent(l).addClass("is-loading"),r.setPlayerAttribute(o,"src",e.url),r.setPlayerAttribute(o,"loop",e.loop),r.setPlayerAttribute(o,"autoplay",e.autoplay),r.setPlayerAttribute(o,"hover",e.hover),r.appendPlayer(t)},appendPlayer:function(e){var t=r.player.inside(e),o=s.getBlockContent(l);t.addClass("t-hidden"),o.append(e),r.urlSection().removeClass("t-hidden"),r.settingsSection().removeClass("t-hidden"),t.off("load").on("load",function(){o.removeClass("is-loading"),t.removeClass("t-hidden")})},setPlayerAttribute:function(e,t,o){o?"src"!==t?e.attr(t,""):e.attr(t,o):e.removeAttr(t)},"{fileInput} change":function(e,t){var o,n,a,i;c.isEmpty(e.val())||"application/json"===e[0].files[0].type&&(r.errorMessage().addClass("t-hidden"),o=s.data(l),n=s.getBlockContent(l),r.form.inside(n),a=r.wrapper.inside(n),i=e.closest("[data-composer-frame]").data("post-id"),a.addClass("t-hidden"),n.addClass("is-loading"),EasyBlog.ajax("site/views/lottie/getPlayer",{files:e,postId:i,loop:o.loop,autoplay:o.autoplay,hover:o.hover},{type:"iframe"}).done(function(e){o.url=e.url,r.appendPlayer(c(e.html));var t=c("<input>"),e="lottie_files["+e.name+"]";t.prop("type","hidden"),t.prop("name",e),t.prop("value","1"),r.preview.inside(n).append(t)}).fail(function(){r.errorMessage().removeClass("t-hidden")}))},"{loopFieldset} change":function(e,t){e=parseInt(e.val());let o=s.data(l);o.loop=e,r.setLottiePlayer(o)},"{autoplayFieldset} change":function(e,t){e=parseInt(e.val());let o=s.data(l);o.autoplay=e,r.setLottiePlayer(o)},"{hoverFieldset} change":function(e,t){e=parseInt(e.val());let o=s.data(l);o.hover=e,r.setLottiePlayer(o)}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/metacafe",function(o){EasyBlog.Controller("Composer.Blocks.Handlers.Metacafe",{elements:["[data-metacafe-fieldset-{url|fluid|width-fieldset|height-fieldset|width|height|update-url}]"],defaultOptions:o.extend({"{form}":"> [data-metacafe-form]","{insert}":"[data-metacafe-insert]","{source}":"[data-metacafe-source]","{loader}":"> [data-metacafe-loader]","{errorMessage}":"[data-metacafe-error]","{player}":"iframe","{wrapper}":"[data-metacafe-wrapper]"},EBD.selectors)},function(i,e,t,n,r,a,s){return{init:function(){r=i.blocks,n=r.composer,a=e.meta,s=o()},toData:function(e){var t=r.data(e),e=e.data("overlay");if(!e)return t;e=i.player.inside(e.element());return t.source=e.attr("src"),t},toText:function(e){return r.data(e).source},toHTML:function(e){var t=e.clone(),e=(r.data(t),e.data("overlay"));if(e)return e.element().html()},activate:function(e){r.getBlockContent(e),r.data(e);s=e,i.populate(e)},deactivate:function(e){},construct:function(e){},getWrapper:function(e){return o(a.wrapper)},getPlayer:function(e){var t=o(a.player);return t.attr("src",e),t},reconstruct:function(e){var t=r.data(e);console.log(t);var o=e.data("overlay"),n=r.getBlockContent(e);t.source&&!o?i.setOverlay(e):!t.source&&t.url?(n.html(a.html),i.crawl(t.url,e)):n.html(a.html),e.find(i.source.selector).off("paste").on("paste",function(e){e.stopPropagation()})},deconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){r.data(e);i.updateFieldset(e)},updateFieldset:function(e){e=r.data(e);e.url&&(i.url().val(e.url),i.width().val(e.width),i.height().val(e.height),i.fluid().val(e.fluid?"1":"0").trigger("change"))},getOverlay:function(e){var t=e.data("overlay"),o=(r.data(e),r.getBlockContent(e));return t||(t=n.document.overlay.create(e),e=i.getWrapper(),t.placeholder().appendTo(e),o.empty().append(e),t.attach()),t},setWrapperLayout:function(e){var t=i.wrapper.inside(e),e=r.data(e);e.fluid?t.addClass("is-responsive").css({width:"",height:""}):(t.hasClass("is-responsive")&&(e.width=t.width(),e.height=t.outerHeight()),i.width().val(e.width),i.height().val(e.height),t.css({width:e.width,height:e.height}).removeClass("is-responsive"))},setOverlay:function(e){var t=r.data(e),o=i.getOverlay(e);0<o.element().length&&o.element().empty(),i.setWrapperLayout(e),o.element().append(t.embed),o.refresh(),e.data("overlay",o)},isUrlValid:function(e){if(!e)return!1;return/^https:\/\/www\.metacafe\.com\/watch\/(.*)\/(.*)$/.test(e)},loading:function(){var e=r.getBlockContent(s),t=i.loader.inside(e),e=i.form.inside(e);i.isLoading?(t.addClass("hidden"),e.removeClass("hidden"),i.isLoading=!1):(t.removeClass("hidden"),e.addClass("hidden"),i.isLoading=!0)},crawl:function(o,n){var a=r.data(n),e=r.getBlockContent(n),t=n.data("overlay");t&&t.element().empty(),i.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:o}).done(function(e){var t=e[o],e=a.url=o;a.source=e.replace("/watch/","/embed/"),a.width=t.video.width,a.height=t.video.height,a.title=t.opengraph.title,a.description=t.opengraph.desc,a.embed=i.getPlayer(a.source).prop("outerHTML"),a.permalink=t.opengraph.url,i.setOverlay(n),i.updateFieldset(n)}).fail(function(e){i.errorMessage().removeClass("hide").html(e)}).always(function(){i.loading(),i.form.inside(e).addClass("hidden")})},"{insert} click":function(e){s.length<1&&(t=i.block.of(e),r.activateBlock(t));var t=r.getBlockContent(s),t=i.source.inside(t).val();r.data(s);i.isUrlValid(t)?i.crawl(t,s):i.errorMessage().removeClass("hide")},"{fluid} change":function(e,t){e=1==e.val();r.data(s).fluid=e,i.setWrapperLayout(s),i.widthFieldset().toggleClass("hide",e),i.heightFieldset().toggleClass("hide",e),i.getOverlay(s).refresh()},"{width} keyup":o.debounce(function(e,t){var o=r.data(s),e=e.val();0!=e&&(o.width=e,i.getOverlay(s),i.wrapper.inside(s).css("width",e),i.getOverlay(s).refresh())},250),"{height} keyup":o.debounce(function(e,t){var o=r.data(s),e=e.val();0!=e&&(o.height=e,i.wrapper.inside(s).css("height",e),i.getOverlay(s).refresh())},250),"{updateUrl} click":function(e,t){var o=i.url().val(),n=(r.data(s),r.getBlockContent(s));i.isUrlValid(o)?i.crawl(o,s):i.errorMessage.inside(n).removeClass("hide")}}}),this.resolve()}),EasyBlog.require().script("admin/vendors/select2").done(function(e){EasyBlog.module("composer/blocks/handlers/module",function(s){EasyBlog.Controller("Composer.Blocks.Handlers.Module",{defaultOptions:s.extend({"{form}":"> [data-module-form]","{errorMessage}":"[data-module-error]","{moduleSelection}":"[data-module-selection]","{loader}":"> [data-module-loader]","{moduleSelectionContent}":"[data-module-selection-content]","{moduleItem}":"[data-module-item]","{moduleList}":"[data-module-list]","{placeholder}":"[data-module-placeholder]","{placeholderContent}":"[data-module-placeholder-content]","{placeholderTitle}":"[data-module-placeholder-title]","{placeholderPreviewError}":"[data-module-preview-error]","{placeholderInfo}":"[data-module-placeholder-info]","{placeholderNotice}":"[data-module-placeholder-notice]"},EBD.selectors)},function(i,e,t,o,r,n,a){return{init:function(){r=i.blocks,r.composer,n=e.meta,a=s()},toData:function(e){return r.data(e)},toText:function(e){return r.data(e).embed},toEditableHTML:function(e){return""},toHTML:function(e){return r.data(e).embed},activate:function(e){a=e,i.populate(e)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){var t=r.data(e),o=r.getBlockContent(e);t.html&&(o.empty(),i.loadPlaceholder(e,t)),t.html||o.html(s(n.html));t=i.moduleSelection.inside(o),o=s(t).data("select2");null==o&&s(t).select2({theme:"si"})},deconstruct:function(e){var t=r.getBlockContent(e);return i.form.inside(t).remove(),e},refocus:function(e){},reset:function(e){},populate:function(e){e=r.data(e);i.updateFieldset(e.id)},showForm:function(e){e=r.getBlockContent(e);i.placeholderInfo.inside(e).removeClass("hidden"),i.moduleSelectionContent.inside(e).removeClass("hidden")},hideForm:function(e){e=r.getBlockContent(e);i.placeholderInfo.inside(e).addClass("hidden"),i.placeholderNotice.inside(e).removeClass("hidden")},loadPlaceholder:function(e,t){var o,n=r.getBlockContent(e),t=r.data(e);i.updateFieldset(t.id),t.html?(n.html(t.html),o=i.placeholderTitle.inside(n),e=i.moduleSelection.inside(n),o.html(t.name),e.data("flag")?e.val(t.module+"-"+t.id):e.val(t.module)):((o=i.placeholderTitle.inside(n)).html(t.name),a=i.moduleSelection.inside(n),null!=s(a).data("select2")&&s(a).select2("destroy"),t.html=n.html());var a=i.moduleSelection.inside(n);null==s(a).data("select2")&&s(a).select2({theme:"si"})},processModule:function(e,t){r.getBlockContent(e);var o=r.data(e);i.loading(),EasyBlog.ajax("site/views/composer/checkModuleContent",{module:t.module}).done(function(){o.moduleObj=t,o.id=t.id,o.name=t.name,o.module=t.module,i.updateFieldset(o.id),i.loading(),i.hideForm(e),i.loadPlaceholder(e,o),i.removeError(e)}).fail(function(){i.loading(),i.showError(e)})},showError:function(e){e=r.getBlockContent(e);i.errorMessage.inside(e).removeClass("hidden"),i.placeholderNotice.inside(e).addClass("hidden"),i.placeholderTitle.inside(e).addClass("hidden"),i.placeholderInfo.inside(e).addClass("hidden")},removeError:function(e){e=r.getBlockContent(e);i.errorMessage.inside(e).addClass("hidden"),i.placeholderNotice.inside(e).removeClass("hidden"),i.placeholderTitle.inside(e).removeClass("hidden")},updateFieldset:function(e){i.moduleItem().removeClass("active"),i.moduleList().find("[data-id='"+e+"']").addClass("active")},loading:function(){var e=r.getBlockContent(a),t=i.loader.inside(e),e=i.form.inside(e);i.isLoading?(t.addClass("hidden"),e.removeClass("hidden"),i.isLoading=!1):(t.removeClass("hidden"),e.addClass("hidden"),i.isLoading=!0)},"{moduleItem} click":function(e){var t=s(e).data("id"),o=s(e).data("title"),e=s(e).data("module");i.processModule(a,{id:t,name:o,module:e})},"{moduleSelection} change":function(e,t){var o=s(e).val().split("-")[0],n=s(e).find(":selected").data("id"),e=s(e).find(":selected").html();i.processModule(a,{id:n,name:e,module:o})}}}),this.resolve()})}),EasyBlog.module("composer/blocks/handlers/notes",function(c){var e=this;EasyBlog.require().done(function(){EasyBlog.Controller("Composer.Blocks.Handlers.Notes",{defaultOptions:{data:{type:"paragraph"},"{noteContent}":"[data-eb-block-notes-content]","{noteTypeSelection}":"[data-eb-composer-block-notes-type] [data-type]"}},function(r,e,t,n,s,o,l){return{init:function(){s=r.blocks,n=s.composer,o=e.meta,l=c(),e.data.content=c(o.content).html()},activate:function(e){l=e,r.populate(e)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){},deconstruct:function(e){var t=s.getBlockContent(e);return r.noteContent.inside(t).editable(!1),e},refocus:function(e){var t=s.getBlockContent(e);const o=r.noteContent.inside(t);o.focus(),e.hasClass("is-new")&&n.editor.caret.setEnd(o[0])},toText:function(e){},toData:function(e){return s.data(e)},toHTML:function(e){e=e.clone(),e=r.deconstruct(e);const t=s.getBlockContent(e);return t.html()},reset:function(e){},currentType:null,populate:function(e){e=s.data(e);r.noteTypeSelection().where("type",e.type).activateClass("selected"),r.currentType=e.type,r.setContentType(r.currentType)},setContentType:function(e){e="list"===e?"html":"text";r.noteContent().attr("data-content-type",e)},setNoteType:function(e){const t=s.getBlockContent(l),n=t.find(r.noteContent);if(r.setContentType(e),"paragraph"===e){let o="";const a=n.find("li");a.each(function(e,t){t=c(t),0!==e&&(o+=" "),o+=t.html()}),n.empty(),n.html(o)}if("list"===e){var o=n.html().trim();n.empty();const i=c("<ul>");e=c("<li>");i.append(e),n.append(i),n.find("ul").find("li").first().html(o)}},"{noteTypeSelection} click":function(e){var t=e.data("type");if(r.currentType!==t){const o=s.data(l);r.noteTypeSelection().removeClass("selected"),c(e).addClass("selected"),r.setNoteType(t),o.type=t,r.currentType=t}}}}),e.resolve()})}),EasyBlog.module("composer/blocks/handlers/pagebreak",function(s){EasyBlog.Controller("Composer.Blocks.Handlers.Pagebreak",{elements:["[data-pagebreak-fieldset-{title|alt}]"],defaultOptions:{"{spanTitle}":"[data-pagebreak-title]","{spanAlt}":"[data-pagebreak-alt]"}},function(a,e,t,o,i,n,r){return{init:function(){i=a.blocks,i.composer,n=e.meta,r=s()},toData:function(e){return i.data(e)},toText:function(e){return""},toHTML:function(e){var t=i.data(e),e=s.create("hr");return t.alt&&e.attr("alt",t.alt),t.title&&e.attr("title",t.title),e.attr("class","system-pagebreak"),e.toHTML()},deactivate:function(e){},activate:function(e){r=e,a.populate(e)},deconstruct:function(e){},construct:function(e){},reconstruct:function(e){i.data(e);i.getBlockContent(e).html(n.html),a.updateFieldset(e)},refocus:function(e){},reset:function(e){},populate:function(e){a.updateFieldset(e)},updateFieldset:function(e){var t=i.data(e),o=i.getBlockContent(e);a.title().val(t.title),a.alt().val(t.alt);e=0<t.title.length?" - "+t.title:"";a.spanTitle.inside(o).text(e);e=0<t.alt.length?" - "+t.alt:"";a.spanAlt.inside(o).text(e)},"{title} keyup":s.debounce(function(e,t){var o=i.data(r),n=i.getBlockContent(r),e=e.val(),e=0<(o.title=e).length?" - "+e:"";a.spanTitle.inside(n).text(e)},250),"{alt} keyup":s.debounce(function(e,t){var o=i.data(r),n=i.getBlockContent(r),e=e.val(),e=0<(o.alt=e).length?" - "+e:"";a.spanAlt.inside(n).text(e)},250)}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/pdf",function(u){var e=this;EasyBlog.require().script("composer/vendors/redactor10","composer/document/overlay","composer/vendors/selectionchange").done(function(){EasyBlog.Controller("Composer.Blocks.Handlers.Pdf",{defaultOptions:{"{browseButton}":".eb-composer-placeholder-pdf [data-eb-mm-browse-button]","{fileError}":"[data-eb-file-error]","{placeholder}":"[data-eb-composer-pdf-placeholder]","{player}":"[data-file-preview]","{dropElement}":"[data-plupload-drop-element]","{height}":"[data-pdf-height]","{wrapper}":"> [data-pdf-previewer]","{object}":"object","{iframe}":"iframe",width:"100%",height:"450px"}},function(l,c,e,s,d,a,i,t){return{init:function(){d=l.blocks,s=d.composer,a=c.meta,i=u(),EasyBlog.MediaManager},toData:function(e){return d.data(e)},toText:function(e){return d.data(e).url},toHTML:function(e){d.data(e);e=e.data("overlay");if(e)return e.element().html()},toLegacyShortcode:function(e,t){t={uri:e.uri,height:t.height};return"[pdf]"+JSON.stringify(t)+"[/pdf]"},toLegacyHTMLPermalink:function(e){var o=[];return u.each(e,function(e,t){t=t.meta;if("pdf"!=t.type)return!0;t=u("<a>").attr({href:t.url,target:"_blank"}).append(t.title);o.push(t.prop("outerHTML"))}),o.join("<br>")},toEditableHTML:function(e){return""},activate:function(e){i=e,l.populate(e)},deactivate:function(e){},construct:function(e){var t=d.createBlockContainer("pdf"),e=u.extend(d.data(t),e);return t},reconstruct:function(e){var t=d.data(e),o=e.data("overlay"),n=d.getBlockContent(e);t.url&&!o?(n.html(a.html),l.createEmbedObject(e)):n.html(a.html);e=l.placeholder.inside(e);0<l.dropElement.inside(e).length&&EasyBlog.MediaManager.uploader.register(e)},deconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){d.data(e);l.populateHeight(e)},getHeight:function(e){e=d.data(e);return e.height||c.height},updateHeight:function(e,t){var o,n=e.data("overlay");n&&(d.getBlockContent(e),e=(o=n.element()).find("iframe"),o=o.find("object"),n.placeholder().css("height",t),o.attr("height",t),e.attr("height",t))},setOverlay:function(n,a){var e=n.data("overlay");e?(e.element().empty(),e.element().append(a)):setTimeout(function(){var e=s.document.overlay.create(n),t=d.getBlockContent(n),o=l.getHeight(n);e.placeholder().css("height",o).appendTo(t),e.element().append(a),e.attach()},300),n.data("overlay",e)},createEmbedObject:function(e){l.placeholder.inside(e).remove();var t=u(document.createElement("object")),o=document.createElement("iframe"),n=(d.getBlockContent(e),d.data(e)),a=window.origin,i=window.eb.rootUrl,r=n.url,s=a.replace(/^http(s?):/i,""),i=(i=i.replace(/^http(s?):/i,"").replace(s,"")).replace("/",""),r=r.replace(s,"");i&&(r="/"+i+r),n.pdfjs&&(n.pdfjs=n.pdfjs.replace(a,""),r=n.pdfjs+r);n=e.data("overlay");n&&n.element().empty();n=l.getHeight(e);return t.attr("data",r),t.attr("type","application/pdf"),t.attr("width",c.width),t.attr("height",n),o.setAttribute("width",c.width),o.setAttribute("height",n),o.setAttribute("src",r),o.setAttribute("scrolling","no"),o.setAttribute("frameborder","0"),o.setAttribute("allowTransparency","true"),t.html(o),l.setOverlay(e,t),o},populateHeight:function(e){e=d.data(e);l.height().val(e.height)},"{height} change":function(e,t){var o=d.data(i);o.height=e.val(),l.updateHeight(i,o.height)},"{placeholder} mediaUploaderFilesAdded":function(e,t,o,n){EasyBlog.MediaManager.uploader.addItem(n[0],e)},"{placeholder} mediaUploaderFileUploaded":function(e,t,o,n,a){var i=a.response.media.meta,r=d.block.of(e),a=d.data(r);a=u.extend(a,i),setTimeout(function(){l.createEmbedObject(r)},600)},"{placeholder} mediaUploaderFileError":function(e,t,o,n){n.code==u.plupload2.FILE_EXTENSION_ERROR&&l.fileError.inside(i).removeClass("hide")},"{placeholder} mediaUploaderError":function(e,t,o,n){},"{browseButton} mediaSelect":function(e,t,o){var n=d.block.of(e);if("pdf"==o.meta.type){if(!o.data.previewer){n=d.constructBlock("file",{name:o.data.title,type:o.meta.extension,size:o.meta.size,url:o.meta.url,showicon:!0,showsize:!0});return d.addBlock(n),d.activateBlock(n),void d.removeBlock(i)}var a=o.meta,e=s.document;e.isLegacy()?(content=l.toLegacyShortcode(n),content=l.toLegacyHTML(n),e.insertContent(content)):((e=d.data(n)).url=a.url,e.height=o.data.height,l.createEmbedObject(n))}},"{self} mediaInsertPermalink":function(e,t,o){var n=s.document.isLegacy(),a=s.document;n&&(content=l.toLegacyHTMLPermalink(o),a.insertContent(content))},"{self} mediaInsert":function(e,t,o,n,a,i){var r;"pdf"==o.meta.type&&((r=s.document).isLegacy()?(content=l.toLegacyShortcode(o.meta,a),r.insertContent(content)):(n=a.previewer?d.constructBlock("pdf",{name:a.title,url:o.meta.url,height:a.height}):d.constructBlock("file",{name:a.title,type:o.meta.extension,size:o.meta.size,url:o.meta.url,showicon:!0,showsize:!0}),d.addBlock(n),i||d.activateBlock(n)))}}}),e.resolve()})}),EasyBlog.module("composer/blocks/handlers/pinterest",function(l){EasyBlog.Controller("Composer.Blocks.Handlers.Pinterest",{defaultOptions:l.extend({"{form}":"> [data-pinterest-form]","{insert}":"[data-pinterest-insert]","{source}":"[data-pinterest-source]","{loader}":"> [data-pinterest-loader]","{preview}":"> [data-pinterest-preview]","{errorMessage}":"[data-pinterest-error]","{fsSource}":"[data-fs-pinterest-source]","{fsUpdate}":"[data-fs-pinterest-update]"},EBD.selectors)},function(r,e,t,o,s,n,a){return{init:function(){s=r.blocks,s.composer,n=e.meta,a=l()},toData:function(e){return s.data(e)},toText:function(e){return s.data(e).url},toEditableHTML:function(e){return""},toHTML:function(e){return s.data(e).embed},activate:function(e){a=e,r.populate(e)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){var t=s.data(e),o=s.getBlockContent(e);t.embed&&(r.loadScript(),o.html(t.embed)),t.embed||o.html(l(n.html)),e.find(r.source.selector).off("paste").on("paste",function(e){e.stopPropagation()})},deconstruct:function(e){var t=s.getBlockContent(e);return r.form.inside(t).remove(),r.loader.inside(t).remove(),e},refocus:function(e){},reset:function(e){},populate:function(e){e=s.data(e);e.url&&r.fsSource().val(e.url)},isUrlValid:function(e){if(""==e)return!1;return/^https:\/\/.+\.pinterest\.com\/pin\/(.*)$/.test(e)},insertEmbed:function(e,t){var o=s.getBlockContent(e),n=s.data(e),e=l("<a>");if(e.attr("data-pin-do","embedPin").attr("href",t),n.url=t,n.embed=e.toHTML(),!r.isUrlValid(t))return r.errorMessage().removeClass("hide"),!1;o.html(e.toHTML()),r.form.inside(o).addClass("hidden")},scriptLoaded:!1,scriptLoadedFromAjax:!1,scriptMainLoadedFromAjax:!1,loadScriptFromAjax:function(){r.scriptLoadedFromAjax?(l("<script>").attr("type","text/javascript").attr("src","//assets.pinterest.com/js/pinit_main.js").appendTo("head"),r.scriptMainLoadedFromAjax=!0):(l("<script>").attr("type","text/javascript").attr("src","//assets.pinterest.com/js/pinit.js").appendTo("head"),r.scriptLoadedFromAjax=!0)},loadScript:function(){r.scriptLoaded||(l("<script>").attr("type","text/javascript").attr("src","//assets.pinterest.com/js/pinit.js").appendTo("head"),r.scriptLoaded=!0,r.scriptLoadedFromAjax=!0)},"{insert} click":function(e){a.length<1&&(t=r.block.of(e),s.activateBlock(t));var t=s.getBlockContent(a),t=r.source.inside(t).val();r.fsSource().val(t),r.hideForm(a),r.crawl(a,t)},crawl:function(a,i){EasyBlog.ajax("site/views/crawler/crawl",{url:i}).done(function(e){r.loadScriptFromAjax();var t=e[i],o=s.getBlockContent(a),n=s.data(a),e=l("<a>");if(n.url=t.opengraph.url,e.attr("data-pin-do","embedPin").attr("href",n.url),n.embed=e.toHTML(),!r.isUrlValid(n.url))return r.showForm(a),r.errorMessage().removeClass("hide"),!1;o.html(e.toHTML()),r.form.inside(o).addClass("hidden")}).fail(function(e){r.showForm(a),r.errorMessage().html(e).removeClass("hide")})},showForm:function(e){e=s.getBlockContent(e);r.form.inside(e).removeClass("hidden"),r.loader.inside(e).addClass("hidden")},hideForm:function(e){e=s.getBlockContent(e);r.form.inside(e).addClass("hidden"),r.loader.inside(e).removeClass("hidden")},"{fsUpdate} click":function(){s.getBlockContent(a);var e=r.fsSource().val();r.hideForm(a),r.crawl(a,e)}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/polls",function(g){EasyBlog.Controller("Composer.Blocks.Handlers.Polls",{defaultOptions:{"{composeButton}":"[data-poll-compose-button]","{updateButton}":"[data-poll-update-button]"}},function(f,e,t,o,h,n,a){return{init:function(){h=f.blocks,h.composer,n=e.meta,a=g()},toData:function(e){return h.data(e)},toText:function(e){},toEditableHTML:function(e){return""},toHTML:function(e){},activate:function(e){h.getBlockContent(e),h.data(e);a=e,f.updateButton.inside(a).removeClass("t-hidden")},deactivate:function(e){f.updateButton.inside(a).addClass("t-hidden")},construct:function(e){},populate:function(){},reconstruct:function(e){var t=h.data(e);if(!t.pollId){if(t.toRemove)return void h.removeBlock(e);h.getBlockContent(e).html(n.html)}e=Date.now();t.identifier=e,f.isSaving.push(t.identifier,!1)},deconstruct:function(e){},refocus:function(e){},reset:function(e){},isBlockActive:function(){return!!a.hasClass("active")},"{composeButton} click":function(){f.isBlockActive()&&f.displayPopUpForm()},"{updateButton} click":function(){var e;f.isBlockActive()&&(e=h.data(a),f.displayPopUpForm(e.pollId))},isSaving:[],displayPopUpForm:function(u){var p=h.getBlockContent(a),m=h.data(a);u=void 0===u?0:u,EasyBlog.dialog({content:EasyBlog.ajax("site/views/polls/form",{pollId:u,isComposer:1}),bindings:{"{saveButton} click":function(e,t){var o,n,a,i,r,s,l,c,d;f.isSaving[m.identifier]||(f.isSaving[m.identifier]=!0,c=(i=(e=g(e)).closest(".eb-dialog-footer").closest(".eb-dialog-modal").find(".eb-dialog-content")).find("[data-eb-poll-form]"),o=i.find("[data-poll-error]"),r=c.find("[data-eb-poll-form-select]"),l=c.find("[data-eb-poll-form-create]"),n={},a="savePoll",r.is(":checked")&&(s=c.find("[data-unassociated-post-polls-list]").val(),a="selectPoll",n.selectedPollId=s),"savePoll"!=a&&!l.is(":checked")||(i=c.find("[data-eb-poll-form-title]").val(),r=c.find("[data-eb-poll-form-multiple]").find('input[type="hidden"]').val(),s=c.find("[data-eb-poll-form-unvote]").find('input[type="hidden"]').val(),l=c.find("[data-eb-poll-form-expiration]").find("[data-datetime]").val(),c=c.find("[data-eb-poll-form-item]"),d=[],g.each(c,function(e,t){var o=g(t),t=o.data("id"),o=o.find("input").val();d.push({id:t||0,content:o})}),a="savePoll",n.title=i,n.items=d,n.multiple=parseInt(r),n.unvote=parseInt(s),n.expiry_date=l),o.addClass("t-hidden"),e.addClass("is-loading"),EasyBlog.ajax("site/views/polls/save",{formOption:a,pollId:u,postData:JSON.stringify(n)}).done(function(e){p.empty(),"savePoll"==a&&u&&h.getAllBlocks().find('[data-poll-form][data-id="'+e.id+'"]').html(e.html),p.html(e.html),m.pollId=e.id,EasyBlog.dialog().close()}).fail(function(e){o.find("[data-fd-alert-message]").html(e),o.removeClass("t-hidden")}).always(function(){e.removeClass("is-loading"),f.isSaving[m.identifier]=!1}))}}})}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/post",function(s){EasyBlog.Controller("Composer.Blocks.Handlers.Post",{defaultOptions:{"{block}":".ebd-block[data-type=text]","{wrapper}":"> div[data-text-wrapper]","{lastParagraph}":"> div > p:last","{mediaPreview}":"[data-post-media]","{introPreview}":"[data-post-intro]","{linkPreview}":"[data-post-link-preview]","{titlePreview}":"[data-preview-title]","{showImage}":"[data-post-option-image]","{showIntro}":"[data-post-option-intro]","{showHyperlink}":"[data-post-option-link]"}},function(n,e,t,o,a,i,r){return{init:function(){a=n.blocks,o=a.composer,i=e.meta,r=s()},activate:function(e){var t=a.data(e);r=e,n.showImage().val(0==t.show_image?0:1).trigger("change"),n.showIntro().val(0==t.show_intro?0:1).trigger("change"),n.showHyperlink().val(0==t.show_link?0:1).trigger("change"),n.populate()},deactivate:function(){},construct:function(e){var t=a.createBlockContainer("post"),e=s.extend({},i.data,e),o=s(e.content);return o.find("[data-post-title]").html(e.title),o.find("[data-post-link]").attr("href",e.url),o.on("click",function(e){e.preventDefault()}),o.find("[data-post-link-preview]").html(e.url),o.find("[data-post-intro]").html(e.intro),e.image?o.find("[data-post-image]").attr("src",e.image):o.find("[data-post-image]").remove(),a.content.inside(t).append(o),s.extend(a.data(t),e),t},reconstruct:function(e){var t=a.getBlockContent(e);a.data(e);t.find("[data-post-link]").on("click",function(e){e.preventDefault()})},deconstruct:function(e){var t=n.wrapper.inside(e),o=t.parent();return t.children().appendTo(o),t.remove(),e},refocus:function(e){var t=n.wrapper.inside(e),e=n.lastParagraph.inside(e);t.focus(),o.editor.caret.setEnd(e)},reset:function(e){(e=a.getBlockContent(e)).html(i.content)},populate:function(e){},recover:function(e){},revert:function(e){},toText:function(e){return(e=a.getBlockContent(e)).text()},toHTML:function(e){e=(e=a.getBlockContent(e)).clone(),n.deconstruct(e).html();return n.deconstruct(e).html()},toData:function(e){var t=a.data(e);return t.content=n.toHTML(e),t},"{showImage} change":function(e,t){var o=a.getBlockContent(r),e=1==e.val();(a.data(r).show_image=e)?n.mediaPreview.inside(o).show():n.mediaPreview.inside(o).hide()},"{showIntro} change":function(e,t){var o=a.getBlockContent(r),e=1==e.val();(a.data(r).show_intro=e)?n.introPreview.inside(o).show():n.introPreview.inside(o).hide()},"{showHyperlink} change":function(e,t){var o=a.getBlockContent(r),e=1==e.val();(a.data(r).show_link=e)?n.linkPreview.inside(o).show():n.linkPreview.inside(o).hide()}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/quotes",function(i){EasyBlog.Controller("Composer.Blocks.Handlers.Quotes",{defaultOptions:{"{styleSelection}":"[data-eb-composer-block-quotes-style] [data-style]","{citation}":"[data-quotes-citation]","{blockquote}":"> blockquote","{cite}":"> blockquote > cite","{text}":"> blockquote > p"}},function(r,t,e,o,s,n,l){return{init:function(){s=r.blocks,s.composer,t.meta,l=i()},reconstruct:function(e){},deconstruct:function(e){var t=s.getBlockContent(e);return r.text.inside(t).editable(!1),r.cite.inside(t).editable(!1),e},toData:function(e){return s.data(e)},toText:function(e){},toHTML:function(e){e=e.clone(),e=r.deconstruct(e);return s.getBlockContent(e).html()},activate:function(e){l=e,r.populate(e)},deactivate:function(e){},construct:function(e){e=i.extend({},t.data,e);return content},refocus:function(e){var t=s.data(e);t.style&&r.setStyle(e,t.style)},reset:function(e){e.hasClass("is-new")||s.getBlockContent(e).html(r.construct())},populate:function(e){e=s.data(e);r.styleSelection("[data-style="+e.style+"]").activateClass("active"),r.citation().val(e.citation).trigger("change")},setStyle:function(e,t){s.data(e,"current",t),r.styleSelection().removeClass("selected"),r.styleSelection().where("style",t).addClass("selected");t=[e,r,t];r.trigger("composerBlockQuotesSetStyle",t),r.trigger("composerBlockChange",t)},"{styleSelection} click":function(e){e=e.data("style");s.data(l).style=e,r.setStyle(l,e)},"{self} composerBlockQuotesSetStyle":function(e,t,o,n,a){clearTimeout(r.previewTimer);var i=s.getBlockContent(l);r.blockquote.inside(i).switchClass(a),r.populate(o)},"{citation} change":function(e,t){var o=s.data(l),n=1==i(e).val()?1:0,a=!n,e=s.getBlockContent(l);o.citation=n,r.cite.inside(e).toggleClass("hidden",a)}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/readmore",function(s){EasyBlog.Controller("Composer.Blocks.Handlers.Readmore",{defaultOptions:{}},function(n,e,t,o,a,i,r){return{init:function(){a=n.blocks,a.composer,i=e.meta,r=s()},toData:function(e){return a.data(e)},toText:function(e){},toHTML:function(e){var t=s.create("hr");return t.attr("id","system-readmore"),t.toHTML()},deactivate:function(e){},activate:function(e){r=e,blockActions=a.getBlockActions(r),blockActions.find("[data-blocks-duplicate]").remove(),n.populate(e)},deconstruct:function(e){},construct:function(e){},reconstruct:function(e){a.data(e);e=a.getBlockContent(e);n.hideMenu(),e.html(i.html)},refocus:function(e){},reset:function(e){},populate:function(e){},showMenu:function(){a.menu().where("type","readmore").removeClass("hide")},hideMenu:function(){a.menu().where("type","readmore").addClass("hide")},"{self} composerBlockAdd":function(e,t,o){"readmore"==a.getBlockType(o)&&n.hideMenu()},"{self} composerBlockRemove":function(e,t,o){"readmore"==a.getBlockType(o)&&n.showMenu()}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/rule",function(i){EasyBlog.Controller("Composer.Blocks.Handlers.Rule",{defaultOptions:{"{rule}":"> hr","{styleSelection}":"[data-eb-composer-rule-style] [data-style]"}},function(r,t,e,o,s,n,a){return{init:function(){s=r.blocks,s.composer,t.meta,a=i()},activate:function(e){a=e,r.populate(e)},construct:function(e){e=i.extend({},t.data,e);return i("<hr/>")},toText:function(e){},toData:function(e){return s.data(e)},toHTML:function(e){s.data(e);return s.getBlockContent(e).html()},reconstruct:function(e){s.data(e)},refocus:function(e){var t=s.data(e);t.style&&r.setStyle(e,t.style)},reset:function(e){s.getBlockContent(e).html(r.construct())},populate:function(e){e=s.data(e);r.styleSelection("[data-style="+e.style+"]").activateClass("active")},setStyle:function(e,t){s.data(e,"current",t),r.styleSelection().removeClass("selected"),r.styleSelection().where("style",t).addClass("selected");t=[e,r,t];r.trigger("composerBlockRuleSetStyle",t),r.trigger("composerBlockChange",t)},"{styleSelection} click":function(e){e=e.data("style");s.data(a).style=e,r.setStyle(a,e),r.refocus(a)},"{self} composerBlockRuleSetStyle":function(e,t,o,n,a){var i=s.getBlockContent(o);r.rule.inside(i).switchClass(a),r.populate(o)}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/section",function(s){EasyBlog.Controller("Composer.Blocks.Handlers.Section",{defaultOptions:{"{columnsHeader}":".row","{columns}":".row > div","{wrapper}":"> div[data-col-wrapper]","{columnRange}":"[data-eb-composer-block-column-range]","{control}":"[data-columns-control]","{controlWidth}":"[data-select-width]","{dropdown}":".eb-composer-manage-tab-name > select ","{listboxItem}":"[data-listbox-item]"}},function(t,o,e,n,i,a,r){return{init:function(){i=t.blocks,i.composer,o.meta,s()},activate:function(e){t.populate(e)},deactivate:function(e){},construct:function(e){e=s.extend({},o.data,e);return content},reconstruct:function(e){},refocus:function(){},deconstruct:function(e){return e},reset:function(e){},populate:function(e){},toHTML:function(e){e=e.clone(),e=t.deconstruct(e);return i.getBlockContent(e).html()},toData:function(e){return i.data(e)},toText:function(e){return i.getBlockContent(e).clone().text()},"{self} composerBlockDuplicate":function(e,t,o,n){var a;"section"==i.getBlockType(o)&&(i.updateBlockUid(o),a=i.data(n),data=i.data(o),s.extend(data,a),i.duplicateChildBlocksData(o,n))}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/sendy",function(s){EasyBlog.Controller("Composer.Blocks.Handlers.Sendy",{defaultOptions:{"{wrapper}":"[data-eb-sendy-wrapper]","{placeholder}":"[data-sendy-placeholder]","{form}":"[data-sendy-form]","{formTitle}":"[data-sendy-title]","{formId}":"[data-sendy-id]","{formInfo}":"[data-sendy-info]","{formEmail}":"[data-sendy-email]","{formName}":"[data-sendy-name]","{formButton}":"[data-sendy-button]","{fieldUrl}":"[data-field-sendy-link]","{fieldId}":"[data-field-sendy-id]","{fieldTitleToggle}":"[data-field-sendy-title-toggle]","{fieldTitle}":"[data-field-sendy-title]","{fieldInfoToggle}":"[data-field-sendy-info-toggle]","{fieldInfo}":"[data-field-sendy-info]","{fieldEmailPlaceholder}":"[data-field-sendy-email-placeholder]","{fieldNameToggle}":"[data-field-sendy-name-toggle]","{fieldNamePlaceholder}":"[data-field-sendy-name-placeholder]","{fieldButton}":"[data-field-sendy-button]"}},function(n,e,t,o,a,i,r){return{init:function(){a=n.blocks,a.composer,e.meta,r=s()},activate:function(e){r=e,n.populate(e)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){a.data(e)},refocus:function(){},deconstruct:function(e){return e},reset:function(e){},populate:function(e){e=a.data(e);n.fieldUrl().val(e.url).trigger("keyup"),n.fieldId().val(e.list_id).trigger("keyup"),n.fieldTitleToggle().val(e.title?1:0).trigger("change"),n.fieldTitle().val(e.title_text).trigger("keyup"),n.fieldInfoToggle().val(e.info?1:0).trigger("change"),n.fieldInfo().val(e.info_text).trigger("keyup"),n.fieldNameToggle().val(e.name?1:0).trigger("change"),n.fieldEmailPlaceholder().val(e.email_placeholder),n.fieldNamePlaceholder().val(e.name_placeholder),n.fieldButton().val(e.button)},toHTML:function(e){e=e.clone(),e=n.deconstruct(e);return a.getBlockContent(e).html()},toData:function(e){return a.data(e)},toText:function(e){return a.getBlockContent(e).clone().text()},getForm:function(){return n.getWrapper().find(n.form.selector)},getPlaceHolder:function(){var e=a.getBlockContent(r);return n.placeholder.inside(e)},getWrapper:function(){var e=a.getBlockContent(r);return n.wrapper.inside(e)},updateForm:function(){var e=a.data(r),t=n.getWrapper(),o=n.getPlaceHolder();if(!e.url||!e.list_id)return t.addClass("t-hidden"),void o.removeClass("t-hidden");t.hasClass("t-hidden")&&(t.removeClass("t-hidden"),o.addClass("t-hidden"),n.updateFormTitle(),n.updateFormId(),n.updateFormButton(),n.updateFormInfo(),n.updateFormEmail(),n.updateFormName(),n.updateFormButton())},updateFormId:function(){var e=n.getForm(),t=a.data(r);e.find(n.formId.selector).val(t.id)},updateFormInfo:function(){var e=n.getForm(),t=a.data(r),e=e.find(n.formInfo.selector);t.info?e.removeClass("t-hidden"):e.addClass("t-hidden"),e.html(t.info_text)},updateFormTitle:function(){var e=n.getForm(),t=a.data(r),e=e.find(n.formTitle.selector);t.title?e.removeClass("t-hidden"):e.addClass("t-hidden"),e.html(t.title_text)},updateFormButton:function(){var e=n.getForm(),t=a.data(r);e.find(n.formButton.selector).text(t.button)},updateFormEmail:function(){var e=n.getForm(),t=a.data(r);e.find(n.formEmail.selector).attr("placeholder",t.email_placeholder)},updateFormName:function(){var e=n.getForm(),t=a.data(r),e=e.find(n.formName.selector);t.name?e.parent().removeClass("t-hidden"):e.parent().addClass("t-hidden"),e.attr("placeholder",t.name_placeholder)},"{fieldUrl} keyup":s.debounce(function(e){a.data(r).url=e.val(),n.updateForm()},300),"{fieldId} keyup":s.debounce(function(e){a.data(r).list_id=e.val(),n.updateForm()},300),"{fieldTitleToggle} change":function(e,t){var o=a.data(r),e=0!=e.val();a.getBlockContent(r);o.title=e,n.updateFormTitle()},"{fieldTitle} keyup":s.debounce(function(e){var t=a.data(r),e=e.val();t.title_text=e,n.updateFormTitle()}),"{fieldInfoToggle} change":function(e,t){var o=a.data(r),e=0!=e.val();a.getBlockContent(r);o.info=e,n.updateFormInfo()},"{fieldInfo} keyup":s.debounce(function(e){var t=a.data(r),e=e.val();t.info_text=e,n.updateFormInfo()}),"{fieldEmailPlaceholder} keyup":s.debounce(function(e){var t=a.data(r),e=e.val();t.email_placeholder=e,n.updateFormEmail()}),"{fieldNameToggle} change":function(e,t){var o=a.data(r),e=0!=e.val();a.getBlockContent(r);o.name=e,n.updateFormName()},"{fieldNamePlaceholder} keyup":s.debounce(function(e){var t=a.data(r),e=e.val();t.name_placeholder=e,n.updateFormName()}),"{fieldButton} keyup":s.debounce(function(e){var t=a.data(r),e=e.val();t.button=e,n.updateFormButton()})}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/slideshare",function(l){EasyBlog.Controller("Composer.Blocks.Handlers.Slideshare",{defaultOptions:l.extend({"{form}":"> [data-slideshare-form]","{insert}":"[data-slideshare-insert]","{source}":"[data-slideshare-source]","{loader}":"> [data-slideshare-loader]","{preview}":"> [data-slideshare-preview]","{fsSource}":"[data-fs-slideshare-source]","{fsUpdate}":"[data-fs-slideshare-update]","{errorMessage}":"[data-slideshare-error]"},EBD.selectors)},function(i,e,t,a,r,s,o){return{init:function(){r=i.blocks,a=r.composer,s=e.meta,o=l()},toText:function(e){return r.data(e).url},toData:function(e){return r.data(e)},toEditableHTML:function(e){return""},toHTML:function(e){return r.data(e).embed},activate:function(e){o=e,i.populate(e)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){var t=r.data(e),o=e.data("overlay"),n=r.getBlockContent(e);t.embed&&!o&&(n.empty(),i.setOverlay(e,t.embed)),t.embed||n.html(l(s.html)),e.find(i.source.selector).off("paste").on("paste",function(e){e.stopPropagation()})},deconstruct:function(e){var t=r.getBlockContent(e);return i.form.inside(t).remove(),i.loader.inside(t).remove(),e},refocus:function(e){},reset:function(e){},populate:function(e){e=r.data(e);i.fsSource().val(e.url)},loading:function(){var e=r.getBlockContent(o);i.isLoading?(i.loader.inside(e).addClass("hidden"),i.form.inside(e).removeClass("hidden"),i.isLoading=!1):(i.loader.inside(e).removeClass("hidden"),i.form.inside(e).addClass("hidden"),i.isLoading=!0)},setOverlay:function(e,t){if(!(o=e.data("overlay"))){var o=a.document.overlay.create(e),n=r.getBlockContent(e);return o.placeholder().css("height","600px").appendTo(n),o.element().append(t),o.attach(),void e.data("overlay",o)}o.element().empty(),o.element().append(t)},isUrlValid:function(e){if(""==e)return!1;return/^(http|https):\/\/www\.slideshare\.net\/(.*)$/.test(e)},crawl:function(t,o){var n=r.getBlockContent(t),a=r.data(t);if(!i.isUrlValid(o))return i.errorMessage().removeClass("hide"),!1;var e=t.data("overlay");e&&e.element().empty(),i.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:o}).then(function(e){e=e[o];return null===e.oembed?l.Deferred().reject():l.Deferred().resolve(e)}).done(function(e){a.url=o,a.embed=e.oembed.html,i.setOverlay(t,a.embed),i.loading(),i.form.inside(n).addClass("hidden")}).fail(function(e){i.errorMessage().removeClass("hide").html(e)})},"{insert} click":function(e){o.length<1&&(t=i.block.of(e),r.activateBlock(t));var t=r.getBlockContent(o),t=i.source.inside(t).val();r.data(o);i.crawl(o,t),i.fsSource().val(t)},"{fsUpdate} click":function(){var e=i.fsSource().val();r.data(o);i.crawl(o,e)}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/soundcloud",function(l){EasyBlog.Controller("Composer.Blocks.Handlers.Soundcloud",{defaultOptions:l.extend({"{form}":"> [data-soundcloud-form]","{insert}":"[data-soundcloud-insert]","{source}":"[data-soundcloud-source]","{loader}":"> [data-soundcloud-loader]","{preview}":"> [data-soundcloud-preview]","{fsSource}":"[data-fs-soundcloud-source]","{fsUpdate}":"[data-fs-soundcloud-update]","{errorMessage}":"[data-soundcloud-error]"},EBD.selectors)},function(i,e,t,a,r,s,o){return{init:function(){r=i.blocks,a=r.composer,s=e.meta,o=l()},toText:function(e){return r.data(e).url},toData:function(e){return r.data(e)},toEditableHTML:function(e){return""},toHTML:function(e){return r.data(e).embed},normalize:function(e){return l.extend({},s.data,e)},activate:function(e){o=e,i.populate(e)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){var t=r.data(e),o=e.data("overlay"),n=r.getBlockContent(e);t.embed&&!o&&(n.empty(),i.setOverlay(e,t.embed)),t.embed||n.html(l(s.html)),e.find(i.source.selector).off("paste").on("paste",function(e){e.stopPropagation()})},deconstruct:function(e){var t=r.getBlockContent(e);return i.form.inside(t).remove(),i.loader.inside(t).remove(),e},refocus:function(e){},reset:function(e){},populate:function(e){e=r.data(e);i.fsSource().val(e.url)},isLoading:!1,loading:function(){var e=r.getBlockContent(o);i.isLoading?(i.loader.inside(e).addClass("hidden"),i.form.inside(e).removeClass("hidden"),i.isLoading=!1):(i.loader.inside(e).removeClass("hidden"),i.form.inside(e).addClass("hidden"),i.isLoading=!0)},setOverlay:function(e,t){var o=e.data("overlay"),n=r.getBlockContent(e);o?(o.element().empty(),o.element().append(t)):((o=a.document.overlay.create(e)).placeholder().css("height","350px").appendTo(n),o.element().append(t),o.attach()),e.data("overlay",o)},isUrlValid:function(e){if(""==e)return!1;return/^https:\/\/soundcloud\.com\/(.*)$/.test(e)},crawl:function(t,o){var n=r.data(t),e=r.getBlockContent(t);if(!i.isUrlValid(o))return i.errorMessage().removeClass("hide"),!1;var a=t.data("overlay");a&&a.element().empty(),i.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:o}).done(function(e){e=e[o];n.url=o,n.embed=e.oembed.html,i.setOverlay(t,n.embed)}).fail(function(e){i.errorMessage().removeClass("hide").html(e)}).always(function(){i.loading(),i.form.inside(e).addClass("hidden")})},"{insert} click":function(e){o.length<1&&(t=i.block.of(e),r.activateBlock(t));var t=r.getBlockContent(o),t=i.source.inside(t).val();i.fsSource().val(t),i.crawl(o,t)},"{fsUpdate} click":function(){var e=i.fsSource().val();i.crawl(o,e)}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/spotify",function(l){EasyBlog.Controller("Composer.Blocks.Handlers.Spotify",{defaultOptions:l.extend({"{form}":"> [data-spotify-form]","{insert}":"[data-spotify-insert]","{source}":"[data-spotify-source]","{loader}":"> [data-spotify-loader]","{errorMessage}":"[data-spotify-error]","{preview}":"> [data-spotify-preview]","{fsSource}":"[data-fs-spotify-source]","{fsRefreshButton}":"[data-fs-spotify-refresh]"},EBD.selectors)},function(a,e,t,i,r,s,o){return{init:function(){r=a.blocks,i=r.composer,s=e.meta,o=l()},toData:function(e){return r.data(e)},toText:function(e){return r.data(e).url},toEditableHTML:function(e){return""},toHTML:function(e){return r.data(e).embed},activate:function(e){o=e,a.populate(e)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){var t=r.data(e),o=e.data("overlay"),n=r.getBlockContent(e);t.embed&&!o&&(n.empty(),a.setOverlay(e,t.embed)),t.embed||n.html(l(s.html)),e.find(a.source.selector).off("paste").on("paste",function(e){e.stopPropagation()})},deconstruct:function(e){var t=r.getBlockContent(e);return a.form.inside(t).remove(),a.loader.inside(t).remove(),e},refocus:function(e){},reset:function(e){},populate:function(e){e=r.data(e);a.fsSource().val(e.url)},isLoading:!1,loading:function(){var e=r.getBlockContent(o);a.isLoading?(a.loader.inside(e).addClass("hidden"),a.form.inside(e).removeClass("hidden"),a.isLoading=!1):(a.loader.inside(e).removeClass("hidden"),a.form.inside(e).addClass("hidden"),a.isLoading=!0)},setOverlay:function(e,t){var o,n=e.data("overlay");n?(n.element().empty(),n.element().append(t)):(n=i.document.overlay.create(e),o=r.getBlockContent(e),n.placeholder().css("height","400px").appendTo(o),n.element().append(t),n.attach()),e.data("overlay",n)},showForm:function(e){e=r.getBlockContent(e);a.form.inside(e).removeClass("hidden")},hideForm:function(e){e=r.getBlockContent(e);a.form.inside(e).addClass("hidden")},crawl:function(t,o){r.getBlockContent(t);var n=r.data(t);if(!a.isUrlValid(o))return a.errorMessage().removeClass("hide"),!1;var e=t.data("overlay");e&&e.element().empty(),a.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:o}).then(function(e){e=e[o];return null===e.oembed?l.Deferred().reject():l.Deferred().resolve(e)}).done(function(e){a.loading(),n.url=o,n.embed=e.oembed.html,a.hideForm(t),a.setOverlay(t,n.embed)}).fail(function(e){a.loading(),a.errorMessage().html(e).removeClass("hide")})},isUrlValid:function(e){if(""==e)return!1;return/^http(s):\/\/open\.spotify\.com\/(track|artist|album|episode)\/(.*)$/.test(e)},"{insert} click":function(e){o.length<1&&(t=a.block.of(e),r.activateBlock(t));var t=r.getBlockContent(o),t=a.source.inside(t).val();a.fsSource().val(t),a.crawl(o,t)},"{fsRefreshButton} click":function(){var e=a.fsSource().val();a.crawl(o,e)}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/table",function(d){EasyBlog.Controller("Composer.Blocks.Handlers.Table",{defaultOptions:{"{tableContainer}":"> .table-container","{table}":"table","{row}":"tr","{cell}":"td","{cellContent}":"td div[contenteditable]","{loading}":"[data-table-loading]","{tableStriped}":"[data-table-striped]","{tableBordered}":"[data-table-bordered]","{tableHover}":"[data-table-hover]","{tableCondensed}":"[data-table-condensed]","{tableRowFieldset}":"[data-table-rows]","{addRow}":"[data-table-rows-add]","{removeRow}":"[data-table-rows-remove]","{tableColumns}":"[data-table-columns]","{tableColumnsAdd}":"[data-table-columns-add]","{tableColumnsRemove}":"[data-table-columns-remove]"}},function(s,e,t,n,l,o,c){return{init:function(){l=s.blocks,n=l.composer,e.meta,c=d()},activate:function(e){c=e,s.populate(e),e.on("keydown.tab",s.cellContent.selector,function(e){var t,o;9==e.which&&(t=d(e.target).parent(),o=(o=s.cell.inside(c)).eq(Math.min(o.index(t)+1,o.length-1)).find("> div[contenteditable]"),n.editor.caret.setAfter(o[0].lastChild),e.stopPropagation())})},deactivate:function(e){e.off("keydown.tab")},construct:function(e){return content},deconstruct:function(e){},reconstruct:function(e){},refocus:function(e){var t=l.getBlockContent(e);(e.data("lastFocused")||s.cell.inside(t).filter(":first")).focus()},reset:function(e){},populate:function(e){e=l.data(e);s.tableStriped().val(e.striped).trigger("change"),s.tableBordered().val(e.bordered).trigger("change"),s.tableHover().val(e.hover).trigger("change"),s.tableCondensed().val(e.condensed).trigger("change"),s.tableRowFieldset().val(e.rows),s.tableColumns().val(e.columns)},toHTML:function(e){s.loader(!1);e=l.getBlockContent(e),e=s.table.inside(e).clone();return d.each(e.find("td"),function(e,t){(t=d(t)).html(t.find("div[contenteditable]").html())}),e[0].outerHTML},toData:function(e){return l.data(e)},toText:function(e){e=l.getBlockContent(e);return s.table.inside(e).text()},"{tableStriped} change":function(e,t){var o=l.getBlockContent(c),e=e.val();s.table.inside(o).toggleClass("table-striped",1==e),l.data(c,"striped",1==e?1:0)},"{tableBordered} change":function(e,t){var o=l.getBlockContent(c),e=e.val();s.table.inside(o).toggleClass("table-bordered",1==e),l.data(c,"bordered",1==e?1:0)},"{tableHover} change":function(e,t){var o=l.getBlockContent(c),e=e.val();s.table.inside(o).toggleClass("table-hover",1==e),l.data(c,"hover",1==e?1:0)},"{tableCondensed} change":function(e,t){var o=l.getBlockContent(c),e=e.val();s.table.inside(o).toggleClass("table-condensed",1==e),l.data(c,"condensed",1==e?1:0)},loader:function(e){var t=l.getBlockContent(c),o=s.tableContainer.inside(t);!1!==e?0<s.loading.inside(t).length||(s.table.inside(o),e=d.create("div").attr("data-table-loading","").css({top:0,left:0,width:"100%",height:"50px",position:"absolute",background:"rgba(0,0,0,0.5)"}).html(d.create("div").css({textAlign:"center",position:"relative",top:"50%",lineHeight:"20px",marginTop:"-10px"}).html('<i class="fdi fa fa-circle-o-notch fa-spin"></i>')),o.append(e)):s.loading.inside(t).remove()},"{tableRowFieldset} change":function(e,t){var o=l.getBlockContent(c),n=e.val(),a=l.data(c);(isNaN(n)||parseInt(n)<1||d.isEmpty(n))&&e.val(n=1);var i,r=(n=parseInt(n))-s.row.inside(o).length;0!=r&&(a.rows=n,i=s.table.inside(o),setTimeout(function(){var e;r<0&&s.row.inside(i).slice(r).remove(),0<r&&(e=parseInt(s.tableColumns().val()),e=Array(1+r).join("<tr>"+Array(e+1).join('<td><div contenteditable="true">&#8203;</div></td>')+"</tr>"),i.append(e)),i.appendTo(o)},50))},"{tableColumns} change":function(e,t){var o=l.getBlockContent(c),n=e.val(),a=l.data(c);(isNaN(n)||parseInt(n)<1||d.isEmpty(n))&&e.val(n=1);var i,n=parseInt(n),e=s.row.inside(o).filter(":first-child"),r=n-s.cell.inside(e).length;0!=r&&(a.columns=n,i=s.table.inside(o),setTimeout(function(){var e,t=s.row.inside(i);r<0&&d.each(t,function(e,t){s.cell.inside(t).slice(r).remove()}),0<r&&(e=Array(1+r).join('<td><div contenteditable="true">&#8203;</div></td>'),t.append(e)),i.appendTo(o)},50))},"{addRow} click":function(e,t){l.getBlockContent(c);var o=parseInt(s.tableRowFieldset().val())+1;s.tableRowFieldset().val(o).trigger("change")},"{removeRow} click":function(e,t){l.getBlockContent(c);var o=Math.max(parseInt(s.tableRowFieldset().val())-1,1);s.tableRowFieldset().val(o).trigger("change")},"{tableColumnsAdd} click":function(e,t){var o=parseInt(s.tableColumns().val())+1;s.tableColumns().val(o).trigger("change")},"{tableColumnsRemove} click":function(e,t){s.tableColumns().val(Math.max(parseInt(s.tableColumns().val())-1,1)).trigger("change")}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/tabs",function(c){EasyBlog.Controller("Composer.Blocks.Handlers.Tabs",{defaultOptions:{"{tabHeader}":".nav-tabs","{tabHeaderListItem}":".nav-tabs > li","{tabHeaderListItemContent}":".nav-tabs > li a","{tabContent}":".tab-content","{tabPane}":"> .tab-content > .tab-pane","{titleItem}":"[data-tab-header-item]","{control}":"[data-tabs-control]","{controlItemContent}":"[data-tabs-control] [data-listbox-item-content]"}},function(r,t,e,i,s,o,l){return{init:function(){s=r.blocks,i=s.composer,t.meta,l=c()},activate:function(e){l=e,r.populate(e)},deactivate:function(e){},construct:function(e){e=c.extend({},t.data,e);return content},reconstruct:function(e){var t;e.hasClass("is-new")&&(s.data(e),t=s.getBlockContent(e),e=c.uid("firsttab"),newcontent=t.html().replace(/firsttab/g,e),t.html(newcontent))},"{self} composerBlockDuplicate":function(e,t,o,n){var a,i;"tabs"==s.getBlockType(o)&&(s.updateBlockUid(o),a=s.data(n),data=s.data(o),c.extend(data,a),s.duplicateChildBlocksData(o,n),clonedContent=s.getBlockContent(o),i=r.tabHeaderListItem.inside(o).find("a"),c.each(i,function(e,t){var o=c(i[e]).attr("href"),n=c.uid("tab-");c(i[e]).attr("href","#"+n),clonedContent.find("div"+o).attr("id",n)}))},deconstruct:function(n){return c.each(n.find("[data-tab-wrapper]"),function(e,t){var o=(t=c(t)).parent();o.removeAttr("contenteditable"),t.children().appendTo(o),t.remove(),r.tabHeaderListItemContent.inside(n).eq(e).removeAttr("contenteditable")}),n},refocus:function(e){r.tabPane.inside(e).filter(".active").focus()},reset:function(e){},recover:function(e){},populate:function(e){e=s.data(e);r.control().listbox().listbox("populate",e.tabs,function(e,t){e.listboxitem("content",t)})},revert:function(e){},toHTML:function(e){e=e.clone(),e=r.deconstruct(e);return s.getBlockContent(e).html()},toData:function(e){return s.data(e)},toText:function(e){e=e.clone();return r.deconstruct(e).text()},tab:{create:function(e){var t=c.uid("tab-"),o='<li><a href="#'+t+'" role="tab" data-bp-toggle="tab" data-tab-title contenteditable="true"></a></li>',n=c("<div></div>",{class:"tab-pane",id:t}),a=c("<div></div>",{class:"ebd-nest","data-type":"block","data-tab-wrapper":""}),t=s.constructNestedBlock("text");a.wrapInner(t),n.wrapInner(a),r.tabContent.inside(l).filter(":first").append(n),r.tabHeader.inside(l).filter(":first").append(o),i.blocks.tree.populate()},remove:function(e){var t=r.tabContent.inside(l).filter(":first").children(".tab-pane").eq(e);t.find(EBD.nestedBlock).each(function(){var e=c(this);s.removeBlock(e,{skipPanelTrigger:!0,skipFontTrigger:!0})}),t.remove(),r.tabHeaderListItem.inside(l).eq(e).remove()},focus:function(e){r.tabHeaderListItem.inside(l).eq(e).find("a").tab("show")}},"{tabHeaderListItem} click":function(e){e.find("a").tab("show")},"{tabHeaderListItemContent} keyup":c.debounce(function(e,t){"13"!=(t.keyCode||t.which)&&(t=e.parents(".nav-tabs > li").index(),e=e.html().replace(/(<br>\s*)+$/,""),r.control().listbox("getItems").eq(t).listboxitem("content",e),s.data(l).tabs[t].content=e)},250),"{tabHeaderListItemContent} click":function(e,t){t.preventDefault()},"{tabHeaderListItemContent} keydown":function(e,t){"13"==(t.keyCode||t.which)&&t.preventDefault()},"{control} listboxBeforeAddItem":function(e,t,o){r.tab.create();o=o.listboxitem("toData");r.tabHeader.inside(l).filter(":first").find("li").filter(":last").find("a").html(o.content)},"{control} listboxAfterAddItem":function(e,t,o){s.data(l).tabs=r.control().listbox("toData"),1==r.tabContent.inside(l).length&&r.tabHeaderListItem.inside(l).filter(":first").find("a").tab("show")},"{control} listboxBeforeRemoveItem":function(e,t,o){o=o.index();r.tab.remove(o)},"{control} listboxAfterRemoveItem":function(e,t,o){s.data(l).tabs=r.control().listbox("toData"),1==r.tabContent.inside(l).length&&r.tabHeaderListItem.inside(l).filter(":first").find("a").tab("show")},"{control} listboxAfterToggleDefault":function(e,t,o){s.data(l).tabs=r.control().listbox("toData")},"{controlItemContent} keyup":c.debounce(function(e,t){"13"!=(t.keyCode||t.which)&&(t=e.parents("[data-listbox-item]").index(),e=e.html().replace(/(<br>\s*)+$/,""),r.tabHeaderListItem.inside(l).eq(t).find("a").html(e),s.data(l).tabs[t].content=e)},250),"{controlItemContent} keypress":function(e,t){"13"==(t.keyCode||t.which)&&t.preventDefault()}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/ted",function(o){EasyBlog.Controller("Composer.Blocks.Handlers.Ted",{elements:["[data-ted-fieldset-{url|fluid|width-fieldset|height-fieldset|width|height|update-url}]"],defaultOptions:o.extend({"{form}":"> [data-ted-form]","{insert}":"[data-ted-insert]","{source}":"[data-ted-source]","{loader}":"> [data-ted-loader]","{errorMessage}":"[data-ted-error]","{player}":"iframe","{wrapper}":"[data-ted-wrapper]"},EBD.selectors)},function(i,e,t,n,r,a,s){return{init:function(){r=i.blocks,n=r.composer,a=e.meta,s=o()},toData:function(e){var t=r.data(e),e=e.data("overlay");if(!e)return t;e=i.player.inside(e.element());return t.source=e.attr("src"),t},toText:function(e){return r.data(e).source},toHTML:function(e){var t=e.clone(),e=(r.data(t),e.data("overlay"));if(e)return e.element().html()},activate:function(e){r.getBlockContent(e),r.data(e);s=e,i.populate(e)},deactivate:function(e){},construct:function(e){},getWrapper:function(e){return o(a.wrapper)},reconstruct:function(e){var t=r.data(e),o=e.data("overlay"),n=r.getBlockContent(e);t.source&&!o?i.setOverlay(e):!t.source&&t.url?(n.html(a.html),i.crawl(t.url,e)):n.html(a.html),e.find(i.source.selector).off("paste").on("paste",function(e){e.stopPropagation()})},deconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){r.data(e);i.updateFieldset(e)},updateFieldset:function(e){e=r.data(e);i.url().val(e.url),i.width().val(e.width),i.height().val(e.height),i.fluid().val(e.fluid?"1":"0").trigger("change")},getOverlay:function(e){var t=e.data("overlay"),o=(r.data(e),r.getBlockContent(e));return t||(t=n.document.overlay.create(e),e=i.getWrapper(),t.placeholder().appendTo(e),o.empty().append(e),t.attach()),t},setWrapperLayout:function(e){var t=i.wrapper.inside(e),e=r.data(e);e.fluid?t.addClass("is-responsive").css({width:"",height:""}):(t.hasClass("is-responsive")&&(e.width=t.width(),e.height=t.outerHeight()),i.width().val(e.width),i.height().val(e.height),t.css({width:e.width,height:e.height}).removeClass("is-responsive"))},setOverlay:function(e){var t=r.data(e),o=i.getOverlay(e);0<o.element().length&&o.element().empty(),i.setWrapperLayout(e),o.element().append(t.embed),o.refresh(),e.data("overlay",o)},isUrlValid:function(e){if(""==e)return!1;return/^(http|https):\/\/www\.ted\.com\/talks\/(.*)$/.test(e)},loading:function(){var e=r.getBlockContent(s),t=i.loader.inside(e),e=i.form.inside(e);i.isLoading?(t.addClass("hidden"),e.removeClass("hidden"),i.isLoading=!1):(t.removeClass("hidden"),e.addClass("hidden"),i.isLoading=!0)},crawl:function(t,o){var n=r.data(o),e=r.getBlockContent(o),a=o.data("overlay");a&&a.element().empty();t="http://www.ted.com/services/v1/oembed.json?url="+encodeURIComponent(t);i.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:t}).done(function(e){e=e[t];n.url=t,n.title=e.oembed.title,n.author={name:e.oembed.author_name,url:e.oembed.author_url},n.embed=e.oembed.html,n.permalink=e.oembed.url,i.setOverlay(o),i.updateFieldset(o)}).fail(function(e){i.errorMessage().removeClass("hide").html(e)}).always(function(){i.loading(),i.form.inside(e).addClass("hidden")})},"{insert} click":function(e){s.length<1&&(t=i.block.of(e),r.activateBlock(t));var t=r.getBlockContent(s),t=i.source.inside(t).val();r.data(s);i.isUrlValid(t)?i.crawl(t,s):i.errorMessage().removeClass("hide")},"{fluid} change":function(e,t){var o=1==e.val(),e=r.data(s);e.fluid=o,e.url&&(i.setWrapperLayout(s),i.widthFieldset().toggleClass("hide",o),i.heightFieldset().toggleClass("hide",o),i.getOverlay(s).refresh())},"{width} keyup":o.debounce(function(e,t){var o=r.data(s),e=e.val();0!=e&&(o.width=e,i.getOverlay(s),i.wrapper.inside(s).css("width",e),i.getOverlay(s).refresh())},250),"{height} keyup":o.debounce(function(e,t){var o=r.data(s),e=e.val();0!=e&&(o.height=e,i.wrapper.inside(s).css("height",e),i.getOverlay(s).refresh())},250),"{updateUrl} click":function(e,t){var o=i.url().val(),n=(r.data(s),r.getBlockContent(s));i.isUrlValid(o)?i.crawl(o,s):i.errorMessage.inside(n).removeClass("hide")}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/text",function(s){EasyBlog.Controller("Composer.Blocks.Handlers.Text",{defaultOptions:{"{block}":".ebd-block[data-type=text]","{blockWrapper}":"> [data-eb-text-block-wrapper]","{contentWrapper}":"> [data-eb-text-block-wrapper] > [data-eb-text-content-wrapper]","{allContentWrapper}":"[data-eb-text-content-wrapper]","{lastParagraph}":"> p:last"}},function(a,e,t,o,i,n,r){return{init:function(){i=a.blocks,i.composer,n=e.meta,s()},activateKeys:function(){s(document).off("keydown.blocks.text")},deactivateKeys:function(){s(document).on("keydown.blocks.text",function(e){var t=e.which;return 33!=t&&34!=t||(e.preventDefault(),!1)})},getContent:function(e){e=i.getBlockContent(e);return a.contentWrapper.inside(e).find("p").text()},activate:function(e){a.deactivateKeys(),content=a.getContent(e),content=s.trim(content);e=i.getBlockContent(e),e=a.contentWrapper.inside(e);(content==n.data.default?e.find("> p").html("&nbsp;"):e).focus(),a.populate()},deactivate:function(e){a.activateKeys();var t=a.getContent(e);0!=(t=s.trim(t)).length&&" "!=t||(e=i.getBlockContent(e),1===(e=a.contentWrapper.inside(e).find("> p")).length&&e.html(n.data.default))},construct:function(e){var t=i.createBlock("text");return i.getBlockContent(t).html(n.data.content),t},reconstruct:function(e){var t=i.getBlockContent(e),e=a.blockWrapper.inside(t);e.length||(e=s(n.blockWrapper).append(t[0].childNodes).appendTo(t));var o,t=a.contentWrapper.inside(t);t.length||(o=[],s.each(e[0].childNodes,function(){s(this).is(EBD.block)||o.push(this)}),s(n.contentWrapper).append(o).appendTo(e))},"{self} composerBlockDuplicate":function(e,t,o,n){"text"==i.getBlockType(o)&&(i.updateBlockUid(o),i.duplicateChildBlocksData(o,n))},"{block} keydown":function(e,t){var o=t.keyCode;t.metaKey&&13==o&&(o=i.createBlock("text"),i.addBlock(o),i.activateBlock(o))},deconstruct:function(e){var t=i.getBlockContent(e),o=a.contentWrapper.inside(t);if(0==o.length)return e;var n=o[0].childNodes,o=t.find(EBD.immediateNestedBlock).filter(":not(.is-isolated)");return t.empty().append(o).append(n),e},refocus:function(e){e=i.getBlockContent(e);a.contentWrapper.inside(e).focus()},reset:function(e){},populate:function(e){},recover:function(e){},revert:function(e){},toText:function(e){e=e.clone(),e=a.deconstruct(e);return i.getBlockContent(e).text()},toHTML:function(e){e=e.clone(),e=a.deconstruct(e);return i.getBlockContent(e).html()},toData:function(e){},"{self} composerListFormat":function(e,t,o){"text"==i.getBlockType(o)&&(a.reconstruct(o),o.find(".redactor-selection-marker").each(function(){var e=s(this);e.find("ul, ol").length&&e.children().insertBefore(e)}))},"{allContentWrapper} mouseup":function(e){e=i.block.of(e);i.font.populateFontFormatting(e)},"{allContentWrapper} keyup":s.debounce(function(e){e=i.block.of(e);i.font.populateFontFormatting(e)},100)}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/thumbnails",function(b){var a="view-selectratio",i="view-customratio";EasyBlog.Controller("Composer.Blocks.Handlers.Thumbnails",{elements:["[data-eb-thumbnails-{layout-fieldset|layout-selection|size-fieldset|strategy-field|strategy-menu-item}]","[data-eb-thumbnails-columns-field] [data-eb-{"+["numslider","numslider-toggle","numslider-widget","numslider-value","numslider-input"].join("|")+"}]","[data-eb-thumbnails-{ratio-button|ratio-label|ratio-customize-button|ratio-cancel-button|ratio-use-custom-button|ratio-cancel-custom-button|alignment-selection|size-field|ratio-selection|ratio-input}]"],defaultOptions:{"{thumbUploadPlaceholder}":".eb-thumbs-upload-placeholder","{thumbContainer}":".eb-thumbs","{thumbColumn}":".eb-thumbs-col","{thumbItem}":".eb-thumb","{thumbViewport}":"> div","{thumbPlaceholder}":".eb-thumb-placeholder","{thumbImage}":".ebd-block[data-type=image]","{browseButton}":"[data-eb-thumbnails-browse]","{sourceChangeButton}":"[data-eb-image-source-change-button]"}},function(h,e,t,o,g,s,c,n,v){return{init:function(){g=h.blocks,g.composer,s=e.meta,c=b(),g.dimensions,mediaManager=EasyBlog.MediaManager,mediaUploader=mediaManager.uploader,h.initImageBlockHandler(),h.initIndexing(c)},initIndexing:function(e){e=h.thumbItem.inside(e);indexing=b(e).length},normalize:function(e){return b.extend({},s.data,e)},activate:function(e){c=e,h.initIndexing(e),h.populate(e),h.initSortable(e)},deactivate:function(e){h.destroySortable(e)},initSortable:function(e){var t;window.ezb.mobile||(t=h.thumbColumn.inside(e),e=h.thumbContainer.inside(e),b(t).data("ui-sortable")||b(t).sortable({connectWith:".eb-thumbs-col",placeholder:"eb-thumb",containment:e}).disableSelection())},destroySortable:function(e){if(!window.ezb.mobile){e=h.thumbColumn.inside(e);if(b(e).data("ui-sortable"))try{b(e).sortable("destroy")}catch(e){}}},construct:function(e){},initImageBlockHandler:function(){null==v&&(g=h.blocks,v=g.getBlockHandler("image"))},constructImage:function(o,n,e){h.initImageBlockHandler();var t=h.addThumbItem(o),a=g.data(o);const i=a.strategy,r=a.layout,s=a.column_count;t.removeClass("is-uploading"),t.find(".eb-loader-o").remove();var l=h.thumbViewport.inside(t);t.append(l),b.each(e,function(e,t){t=h.createThumbImage(o,n,t);l.html(t),"stack"===r&&1===s&&(v.toAdvancedImageMode(t),v.resizeToViewport(t,i))}),h.thumbContainer.inside(o).removeClass("is-empty"),h.activate(c)},reconstruct:function(e){e.editable(!1);e=h.thumbUploadPlaceholder.inside(e);EasyBlog.MediaManager.uploader.register(e)},deconstruct:function(e){return h.destroySortable(e),h.thumbUploadPlaceholder.inside(e).remove(),e},refocus:function(e){},reset:function(e){},toData:function(e){return g.data(e)},toText:function(e){},toHTML:function(e){e=e.clone(),e=h.deconstruct(e);return g.getBlockContent(e).html()},createThumbItem:function(){return b(s.thumbItem)},addThumbItem:function(e){var t=h.createThumbItem();return t.attr("data-position",indexing),indexing++,h.getNextColumn(e).append(t),t},getNextColumnIndex:function(e){var t=g.data(e),e=h.thumbItem.inside(e).length,t=t.column_count;return h.getColumnIndex(e,t)},getColumnIndex:function(e,t){return e-Math.floor(e/t)*t},getNextColumn:function(e){var t=h.getNextColumnIndex(e);return h.thumbColumn.inside(e).eq(t)},createThumbPlaceholder:function(){return b(s.thumbPlaceholder)},createThumbImage:function(e,t,o){var n=g.data(e),a=t.uri,i=mediaManager.getVariation(a,"small"),r=mediaManager.getVariation(a,"large"),s=i.width,l=i.height,c=s/l,d=!1,u=!1,p="",e="";null!=o.meta.params&&(d=(t=JSON.parse(o.meta.params)).caption_text,u=t.alt_text,p=void 0!==t.extension?t.extension:""),"webp"==p&&(e=o.meta.fallbackItem.meta);a={uri:a,url:i.url,variation:i.key,extension:p,fallbackItem:e,mode_lock:!0,width_lock:!0,height_lock:!0,element_ratio:c,natural_width:s,natural_height:l,natural_ratio:c,caption_enabled:!0,caption_text:d,alt_text:u,link_enabled:!1,style_enabled:!1,size_enabled:!1,popup_uri:a,popup_url:r.url,popup_variation:r.key},r=n.layout;const m=n.strategy;"stack"===r&&b.extend(a,{mode:"simple",fluid:!1,width:"100%"}),"grid"===r&&b.extend(a,{mode:"advanced",fluid:!0,width:"100%",height:"100%",ratio:n.ratio,strategy:n.strategy});var f=g.constructNestedBlock("image",a).addClass("is-isolated");return h.initImageBlockHandler(),"grid"===r&&setTimeout(function(){v.toAdvancedImageMode(f),v.setImageRatio(f,n.ratio),v.resizeToViewport(f,m)},150),f},"{thumbUploadPlaceholder} mediaUploaderFilesAdded":function(e,t,o,n){var i=g.block.of(e);b.each(n,function(e,t){var o=t.id,n=h.addThumbItem(i);n.addClass("is-uploading").attr("data-file-id",o);var a=h.thumbViewport.inside(n),o=h.createThumbPlaceholder();n.append(a),mediaUploader.addItem(t,o),h.thumbContainer.inside(i).removeClass("is-empty")})},"{thumbUploadPlaceholder} mediaUploaderFileUploaded":function(i,e,t,r,o){var s=r.id,l=o.response.media,c=l.meta;setTimeout(function(){var e=g.block.of(i),t=g.data(e),o=t.layout,n=t.column_count,a=t.strategy,t=h.thumbItem().where("fileId",s);t.removeClass("is-uploading").removeAttr("data-file-id").find(".eb-loader-o").remove(),mediaUploader.removeItem(r,t);t=h.thumbViewport.inside(t),e=h.createThumbImage(e,c,l);t.html(e),"stack"===o&&1===n&&(v.toAdvancedImageMode(e),v.resizeToViewport(e,a))},600)},populate:function(e){var t=h.hasThumbnails(e);g.panel.fieldgroup.get("thumbnails").toggleClass("is-new",!t),t&&(h.populateLayout(e),h.populateColumnCount(e),h.populateResizeStrategy(e),h.populateRatio(e))},fixedViewport:!1,setLayout:function(e,a){h.initImageBlockHandler();var i=g.data(e);i.layout=a;var r=h.thumbImage.inside(e);r.each(function(e){var t=b(this),o=i.strategy,n=i.ratio;"grid"==a&&r.each(function(e){v.toAdvancedImageMode(t),v.setImageRatio(t,n),v.resizeToViewport(t,o)}),"stack"==a&&(!1===h.fixedViewport?(v.toAdvancedImageMode(t),v.resizeToViewport(t,o)):v.toSimpleImageMode(t))}),h.fixedViewport=!0},updateLayout:function(e,t){h.setLayout(e,t),h.populateLayout(e)},populateLayout:function(e){e=g.data(e).layout;h.layoutSelection().removeClass("active").where("value",e).addClass("active"),h.sizeFieldset().switchClass("preset-"+e)},"{layoutSelection} click":function(e){e=e.data("value");h.updateLayout(c,e)},setColumnCount:function(e,o){g.data(e).column_count=o;var t=h.thumbItem.inside(e);t.detach();for(var n=[],a=0;a++<o;)n.push(b(s.thumbColumn));var i=[];t.each(function(e){var t=b(this),o=t.data("position");i[o]=t});for(var r=new Array,a=0;a<i.length;a++)i[a]&&r.push(i[a]);(t=b(r)).each(function(e){var t=b(this),e=h.getColumnIndex(e,o);n[e].append(t)}),h.thumbColumn.inside(e).remove(),h.thumbContainer.inside(e).append(n),e.hasClass("active")&&h.initSortable(e)},updateColumnCount:function(e,t){h.setColumnCount(e,t),h.populateColumnCount(e)},populateColumnCount:function(e){e=g.data(e).column_count;h.resizingFromSlider||(e={start:e,step:1,range:{min:1,max:8},pips:{mode:"values",values:[1,2,3,4,5,6,7,8],density:16}},h.numsliderWidget().find(".noUi-pips").remove().end().noUiSlider(e,!0).noUiSlider_pips(e.pips))},"{numsliderWidget} set":function(e,t,o){h.resizingFromSlider=!0;o=Math.round(o);h.updateColumnCount(c,o);o=g.data(c).layout;h.updateLayout(c,o),h.resizingFromSlider=null},setRatio:function(e,o){h.initImageBlockHandler(),g.data(e).ratio=o,h.thumbImage.inside(e).each(function(e){var t=b(this);v.setImageRatio(t,o)})},updateRatio:function(e,t){h.setRatio(e,t),h.populateRatio(e)},populateRatio:function(e){e=g.data(e).ratio;h.ratioLabel().html(e)},"{ratioButton} click":function(e){h.sizeFieldset().switchClass(a)},"{ratioCustomizeButton} click":function(e){h.sizeFieldset().switchClass(i)},"{ratioCancelButton} click":function(e){h.sizeFieldset().removeClass(a)},"{ratioCancelCustomButton} click":function(e){h.sizeFieldset().switchClass(a)},"{ratioOkCustomButton} click":function(e){h.sizeFieldset().removeClass(i)},"{ratioUseCustomButton} click":function(e){var t=function(e){if(e=b.trim(e),/\:/.test(e)){var t=e.split(":");return parseInt(t[0])+":"+parseInt(t[1])}return parseFloat(e)||0}(h.ratioInput().val());0!=t&&(h.updateRatio(c,t),h.ratioSelection().removeClass("active"),h.sizeFieldset().removeClass(i))},"{ratioSelection} click":function(e){h.ratioSelection().removeClass("active"),e.addClass("active"),h.sizeFieldset().removeClass(a);e=e.data("value");h.updateRatio(c,e)},setResizeStrategy:function(e,o){h.initImageBlockHandler(),g.data(e).strategy=o,h.thumbImage.inside(e).each(function(e){var t=b(this);v.resizeToViewport(t,o)})},updateResizeStrategy:function(e,t){h.setResizeStrategy(e,t),h.populateResizeStrategy(e)},populateResizeStrategy:function(e){e=g.data(e).strategy;h.strategyMenuItem().removeClass("active").where("strategy",e).addClass("active")},"{strategyMenuItem} click":function(e){e=e.data("strategy");h.updateResizeStrategy(c,e)},hasThumbnails:function(e){return!!h.thumbItem.inside(e).length},"{self} composerBlockBeforeRemove":function(e,t,o){var n;"image"==g.getBlockType(o)&&(n=h.thumbItem.of(o),setTimeout(function(){var e=g.block.of(n);n.remove();var t=h.thumbContainer.inside(e),e=h.hasThumbnails(e);t.toggleClass("is-empty",!e)},1))},"{self} composerBlockDuplicate":function(e,t,o,n){"thumbnails"==g.getBlockType(o)&&(g.updateBlockUid(o),g.duplicateChildBlocksData(o,n))},"{browseButton} mediaSelect":function(e,t,o,n){"image"==o.meta.type&&h.constructImage(c,n,[o])},"{sourceChangeButton} mediaSelect":function(e,t,o,n){"image"==o.meta.type&&(o=g.data(c).layout,h.updateLayout(c,o))}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/tiktok",function(d){EasyBlog.Controller("Composer.Blocks.Handlers.Tiktok",{defaultOptions:{"{wrapper}":"[data-tiktok-wrapper]","{form}":"[data-tiktok-form]","{embed}":"[data-tiktok-embed]","{itemPreview}":"[data-tiktok-preview]","{errorMessage}":"[data-tiktok-error]","{input}":"[data-tiktok-input]","{fieldInput}":"[data-tiktok-field-input]","{update}":"[data-tiktok-update]"}},function(r,e,t,a,s,l,c){return{init:function(){s=r.blocks,a=s.composer,l=e.meta,c=d()},toData:function(e){return s.data(e)},toText:function(e){},toEditableHTML:function(e){return""},toHTML:function(e){},activate:function(e){var t=s.data(e);c=e,r.populate(t)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){var t=s.data(e),o=e.data("overlay"),n=s.getBlockContent(e);t.html&&!o?(n.empty(),r.setOverlay(e,t.html)):n.html(l.html)},deconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){r.fieldInput().val(""),e.url&&r.fieldInput().val(e.url)},isValidUrl:function(e){if(!e)return!1;return/^https:\/\/www\.tiktok\.com\/(.*)\/video\/(.*)$/.test(e)},crawl:function(t){var o=s.data(c),e=d(l.preview),n=(r.itemPreview.inside(e),s.getBlockContent(c)),a=r.form.inside(n),i=r.wrapper.inside(n);r.errorMessage().addClass("t-hidden"),r.isValidUrl(t)?(a.addClass("t-hidden"),i.addClass("is-loading"),EasyBlog.ajax("site/views/crawler/crawl",{url:t}).done(function(e){e=e[t].oembed.html;o.url=t,o.html=e,r.fieldInput().val(t),n.empty(),r.setOverlay(c,e)}).fail(function(e){a.removeClass("t-hidden"),i.removeClass("is-loading"),r.errorMessage().html(e).removeClass("t-hidden")}).always(function(){n.removeClass("is-loading")})):r.errorMessage().removeClass("t-hidden")},setOverlay:function(e,t){var o,n=e.data("overlay");n?(n.element().empty(),n.element().append(t)):(n=a.document.overlay.create(e),o=s.getBlockContent(e),n.placeholder().css("height","750px").appendTo(o),n.element().append(t),n.attach()),e.data("overlay",n)},"{embed} click":function(e,t){var o=r.input().val();r.crawl(o)},"{update} click":function(e,t){var o=r.fieldInput().val();r.crawl(o)}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/tweet",function(s){EasyBlog.Controller("Composer.Blocks.Handlers.Tweet",{defaultOptions:s.extend({"{form}":"> [data-tweet-form]","{insert}":"[data-tweet-insert]","{source}":"[data-tweet-source]","{loader}":"> [data-codepen-loader]","{preview}":"> [data-tweet-preview]","{fsSource}":"[data-fs-tweet-source]","{fsUpdate}":"[data-fs-tweet-update]","{errorMessage}":"[data-tweet-error]"},EBD.selectors)},function(a,e,t,o,i,r,n){return{init:function(){i=a.blocks,i.composer,r=e.meta,n=s()},toData:function(e){return i.data(e)},toText:function(e){return i.data(e).source},toHTML:function(e){e=e.clone(),e=a.deconstruct(e);return i.getBlockContent(e).html()},activate:function(e){n=e,a.populate(e)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){var t=i.data(e),o=i.getBlockContent(e),n=e.data("overlay");t.embed&&!n&&a.preview.inside(o).removeClass("hidden").html(t.embed),t.source||o.html(s(r.html)),e.find(a.source.selector).off("paste").on("paste",function(e){e.stopPropagation()})},deconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){i.data(e)},loading:function(){var e=i.getBlockContent(n);a.isLoading?(a.loader.inside(e).addClass("hidden"),a.form.inside(e).removeClass("hidden"),a.isLoading=!1):(a.loader.inside(e).removeClass("hidden"),a.form.inside(e).addClass("hidden"),a.isLoading=!0)},isUrlValid:function(e){if(""==e)return!1;return/^https:\/\/twitter\.com\/(.*)\/status\/(.*)$/.test(e)},crawl:function(e,t){var o=i.getBlockContent(e),n=i.data(e);if(!a.isUrlValid(t))return a.errorMessage().removeClass("hide"),!1;a.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:t}).done(function(e){a.loading();e=e[t];n.url=t,n.embed=e.oembed.html,n.source=t,a.form.inside(o).addClass("hidden"),a.preview.inside(o).html(n.embed).removeClass("hidden")}).fail(function(e){a.loading(),a.errorMessage().html(e).removeClass("hide")})},"{insert} click":function(e){n.length<1&&(t=a.block.of(e),i.activateBlock(t));var t=i.getBlockContent(n),t=a.source.inside(t).val();a.fsSource().val(t),a.crawl(n,t)},"{fsUpdate} click":function(){var e=a.fsSource().val();i.data(n);a.crawl(n,e)}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/twitch",function(l){EasyBlog.Controller("Composer.Blocks.Handlers.Twitch",{defaultOptions:{"{wrapper}":"[data-twitch-wrapper]","{embedButton}":"[data-twitch-embed]","{errorMessage}":"[data-twitch-error]","{input}":"[data-twitch-input]","{fieldInput}":"[data-twitch-field-input]","{update}":"[data-twitch-update]"}},function(a,e,t,i,r,s,n){return{init:function(){r=a.blocks,i=r.composer,s=e.meta,n=l()},toData:function(e){return r.data(e)},toText:function(e){},toEditableHTML:function(e){return""},toHTML:function(e){},activate:function(e){var t=r.data(e);n=e,a.populate(t)},deactivate:function(e){},construct:function(e){},reconstruct:function(e){var t=r.data(e),o=e.data("overlay"),n=r.getBlockContent(e);t.src&&!o?(n.empty(),a.createIframe(e,t.src)):n.html(s.html)},deconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){a.fieldInput().val(""),e.url&&a.fieldInput().val(e.url)},type:null,match:null,isValidUrl:function(e){if(!e)return!1;var t=(e=(e=e.trim()).replace(/\/+$/,"")).match(/^https:\/\/www\.twitch\.tv\/(.*)\/video\/(.*)$/);return t?(a.type="video",a.match=t,!0):(t=e.match(/^https:\/\/www\.twitch\.tv\/(.*)\/clip\/(.*)$/))?(a.type="clip",a.match=t,!0):(t=e.match(/^https:\/\/www\.twitch\.tv\/popout\/(.*)\/chat\?popout\=$/))?(a.type="chat",a.match=t,!0):!!(t=e.match(/^https:\/\/www\.twitch\.tv\/([^?\/]+)$/))&&(a.type="live",a.match=t,!0)},embed:function(e){var t,o;a.errorMessage().addClass("t-hidden"),a.isValidUrl(e)?(t=r.data(n),o=r.getBlockContent(n),o=a.wrapper.inside(o),a.fieldInput().val(e),t.url=e,e=a.formatSrc(e),t.src=e,a.createIframe(n,e),o.addClass("t-hidden")):a.errorMessage().removeClass("t-hidden")},createIframe:function(e,t){var o=l.create("iframe");o.attr("src",t),o.attr("frameborder","0"),o.attr("allowfullscreen","1"),o.attr("width","100%"),o.attr("height","400"),a.setOverlay(e,o)},formatSrc:function(){var e="",t=a.type,o=a.match,n=(n=window.eb.rootUrl).replace("https://","");return"video"!=t&&"live"!=t||(e="https://player.twitch.tv/","video"==t&&(e+="?video=v"+o[2]),"live"==t&&(e+="?channel="+o[1]),e+="&"),"clip"==t&&(e="https://clips.twitch.tv/embed?clip="+o[2]+"&"),"chat"==t&&(e="https://www.twitch.tv/embed/"+o[1]+"/chat?"),e+="parent="+n+"&autoplay=false"},setOverlay:function(e,t){var o,n=e.data("overlay");n?(n.element().empty(),n.element().append(t)):(n=i.document.overlay.create(e),o=r.getBlockContent(e),n.placeholder().css("height","400px").appendTo(o),n.element().append(t),n.attach()),e.data("overlay",n)},"{embedButton} click":function(e,t){e=e.closest("[data-twitch-form]").find("[data-twitch-input]").val();a.embed(e)},"{update} click":function(e,t){var o=a.fieldInput().val();a.embed(o)}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/video",function(o){function s(e){return e.toString().match("%")?"%":"px"}function n(e,t){return t=Math.pow(10,t),Math.round(e*t)/t}var e=this,a="view-selectratio",i="view-customratio",t=["video-width","video-height"],h=["numslider","numslider-toggle","numslider-widget","numslider-value","numslider-input","numslider-units","numslider-unit","numslider-current-unit"],g=ratioDecimal=function(e){if(o.isNumeric(e))return e;e=e.split(":");return e[0]/e[1]};ratioPercent=function(e,t){return n(100*g(e),2)+(t?"%":0)},ratioPadding=function(e){return n(1/g(e)*100,2)+"%"};EasyBlog.require().library("plupload2","videojs").done(function(f){EasyBlog.Controller("Composer.Blocks.Handlers.Video",{elements:["[data-eb-{file-error}]","[data-eb-video-size-field] [data-eb-{"+h.join("|")+"}]","^videoSizeField .eb-composer-field[data-name={"+t.join("|")+"}]","[data-eb-video-{ratio-button|ratio-label|ratio-customize-button|ratio-cancel-button|ratio-use-custom-button|ratio-cancel-custom-button|alignment-selection|size-field|ratio-selection|ratio-input}]"],defaultOptions:{"{browseButton}":".eb-composer-placeholder-video [data-eb-mm-browse-button]","{placeholder}":"[data-eb-composer-video-placeholder]","{player}":"[data-video-player]","{dropElement}":"[data-plupload-drop-element]","{autoplay}":"[data-video-fieldset-autoplay]","{loop}":"[data-video-fieldset-loop]","{muted}":"[data-video-fieldset-muted]","{controls}":"[data-video-controls]","{width}":"[data-video-width]","{height}":"[data-video-height]","{videoContainer}":".eb-video","{videoViewport}":".eb-video-viewport","{videoPlayer}":"video","{videoSource}":"source"}},function(d,e,t,l,u,c,r,p,m,n){return{init:function(){u=d.blocks,l=u.composer,c=e.meta,r=f(),m=u.dimensions,n=EasyBlog.MediaManager,f.each(h,function(e,t){var o=f.camelize(t);d[o].of=f.memoize(function(e){e=d.getVideoSizeField(e);return d[o].under(e)})});var t={};p=function(e){return f(t[e.data("uid")]||(t[e.data("uid")]=d.videoContainer.inside(e)[0]))},getVideoViewport=f.memoize(function(e){return d.videoViewport.inside(e)},function(e){return e.data("uid")})},normalize:function(e){return f.extend({},c.data,e)},activate:function(e){r=e,d.populate(e)},deactivate:function(e){},construct:function(e){var t=u.createBlockContainer("video"),o=u.data(t);f.extend(o,e);return t},constructFromMediaFile:function(e){var e=e.data("key"),e=n.getUri(e),o=u.createBlockContainer("video");u.getBlockContent(o),u.data(o);return o.addClass("is-loading"),n.getMedia(e).done(function(t){setTimeout(function(){var e=t.meta.url;d.createPlayer(o,e)},250)}).fail(function(){}).always(function(){o.removeClass("is-loading")}),o},reconstruct:function(e){e.editable(!1);var t=u.data(e);d.hasVideo(e)?(t=u.data(e),d.createPlayer(e,t.url)):0<(e=d.placeholder.inside(e)).length&&EasyBlog.MediaManager.uploader.register(e)},deconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){var t=d.hasVideoContainer(e);u.panel.fieldgroup.get("video").toggleClass("is-new",!t),data=u.data(e),t&&(d.populateVideoSize(e),d.populateVideoControls(e))},toData:function(e){var t=u.data(e),e=p(e);return 0<e.length&&(e=e[0].style,t.width=e.width,t.height=e.height),t},toText:function(e){},toHTML:function(e){},toLegacyShortcode:function(e,t){t=u.data(t),t={width:t.width+"px",height:t.height+"px",uri:e.uri,autoplay:t.autoplay?"1":"0",muted:t.muted?"1":"0",loop:t.loop?"1":"0"};return"[embed=video]"+JSON.stringify(t)+"[/embed]"},toEditableHTML:function(e){},"{placeholder} mediaUploaderFilesAdded":function(e,t,o,n){EasyBlog.MediaManager.uploader.addItem(n[0],e)},"{placeholder} mediaUploaderFileUploaded":function(e,t,o,n,a){var i=a.response.media.meta,r=u.block.of(e);setTimeout(function(){d.createPlayer(r,i.url),r.hasClass("active")&&d.populate(r)},600)},"{placeholder} mediaUploaderFileError":function(e,t,o,n){n.code==f.plupload2.FILE_EXTENSION_ERROR&&d.fileError.inside(r).removeClass("hide")},"{self} composerBlockDuplicate":function(e,t,o,n){"video"==u.getBlockType(o)&&(o.removeAttr("data-uid"),u.setBlockUid(o),n=u.data(n),data=u.data(o),f.extend(data,n),data.uid=f.uid("video-"),u.getBlockContent(o).empty())},createPlayer:function(e,t){var o=u.data(e),n=t.substr(t.lastIndexOf(".")+1),a="video/x-flv";"mp4"!=n&&"MP4"!=n&&"3gp"!=n&&"3GP"!=n&&"MOV"!=n&&"mov"!=n&&"webm"!=n||(a="video/mp4");var i=o.uid||(o.uid=f.uid("video-")),r=f(c.player).clone(),s=d.videoPlayer.inside(r),n=d.videoSource.inside(r);s.attr("id",i),n.attr("src",t),n.attr("type",a),o.url=t,o.width&&r.css("width",o.width),o.height&&r.css("height",o.height),m.toFluidWidth(e),m.toFluidHeight(e);e=u.getBlockContent(e);e.empty(),e.append(r),videojs(i,{controls:!0,autoplay:!1},function(){this.muted(o.muted)})},populateVideoControls:function(e){var t=u.data(e),o=1==t.autoplay?1:0,e=1==t.loop?1:0,t=1==t.muted?1:0;d.autoplay().val(o).trigger("change"),d.loop().val(e).trigger("change"),d.muted().val(t).trigger("change")},"{muted} change":function(e,t){u.data(r).muted=e.val()},"{autoplay} change":function(e,t){u.data(r).autoplay=e.val()},"{loop} change":function(e,t){u.data(r).loop=e.val()},populateVideoSize:function(e,t){for(var o,t=t||["width","height"];o=t.shift();){var n,a="width"==o?d.getVideoWidth(e):d.getVideoHeight(e),i=parseFloat(a),a=s(a);d.resizingFromSlider!==o&&("px"==a&&(n={start:i,step:1,range:{min:1,max:1600},pips:{mode:"values",values:[64,320,640,960,1280,1600],density:4}}),"%"==a&&(n={start:i,step:1,range:{min:1,max:100},pips:{mode:"values",values:[0,20,40,60,80,100],density:5}}),d.numsliderWidget.of(o).find(".noUi-pips").remove().end().noUiSlider(n,!0).noUiSlider_pips(n.pips));i=Math.round(i);"width"==o&&d.width().val(i),"height"==o&&d.height().val(i)}d.populateVideoRatio(e),d.populateVideoAlignment(e)},getVideoWidth:function(e){var t=p(e),o=t[0].style;if(u.isNestedBlock(e)){e=e[0].style.width;if(/%/.test(e))return e}return o.width||t.css("width")},getVideoHeight:function(e){e=p(e);return e[0].style.height||e.css("height")},getVideoSize:function(e,t){return"width"==t?d.getVideoWidth(e):"height"==t?d.getVideoHeight(e):void 0},getVideoComputedWidth:function(e){return p(e).width()},getVideoComputedHeight:function(e){return p(e).outerHeight()},setVideoWidth:function(e,t){var o=p(e),n=(getVideoViewport(e),d.getVideoRatio(e)),a=s(t);d.getVideoComputedHeight(e);o.toggleClass("is-responsive","%"==a),u.isNestedBlock(e)?("%"==a&&(e.css("width",t),o.css("width","")),"px"==a&&(e.css("width","auto"),o.css("width",t))):o.css("width",t),d.adjustVideoRatio(e,n=0==n&&"%"==a?null:n)},setVideoFluidWidth:function(e,t){var o=p(e);u.isNestedBlock(e)?(m.toAutoWidth(e),o.css("width",t),m.toFluidWidth(e),o.css("width","")):(t=t/u.getBlockContent(e).width()*100+"%",o.css("width",t))},setVideoSize:function(e,t,o){"width"==t&&d.setVideoWidth(e,o),"height"==t&&d.setVideoHeight(e,o)},updateVideoSize:function(e,t,o){d.setVideoSize(e,t,o),d.populateVideoSize(e)},setVideoHeight:function(e,t){var o,n=p(e),a=getVideoViewport(e),i=d.getVideoRatio(e);d.isFluidVideo(e)?(0==i?i=(o=d.getVideoComputedWidth(e))/(t=parseFloat(t)):(o=parseFloat(t)*i,d.setVideoFluidWidth(e,o)),n.css("height",""),a.css("padding-top",ratioPadding(i))):(n.css("height",t),0!==i&&(o=parseFloat(t)*ratioDecimal(i),n.css("width",o),a.css("padding-top","")))},setVideoUnit:function(e,t,o){var n;"width"===t&&(p(e),n=d.getVideoWidth(e),t=d.getVideoComputedWidth(e),d.getVideoComputedHeight(e),"px"==o&&/%/.test(n)&&d.setVideoWidth(e,t),"%"==o&&/px/.test(n)&&d.setVideoFluidWidth(e,t))},getVideoUnit:function(e,t){t=d.getVideoSize(e,t);return s(t)},updateVideoUnit:function(e,t,o){d.setVideoUnit(e,t,o),d.populateVideoSize(e)},handleNumsliderWidget:function(e,t){var o=d.getVideoSizeProp(e),e=d.getVideoSizeUnit(o),t=Math.round(t)+e;d.resizingFromSlider=o,d.updateVideoSize(r,o,t),d.resizingFromSlider=null},"{width} change":function(e,t){e=e.val();(e=100<e?100:e)<0&&(e=0),d.updateVideoSize(r,"width",e+="%")},"{height} change":function(e,t){e=e.val()+"px";d.updateVideoSize(r,"height",e)},"{numsliderWidget} nouislide":function(e,t,o){d.handleNumsliderWidget(e,o)},"{numsliderWidget} set":function(e,t,o){d.handleNumsliderWidget(e,o)},"{numsliderInput} input":function(e){e.off("blur.numslider");var t,o=d.getVideoSizeProp(e),n=d.getVideoSize(r,o),a=parseFloat(n),i=e.val(),n=i+s(n);if(!f.isNumeric(i))return t=a,void e.on("blur.numslider",function(){e.val(t)});d.updateVideoSize(r,o,n)},"{numsliderUnit} click":function(e){var t=d.getVideoSizeProp(e),e=e.data("unit");d.updateVideoUnit(r,t,e)},"{self} composerBlockResizeStart":function(e,t,o,n){var a,i;"video"===u.getBlockType(o)&&(a=d.getVideoComputedWidth(o),i=d.getVideoComputedHeight(o),o.data("initialWidth",a),o.data("initialHeight",i))},"{self} composerBlockBeforeResize":function(e,t,o,n){function a(){d.isFluidVideo(o)?d.setVideoFluidWidth(o,l):d.setVideoWidth(o,l)}function i(){d.setVideoHeight(o,c)}var r,s,l,c;"video"===u.getBlockType(o)&&d.hasVideoContainer(o)&&(t.preventDefault(),o.data("initialImageSize"),s=n.originalSize,t=(r=n.size).width-s.width,n=r.height-s.height,r=o.data("initialWidth"),s=o.data("initialHeight"),l=r+t,c=s+n,0==d.getVideoRatio(o)?(0!=t&&a(),0!=n&&i()):0==t?0!=n&&i():a(),d.populateVideoSize(o))},setVideoRatio:function(e,t){u.data(e).ratio=t,d.adjustVideoRatio(e,t)},adjustVideoRatio:function(e,t){var o=p(e),n=getVideoViewport(e),a=d.getVideoComputedWidth(e),i=d.getVideoComputedHeight(e),r="",s="";null==t&&(t=a/i),d.isFluidVideo(e)?s=ratioPadding(t):r=0==t?i:a/ratioDecimal(t),o.css("height",r),n.css("padding-top",s)},populateVideoRatio:function(e){e=u.data(e).ratio;d.ratioButton().toggleClass("ratio-unlocked",0==e),d.ratioLabel().html(e)},updateVideoRatio:function(e,t){d.setVideoRatio(e,t),d.populateVideoRatio(e)},getVideoRatio:function(e){var t,o=u.data(e);p(e);return void 0===o.ratio&&(t=d.getVideoComputedWidth(e),e=d.getVideoComputedHeight(e),o.ratio=t/e),g(o.ratio)},"{browseButton} mediaSelect":function(e,t,o,n){var a=u.block.of(e);"video"==o.meta.type&&(e=o.meta,(o=l.document).isLegacy()?(content=d.toLegacyHTML(a),o.insertContent(content)):d.createPlayer(a,e.url))},"{self} mediaInsert":function(e,t,o,n,a,i){var r,s;"video"==o.meta.type&&((r=l.document).isLegacy()?(s=u.data(n),a=f.extend(s,a),content=d.toLegacyShortcode(o.meta,n),r.insertContent(content)):(n=u.constructBlock("video",{url:o.meta.url,autoplay:a.autoplay,loop:a.loop,muted:a.muted}),u.addBlock(n),i||u.activateBlock(n)))},"{self} mediaInfoDestroy":function(e,t,o,n){n&&"video"!=n.meta.type||(o=d.videoPlayer.inside(o).attr("id"),videojs(o).dispose())},"{ratioButton} click":function(e){d.sizeField().switchClass(a)},"{ratioCustomizeButton} click":function(e){d.sizeField().switchClass(i)},"{ratioCancelButton} click":function(e){d.sizeField().removeClass(a)},"{ratioCancelCustomButton} click":function(e){d.sizeField().switchClass(a)},"{ratioOkCustomButton} click":function(e){d.sizeField().removeClass(i)},"{ratioUseCustomButton} click":function(e){var t=function(e){if(e=o.trim(e),/\:/.test(e)){var t=e.split(":");return parseInt(t[0])+":"+parseInt(t[1])}return parseFloat(e)||0}(d.ratioInput().val());0!=t&&(d.updateVideoRatio(r,t),d.ratioSelection().removeClass("active"),d.sizeField().removeClass(i))},"{ratioSelection} click":function(e){d.ratioSelection().removeClass("active"),e.addClass("active"),d.sizeField().removeClass(a);e=e.data("value");d.updateVideoRatio(r,e)},"{alignmentSelection} change":function(e){e=e.val();u.font.setFontFormatting(r,"align"+e)},populateVideoAlignment:function(e){var t;u.isNestedBlock(e)?d.sizeField().addClass("no-alignment"):(t=u.getBlockContent(e),t=d.getVideoComputedWidth(e)<t.width(),d.sizeField().toggleClass("no-alignment",!t),e=e.css("text-align"),d.alignmentSelection().val(e))},getVideoSizeField:function(e){return d["videoSizeFieldVideo"+f.capitalize(e)]()},getVideoSizeProp:function(e){return e.closest(d.numslider.selector).data("name").replace(/video-/,"")},getVideoSizeUnit:function(e){e=d.getVideoSizeField(e);return f.trim(d.numsliderCurrentUnit.under(e).text())},isFluidVideo:function(e){return p(e).hasClass("is-responsive")},hasVideo:function(e){return!!u.data(e).url},hasVideoContainer:function(e){return 0<d.videoContainer.inside(e).length}}}),e.resolve()})}),EasyBlog.module("composer/blocks/handlers/vimeo",function(o){EasyBlog.Controller("Composer.Blocks.Handlers.Vimeo",{elements:["[data-vimeo-fieldset-{url|fluid|width-fieldset|height-fieldset|width|height|update-url}]"],defaultOptions:o.extend({"{form}":"> [data-vimeo-form]","{insert}":"[data-vimeo-insert]","{source}":"[data-vimeo-source]","{loader}":"> [data-vimeo-loader]","{player}":"iframe","{wrapper}":"[data-vimeo-wrapper]"},EBD.selectors)},function(i,e,t,n,r,a,s){return{init:function(){r=i.blocks,n=r.composer,a=e.meta,s=o()},toData:function(e){var t=r.data(e),e=e.data("overlay");if(!e)return t;e=i.player.inside(e.element());return t.source=e.attr("src"),t},toText:function(e){return r.data(e).source},toHTML:function(e){var t=e.clone(),e=(r.data(t),e.data("overlay"));if(e)return e.element().html()},activate:function(e){r.getBlockContent(e),r.data(e);s=e,i.populate(e)},deactivate:function(e){},construct:function(e){},getWrapper:function(e){return o(a.wrapper)},reconstruct:function(e){var t=r.data(e),o=e.data("overlay"),n=r.getBlockContent(e);t.source&&!o?i.setOverlay(e):0==t.source.length&&t.url?(n.html(a.html),i.crawl(t.url,e)):n.html(a.html),e.find(i.source.selector).off("paste").on("paste",function(e){e.stopPropagation()})},deconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){r.data(e);i.updateFieldset(e)},updateFieldset:function(e){e=r.data(e);e.url&&(i.url().val(e.url),i.width().val(e.width),i.height().val(e.height),i.fluid().val(e.fluid?"1":"0").trigger("change"))},getOverlay:function(e){var t=e.data("overlay"),o=(r.data(e),r.getBlockContent(e));return t||(t=n.document.overlay.create(e),e=i.getWrapper(),t.placeholder().appendTo(e),o.empty().append(e),t.attach()),t},setWrapperLayout:function(e){var t=i.wrapper.inside(e),e=r.data(e);e.fluid?t.addClass("is-responsive").css({width:"",height:""}):(t.hasClass("is-responsive")&&(e.width=t.width(),e.height=t.outerHeight()),i.width().val(e.width),i.height().val(e.height),t.css({width:e.width,height:e.height}).removeClass("is-responsive"))},setOverlay:function(e){var t=r.data(e),o=i.getOverlay(e);0<o.element().length&&o.element().empty(),i.setWrapperLayout(e),o.element().append(t.embed),o.refresh(),e.data("overlay",o)},isUrlValid:function(e){if(""==e)return!1;return/^https:\/\/vimeo\.com\/(.*)$/.test(e)},loading:function(){var e=r.getBlockContent(s),t=i.loader.inside(e),e=i.form.inside(e);i.isLoading?(t.addClass("hidden"),e.removeClass("hidden"),i.isLoading=!1):(t.removeClass("hidden"),e.addClass("hidden"),i.isLoading=!0)},crawl:function(t,o){var n=r.data(o),e=r.getBlockContent(o),a=o.data("overlay");a&&a.element().empty(),i.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:t}).done(function(e){e=e[t];n.url=t,n.author={name:e.oembed.author_name,url:e.oembed.author_url},n.description=e.oembed.description,n.embed=e.oembed.html,n.duration=e.oembed.duration,n.width=e.oembed.width,n.height=e.oembed.height,i.setOverlay(o),i.updateFieldset(o)}).fail(function(e){i.errorMessage().removeClass("hide").html(e)}).always(function(){i.loading(),i.form.inside(e).addClass("hidden")})},"{insert} click":function(e){s.length<1&&(t=i.block.of(e),r.activateBlock(t));var t=r.getBlockContent(s),t=i.source.inside(t).val();r.data(s);i.isUrlValid(t)?i.crawl(t,s):i.errorMessage().removeClass("hide")},"{fluid} change":function(e,t){e=1==e.val();r.data(s).fluid=e,i.setWrapperLayout(s),i.widthFieldset().toggleClass("hide",e),i.heightFieldset().toggleClass("hide",e),i.getOverlay(s).refresh()},"{width} keyup":o.debounce(function(e,t){var o=r.data(s),e=e.val();0!=e&&(o.width=e,i.getOverlay(s),i.wrapper.inside(s).css("width",e),i.getOverlay(s).refresh())},250),"{height} keyup":o.debounce(function(e,t){var o=r.data(s),e=e.val();0!=e&&(o.height=e,i.wrapper.inside(s).css("height",e),i.getOverlay(s).refresh())},250),"{updateUrl} click":function(e,t){var o=i.url().val(),n=(r.data(s),r.getBlockContent(s));i.isUrlValid(o)?i.crawl(o,s):i.errorMessage.inside(n).removeClass("hide")}}}),this.resolve()}),EasyBlog.module("composer/blocks/handlers/youtube",function(o){EasyBlog.Controller("Composer.Blocks.Handlers.Youtube",{elements:["[data-youtube-fieldset-{url|fluid|width-fieldset|height-fieldset|width|height|update-url|nocookie}]"],defaultOptions:o.extend({"{related}":"[data-youtube-fieldset-related]","{form}":"> [data-youtube-form]","{insert}":"[data-youtube-insert]","{source}":"[data-youtube-source]","{loader}":"> [data-youtube-loader]","{errorMessage}":"[data-youtube-error]","{player}":"iframe","{wrapper}":"[data-youtube-wrapper]"},EBD.selectors)},function(i,e,t,n,r,a,s){return{init:function(){r=i.blocks,n=r.composer,a=e.meta,s=o()},toData:function(e){var t=r.data(e),e=e.data("overlay");if(!e)return t;e=i.player.inside(e.element());return t.source=e.attr("src"),t},toText:function(e){return r.data(e).source},toEditableHTML:function(e){return""},toHTML:function(e){r.data(e);e=e.data("overlay");if(e)return e.element().html()},activate:function(e){r.getBlockContent(e),r.data(e);s=e,i.populate(s)},deactivate:function(e){},construct:function(e){},getWrapper:function(e){return o(a.wrapper)},reconstruct:function(e){var t=r.data(e),o=e.data("overlay"),n=r.getBlockContent(e);t.source&&!o?i.setOverlay(e):0==t.source.length&&t.url?(n.html(a.html),i.crawl(t.url,e)):n.html(a.html),e.find(i.source.selector).off("paste").on("paste",function(e){e.stopPropagation()})},deconstruct:function(e){},refocus:function(e){},reset:function(e){},populate:function(e){r.data(e);i.updateFieldset(e)},updateFieldset:function(e){e=r.data(e);i.url().val(e.url),i.width().val(e.width),i.height().val(e.height),i.fluid().val(e.fluid?"1":"0").trigger("change"),i.related().val(e.related?"any":"same").trigger("change"),i.nocookie().val(1==e.nocookie?"1":"0").trigger("change")},getOverlay:function(e){var t=e.data("overlay"),o=(r.data(e),r.getBlockContent(e));return t||(t=n.document.overlay.create(e),e=i.getWrapper(),t.placeholder().appendTo(e),o.empty().append(e),t.attach()),t},setWrapperLayout:function(e){var t=i.wrapper.inside(e),e=r.data(e);e.fluid?t.addClass("is-responsive").css({width:"",height:""}):(t.hasClass("is-responsive")&&(e.width=t.width(),e.height=t.outerHeight()),i.width().val(e.width),i.height().val(e.height),t.css({width:e.width,height:e.height}).removeClass("is-responsive"))},setOverlay:function(e){var t=r.data(e),o=i.getOverlay(e);0<o.element().length&&o.element().empty(),i.setWrapperLayout(e),o.element().append(t.embed),o.refresh(),e.data("overlay",o)},isUrlValid:function(e){if(""==e)return!1;var t=/^(http|https):\/\/www\.youtube\.com\/watch\?v=(.*)$/.test(e);return t=(t=t||/^(http|https):\/\/youtu\.be\/(.*)$/.test(e))||/^(http|https):\/\/www\.youtube\.com\/shorts\/(.*)$/.test(e)},loading:function(){var e=r.getBlockContent(s),t=i.loader.inside(e),e=i.form.inside(e);i.isLoading?(t.addClass("hidden"),e.removeClass("hidden"),i.isLoading=!1):(t.removeClass("hidden"),e.addClass("hidden"),i.isLoading=!0)},hideForm:function(e){e=r.getBlockContent(e);i.form.inside(e).addClass("hidden"),i.loader.inside(e).removeClass("hidden")},showForm:function(e){e=r.getBlockContent(e);i.form.inside(e).removeClass("hidden"),i.loader.inside(e).addClass("hidden")},crawl:function(o,n){var a=r.data(n),e=(r.getBlockContent(n),n.data("overlay"));e&&e.element().empty(),i.loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:o}).done(function(e,t){e=e[o];if(e.oembed.error)return i.showForm(n),void i.errorMessage().removeClass("hide").html(t);a.url=o,a.author={name:e.oembed.author_name,url:e.oembed.author_url},a.embed=e.oembed.html,a.embed_nocookie=e.oembed.html_nocookie,a.embed_original=e.oembed.html,a.width=e.oembed.width,a.height=e.oembed.height,i.setOverlay(n),i.updateFieldset(n)}).fail(function(e){i.errorMessage().removeClass("hide").html(e)}).always(function(){i.loading()})},"{insert} click":function(e){var t;s.length<1?(t=i.block.of(e),r.activateBlock(t)):(t=r.getBlockContent(s),t=i.source.inside(t).val(),r.data(s),i.isUrlValid(t)?i.crawl(t,s):i.errorMessage().removeClass("hide"))},"{related} change":function(e,t){var o=r.data(s),n="any"==e.val(),a=s.data("overlay");o.related=n,a&&(a=(e=i.player.inside(a.element())).attr("src"),n||(a=a.replace("?feature=oembed","?feature=oembed&rel=0"),e.attr("src",a)),n&&(a=a.replace("&rel=0",""),e.attr("src",a)),o.source=a)},"{fluid} change":function(e,t){var o=1==e.val(),e=r.data(s);e.fluid=o,e.url&&(i.setWrapperLayout(s),i.widthFieldset().toggleClass("hide",o),i.heightFieldset().toggleClass("hide",o),i.getOverlay(s).refresh())},"{width} keyup":o.debounce(function(e,t){var o=r.data(s),e=e.val();o.url&&0!=e&&(o.width=e,i.getOverlay(s),i.wrapper.inside(s).css("width",e),i.getOverlay(s).refresh())},250),"{height} keyup":o.debounce(function(e,t){var o=r.data(s),e=e.val();0!=e&&(o.height=e,i.wrapper.inside(s).css("height",e),i.getOverlay(s).refresh())},250),"{updateUrl} click":function(e,t){var o=i.url().val(),n=(r.data(s),r.getBlockContent(s));i.isUrlValid(o)?i.crawl(o,s):i.errorMessage.inside(n).removeClass("hide")},"{nocookie} change":function(e,t){var o=r.data(s),e=1==e.val();o.nocookie=e,o.url&&(o.embed=e?o.embed_nocookie:o.embed_original,o.related||(o.embed=o.embed.replace("?feature=oembed","?feature=oembed&rel=0")),i.setOverlay(s))}}}),this.resolve()}),EasyBlog.module("composer/blocks/mobile",function(c){EasyBlog.Controller("Composer.Blocks.Mobile",{defaultOptions:c.extend({"{blipp}":"[data-eb-blipp]","{viewport}":".eb-composer-viewport","{actionBar}":"[data-eb-composer-actions]"},EBD.selectors)},function(l,e,t,o,n,a){return{init:function(){n=l.blocks,o=n.composer},"{blipp} mousedown":function(r,e){var s;e.stopPropagation(),e.preventDefault(),c(document).off("mousemove.blip mouseup.blip").on("mousemove.blip",function(e){var t=c.getPointerPosition(e),o=l.viewport(),n=o.offset(),a=o.width()-10,i=o.height()-30,e=n.left+30,o=t.x-n.left,n=t.y-n.top;r.css("left",o),r.css("top",n),s=null,t.y<30&&(s="addBlock"),t.y>i&&(s="removeBlock"),t.x<e&&(s="viewBlockTree"),t.x>a&&(s="moveBlock")}).on("mouseup.blip",function(){return c(document).off("mousemove.blip"),l.actionBar().show(),o.blocks.droppable.destroyDropzones(),o.sidebar.deactivate("blocks"),o.sidebar.deactivate("explorer"),"addBlock"==s?(o.sidebar.activate("blocks"),o.blocks.droppable.populateDropzones(),void l.trigger("ComposerMobileAddBlock")):"moveBlock"==s?(o.blocks.droppable.populateDropzones(),void n.getAllBlocks().on("click.tapremove",function(e){e.stopPropagation(),c(this).addClass("hide")})):"removeBlock"==s?(l.actionBar().hide(),n.getAllBlocks().on("click.tapremove",function(e){e.stopPropagation();e=c(this);n.removeBlock(e)}),void l.trigger("ComposerMobileRemoveBlock")):void("viewBlockTree"==s&&(EasyBlog.Composer.sidebar.activate("explorer"),l.trigger("ComposerMobileViewTree")))})}}}),this.resolve()}),EasyBlog.module("composer/blocks/nestable",function(e){var t=this,l="is-nested";EasyBlog.require().library("ui/sortable").done(function(s){EasyBlog.Controller("Composer.Blocks.Nestable",{defaultOptions:s.extend({},EBD.selectors)},function(r,e,t,o,i,n){return{init:function(){i=r.blocks,o=r.blocks.composer,currentNest=s()},enable:function(){r.nest().each(function(){var e=s(this);r.initNestable(e)})},disable:function(){r.nest().each(function(){var e=s(this);r.destroyNestable(e)})},initNestable:function(e){e.hasClass("ui-sortable")||e.sortable({items:EBD.childBlock,connectWith:EBD.root+", "+EBD.nest,helper:"clone",appendTo:o.document.ghosts(),placeholder:"ebd-block is-placeholder is-nested",tolerance:"pointer",refreshPositions:!0,handle:EBD.immediateBlockSortHandle})},destroyNestable:function(e){e.hasClass("ui-sortable")&&e.sortable("destroy")},"{self} composerBlockMechanicsChange":function(e,t,o){"sortable"==o?r.enable():r.disable()},isBlockNest:function(e){return"block"==e.data("type")},isContentNest:function(e){return"content"==e.data("type")},"{self} composerBlockCreate":function(e,t,o,n){},"{self} composerBlockInit":function(e,t,o,n){o.is(EBD.nestableBlock)&&"sortable"!=!i.getMechanics()&&o.find(EBD.nest).each(function(){var e=s(this);r.initNestable(e)})},disableEditableNest:function(e){e.editable()&&(e.editable(!1),e.data("editable-nest",!0))},enableEditableNest:function(e){e.data("editable-nest")&&(e.editable(!0),e.removeData("editable-nest"))},"{block} mouseover":function(e,t){if(!t.nestHandled){if(e.is(EBD.nestedBlock)){var o=r.nest.of(EBD.nestedBlock);r.disableEditableNest(o)}else{if((o=r.nest.inside(e)).length<1)return;r.enableEditableNest(o)}t.nestHandled=!0}},"{block} mouseout":function(e,t){e.is(EBD.nestedBlock)&&(e=r.nest.of(EBD.nestedBlock),r.enableEditableNest(e))},snap:function(e,t,o,n){var a,i;r.isBlockNest(o)?n.addClass(l):(a=o.offset(),i=o.width(),i=a.left+i/2,i=r.position(o,e<i?"left":"right"),n.addClass(l).switchClass("nest-"+i),o.data("snappedPosition",i))},unsnap:function(e){e.removeClass(l).removeClass(function(e,t){return(t.match(/(^|\s)nest-\S+/g)||[]).join(" ")})},positions:function(e){return(e.data("positions")||"left,right").split(",")},availablePositions:function(e){var t=r.positions(e);return e.find(EBD.childBlock+":not(.is-sort-item)").each(function(){var e=r.extractPosition(s(this).attr("class"));e&&s.pull(t,e)}),t},extractPosition:function(e){return(((e=e instanceof s?e.attr("class"):e).match(/nest-\w+/g)||[])[0]||"").split("nest-")[1]},position:function(e,t){e=r.availablePositions(e);return-1<s.indexOf(e,t)?t:e[0]},setTargetNest:function(e){r.clearTargetNest(),i.over(e)},unsetTargetNest:function(e){i.out(e)},clearTargetNest:function(){r.nest().each(function(){var e=s(this);i.out(e)})},trackNest:function(t,o){s(document).off("mousemove.nestable").on("mousemove.nestable",function(e){r.snap(e.pageX,e.pageY,t,o)})},untrackNest:function(){s(document).off("mousemove.nestable")},"{self} composerBlockBeforeDrop":function(e,t,o){var n=o.closest(EBD.nest),a=r.extractPosition(o);o.toggleClass(l,0<n.length),r.isContentNest(n)?(n=r.position(n,n.data("snappedPosition")),o.switchClass("nest-"+n),o.hasClass("is-new")&&i.dimensions.toFluidWidth(o),a&&n!==a?r.trigger("composerBlockNestChange",[o,n,a]):r.trigger("composerBlockNestIn",[o,n])):a&&(r.unsnap(o),r.trigger("composerBlockNestOut",[o]))},replaceWithCommentPlaceholder:function(n,a){var e=s("<div>").html(n[a]),t=e.find(EBD.immediateNestedBlock);t.length<=0||(t.each(function(){var e=s(this),t=i.getBlockUid(e),o=document.createComment("block"+t);e.replaceWith(o);o=i.getBlock(t),t=i.exportBlock(o),o=r.extractPosition(o.attr("class"));o&&(t.position=o),"html"==a&&n.blocks.push(t)}),e=e.html(),n[a]=e)},"{self} composerBlockExport":function(e,t,o,n){n.blocks=[],r.replaceWithCommentPlaceholder(n,"editableHtml"),r.replaceWithCommentPlaceholder(n,"html")}}}),t.resolve()})}),EasyBlog.module("composer/blocks/panel",function(r){EasyBlog.Controller("Composer.Blocks.Panel",{elements:["[data-eb-composer-blocks-{props}]","[data-eb-composer-blocks-{prop-group|prop-action}]","[data-eb-composer-{panel}][data-id=blocks]","[data-eb-composer-blocks-{block-subpanel|removal-subpanel}]","[data-eb-composer-block-{fieldgroup}]","[data-eb-composer-blocks-props-{block-menu|text-menu|block-content|text-content}]","[data-eb-composer-blocks-{subpanel|subpanel-button}]"],defaultOptions:{"{blockTitle}":"[data-block-property-title]","{blockIcon}":"[data-block-property-icon]"}},function(a,e,t,n,i,o){return{init:function(){i=a.blocks,n=i.composer,r()},"{self} composerBlockBeforeActivate":function(e,t,o){n.panels.activate("blocks"),a.panel().switchClass("show-block-subpanel"),a.fieldgroup.display(o)},fieldgroup:{get:r.memoize(function(e){var t=n.find(a.fieldgroup).where("type",e);return t.length<1&&(e=i.getBlockMeta(e),t=r(e.fieldgroup)),t}),hide:function(){a.panel().addClass("is-empty").find(a.fieldgroup).detach()},display:function(e){var t=e.attr("data-type"),o=a.panel();o.removeClass("is-empty").find(a.fieldgroup).detach();o=o.find(a.propGroup).where("type","specific");a.fieldgroup.get(t).toggleClass("is-standalone",i.isStandaloneBlock(e)).appendTo(o)}},openPanel:function(e){"block"!=e&&"text"!=e||(a.panel().switchClass("show-"+e+"-subpanel"),a.subpanelButton().where("name",e).activateClass("active")),"removal"==e&&a.panel().switchClass("show-removal")},activatePanel:function(e){clearTimeout(a.revertToPostPanel);var t=i.getBlockMeta(e);i.getAllParentBlocks(e),i.getChildBlocks(e);a.subpanelButton().show(),t.properties.textpanel||a.subpanelButton().hide(),a.blockIcon().attr("class",t.icon),a.blockTitle().html(i.getBlockTitle(e))},deactivatePanel:function(){a.revertToPostPanel=setTimeout(function(){n.document.workarea().hasClass("is-sorting")||n.panels.activate("post-options")},1),a.fieldgroup.hide()},"{self} composerBlockUpdateTitle":function(e,t,o,n){a.blockTitle().html(n)},"{self} composerBlockActivate":function(e,t,o){a.activatePanel(o)},"{self} composerBlockDeactivate":function(e,t,o){a.deactivatePanel(o)},"{self} composerBlockRemove":function(e,t,o,n){n.skipPanelTrigger||a.fieldgroup.hide(o)},"{subpanelButton} click":function(e){e=e.data("name");a.openPanel(e)}}}),this.resolve()}),EasyBlog.module("composer/blocks/removal",function(e){var t=this,s="is-removing";EasyBlog.require().library("ui/droppable").done(function(e){EasyBlog.Controller("Composer.Blocks.Removal",{defaultOptions:{"{workarea}":EBD.workarea,"{dropzone}":"[data-eb-composer-blocks-removal-subpanel]"}},function(i,e,t,n,r,o){return{init:function(){r=i.blocks,n=r.composer},"{self} composerBlockDrag":function(e,t,o){n.panels.activate("blocks"),r.panel.openPanel("removal");o=i.dropzone();o.data("inited")||(o.droppable({accept:EBD.block,tolerance:"pointer"}),o.data("inited",!0))},"{self} composerBlockDrop":function(e,t,o){i.workarea().hasClass(s)||r.panel.openPanel("block")},"{dropzone} drop":function(e,t,o){var n=o.draggable,a=i.workarea();a.addClass(s),n.addClass(s),e.addClass(s),setTimeout(function(){r.removeBlock(n),setTimeout(function(){r.panel.openPanel("block"),a.removeClass("is-removing"),setTimeout(function(){e.removeClass("is-removing active")},250)},250)},100)},"{dropzone} dropout":function(e,t,o){e.removeClass("active")},"{dropzone} dropover":function(e,t,o){e.addClass("active")}}}),t.resolve()})}),EasyBlog.module("composer/blocks/resizable",function(e){var t=this;EasyBlog.require().library("ui/resizable").done(function(r){EasyBlog.Controller("Composer.Blocks.Resizable",{defaultOptions:r.extend({"{resizeHandle}":".ui-resizable-handle"},EBD.selectors)},function(a,e,t,o,i,n){return{init:function(){i=a.blocks,a.blocks.composer},initResizable:function(e){var t,o;a.hasResizable(e)||(o=a.determineResizeHandles(e))&&(t=a.createResizeHandleElements(o),o=a.createResizeHandleSelectors(o),i.getBlockViewport(e).append(t).resizable({handles:o}),r(t).hide(),e.addClass("is-resizable"))},destroyResizable:function(e){e.hasClass("ui-resizable")&&i.getBlockViewport(e).resizable("destroy"),e.removeClass("is-resizable")},hasResizable:function(e){return i.getBlockViewport(e).hasClass("ui-resizable")},handles:{right:{w:"dimension",sw:"dimension",s:"dimension"},left:{e:"dimension",se:"dimension",s:"dimension"}},determineResizeHandles:function(e){e=i.nestable.extractPosition(e);return a.handles[e]},createResizeHandleElements:function(e){var o=[];return r.each(e,function(e,t){t=r('<div class="ui-resizable-handle"><div></div></div>').addClass("ui-resizable-"+e).attr({"data-direction":e,"data-role":t});o.push(t[0])}),o},createResizeHandleSelectors:function(e){var o=[];return r.each(e,function(e,t){o[e]="> .ui-resizable-"+e}),o},getResizeHandles:function(e){return i.getBlockViewport(e).children(a.resizeHandle.selector)},"{self} composerBlockActivate":function(e,t,o){a.initResizable(o),a.getResizeHandles(o).show()},"{self} composerBlockDeactivate":function(e,t,o){a.getResizeHandles(o).hide()},"{self} composerBlockNestIn":function(e,t,o){a.initResizable(o)},"{self} composerBlockNestOut":function(e,t,o){a.destroyResizable(o)},"{self} composerBlockNestChange":function(e,t,o){a.destroyResizable(o),a.initResizable(o)},"{blocks.viewport} resizestart":function(e,t,o){a.workarea().addClass("is-resizing");e=a.block.of(e);parentBlocks=i.getAllParentBlocks(e),parentBlocks.addClass("has-resizing-child"),a.trigger("composerBlockResizeStart",[e,o])},"{blocks.viewport} resize":function(e,t,o){e.css({top:"",left:"",width:"",height:""}),t.stopPropagation();var n=a.block.of(e);i.isNestedBlock(n)&&"content"===i.getBlockNestType(n)&&(a.trigger("composerBlockBeforeResize",[n,o]).isDefaultPrevented()||(t=o.originalSize,e=o.size,t.width!==e.width&&(o=i.getBlockNest(n),1<(o=(o=e.width/o.width())<0?0:o)&&(o=1),o=Math.floor(100*o)+"%",n.css("width",o)),t.height!==e.height&&(n.css("height",""),t=n.height(),e=e.height,n.css("height",e=e<t?"":e))),a.trigger("composerBlockResize",[n]))},"{blocks.viewport} resizestop":function(e,t,o){a.workarea().removeClassAfter("is-resizing");e=a.block.of(e);parentBlocks=i.getAllParentBlocks(e),parentBlocks.removeClass("has-resizing-child"),a.trigger("composerBlockResizeStop",[e,o])}}}),t.resolve()})}),EasyBlog.module("composer/blocks/scrollable",function(l){EasyBlog.Controller("Composer.Blocks.Scrollable",{defaultOptions:l.extend({},EBD.selectors)},function(r,e,t,s,o,n){return{init:function(){o=r.blocks,s=o.composer},"{block} dragstart":function(){r.scrollstart()},"{blocks.menu} dragstart":function(){r.scrollstart()},"{block} dragstop":function(){r.scrollstop()},"{blocks.menu} dragstop":function(){r.scrollstop()},"{self} composerBlockDrop":function(){r.scrollstop()},stop:!1,scrollTimer:null,scrollstart:function(){function t(){r.stop=!1,(o.y>i||o.y<50)&&(r.stop=!0,o.y>i&&(n.scrollTop+=a/2),o.y<50&&(n.scrollTop-=a/2),clearTimeout(r.scrollTimer),r.scrollTimer=setTimeout(t,1e3),r.trigger("composerDocumentScroll"))}var o,e=s.viewport(),n=s.document.viewportContent()[0],a=e.height(),i=a-50;l(document).on(l.ns("mousemove touchmove",".scrollable"),function(e){o=l.getPointerPosition(e),r.stop&&50<o.y&&o.y<i&&(r.stop=!1),r.stop||t()})},scrollstop:function(){clearTimeout(r.scrollTimer),l(document).off(l.ns("mousemove touchmove",".scrollable"))}}}),this.resolve()}),EasyBlog.module("composer/blocks/search",function(r){EasyBlog.Controller("Composer.Blocks.Search",{defaultOptions:{"{searchInput}":"[data-eb-blocks-search]","{blockSectionContent}":"[data-eb-composer-block-section-content]"}},function(a,e,t,o,i){return{init:function(){i=a.blocks,i.composer},search:function(e){var e=r.trim(e.toLowerCase()),t=i.menu(),o=t.filter("[data-keywords*='"+e+"']"),n=""==e,e=!n&&o.length<1;if(n?t.show():t.hide(),n)return r("[data-eb-composer-block-section]").show(),r('[data-eb-composer-block-menu][data-type="post"]').hide(),void a.trigger("onBlocksAfterSearch");o.show(),o.each(function(e,t){r(t).parents(a.blockSectionContent.selector).removeClass("t-hidden")}),i.view().toggleClass("is-empty",e),i.menuGroup().each(function(){var e=r(this),t=e.parents(".eb-composer-fieldset").show();e.height()<1&&t.hide()}),a.trigger("onBlocksAfterSearch")},"{searchInput} input":r.debounce(function(e,t){a.search(e.val())},150)}}),this.resolve()}),EasyBlog.module("composer/blocks/text",function(e){var t=this;EasyBlog.require().script("composer/vendors/colorpicker","composer/vendors/nouislider","composer/layout/elements").done(function(d){EasyBlog.Controller("Composer.Blocks.Text",{elements:[".eb-composer-fieldset[data-name=text] [data-eb-{font-color-menu|font-family-menu|font-size-menu|font-color-content|font-color-picker|font-family-content|font-size-content|font-color-caption|font-family-caption|font-size-caption|font-family-option}]",".eb-composer-fieldset[data-name=text] [data-eb-{numslider-toggle|numslider-widget|numslider-value|numslider-input|numslider-units|numslider-unit|numslider-current-unit|numslider-unit-toggle}]",".eb-composer-fieldset[data-name=text] [data-eb-{colorpicker|colorpicker-toggle}]","[data-eb-{links|link-item-group|link|link-item|link-preview|link-preview-caption|link-url-field|link-title-field}]"],defaultOptions:d.extend({fontSizeUnits:{px:{start:12,step:2,range:{min:8,max:72},pips:{mode:"values",density:4,values:[8,12,18,24,48,72]}},"%":{start:100,step:10,range:{min:0,max:200},pips:{mode:"positions",values:[0,50,100],density:10}}},"{textFieldset}":"[data-composer-selection][data-type=text]","{fontFormatOption}":"[data-composer-selection][data-type=text] [data-eb-font-format-option]","{fontFormatGroupDropdown}":"[data-composer-selection][data-type=text] [data-font-format-group-dropdown]","{fontSizeCheckbox}":"[data-eb-font-size-content] .eb-numslider-toggle input","{fontSizeToggle}":"[data-eb-font-size-content] .eb-numslider-toggle label","{linksFieldset}":".eb-composer-fieldset[data-name=links]","{linkBlankOption}":"[data-eb-link-blank-option]","{linkFollowOption}":"[data-eb-link-follow-option]","{linkNofollowOption}":"[data-eb-link-nofollow-option]","{linkRemoveButton}":"[data-eb-link-remove-button]","{fontSizeInputBox}":"[data-eb-numslider-input]","{colorInputBox}":"[data-eb-colorhex-field]","{colorHexContainer}":"[data-eb-colorhex-container]","{colorHexInput}":"[data-eb-colorhex-field]"},EBD.selectors)},function(r,t,e,o,s,i,n,a,l,c){return{init:function(){s=r.blocks,o=s.composer,textSelected=!1,hasTextSelection=!1,hasHexIframe=!1,r.textFieldset().on("touchstart click mousedown mouseup",function(e){e.preventDefault()}),r.linksFieldset().on("touchstart click mousedown mouseup",function(e){e.preventDefault()})},"{self} composerDocumentReady":function(){i=o.editor,r.initFontColor(),r.initLinks(),d(document).on("selectionchange",function(){r.stopEditingSelection()})},"{self} composerBlockActivate":function(e,t,o){s.getBlockMeta(o).properties.fonts||r.textFieldset().hide()},"{self} composerTextSelect":function(e,t,o,n,a){var i=s.getBlockMeta(n);if(!i.properties.fonts||"buttons"==i.type)return r.textFieldset().hide(),void r.linksFieldset().hide();c||("alerts"===i.type&&(r.textFieldset().find("[data-font-format-group-basic]").removeClass("eb-pill-group"),r.textFieldset().find("[data-font-format-group-list]").hide(),r.textFieldset().find("[data-font-format-group-dropdown]").hide()),s.panel.blockSubpanel().addClass("has-text-selection"),r.textFieldset().show(),i.data.tabs||r.linksFieldset().show(),r.fontSizeInputBox().disabled(!0),r.textFieldset().find(".eb-font-formatting.section-list").toggle("text"==n.data("type")),r.populateFont(),hasTextSelection=!0,r.startEditingSelection(),r.populateColorHexItem())},"{self} composerTextDeselect":function(e,t,o){c||r.workarea().hasClass("is-sorting")||(r.textFieldset().find("[data-font-format-group-basic]").addClass("eb-pill-group"),r.textFieldset().find("[data-font-format-group-list]").show(),r.textFieldset().find("[data-font-format-group-dropdown]").show(),s.panel.blockSubpanel().removeClass("has-text-selection"),r.textFieldset().hide(),r.linksFieldset().hide(),r.removeTextMarkers(),hasTextSelection=!1,r.linkItemGroup().empty(),r.detroyColorHexItem())},populateFont:function(){r.populateFontColor(),r.populateFontFamily(),r.populateFontSize(),r.populateFontFormatting()},initFontColor:function(){r.fontColorPicker().colorpicker()},"{self} colorpickerChange":function(e,t,o){var n;r.colorHexInput().val(o),!hasTextSelection||0<(n=r.colorHexContainer().find("iframe[data-colorhex-iframe]")).length&&n.contents().find("[data-eb-colorhex-field]").val(o)},detroyColorHexItem:function(){r.colorHexInput().removeClass("t-hidden"),r.colorHexContainer().find("iframe[data-colorhex-iframe]").remove(),r.hasHexIframe=!1},populateColorHexItem:function(){if(hasTextSelection){var e=i.selection.getParent(),e=d(e).css("color").match(/\d+/g);rgb={r:e[0]||0,g:e[1]||0,b:e[2]||0};e="#"+(e=d.hsbToHex(d.rgbToHsb(rgb)));if(1!=r.hasHexIframe){r.hasHexIframe=!0;var t=d(r.colorHexInput()[0]).clone();t.css({padding:"0px 12px",display:"block",fontSize:"13px",lineHeight:"16px",paddingBottom:"0px",color:"#555555",width:"100%",height:"31px",position:"absolute",zIndex:2,backgroundColor:"#ffffff",backgroundImage:"none",border:"1px solid #e1e1e1",borderRadius:"3px",textTransform:"uppercase"}),t.val(e),t.on("keyup",function(e){e=e.keyCode||e.charCode;0<=d.inArray(e,[13,38,40,39,37,27,32,17,18,16,8,46])||(e=d(this).val(),r.colorHexInput().val(e),7==e.length&&r.setFontColor(e))});try{(o=d("<iframe data-colorhex-iframe>")).css({margin:0,padding:"0px",height:"31px",width:"100px",border:"none",display:"block",float:"left"}),o.on("load",function(){d(this.contentWindow.document.body).css({margin:0,overflow:"hidden",width:"100px"}).append(t)}),r.colorHexInput().addClass("t-hidden"),r.colorHexContainer().prepend(o)}catch(e){console.error("There may a cross-iframe security issue. Unable to create text link item properly",e)}}else{var o;(o=r.colorHexContainer().find("iframe[data-colorhex-iframe]")).contents().find("[data-eb-colorhex-field]")}}},populateFontColor:function(){var e,t;r.lastUpdatedViaFontColorUI?r.lastUpdatedViaFontColorUI=!1:(e=i.selection.getParent(),t=d(e).css("color"),r.colorpickerToggle().prop("checked",e.style.color),r.updateFontColorUI(t,!0))},setFontColor:function(e){r.lastUpdatedViaFontColorUI=!0;i.inline.toggleStyle("color: "+e,!0),r.updateFontColorUI(e)},updateFontColorUI:function(e,t){r.updatingFontColorUI=!0,e=e||"#000",r.fontColorCaption().css("backgroundColor",e),!0===t&&r.fontColorPicker().colorpicker("setColor",e),r.updatingFontColorUI=!1},removeFontColor:function(){i.inline.removeStyleRule("color")},populateFontFamily:function(){var e;r.lastUpdatedViaFontFamilyUI?r.lastUpdatedViaFontFamilyUI=!1:(e=i.selection.getParent().style.fontFamily.replace(/\'\"/g,""),r.updateFontFamilyUI(e))},setFontFamily:function(e){r.lastUpdatedViaFontFamilyUI=!0,i.inline.format("span","style","font-family: "+e),r.updateFontFamilyUI(e)},updateFontFamilyUI:function(e){e=e||"";var t=r.fontFamilyOption().removeClass("active").where("value",'"'+e+'"').addClass("active"),e=0<t.length?t.html():e.split(",")[0];r.fontFamilyCaption().html(e)},removeFontFamily:function(){r.lastUpdatedViaFontFamilyUI=!0,i.inline.removeStyleRule("font-family")},populateFontSize:function(){var e,t;r.lastUpdatedViaFontSizeUI?r.lastUpdatedViaFontSizeUI=!1:(t=i.selection.getParent(),e=d(t).css("fontSize"),t=!!t.style.fontSize,r.updateFontSizeUI(e),r.numsliderToggle().prop("checked",!!t))},setFontSize:function(e){d.isNumeric(e)&&(e+=r.getFontSizeUnit()),r.lastUpdatedViaFontSizeUI=!0,i.inline.format("span","style","font-size: "+e);var t=i.selection.getParent(),t=d(t).css("fontSize");r.updateFontSizeUI(e||t),r.numsliderToggle().prop("checked",!!e)},updateFontSizeUI:function(e){r.updatingFontSizeUI=!0;var t=Math.abs(e.replace(/\%|px/gi,""));unit=e.match("%")?"%":"px",r.getFontSizeUnit()!==unit&&r.setFontSizeUnit(unit),r.fontSizeCaption().html(e),r.numsliderCurrentUnit().html(unit),r.numsliderUnit().removeClass("active").where("unit",'"'+unit+'"').addClass("active"),r.numsliderWidget().val(t),r.numsliderInput().val(t),r.updatingFontSizeUI=!1},removeFontSize:function(){i.inline.removeStyleRule("font-size")},getFontSizeUnit:function(){return r.fontSizeContent().data("unit")||"%"},setFontSizeUnit:function(e){r.fontSizeContent().data("unit",e);e=t.fontSizeUnits[e];r.numsliderWidget().find(".noUi-pips").remove().end().noUiSlider(d.extend({document:a},e),!0)},formattingTags:{bold:"strong",italic:"em",underline:"u",hyperlink:"a",strikethrough:"del",code:"code",superscript:"sup",subscript:"sub",orderedlist:"ol",unorderedlist:"ul"},populateFontFormatting:function(){r.lastUpdatedViaFontFormattingUI?r.lastUpdatedViaFontFormattingUI=!1:r.removeTextMarkers();var n=i.selection.getCurrent(),a=d(n).parentsUntil(EBD.block).filter("ul, ol").eq(0);r.fontFormatOption().each(function(){var e=d(this),t=e.data("format"),o=r.formattingTags[t];hasFormatting=/unorderedlist|orderedlist/.test(t)?a.is(o):0!==d(n).closest(o).length,e.toggleClass("active",hasFormatting)})},toggleFontFormatting:function(e){switch(e){case"orderedlist":case"unorderedlist":i.list.toggle(e);break;case"indent":i.indent.increase();break;case"outdent":i.indent.decrease();break;case"clear":r.selectWithinTextMarkers(),i.inline.removeFormat(),r.removeTextMarkers();break;case"hyperlink":r.populateLinks();break;default:r.hasTextMarkers()||r.createTextMarkers(),i.inline.format(e),r.lastUpdatedViaFontFormattingUI=!0}},hasTextMarkers:function(){return 0<r.workarea().find(".composer-text-marker").length},createTextMarkers:function(){i.selection.removeMarkers(),i.selection.createMarkers();var e=d.makeArray(r.workarea().find(".redactor-selection-marker").each(function(){d(this).removeClass("redactor-selection-marker").addClass("composer-text-marker").attr("id",this.id.replace("selection-","text-"))}));return r.selectWithinTextMarkers(e),e},getTextMarkers:function(){var e=d.makeArray(r.workarea().find("span#text-marker-1, span#text-marker-2"));if(e[0]&&e[1])return e},selectWithinTextMarkers:function(e){(e=e||r.getTextMarkers())&&i.caret.set(e[0].nextSibling,0,e[1],0)},removeTextMarkers:function(){r.workarea().find(".composer-text-marker").remove()},startEditingSelection:function(){c=!0,r.removeTextMarkers(),r.workarea().off("mousedown.stopEditingSelection").one("mousedown.stopEditingSelection",function(){r.stopEditingSelection()})},stopEditingSelection:function(){r.fontSizeInputBox().disabled(!1),c=!1},initLinks:function(){r.linkItem.template=r.linkItem(".is-blank").detach().removeClass("is-blank")[0],d("[data-eb-links]").on("click touchstart",function(e){d(e.target).is(r.linkRemoveButton.selector)||e.stopPropagation()})},populateLinks:function(){var e=i.selection.getNodesInRange(),t=d(e).filter("a").first(),n=r.linkItemGroup().empty();d.each(t,function(e,t){var o=r.createLinkItem().appendTo(n);r.processLinkItem(o),r.updateLinkItem(o,t)}),r.linkItemGroup().toggleClass("has-existing-links",0<t.length);e=r.createLinkItem().addClass("is-new").appendTo(n);r.processLinkItem(e);t=i.selection.getText();r.linkPreviewCaption.inside(e).html(t)},createLinkItem:function(){return d(r.linkItem.template).clone()},processLinkItem:function(e){var t=r.linkUrlField.inside(e),o=r.linkTitleField.inside(e);e.data("linkUrlField",t[0]),e.data("linkTitleField",o[0]),t.data("linkItem",e).on("input",r.linkUrlFieldInputHandler).on("mousedown",function(){d.IE&&(e.data("anchorNode")||i.selection.save())}),o.data("linkItem",e).on("input",r.linkTitleFieldInputHandler).on("mousedown",function(){d.IE&&(e.data("anchorNode")||i.selection.save())});var n=e.find(".eb-link-input");t.css({padding:0,display:"block",fontSize:"13px",lineHeight:"24px",fontWeight:"bold",color:"#ffffff",backgroundColor:"transparent",width:"100%",border:"none",outline:"none",position:"relative",zIndex:2}),d.IE&&t.css({height:"28px"}),o.css({border:"none",resize:"none",fontSize:"12px",padding:"0px",paddingTop:"0px",overflow:"hidden",overflowY:"auto",outline:"none",position:"relative",width:"100%",height:"100%",color:"#ffffff",backgroundColor:"transparent",fontFamily:"Arial, Helvetica, sans-serif",top:0,left:0,zIndex:1});try{var a=d("<iframe></iframe>");a.on("load",function(){d(a[0].contentWindow.document.body).css({margin:0,overflow:"hidden",display:"flex",flexDirection:"column",height:"100%"}).append(t).append(o)}),n.append(a)}catch(e){console.error("There may a cross-iframe security issue. Unable to create text link item properly",e)}},updateLinkItem:function(e,t){r.linkPreviewCaption.inside(e).html(d(t).text()),d(e.data("linkUrlField")).val(t.getAttribute("href")),d(e.data("linkTitleField")).val(t.title);var o="_blank"==t.target;r.linkBlankOption.inside(e).prop("checked",o),r.linkNofollowOption.inside(e).prop("checked",0<=t.rel.toLowerCase().indexOf("nofollow")),r.linkFollowOption.inside(e).prop("checked",0<=t.rel.toLowerCase().indexOf("follow")),e.data("anchorNode",t)},removeLinkItem:function(e){r.removeAnchorNode(e),e.hasClass("is-new")?r.resetLinkItem(e):(e.remove(),r.linkItem(":not(.is-new)").length<1&&r.linkItemGroup().removeClass("has-existing-links"))},resetLinkItem:function(e){r.linkUrlField.inside(e).val(""),r.linkTitleField.inside(e).val(""),r.linkBlankOption.inside(e).prop("checked",!1)},createAnchorNode:function(e){var t=i.selection.getHtml(),o=d.uid("link-"),t=d("<a />").attr("id",o).html(t)[0];return i.insert.node(t),t=d("#"+o).removeAttr("id")[0],i.selection.selectElement(t),e.data("anchorNode",t),t},updateAnchorNode:function(e){var t,o,n,a,i=e.data("anchorNode");i&&(t=d(e.data("linkUrlField")),a=d(e.data("linkTitleField")),o=r.linkBlankOption.inside(e),n=r.linkNofollowOption.inside(e),e=r.linkFollowOption.inside(e),i.href=d.trim(t.val()),i.title=a.val(),o.is(":checked")||n.is(":checked")||e.is(":checked")?(a="",o.is(":checked")&&(i.target="_blank",a+="noopener noreferrer"),n.is(":checked")&&(a+=" nofollow"),e.is(":checked")&&(a+=" follow"),a=d.trim(a),i.rel=a):(i.removeAttribute("target"),i.removeAttribute("rel")))},removeAnchorNode:function(e){var t=e.data("anchorNode");t&&(i.selection.save(),$anchorNode=d(t),$anchorNode.contents().insertAfter($anchorNode),$anchorNode.remove(),i.selection.restore(),e.removeData("anchorNode"))},activateFontFormatting:function(e){var t=e.data("format");"clear"!=t&&e.toggleClass("active"),r.toggleFontFormatting(t)},"{fontFormatOption} click":function(e){r.activateFontFormatting(e)},"{fontFormatOption} touchstart":function(e){r.activateFontFormatting(e),0<e.find("[data-bp-toggle=dropdown]").length&&e.find("[data-bp-toggle=dropdown]").trigger("click.bs.dropdown.data-api")},"{fontFormatGroupDropdown} touchstart":function(e){0<e.find("[data-bp-toggle=dropdown]").length&&e.find("[data-bp-toggle=dropdown]").trigger("click.bs.dropdown.data-api")},"{fontFamilyOption} click":function(e){e=e.data("value");r.setFontFamily(e)},"{colorpicker} colorpickerChange":function(e,t,o){r.updatingFontColorUI||(r.colorpickerToggle().prop("checked",!0),r.setFontColor(o))},"{colorpickerToggle} change":function(e){e.checked()||r.removeFontColor()},"{fontSizeToggle} click":function(e){var t=r.fontSizeCheckbox();t.is(":checked")?(t.prop("checked",!1),r.removeFontSize()):t.prop("checked",!0)},"{numsliderWidget} nouislide":function(e,t,o){r.numsliderInput().val(Math.abs(o))},"{numsliderWidget} set":function(e,t,o){r.updatingFontSizeUI||r.setFontSize(Math.abs(o))},"{numsliderInput} input":function(e){r.updatingFontSizeUI||(e=Math.abs(d.trim(e.val())),r.setFontSize(e))},"{numsliderUnit} click":function(e){e=e.data("unit");r.setFontSizeUnit(e),r.numsliderUnits().removeClass("open")},"{numsliderUnitToggle} click":function(e){r.numsliderUnits().toggleClass("open")},linkUrlFieldInputHandler:function(e){var t=d(this);r.startEditingSelection();var o=d(t.data("linkItem")),n=d.trim(t.val()),a=o.data("anchorNode");""===n||a||(d.IE&&i.selection.restore(),a=r.createAnchorNode(o),setTimeout(function(){t.focus().val(t.val())},10)),""==n&&a?r.removeAnchorNode(o):r.updateAnchorNode(o)},linkTitleFieldInputHandler:function(e){var t=d(this);r.startEditingSelection();t=d(t).data("linkItem");r.updateAnchorNode(t)},updateAnchorItem:function(e){r.startEditingSelection();e=r.linkItem.of(e);r.updateAnchorNode(e)},"{linkBlankOption} change":function(e,t){r.updateAnchorItem(e)},"{linkFollowOption} change":function(e,t){r.updateAnchorItem(e)},"{linkNofollowOption} change":function(e,t){r.updateAnchorItem(e)},"{linkRemoveButton} click":function(e,t){r.startEditingSelection();e=r.linkItem.of(e);r.removeLinkItem(e)}}}),t.resolve()})}),EasyBlog.module("composer/blocks/toolbar",function(d){var a="is-editing-block",n="is-moving-block",r="is-inserting-block";EasyBlog.Controller("Composer.Blocks.Toolbar",{elements:["[data-eb-blocks-{close-button|parent-button|cancel-move-button}]","[data-ebd-block-{toolbar|sort-handle}]"],defaultOptions:d.extend({"{cancelDropButton}":"[data-blocks-cancel-drop-button]","{cancelMoveButton}":"[data-blocks-cancel-move]","{closeBlocks}":"[data-toolbar-blocks-close]","{toolbarWrapper}":"[data-toolbar-blocks-wrapper]","{label}":"[data-ebd-block-label]","{done}":"[data-blocks-done]","{insert}":"[data-blocks-insert]","{move}":"[data-blocks-move]","{duplicate}":"[data-blocks-duplicate]","{remove}":"[data-blocks-remove]","{saveTemplate}":"[data-blocks-save-template]","{blockTemplateMenu}":"[data-eb-composer-block-template-menu]"},EBD.selectors)},function(i,e,t,l,c,o){return{init:function(){c=i.blocks,l=i.blocks.composer},dropping:!1,cancelDrop:function(){l.blocks.droppable.selectedMenu=null,l.blocks.droppable.selectedBlock=null,l.blocks.droppable.dropStop(),l.blocks.menu().removeClass("is-selected"),l.manager().removeClass("is-dropping-block")},deleteCurrentBlock:function(){var e=l.manager(),t=c.getCurrentBlock(),o=c.getNextBlock(),n=c.getPreviousBlock();c.removeBlock(t),!1!==o&&c.activateBlock(o),!1===o&&n&&c.activateBlock(n),o||n||e.removeClass("is-editing-block"),e.removeClass("is-inserting-block")},duplicateBlock:function(){var e=c.getCurrentBlock(),t=c.getBlockContent(e),o=c.getBlockType(e),n=c.getData(e),a=c.isBlockTemplate(e),o=c.createBlock(o);c.data(o,n),c.setBlockContent(o,t),a&&(c.updateTemplateId(o,c.getBlockTemplateId(e)),c.updateBlockTitle(o,c.getBlockTitle(e))),e.after(o),c.drop(o),c.release(o),c.out(o);a=c.getChildBlocks(o);0<a.length&&d.each(a,function(e,t){"image"==c.getBlockType(t)&&d(t).removeClass("is-editable")}),c.activateBlock(o),c.getCurrentBlock().click(),i.trigger("composerBlockDuplicate",[o,e])},getLabel:function(e){return e.find("[data-ebd-block-label]")},insertBlock:function(){l.manager().toggleClass("is-inserting-block"),l.blocks.browser.toggle()},moveBlock:function(){var e;l.manager().hasClass(n)||(l.blocks.droppable.populateDropzones(),l.manager().addClass(n),(e=c.getCurrentBlock()).addClass("is-sort-item"),i.workarea().addClass("is-sorting"),i.trigger("composerBlockMove",[e]))},saveBlockAsTemplate:function(){var r=c.getCurrentBlock(),s=c.getBlockTemplateId(r);EasyBlog.dialog({content:EasyBlog.ajax("site/views/composer/saveBlockAsTemplate",{id:s}),bindings:{"{saveButton} click":function(e,t){var o=c.exportBlock(r,!0),n=[],a=o.style;null!=a&&""!=a&&(a=(a=a.replace(/font-family: \"Comic Sans MS\";/,"font-family: Comic Sans MS;")).replace(/font-family: \"Trebuchet MS\";/,"font-family: Trebuchet MS;"),o.style=a),n.push(o);var i=this.form(),a=(i.find("[data-alert-placeholder]"),this.errorMessage(),i.find("[data-template-title]")),o=i.find("[data-template-description]"),i=i.find("[data-template-global]"),i={block:JSON.stringify(n),title:a.val(),description:o.val(),global:i.is(":checked")?1:0};"update"==d(e).data("save-type")&&s&&(i.id=s),EasyBlog.ajax("site/controllers/blocks/saveTemplate",i).done(function(e,t,o,n){l.setMessage({type:"success",message:e});t=d(t),e=d("[data-eb-composer-block-template-menu]");!n||0<(n=e.find('[data-eb-composer-block-menu][data-id="'+s+'"]')).length&&n.remove(),(t=d.buildHTML(t)).appendTo(e),e.parents("[data-eb-composer-block-section]").removeClass("hide"),c.updateTemplateData(r,o)}).fail(function(e,t){l.setMessage({type:"error",message:e})}),this.parent.close()}}})},"{self} composerBlockUpdateTitle":function(e,t,o,n){i.getLabel(o).html(n)},"{closeBlocks} click":function(){i.cancelDrop(),l.manager().removeClass(r),l.blocks.browser.close()},"{self} composerBlockDrop":function(e,t){i.dropping=!1},"{self} composerBlockMenuSelected":function(e,t){i.dropping=!0},"{self} composerBlockActivate":function(e,t,o){var n;o.hasClass("is-standalone")||(i.getLabel(o).html(c.getBlockTitle(o)),l.manager().addClass(a),n=c.isNestedBlock(o),blockActions=c.getBlockActions(o),n&&(blockActions.find("[data-blocks-duplicate]").remove(),blockActions.find("[data-blocks-insert]").remove()),o.hasClass("is-isolated")&&blockActions.find("[data-blocks-move]").remove())},"{self} composerBlockDeactivate":function(){l.manager().removeClass(a).removeClass(r)},"{cancelMoveButton} click":function(e){l.manager().removeClass(n),l.blocks.droppable.dropStop(),c.getCurrentBlock().removeClass("hide").removeClass("is-sort-item"),i.workarea().removeClass("is-sorting")},"{parentButton} click":function(e){var t=c.getCurrentBlock();t.length&&((t=c.getParentBlock(t)).length?c.activateBlock(t):c.deactivateBlock())},"{cancelDropButton} click":function(e,t){i.cancelDrop()},"{closeButton} click":function(e){l.views.hide("blocks")},"{duplicate} click":function(e,t){t.stopPropagation(),i.duplicateBlock()},"{saveTemplate} click":function(e,t){t.stopPropagation(),i.saveBlockAsTemplate()},"{move} click":function(e,t){d(e).mouseleave(),i.moveBlock()},"{remove} click":function(e,t){d(e).mouseleave(),i.deleteCurrentBlock()},"{insert} click":function(){i.insertBlock()}}}),this.resolve()}),EasyBlog.module("composer/blocks/tree",function(u){EasyBlog.Controller("Composer.Blocks.Tree",{elements:["[data-eb-{block|block-icon|block-title|block-level-count|block-child-count}]","[data-eb-blocks-{tree-field|tree|tree-item|tree-item-template|tree-item-icon|tree-item-title|tree-item-group|tree-toggle-button}]"]},function(l,e,t,o,c,d){return{init:function(){c=l.blocks,c.composer,d=l.createTreeItem,l.treeItemTemplate=l.treeItemTemplate().detach().html()},setCurrentBlock:function(e){var t=c.getBlockType(e),t=c.getBlockMeta(t);l.blockTitle().text(c.getBlockTitle(e)),l.blockIcon().attr("class",t.icon);t=c.getAllParentBlocks(e),e=c.getChildBlocks(e).length,t=t.length+1;l.blockChildCount().text(e),l.blockLevelCount().text(t),l.block().toggleClass("has-child",e)},populate:function(t){var e,o,n,a,i,r,s;(t=t||c.getCurrentBlock()).length&&(e=l.treeField(),o=!!(r=c.getParentBlock(t)).length,i=!!(n=c.getChildBlocks(t)).length,e.toggleClass("has-parent",o).toggleClass("has-children",i),a=[],"minimal"==(i=l.getTreeDisplayMode())?o?(a.push(d(r,1)),c.getChildBlocks(r).each(function(){var e=u(this);a.push(d(e,2)),e.is(t)&&n.each(function(){var e=u(this);a.push(d(e,3))})})):(a.push(d(t,1)),n.each(function(){var e=u(this);a.push(d(e,2))})):(r=c.getRootBlocks(),s=function(e,t){var o=t;a.push(d(e,o)),c.getChildBlocks(e).each(function(){var e=u(this);s(e,o+1)})},r.each(function(){s(u(this),1)})),l.tree().toggle("full"==i||1<a.length),l.treeItemGroup().empty().append(a))},createTreeItem:function(e,t){var o=e.data("treeItem");return o||(o=l.renderTreeItem(e),e.data("treeItem",o)),o.toggleClass("active",e.hasClass("active")).toggleClass("is-nested",e.hasClass("is-nested")).switchClass("level-"+t),o},renderTreeItem:function(e){var t=c.getBlockUid(e),o=c.getBlockType(e),e=c.getBlockMeta(o),o=u(l.treeItemTemplate);return o.attr({"data-type":e.type,"data-uid":t}).find(l.treeItemIcon).addClass(e.icon).end().find(l.treeItemTitle).text(e.title),o},getTreeDisplayMode:function(){return l.treeField().hasClass("tree-minimal")?"minimal":"full"},setTreeDisplayMode:function(e){l.treeField().switchClass("tree-"+e),l.populate()},"{self} composerBlockUpdateTitle":function(e,t,o,n){l.blockTitle().text(n)},"{self} composerBlockAdd":function(e,t,o,n){l.populate()},"{self} composerBlockActivate":function(e,t,o,n){l.setCurrentBlock(o),l.populate(o)},"{self} composerBlockRemove":function(e,t,o){l.populate()},"{treeItem} click":function(e){e=e.data("uid"),e=c.getBlock(e);c.scrollTo(e),c.unhighlight(e),c.activateBlock(e)},"{treeToggleButton} click":function(){l.treeField();var e=l.getTreeDisplayMode();l.setTreeDisplayMode("minimal"==e?"full":"minimal")}}}),this.resolve()}),EasyBlog.module("composer/category",function(m){EasyBlog.Controller("Composer.Category",{defaultOptions:{"{itemGroupTemplate}":"[data-category-item-group-template]","{itemTemplate}":"[data-category-item-template]","{viewport}":"[data-eb-composer-category-viewport]","{loader}":"[data-eb-composer-category-loader]","{tree}":"[data-eb-composer-category-tree]","{itemGroup}":"[data-eb-composer-category-item-group]","{itemGroupHeader}":"[data-eb-composer-category-item-group-header]","{item}":"[data-eb-composer-category-item]","{itemCount}":"[data-eb-composer-category-item-count]","{itemCheckbox}":"[data-eb-composer-category-item-checkbox]","{count}":"[data-eb-composer-category-count]","{searchTextfield}":"[data-eb-composer-category-search-textfield]","{jsondata}":"[data-eb-composer-category-jsondata]"}},function(p,n,e,t){return{init:function(){p.composer,p.multipleCategories=p.viewport().data("multiple-categories"),p.initializeTemplates(),p.viewport().on("mousewheel",function(e){e.stopPropagation()});var e=0,t=JSON.parse(p.jsondata().val());for(p.build(t);category=t[e++];)category.selected&&p.selectCategory(category.id);p.go(0),p.jsondata().remove()},initializeTemplates:function(){n.templates={},n.templates.itemGroup=p.itemGroupTemplate().detach().html(),n.templates.item=p.itemTemplate().detach().html()},categories:{0:{id:0,title:"",parent_id:null},search:{id:"search",title:"",parent_id:null}},children:{search:[]},childLoaded:{},keys:{},clones:{},selected:{},build:function(e){for(var t,o=0;t=e[o++];){var n=parseInt(t.id),a=parseInt(t.parent_id);null==p.categories[n]&&(p.categories[n]=t,(p.children[a]||(p.children[a]=[])).push(t),0<t.childs&&(p.childLoaded[n]=!1),n=t.key=t.title.toLowerCase()+" [#"+n+"]",p.keys[n]=t)}},childrens:m.memoize(function(e,t){var o=p.children[e];if(!o)return[];var n,a=t?[].concat(p.childrens(e)):m.flatten(o,"id"),i=a.length;if(t)for(n=0;n<i;n++)a=a.concat(p.childrens(a[n],t));return a},function(e,t){return e+(t?"_deep":"")}),parents:m.memoize(function(e){var t=p.categories[e];if(t){if(0==e)return[0];for(var o=[];t=p.categories[t.parent_id];)o.unshift(t.id);return o}}),itemGroup:{get:m.memoize(function(e){var t=p.children[e];if(t){for(var o,e=p.categories[e],e=p.getItemGroupTemplate(e),n=[],a=0;o=t[a++];)n.push(p.item.get(o.id));return m(e).locate("viewport").append(n),e}})},item:{get:m.memoize(function(e){var t=p.categories[e];if(t){e=p.children[e];return p.getItemTemplate(t,e||null)}})},getItemGroupTemplate:function(e){var t=m(n.templates.itemGroup);return t.attr("data-id",e.id),t.find("[data-item-title]").html(e.title),t.find("[data-category-primary-item]").attr("data-id",e.id).attr("data-title",e.title),t[0]},getItemTemplate:function(e,t){var o=m(n.templates.item);return o.attr("data-id",e.id),o.find("[data-item-title]").html(e.title),o.find("[data-category-primary-item]").attr("data-id",e.id).attr("data-title",e.title),(t||0<e.childs)&&o.addClass("has-children"),o[0]},itemCount:{get:m.memoize(function(e){return m(p.item.get(e)).find(p.itemCount.selector)[0]}),set:function(e,t){m(p.itemCount.get(e)).find("span").html(t)}},populate:function(e){var t=p.children[e];if(t){m(p.itemGroup.get(e)).locate("header").removeClass("active");for(var o=0,n=p.selected,a=m.values(n);d=t[o++];){var i,r,s=d.id,l=[],c=[];p.childLoaded[s]&&(i=[],r=[],allChildIds=p.childrens(s,!0),m.each(allChildIds,function(e,t){i.push(t.id)}),l=m.intersection(a,i),immediateChildIds=p.childrens(s,!1),m.each(immediateChildIds,function(e,t){r.push(t.id)}),c=m.intersection(l,r),u=p.categories[d.parent_id||d.id],0<l.length?u.hadChildSelectedCount=1:u.hadChildSelectedCount=d.hadChildSelectedCount);var d,u=0<l.length||0<d.hadChildSelectedCount,l=m("[data-category-primary-input]").val();m(p.item.get(s)).toggleClass("selected",m.has(n,s)).toggleClass("is-primary",s==l).toggleClass("has-selected-children",u).removeClass("active"),0<d.childs&&(d=(c.length||d.hadChildSelectedCount)+"/"+d.childs,p.itemCount.set(s,d))}}},query:m.memoize(function(e){var t,o,n=p.keys,a={},i=new RegExp("^"+m.regExpEscape(e),"i");for(key in n)key.match(i)&&(a[o=(t=n[key]).parent_id]||(a[o]=[])).push(t);return a}),search:function(l){var e;l.length<3||(e=p.composer.getPostId(),p.loader().removeClass("hide"),EasyBlog.ajax("site/views/categories/search",{keyword:l,postId:e}).done(function(e){if(e){var t=0,o=e;for(p.build(o);category=o[t++];)category.selected&&p.selectCategory(category.id),0!=category.parent_id&&(p.childLoaded[category.parent_id]=!0)}}).always(function(){p.loader().addClass("hide");var e=p.query(l),t=p.clones,o=[],n=[];for(parentId in e){for(var a=p.categories[parentId],a=p.getItemGroupTemplate(a),i=e[parentId],n=[],r=0;s=i[r++];){var s=s.id,s=t[s]||(t[s]=m(p.item.get(s)).clone()[0]);n.push(s)}m(a).locate("viewport").append(n),o[0==parentId?"unshift":"push"](a)}p.itemGroup().detach(),m(p.itemGroup.get("search")).empty().append(o).appendTo(p.tree().switchClass("level-0").data("level",0))}))},currentTree:[],go:function(e){var t,o,n,a;p.categories[e]&&(t=p.tree(),n=(o=p.parents(e)).length-1,a=m.map(o,function(e){return p.itemGroup.get(e)}),n<(e=t.data("level")||0)&&a.push(p.itemGroup().eq(e)),p.itemGroup().detach(),p.populate(m.last(o)),t.append(a).switchClass("level-"+n).data("level",n),p.searchTextfield().val(""))},open:function(e){var t=p.children[e];t&&(m(p.item.get(e)).addClass("active"),p.go(t[0].id))},selectCategory:function(e){p.toggle(e,!0)},deselect:function(e,t){p.toggle(e,!1,t)},toggle:function(e,t,o){var n=m.extend({},p.selected),a=m(p.item.get(e)),i=m(p.clones[e]),r=p.selected;(t=void 0===t?!a.hasClass("selected"):t)?r[e]=parseInt(e):delete r[e];var s=(t?"add":"remove")+"Class";if(a[s]("selected"),i[s]("selected"),0==m.keys(p.selected).length&&!o)return a[s=(t?"remove":"add")+"Class"]("selected"),i[s]("selected"),EasyBlog.dialog({content:EasyBlog.ajax("site/views/composer/errorDefaultCategoryWarning")}),void(t?delete r[e]:r[e]=parseInt(e));p.trigger("category"+(t?"select":"deselect"),[p.categories[e],p.toArray()]),o||p.multipleCategories||m.each(n,function(e,t){p.deselect(t,!0)}),p.count().html(m.keys(p.selected).length)},"{self} categorydeselect":function(e,t,o){!o.parent_id||0<(o=p.categories[o.parent_id]).hadChildSelectedCount&&o.hadChildSelectedCount--},enableKeyboardNavigation:function(){m(document).off("keydown.composer.category").on("keydown.composer.category",function(e){var t=e.keyCode;switch(t){case 38:case 40:case 37:case 39:p.navigate({38:"up",40:"down",37:"left",39:"right"}[t])}})},disableKeyboardNavigation:function(){m(document).off("keydown.composer.category")},navigate:function(e){var t=p.currentClickedItem;switch(e){case"up":t.prev().click();break;case"down":t.next().click();break;case"left":p.go(t.data("id"))}},toArray:function(){if(!p.selected)return[];var e=[];for(id in p.selected){var t=p.categories[id];e.push(t)}return e},lastClickedItem:m(),currentClickedItem:m(),"{item} click":function(e){p.lastClickedItem=p.currentClickedItem,p.currentClickedItem=e},"{self} composerSave":function(e,t,o){o.data.categories=m.values(p.selected)},"{self} categorysetprimary":function(e,t,o){p.item().removeClass("is-primary"),m(p.item.get(o.id)).addClass("is-primary")},"{itemGroup} click":function(e,t){var o=e.find(p.item.selector),n=p.lastClickedItem,e=p.currentClickedItem;t.metaKey||t.ctrlKey||o.removeClass("active"),e.toggleClass("active"),t.shiftKey&&0<n.length&&(n=o.index(n),e=o.index(e),o.slice.apply(o,n<e?[n,e]:[e,n]).addClass("active")),0<o.filter(".active").length?p.enableKeyboardNavigation():p.disableKeyboardNavigation()},"{item} dblclick":function(e){e=e.data("id");p.open(e)},"{itemCount} click":function(e){var n=p.item.of(e).data("id");null==p.childLoaded[n]||p.childLoaded[n]?p.open(n):(e=p.composer.getPostId(),p.loader().removeClass("hide"),EasyBlog.ajax("site/views/categories/getChildCategories",{id:n,postId:e}).done(function(e){if(e){var t=0,o=e;for(p.build(o);category=o[t++];)category.selected;p.open(n)}p.childLoaded[n]=!0}).always(function(){p.loader().addClass("hide")}))},"{itemCheckbox} click":function(e,t){e=p.item.of(e).data("id");p.toggle(e),t.stopPropagation()},"{itemGroupHeader} click":function(e){var t=p.itemGroup.of(e).data("id");e.addClass("active"),p.go(t)},"{searchTextfield} keyup":m.debounce(function(e){e=m.trim(e.val());""==e?p.go(0):p.search(e)},250),"{self} composerValidate":function(e,t,o){}}}),this.resolve()}),EasyBlog.module("composer/composer",function(e){var t=this,o=window.EBD={};o.root=".ebd",o.block=".ebd-block:not(is-helper):not(.is-placeholder):not(.is-dropzone)",o.childBlock="> "+o.block,o.nest=".ebd-nest",o.nestedBlock=o.block+".is-nested",o.immediateNestedBlock=o.nestedBlock+":not("+o.nest+" "+o.nest+" "+o.nestedBlock+")",o.standaloneBlock=o.block+".is-standalone",o.isolatedBlock=o.block+".is-isolated",o.workarea="[data-ebd-workarea]",o.dropzone="[data-ebd-dropzone]",o.blockToolbar="[data-ebd-block-toolbar]",o.blockSortHandle="[data-ebd-block-sort-handle]",o.blockViewport="[data-ebd-block-viewport]",o.blockContent="[data-ebd-block-content]",o.blockActions="[data-ebd-block-actions]",o.immediateBlockSortHandle="> "+o.blockToolbar+" > "+o.blockSortHandle,o.immediateBlockViewport="> "+o.blockViewport,o.immediateBlockContent=o.immediateBlockViewport+"> "+o.blockContent,o.editableContent=o.block+".is-editable [contenteditable=true]",o.selectors={"{workarea}":o.workarea,"{root}":o.workarea+" "+o.root,"{nest}":o.workarea+" "+o.root+" "+o.nest,"{block}":o.workarea+" "+o.root+" "+o.block,"{dropzone}":o.workarea+" "+o.root+" "+o.dropzone};e.fn.caret=function(o,n){var e;if(0!=this.length)return"number"==typeof o?(n="number"==typeof n?n:o,this.each(function(){if(this.setSelectionRange){var e=this;window.setTimeout(function(){e.setSelectionRange(o,n)},0)}else if(this.createTextRange){var t=this.createTextRange();t.collapse(!0),t.moveEnd("character",n),t.moveStart("character",o);try{t.select()}catch(e){}}})):(this[0].setSelectionRange?(o=this[0].selectionStart,n=this[0].selectionEnd):document.selection&&document.selection.createRange&&(e=document.selection.createRange(),o=0-e.duplicate().moveStart("character",-1e5),n=o+e.text.length),{start:o,end:n})},EasyBlog.require().script("composer/perfectscrollbar","composer/document","composer/blocks","composer/category","composer/tags","composer/revisions","composer/shortcuts","composer/mobile","composer/media","composer/posts","composer/templates","composer/googleimport","composer/panels","composer/panels/post","composer/panels/authorship","composer/panels/category","composer/panels/seo","composer/panels/autopost","shared/gallery","shared/foundry").library("dialog").done(function(u){EasyBlog.Controller("Composer",{hostname:"composer",pluginExtendsInstance:!0,elements:["[data-eb-composer-{manager|actions|form|ghosts|alerts}]","[data-eb-composer-{views|view|viewport|viewport-content}]","[data-eb-{alert-template}]"],defaultOptions:{templates:{},isTemplateEditor:null,postUid:null,authorId:null,"{frame}":"[data-composer-frame]","{manager}":"[data-composer-manager]","{alert}":"[data-composer-alert]","{alertMessage}":"[data-composer-alert-message]","{alertPlaceholder}":"[data-eb-alert-placeholder]","{alertCloseButton}":"[data-eb-composer-alert-close]","{retryButton}":"[data-eb-composer-instance-entry-button]","{toolbarViews}":"[data-toolbar-view]","{form}":"[data-composer-form]","{viewport}":"[data-eb-composer-viewport]","{viewportContent}":"[data-eb-composer-viewport-content]","{exit}":"[data-composer-exit]","{publish}":"[data-composer-publish]","{preview}":"[data-composer-preview]","{permalinkPreview}":"[data-permalink-preview]","{saveTemplate}":"[data-composer-save-template]","{deleteTemplate}":"[data-composer-delete-template]","{saveDraft}":"[data-composer-save-draft]","{approvePost}":"[data-composer-approve]","{trashPost}":"[data-composer-trash]","{rejectPost}":"[data-composer-reject]","{submitApproval}":"[data-composer-submit-approval]","{updatePost}":"[data-composer-update]","{autosaveMessage}":"[data-composer-autosave-message]","{publishedField}":"[data-composer-field-published]","{previewField}":"[data-composer-field-preview]","{rejectMessage}":"[data-composer-reject-message]","{postTemplateId}":"[data-eb-composer-post-template-id]","{publishTips}":"[data-publish-tips]","{undoTips}":"[data-undo-tips]","{publishProgressBar}":"[data-publishing-progress]","{undoActionWrapper}":"[data-undo-action-wrapper]","{cancelPublishing}":"[data-cancel-publish]","{publishNow}":"[data-publish-now]","{draftWarning}":"[data-draft-warning]","{draftDiscard}":"[data-draft-discard]","{draftContinue}":"[data-draft-continue]","{draftItems}":"[data-eb-composer-revisions-item].is-draft","{jceFullWindowBtn}":"[data-eb-composer-page-body].eb-editor--jce #content_fullscreen"}},function(c,d,o,n,a){return{saveOptions:{autosave:!1,showSaveMessage:!0,updateRevisionStatus:!0,updateAddressBar:!0},init:function(){EasyBlog.debug||u(window).on("beforeunload",function(e){return e.preventDefault(),!1}),d.templates.alert=c.alertTemplate().detach().html(),n=c.frame(),a=c.manager(),d.authorId=n.data("author-id"),d.permalink=n.data("permalink"),d.exitAlert=n.data("exit-alert"),d.mapIntegration=n.data("map-integration"),d.isTemplateEditor=n.data("is-template-editor"),d.isWebview=n.data("is-webview"),o.noscroll(),EasyBlog.Composer=c,u.extend(d,n.htmlData("composer")),d.mobile=1==d.mobile,c.installPlugins(["media","templates","blocks","posts","panels","document","tags","category","revisions","googleimport","perfectscrollbar"]);c.perfectscrollbar.initPs("[data-eb-composer-viewport-content]");c.installPlugins(["shortcuts"]),d.mobile&&c.installPlugins(["mobile"]),c.keepalive.start(),a.hasClass("show-templates")||c.autosave.start(),u("input, textarea").each(function(){u(this).on("focus",function(e){a.addClass("input-focused")}),u(this).on("blur",function(e){a.removeClass("input-focused")})}),c.trigger("composerReady")},isPublished:function(){return 1==c.publishedField().val()},isDraft:function(){return 3==c.publishedField().val()},publishPost:function(){c.publishNow().addClass("t-hidden"),c.cancelPublishing().addClass("t-hidden"),c.previewField().val(0),c.publishedField().val(1),c.disableLeavePrompt(),c.save({autosave:0,isapply:0})},"{self} composerDocumentReady":function(){n.removeClass("is-loading")},"{self} composerSubmitLock":function(){n.addClass("is-submit-lock")},"{self} composerSubmitUnlock":function(){setTimeout(function(){n.removeClass("is-submit-lock")},2e3)},installPlugins:function(e){u.each(e,function(e,t){c.addPlugin(t)})},settings:{get:function(e){return o.find("input[name='"+e+"']").val()},set:function(e,t){return o.find("input[name='"+e+"']").val(t),c.trigger("composerSettingsChange",[e,t]),t}},getPreviewNamespace:function(){return"post-preview-"+d.authorId+"-"+c.getPostUid()},getPostId:function(){return n.attr("data-post-id")},getPostUid:function(){return n.attr("data-post-uid")},getRevisionId:function(){return c.getPostUid().split(".")[1]},getDoctype:function(){return n.attr("data-post-doctype")},getPostTemplateId:function(){return c.postTemplateId().val()},views:{show:function(e){c.trigger("composerViewShow",[e])},hide:function(e){c.trigger("composerViewHide",[e]);e=c.toolbarViews("[data-type="+e+"]");e.length&&e.removeClass("open"),c.views.show("document")},hideAll:function(){c.toolbarViews("[data-toolbar-view]").length<=0||(c.trigger("composerViewHideAll"),c.views.show("document"))}},keepalive:{timer:null,start:function(e){var t=c.keepalive,e=e||d.keepalive.interval;t.stop(),e<1||(t.timer=setTimeout(function(){t.run(e)},e))},run:function(e){EasyBlog.ajax("site/views/composer/keepAlive").always(function(){c.keepalive.start(e)})},stop:function(){clearTimeout(c.keepalive.timer)}},autosave:{timer:null,counter:0,start:function(e){e=e||d.autosave.interval;c.autosave.stop(),e<1||!e||(c.autosave.timer=setTimeout(function(){c.autosave.run(e)},e))},run:function(e){c.autosave.save(),c.autosave.start(e)},stop:function(){clearTimeout(c.autosave.timer)},save:function(){var e,t,o;c.saving||0<u("div.ebd-block[data-ebd-dropzone]").length||(e=blocks.getCurrentBlock(),t=c.publishedField().val(),0==c.autosave.counter&&4!=t&&c.publishedField().val(3),c.autosave.counter++,n.addClass("is-autosaving"),c.saving=!0,o=u.Task(),c.trigger("composerSave",[o,c]),0<e.length&&blocks.activateBlock(e),o.process().done(function(){u("[data-composer-field-document]").val(o.data.document);var e=c.form().serializeObject();"legacy"==c.getDoctype()&&(e.content=o.data.content),e.template_id=c.getPostTemplateId(),EasyBlog.ajax("site/controllers/posts/autosave",e).done(function(e,t,o){null!=t&&(c.autosaveMessage().removeClass("t-hidden").html(e),history.pushState({state:1},"",o),u("[data-eb-composer-post-uid]").val(t.uid),u("[data-eb-composer-revision-id]").val(t.revision_id))})}).always(function(){c.saving=!1}))}},saving:!1,getSaveData:function(t){c.form().each(function(){var e=u(this).serializeObject();u.extend(t,e)})},save:function(e){var t;n.hasClass("is-submit-lock")||c.saving||(c.saving=!0,(e=u.extend(c.saveOptions,e)).target&&!d.isWebview?c.form().attr("target",c.getPreviewNamespace()):c.form().attr("target","_self"),e.preview?c.previewField().val(1):c.previewField().val(0),t=u.Task(),e.autosave?t.data.autosave=e.autosave:t.data.autosave=0,c.trigger("composerSave",[t,c]),t.process().done(function(){u("[data-composer-field-document]").val(t.data.document),c.form().submit()}).fail(function(){c.saving=!1,c.trigger("composerSaveError")}).always(function(){e.target&&(e.target=void 0),e.preview&&(c.saving=!1,e.preview=!1)}))},trash:function(){c.disableLeavePrompt(),EasyBlog.dialog({content:EasyBlog.ajax("site/views/composer/confirmTrash",{uid:c.getPostId()}),bindings:{"{deleteButton} click":function(){EasyBlog.ajax("site/views/composer/delete",{uid:c.getPostUid()}).done(function(){})}}})},setMessage:function(e,t){var o=(e=!u.isArray(e)?[e]:e)[0],e="success";/error|danger/.test(o.type)&&(e="danger"),t&&void 0!==t||(t=c.alertPlaceholder()),c.alert().length<=0&&u(d.templates.alert).appendTo(t),c.alert().removeClass("t-hidden"),c.alert().removeClass("o-alert--success o-alert--danger").addClass("o-alert--"+e),c.alert().find(c.alertMessage).html(o.message)},"{preview} click":function(){4!=c.publishedField().val()&&c.publishedField().val(3),c.save({preview:!0,target:c.getPreviewNamespace()})},"{saveTemplate} click":function(e,t){c.saving||EasyBlog.dialog({content:EasyBlog.ajax("site/views/composer/saveAsPostTemplateDialog",{template_id:c.getPostTemplateId()}),bindings:{"{saveButton} click":function(){c.disableLeavePrompt(),c.saving=!0;var e=u.Task();c.trigger("composerSave",[e,c]);var t=this.form(),o=t.find("[data-alert-placeholder]"),n=this.errorMessage(),a=t.find("[data-template-title]"),i=t.find("[data-template-id]"),r=t.find("[data-template-global]"),s=t.find("[data-template-lock]"),l=this.parent;a.removeClass("t-border--danger"),n.html(""),0==a.val().length&&a.addClass("t-border--danger"),e.process().done(function(){u("[data-composer-field-document]").val(e.data.document);var n=c.form().serializeObject();"legacy"==c.getDoctype()&&(n.content=e.data.content),n.template_id=i.val(),n.template_title=a.val(),n.system=r.is(":checked")?1:0,n.lock=s.is(":checked")?1:0,EasyBlog.ajax("site/controllers/templates/save",n).done(function(e,t,o){null!=n&&(c.setMessage({type:"success",message:e}),c.postTemplateId().val(t),c.saveTemplate().find("[data-template-button-save]").addClass("t-hidden"),c.saveTemplate().find("[data-template-button-update]").removeClass("t-hidden"),d.isTemplateEditor&&history.pushState({state:1},"",o),l.close())}).fail(function(e){c.setMessage({type:"error",message:e},o)})}).fail(function(){c.trigger("composerSaveError")}).always(function(){c.saving=!1})},"{deleteButton} click":function(){EasyBlog.dialog({content:EasyBlog.ajax("site/views/templates/confirmDeleteTemplates",{from:d.isTemplateEditor?"":"composer",ids:[c.getPostTemplateId()]}),bindings:{"{deleteButtonComposer} click":function(){var t=this.parent;EasyBlog.ajax("site/controllers/templates/delete",{ids:[c.getPostTemplateId()]}).done(function(e){c.setMessage({type:"success",message:e}),c.postTemplateId().val(0),c.saveTemplate().find("[data-template-button-save]").removeClass("t-hidden"),c.saveTemplate().find("[data-template-button-update]").addClass("t-hidden"),t.close()}).fail(function(e){c.setMessage({type:"error",message:e})})}}})}}})},"{exit} click":function(e,t){d.exitAlert||c.disableLeavePrompt(),window.location=e.data("url")},"{saveDraft} click":function(e,t){n.hasClass("is-submit-lock")||(c.disableLeavePrompt(),e.find("[data-eb-icon]").loading(),4!=c.publishedField().val()&&c.publishedField().val(3),c.save({preview:!1,target:!1,autosave:!1,isapply:!1}))},"{submitApproval} click":function(e){c.disableLeavePrompt(),e.find("[data-eb-icon]").loading(),c.publishedField().val(4),c.save({autosave:0,isapply:0})},"{approvePost} click":function(e){c.publishedField().val(1),e.find("[data-eb-icon]").loading(),c.disableLeavePrompt(),c.save({autosave:0,isapply:0})},"{rejectPost} click":function(t){EasyBlog.dialog({content:EasyBlog.ajax("admin/views/dialogs/render",{file:"site/composer/dialogs/reject"}),bindings:{"{submitButton} click":function(){var e=this.reason().val();t.find("[data-eb-icon]").loading(),c.rejectMessage().val(e),c.publishedField().val(3),c.disableLeavePrompt(),c.save({autosave:0,isapply:0})}}})},"{cancelPublishing} click":function(e,t){t.stopPropagation(),t.preventDefault(),clearTimeout(c.countingDown),c.publishTips().removeClass("t-hidden"),c.undoTips().addClass("t-hidden"),c.undoTips().find("span").html(10),c.publishProgressBar().css("width","0%"),c.undoActionWrapper().addClass("t-hidden")},"{publishNow} click":function(e,t){t.preventDefault(),t.stopPropagation(),c.publish().find("[data-eb-icon]").loading(),c.publishProgressBar().addClass("t-hidden"),c.publishTips().removeClass("t-hidden"),c.undoTips().addClass("t-hidden"),c.publishPost()},countingDown:null,countdownPublishing:function(e){var t=9,o=20;c.publishTips().addClass("t-hidden"),c.undoTips().removeClass("t-hidden"),c.undoActionWrapper().removeClass("t-hidden"),c.countingDown=setInterval(function(){c.undoTips().find("span").html(t),t--,c.publishProgressBar().css("width",o+"%"),o+=10,t<1&&(clearTimeout(c.countingDown),setTimeout(function(){e.find("[data-eb-icon]").loading(),c.publishTips().removeClass("t-hidden"),c.undoTips().addClass("t-hidden"),c.publishPost()},1e3))},1e3)},validatePost:function(t){var e=blocks.getCurrentBlock(),o=u.Task();c.trigger("composerSave",[o,c]),0<e.length&&blocks.activateBlock(e),o.process().done(function(){u("[data-composer-field-document]").val(o.data.document);var e=c.form().serializeObject();"legacy"==c.getDoctype()&&(e.content=o.data.content),EasyBlog.ajax("site/controllers/posts/validateContent",e).done(function(){u("[data-show-undo]").addClass("is-undo-on"),c.countdownPublishing(t)}).fail(function(e){c.setMessage(e)})})},"{publish} click":function(e,t){if(!n.hasClass("is-submit-lock")){if(!(1==e.data("undo-enabled")))return e.find("[data-eb-icon]").loading(),void c.publishPost();c.validatePost(e)}},"{updatePost} click":function(e){n.hasClass("is-submit-lock")||(3==c.publishedField().val()&&(c.previewField().val(0),c.publishedField().val(1)),c.disableLeavePrompt(),e.find("[data-eb-icon]").loading(),c.save())},"{unpublishPostButton} click":function(){c.publishedField().val(0),c.save({autosave:0,isapply:0})},"{trashPost} click":function(){c.trash()},"{draftContinue} click":function(){c.disableLeavePrompt()},"{draftDiscard} click":function(){EasyBlog.ajax("site/views/composer/discardDraft",{id:c.getPostId()}).done(function(e){c.setMessage({type:"success",message:e}),a.removeClass("warning-draft"),c.draftItems().remove()}).fail(function(e){c.setMessage(e)})},"{self} composerSelectTemplate":function(e,t,o,n){a.removeClass("show-templates"),n&&(c.saveTemplate().find("[data-template-button-save]").addClass("t-hidden"),c.saveTemplate().find("[data-template-button-update]").removeClass("t-hidden")),setTimeout(function(){c.autosave.start()},6e3)},"{permalinkPreview} click":function(e,t){c.isDraft()?c.preview().click():c.isPublished()&&window.open(d.permalink,c.getPreviewNamespace())},"{jceFullWindowBtn} click":function(e,t){u("[data-eb-composer-page-body].eb-editor--jce").toggleClass("eb-editor--fullscreen")},"{alertCloseButton} click":function(e,t){t.preventDefault(),t.stopPropagation(),c.alertPlaceholder().empty()},disableLeavePrompt:function(){u(window).off("beforeunload"),u(window).unbind("beforeunload"),window.onbeforeunload=function(){}}}}),u("body").addController("EasyBlog.Controller.Composer"),t.resolve()})}),EasyBlog.module("composer/document",function(e){var t=this;EasyBlog.require().script("composer/document/toolbar","composer/document/permalink","composer/document/maps","composer/document/osm","composer/document/cover","composer/vendors/expanding").done(function(c){EasyBlog.Controller("Composer.Document",{hostname:"document",pluginExtendsInstance:!0,elements:["[data-eb-composer-document] .eb-composer-{viewport|viewport-content}","[data-eb-composer-{page|page-viewport|page-header|page-body}]","[data-ebd-{workarea|textarea}]","[data-ebd-workarea-{ghosts}]","[data-ebd-workarea-{legacy}]"],defaultOptions:{"{root}":"[data-ebd-workarea] "+EBD.root,"{block}":EBD.block,"{nest}":EBD.nest,"{titleField}":"[data-post-title]",plugins:["toolbar","permalink","cover"],mapIntegration:"maps"}},function(s,e,t,i,r,l){return{init:function(){l=s.composer,e.mapIntegration="osm"==s.composer.options.mapIntegration?"osm":"maps",s.initPlugins(),s.initTitlebar(),s.isLegacy()?s.initLegacyDocument():s.initEasyBlogDocument()},initPlugins:function(){c.each(e.plugins,function(e,t){s.addPlugin(t)}),s.addPlugin(e.mapIntegration)},initTitlebar:function(){s.titleField().expandingTextarea()},initLegacyDocument:function(){s.trigger("composerDocumentReady")},initEasyBlogDocument:function(){EasyBlog.require().script("composer/vendors/redactor10","composer/document/overlay","composer/vendors/selectionchange").done(function(){i=s.composer.editor=s.workarea().composer({replaceDivs:!1,toolbar:!1}).data("redactor"),r=s.composer.blocks,s.initDocument(),s.setLayout(),s.addPlugin("overlay"),s.initSelectionChange(),s.trigger("composerDocumentReady")})},isLegacy:function(){return"legacy"==l.getDoctype()},initDocument:function(){s.trigger("composerDocumentInit"),s.workarea().removeClass("is-loading")},loadDocument:function(e){s.trigger("composerDocumentLoad"),s.root().html(e),s.initDocument()},"{window} resize":c.throttle(function(){s.setLayout()},250),setLayout:function(){s.updateEditorHeight(),s.trigger("composerDocumentRefresh")},updateEditorHeight:function(){s.page().css("height","auto");var e,t,o=s.viewport().height(),n=s.pageViewport().height(),a=s.pageHeader().height(),i=n-a,r=48,n=60,o=o-50-(n=l.options.mobile?r=0:n)-r-a;window.tinyMCE?tinyMCE.activeEditor&&(n=tinyMCE.activeEditor.editorContainer,c.isString(n)?(r=s.pageBody(),(n=c("#"+n)).find("#content_tbl").css("height","auto"),e=c(tinyMCE.activeEditor.contentAreaContainer).find("iframe"),t=i-(r.height()-e.height()),e.css("height",t),a=c(tinyMCE.activeEditor.getElement()),r=i-r.find(".toggle-editor").height(),a.css("height",r)):(n=c(n).parent(),e=c(n).find("iframe"),t=i-(n.height()-e.height()),e.css("height",t))):s.root().css({minHeight:o})},setTitle:function(e){s.titleField().val(e)},insertContent:function(e){s.isLegacy()?EasyBlog.LegacyEditor.insert(e):(e=c(e)).is(EBD.block)&&r.addBlock(e)},setContent:function(e){if(s.isLegacy())return EasyBlog.LegacyEditor.setContent(e)},getContent:function(){if(s.isLegacy())return EasyBlog.LegacyEditor.getContent();var t="";return r.getRootBlocks().each(function(){var e=c(this);t+=r.getBlockHTML(e)}),t},getText:function(){if(s.isLegacy())return c(s.getContent()).text();var o=[];return r.getRootBlocks().each(function(){var e=c(this),t=r.getBlockType(e);blockHandler=r.getBlockHandler(t),blockHandler.toText&&o.push(c.trim(blockHandler.toText(e)))}),o.join("\n")},initSelectionChange:function(){var a;c.selectionchange.start();var e=c.debounce(function(){if(i){var e=i.selection.get(),t=!1;if(""!=e.toString()){var o=e.focusNode,n=s.block.of(o);if(n.closest(".is-standalone").length)return;if(n.hasClass("active"))for(;o!=n[0];){if(c(o).editable()){t=!0;break}o=o.parentNode}}t?(s.trigger("composerTextSelect",[e,n,i]),a=!1):a||s.trigger("composerTextDeselect",[i])}},300);c(document).on("selectionchange",e)},saveLegacyDocument:function(e){var t=e.data,e=EasyBlog.LegacyEditor.getContent(),e=c.sanitizeHTML(e);c.IE<9&&(e=c.toXHTML(e)),t.intro="",t.content=e},saveEasyBlogDocument:function(e){var t=r.getRootBlocks(),o=[],n=e.add("Saving document"),a={title:e.data.title,permalink:e.data.permalink,type:l.getDoctype(),version:"1.0"};c.when.apply(null,[]).always(function(){t.each(function(){var e=c(this),t=r.exportBlock(e),e=t.style;null!=e&&""!=e&&(e=(e=e.replace(/font-family: \"Comic Sans MS\";/,"font-family: Comic Sans MS;")).replace(/font-family: \"Trebuchet MS\";/,"font-family: Trebuchet MS;"),t.style=e),o.push(t)}),a.blocks=o,e.data.document=JSON.stringify(a)}).done(function(){n.resolve()}).fail(function(){n.reject(c.Exception("Error saving document."))})},"{self} composerSave":function(e,t,o){var n;"legacy"!=l.getDoctype()?(0<(n=r.getCurrentBlock()).length&&r.deactivateBlock(n),s.saveEasyBlogDocument(o)):s.saveLegacyDocument(o)},"{titleField} keydown":function(e,t){if(13==t.keyCode)return t.preventDefault(),s.isLegacy()||0<(t=r.getFirstBlock()).length&&(s.titleField().blur(),r.activateBlock(t)),!1},"{titleField} keyup":function(e,t){s.trigger("composerTitleEditing",[e,e.val()])},"{titleField} change":function(e,t){s.trigger("composerTitleChanged",[e,e.val()])},"{viewport} click":function(e,t){s.isLegacy()||s.workarea().hasClass("is-resizing")||c(t.target).parentsUntil(e).addBack().filter(EBD.block).length||s.trigger("composerDocumentBlur")},"{self} composerValidate":function(e,t,o){}}}),t.resolve()})}),EasyBlog.module("composer/document/cover",function(e){var t=this;EasyBlog.require().library("image","plupload2").done(function(e){EasyBlog.Controller("Composer.Document.Cover",{elements:["[data-eb-composer-blogimage-{browse-button}]",".eb-composer-{field}-blogimage"],defaultOptions:{"{container}":"[data-cover-container]","{placeholder}":"[data-cover-placeholder]","{workarea}":"[data-cover-workarea]","{preview}":"[data-cover-preview]","{previewImage}":"[data-cover-preview-image]","{previewVideo}":"[data-cover-preview-video]","{previewEmpty}":"[data-cover-preview-empty]","{urlForm}":"[data-cover-url-form]","{buttonsWrapper}":"[data-cover-buttons]","{coverMessageArea}":"[data-cover-message-area]","{coverError}":"[data-cover-error]","{coverErrorEmbed}":"[data-cover-error-embed]","{url}":"[data-cover-url]","{urlCancel}":"[data-cover-url-cancel]","{urlAdd}":"[data-cover-url-add]","{browse}":"[data-cover-browse]","{upload}":"[data-cover-upload]","{coverUrlTextbox}":"[data-cover-url-textbox]","{removeButton}":"[data-cover-remove]","{progress}":"[data-eb-mm-upload-progress]","{addCoverButton}":".eb-document-add-cover-button","{title}":"[data-cover-title]","{altText}":"[data-cover-alt]","{caption}":"[data-cover-caption]","{data}":"[data-cover-value]"}},function(r,e,t){return{defaultUri:null,init:function(){var e=r.placeholder();0<e.length&&EasyBlog.MediaManager.uploader.register(e);e=r.data().val();r.defaultUri=e},setImage:function(e,t,o,n,a){var i=EasyBlog.ajax("site/views/composer/setImageCover",{url:e});r.preview().append(i),0<=(t=0<=t.indexOf("flickr:")?"flickr:/"+e:t).indexOf("unsplash:")&&(t="unsplash:/"+e),r.data().val(t),o&&r.title().val(o),a&&r.caption().val(a),n&&r.altText().val(n),r.setHasCover()},setVideoEmbed:function(e,t){var o=EasyBlog.ajax("site/views/composer/setVideoCover",{html:e.html});r.preview().append(o),r.data().val(t),void 0!==e.title&&r.title().val(e.title),r.setHasCover()},setHasCover:function(){r.placeholder().addClass("has-image has-art state-done"),r.coverMessageArea().addClass("t-hidden"),r.coverError().addClass("t-hidden"),r.coverErrorEmbed().addClass("t-hidden"),r.removeButton().removeClass("t-hidden")},setVideo:function(e,t,o){e=EasyBlog.ajax("site/views/composer/setVideoCover",{url:e});r.preview().append(e),r.data().val(t),o&&r.title().val(o),r.setHasCover()},"{container} click":function(e,t){t.stopPropagation()},"{url} click":function(e,t){r.urlForm().removeClass("t-hidden"),r.buttonsWrapper().addClass("t-hidden")},"{urlCancel} click":function(e,t){r.urlForm().addClass("t-hidden"),r.buttonsWrapper().removeClass("t-hidden")},"{urlAdd} click":function(e,t){var o=r.coverUrlTextbox().val();o&&r.crawl(o)},isValidUrl:function(e){return 0<=e.indexOf("youtube.com")||0<=e.indexOf("youtu.be")?"youtube:/"+e:0<=e.indexOf("vimeo.com")?"vimeo:/"+e:0<=e.indexOf("twitch.tv")&&"twitch:/"+e},crawl:function(o){r.remove();var e,n=r.isValidUrl(o);n?((e=r.urlAdd().find("[data-eb-icon]")).loading(),EasyBlog.ajax("site/views/crawler/crawl",{url:o}).done(function(e,t){e=e[o];e.oembed.error?r.coverErrorEmbed().removeClass("t-hidden").html(t):r.setVideoEmbed(e.oembed,n)}).fail(function(e){r.coverErrorEmbed().removeClass("t-hidden").html(e)}).always(function(){e.doneLoading()})):r.coverErrorEmbed().removeClass("t-hidden")},"{browse} mediaSelect":function(e,t,o){r.remove(),"video"==o.meta.type?r.setVideo(o.meta.url,o.meta.uri,o.meta.title):r.setImage(o.meta.url,o.meta.uri,o.meta.title,o.data.alt_text,o.data.caption_text),setTimeout(function(){r.container().parent().addClass("open")},5)},"{placeholder} mediaUploaderFilesAdded":function(e,t,o,n){EasyBlog.MediaManager.uploader.addItem(n[0],e)},"{placeholder} mediaUploaderFileUploaded":function(e,t,o,n,a){r.remove();a=a.response.media.meta;"video"==a.type?r.setVideo(a.url,a.uri,a.title):r.setImage(a.url,a.uri,a.title)},"{placeholder} mediaUploaderFileError":function(e,t,o,n){},"{placeholder} mediaUploaderError":function(e,t,o,n){n=JSON.parse(n.response);e.addClass("is-failed"),r.coverError().removeClass("t-hidden");e=e.find("[data-eb-mm-failed-message]");e.attr("data-original-title",n.message),e.attr("data-eb-provide","tooltip")},"{removeButton} click":function(){r.remove(),EasyBlog.MediaManager.uploader.progressBar().addClass("t-hidden")},"{preview} onUpdateCategoryDefaultCover":function(e,t,o){r.placeholder().hasClass("has-image")||EasyBlog.ajax("site/views/composer/getDefaultPostCover",{catId:o.id}).done(function(e){return e?(r.preview().append(e),void r.coverMessageArea().addClass("t-hidden")):void r.remove()})},remove:function(){r.placeholder().removeClass("has-image is-uploading has-art is-failed"),r.coverMessageArea().removeClass("t-hidden"),r.removeButton().addClass("t-hidden");r.data().val();r.title().val(""),r.data().val(""),r.altText().val(""),r.caption().val(""),r.preview().empty(),r.coverUrlTextbox().val("")}}}),t.resolve()})}),EasyBlog.module("composer/document/maps",function(l){EasyBlog.Controller("Composer.Document.Maps",{elements:["[data-eb-composer-location-{places|autocomplete|form|form-message}]"],defaultOptions:{"{container}":"[data-location-container]",geomode:"native",searchmode:"detect","{detect}":"[data-location-detect]","{remove}":"[data-location-remove]","{preview}":"[data-location-preview]","{map}":"[data-location-map]","{inputContainer}":"[data-location-input-container]","{input}":"[data-location-input]","{address}":"[data-location-address]","{latitude}":"[data-location-latitude]","{longitude}":"[data-location-longitude]","{place}":"[data-eb-composer-location-places] li"}},function(a,i,r,s,t,e){return{init:function(){a.composer=a.document.composer,r=a.container(),i.apikey=a.container().data("google-apikey"),navigator.geolocation||(i.geomode="external"),a.setupAutocomplete()},setupAutocomplete:function(){s=a.autocomplete().detach(),t=s.find(a.places),textfield=a.input(),l(document).on("click",function(e){l(e.target).parents().addBack().filter(textfield).length<1&&s.detach()})},searching:function(e){a.container().toggleClass("is-searching",e);var t=a.input();t.attr("placeholder",e?t.data("placeholder-searching"):t.data("placeholder"))},userCoords:null,getUserCoords:function(){var t=l.Deferred(),e=a.userCoords;return e?(t.resolve(e),t):("native"==i.geomode?navigator.geolocation.getCurrentPosition(function(e){e=e.coords;t.resolve({latitude:e.latitude,longitude:e.longitude})},function(){a.getUserCoordsByIP().done(t.resolve).fail(t.reject)}):t=a.getUserCoordsByIP(),t.done(function(e){a.userCoords=e}))},getUserCoordsByIP:function(){l.getJSON("//www.telize.com/geoip?callback=?").then(function(e){return{latitude:e.latitude,longitude:e.longitude}})},search:function(t){return a.searching(!0),a.getUserCoords().then(function(e){return EasyBlog.ajax("site/views/composer/getLocations",{latitude:e.latitude,longitude:e.longitude,query:t||""})}).fail(function(e){a.container().addClass("has-errors"),a.formMessage().html(e),console.log(e)}).always(function(){a.searching(!1)})},searchManual:l.memoize(function(e){var t=l.Deferred();return a.searching(!0),EasyBlog.ajax("site/views/composer/getLocations",{query:e}).done(function(){t.resolve()}).always(function(){a.searching(!1)})}),populate:function(){var e=a.input(),e=l.trim(e.val());"detect"==a.searchmode?a.search(e).done(l.debounce(function(e){var o=[];l.each(e,function(e,t){t=l.create("li").html("<strong>"+t.name+"</strong><small>"+t.address+"</small>").data("venue",t)[0];o.push(t)}),t.empty().append(o),a.reposition()},50)).fail(function(e){}):""!=e&&a.searchManual(e).done(l.debounce(function(e){var o=[];l.each(e,function(e,t){t=l.create("li").html("<strong>"+t.name+"</strong><small>"+t.address+"</small>").data("venue",t)[0];o.push(t)}),t.empty().append(o),a.reposition()},100)).fail(function(e){})},_populate:l.debounce(function(){a.populate()},350),reposition:function(){var e=a.input();s.appendTo(a.inputContainer()).css({width:e.outerWidth()}).position({my:"left top",at:"left bottom",of:e})},currentLocation:null,setLocation:function(e){a.currentLocation=e,s.detach(),a.preview().addClass("has-location"),a.input().val(e.name),a.latitude().val(e.latitude),a.longitude().val(e.longitude);var t=a.map(),o=e.latitude+","+e.longitude,e=l.param({size:"520x240",sensor:!0,scale:2,zoom:16}),n="//maps.googleapis.com/maps/api/staticmap?"+e+"&center="+o+"&markers="+o;l.isEmpty(i.apikey)||(n="//maps.googleapis.com/maps/api/staticmap?"+e+"&center="+o+"&markers="+o+"&key="+i.apikey),l.Image.get(n).done(function(){t.css("backgroundImage",l.cssUrl(n)),setTimeout(function(){t.addClass("is-ready")},1)}).always(function(){r.removeClass("is-loading")})},removeLocation:function(){a.preview().removeClass("has-location"),a.input().val(""),a.latitude().val(""),a.longitude().val("")},"{window} resize":function(){s.parent().length<1||a.reposition()},"{label} click":function(e){a[a.field().hasClass("active")?"hide":"show"]()},"{input} input":function(){a.searchmode="manual",s.detach(),a._populate()},"{detect} click":function(){a.input().val(""),a.searchmode="detect",s.detach(),a.populate()},"{place} click":function(e){e=e.data("venue");a.setLocation(e)},"{remove} click":function(){a.removeLocation()},"{container} click":function(e,t){t.stopPropagation()}}}),this.resolve()}),EasyBlog.module("composer/document/osm",function(e){EasyBlog.require().library("leaflet").done(function(r){EasyBlog.Controller("Composer.Document.Osm",{elements:["[data-eb-composer-location-{places|autocomplete|form|form-message}]"],defaultOptions:{"{container}":"[data-location-container]",geomode:"native",searchmode:"detect","{detect}":"[data-location-detect]","{remove}":"[data-location-remove]","{preview}":"[data-location-preview]","{map}":"[data-location-map]","{inputContainer}":"[data-location-input-container]","{input}":"[data-location-input]","{address}":"[data-location-address]","{latitude}":"[data-location-latitude]","{longitude}":"[data-location-longitude]","{place}":"[data-eb-composer-location-places] li"}},function(n,o,e,t,a,i){return{init:function(){n.composer=n.document.composer,n.container(),o.apikey=n.container().data("google-apikey"),navigator.geolocation||(o.geomode="external"),n.setupAutocomplete()},initMap:function(){n.osm=L.map("map",{zoom:12}),n.osm.fitWorld(),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:1,maxZoom:19,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(n.osm),n.preview().addClass("has-location")},setupAutocomplete:function(){t=n.autocomplete().detach(),a=t.find(n.places),textfield=n.input(),r(document).on("click",function(e){r(e.target).parents().andSelf().filter(textfield).length<1&&t.detach()})},searching:function(e){n.container().toggleClass("is-searching",e);var t=n.input();t.attr("placeholder",e?t.data("placeholder-searching"):t.data("placeholder"))},userCoords:null,getUserCoords:function(){var t=r.Deferred(),e=n.userCoords;return e?(t.resolve(e),t):("native"==o.geomode?navigator.geolocation.getCurrentPosition(function(e){e=e.coords;t.resolve({latitude:e.latitude,longitude:e.longitude})},function(){n.getUserCoordsByIP().done(t.resolve).fail(t.reject)}):t=n.getUserCoordsByIP(),t.done(function(e){n.userCoords=e}))},getUserCoordsByIP:function(){r.getJSON("//www.telize.com/geoip?callback=?").then(function(e){return{latitude:e.latitude,longitude:e.longitude}})},search:function(t){return n.searching(!0),n.getUserCoords().then(function(e){return EasyBlog.ajax("site/views/composer/getLocations",{latitude:e.latitude,longitude:e.longitude,query:t||""})}).fail(function(e){n.container().addClass("has-errors"),n.formMessage().html(e),console.log(e)}).always(function(){n.searching(!1)})},navigate:function(e,t){t={lat:parseFloat(e),lng:parseFloat(t)};void 0!==n.marker&&n.osm.removeLayer(n.marker),n.osm.flyTo(t,10,{duration:3}),n.marker=L.marker(t).addTo(n.osm)},"{self} composerViewShow":function(e,t,o){"location"==o&&void 0===n.osm&&(n.preview().addClass("has-location"),setTimeout(function(){n.initMap(),latitude=n.latitude().val(),longitude=n.longitude().val(),latitude&&longitude&&n.navigate(latitude,longitude)},250))},"{self} mobileLocationShow":function(e,t){n.preview().addClass("has-location"),setTimeout(function(){n.initMap(),latitude=n.latitude().val(),longitude=n.longitude().val(),latitude&&longitude&&n.navigate(latitude,longitude)},250)},searchManual:r.memoize(function(e){var t=r.Deferred();return n.searching(!0),EasyBlog.ajax("site/views/composer/getLocations",{query:e}).done(function(){t.resolve()}).always(function(){n.searching(!1)})}),populate:function(){var e=n.input(),e=r.trim(e.val());"detect"==n.searchmode?n.search(e).done(r.debounce(function(e){var o=[];r.each(e,function(e,t){t=r.create("li").html("<strong>"+t.name+"</strong><small></small>").data("venue",t)[0];o.push(t)}),a.empty().append(o),n.reposition()},50)).fail(function(e){}):""!=e&&n.searchManual(e).done(r.debounce(function(e){var o=[];r.each(e,function(e,t){t=r.create("li").html("<strong>"+t.name+"</strong><small></small>").data("venue",t)[0];o.push(t)}),a.empty().append(o),n.reposition()},100)).fail(function(e){})},_populate:r.debounce(function(){n.populate()},350),reposition:function(){var e=n.input();t.appendTo(n.inputContainer()).css({width:e.outerWidth()}).position({my:"left top",at:"left bottom",of:e})},currentLocation:null,setLocation:function(e){n.currentLocation=e,t.detach(),n.input().val(e.name),n.latitude().val(e.latitude),n.longitude().val(e.longitude),n.navigate(e.latitude,e.longitude)},removeLocation:function(){n.input().val(""),n.latitude().val(""),n.longitude().val(""),n.osm.removeLayer(n.marker),n.osm.fitWorld()},"{window} resize":function(){t.parent().length<1||n.reposition()},"{label} click":function(e){n[n.field().hasClass("active")?"hide":"show"]()},"{input} input":function(){n.searchmode="manual",t.detach(),n._populate()},"{detect} click":function(){n.input().val(""),n.searchmode="detect",t.detach(),n.populate()},"{place} click":function(e){void 0===n.osm&&n.initMap();e=e.data("venue");n.setLocation(e)},"{remove} click":function(){void 0!==n.marker&&n.removeLocation()},"{container} click":function(e,t){t.stopPropagation()}}})}),this.resolve()}),EasyBlog.module("composer/document/overlay",function(i){EasyBlog.Controller("Composer.Document.Overlay",{defaultOptions:i.extend({"{overlay}":"[data-ebd-overlay]","{placeholder}":"[data-ebd-overlay-placeholder]","{sortable}":".ui-sortable","{placeholderInsideSortHelper}":".ebd-block.is-helper .ebd-overlay-placeholder"},EBD.selectors)},function(n,e,t,a){return{id:1,init:function(){composer=n.document.composer,a=composer.blocks,n.DocumentOverlay=function(e){this.id=n.id++,this.uid=e.data("uid"),this.type=e.data("type"),this._element=i("<div>",{class:"ebd-overlay","data-id":this.id,"data-type":this.type,"data-ebd-overlay":""})[0],this._placeholder=i("<div>",{class:"ebd-overlay-placeholder","data-id":this.id,"data-ebd-overlay-placeholder":""})[0]},i.extend(n.DocumentOverlay.prototype,{block:function(){return a.getBlock(this.uid)},element:function(){return i(this._element)},placeholder:function(){return i(this._placeholder)},attach:function(){this.element().appendTo(n.document.workarea()),this.reposition()},refresh:function(){this.element().hasClass("is-animating")||this.reposition()},reposition:function(){var e=this.element(),t=e.hasClass("is-sorting")?i(n.placeholderInsideSortHelper().where("id",this.id)[0]||this._placeholder):this.placeholder();e.css({width:t.width(),height:t.height()}).position({my:"left top",at:"left top",of:t})},emerge:function(){this.element().addClass("hover"),this.block().addClass("hover")},submerge:function(){this.element().removeClass("hover"),this.block().removeClass("hover")},remove:function(){n.remove(this.id)}});var e=i.throttle(function(){n.refresh()},25,{leading:!0,trailing:!0}),t=i.ns("keydown keypress keyup input mousedown click mousemove mouseup touchstart touchmove touchend",".overlay"),o=i.ns("sortactivate sortchange sortover sortout sortdeactivate sortstop",".overlay");composer.document.root().on(t,e),composer.views().on("scrolly.overlay",e),n.element.on(o,n.sortable.selector,e)},blocks:{},instances:[],keys:{},get:function(e){return n.keys[e]},getInstancesByBlock:function(e){e=a.getBlockUid(e);return n.blocks[e]||[]},create:function(e){var t=new n.DocumentOverlay(e);n.instances.push(t),n.keys[t.id]=t;e=n.blocks;return(e[t.uid]||(e[t.uid]=[])).push(t),t},remove:function(e){var t=n.get(e);t.element().remove(),t.placeholder().remove(),i.pull(n.blocks[e],t),delete n.keys[e],i.pull(n.instances,t)},of:function(e){return n.blocks[e.data("uid")]||[]},refresh:function(e){e=e?n.of(e):n.instances;i.each(e,function(e,t){t.refresh()})},"{self} composerBlockDrag":function(e,t,o){setTimeout(function(){n.refresh()},1),i.each(n.of(o),function(e,t){t.element().addClass("is-sorting")})},"{dropzone} dropover":function(e,t,o){setTimeout(function(){n.refresh()},1)},"{block} drag":function(e,t,o){n.refresh(e)},drop:function(e){i.each(n.of(e),function(e,t){t.element().removeClass("is-sorting").addClass("is-dropping")}),n.refresh()},"{self} composerBlockDrop":function(e,t,o){n.drop(o)},"{self} composerBlockAdd":function(e,t,o){n.drop(o)},"{self} composerBlockBeforeRelease":function(e,t,o){i.each(n.of(o),function(e,t){t.element().removeClass("is-dropping").addClass("is-releasing is-animating").removeClassAfter("is-releasing")}),n.refresh(),setTimeout(function(){n.refresh()},50)},"{self} composerBlockRelease":function(e,t,o){i.each(n.of(o),function(e,t){t.element().removeClass("is-animating")}),n.refresh()},"{self} composerDocumentRefresh":function(){n.refresh()},"{self} composerBlockRemove":function(e,t,o){o=n.getInstancesByBlock(o);i.each(o,function(e,t){t.remove()})},"{placeholder} click":function(e){e=e.data("id");n.get(e).emerge()},"{placeholder} mouseover":function(e){e=e.data("id"),e=n.get(e);e.block().hasClass("active")&&e.emerge()},"{overlay} mouseout":function(e){e=e.data("id");n.get(e).submerge()}}}),this.resolve()}),EasyBlog.module("composer/document/permalink",function(e){EasyBlog.Controller("Composer.Document.Permalink",{defaultOptions:{"{wrapper}":"[data-eb-editor-permalink]","{preview}":"[data-permalink-preview]","{input}":"[data-permalink-input]","{emptyView}":"[data-permalink-empty]","{formView}":"[data-permalink-form]","{edit}":"[data-permalink-edit]","{cancel}":"[data-permalink-cancel]","{update}":"[data-permalink-update]"}},function(a,i,e,t){return{init:function(){t=a.document.composer,i.permalink=a.input().val()},form:{show:function(){a.wrapper().addClass("is-editing")},hide:function(){a.wrapper().removeClass("is-editing")}},normalize:function(){var e=a.input().val();EasyBlog.ajax("site/views/composer/normalizePermalink",{permalink:e,postId:t.getPostId()}).done(function(e,t){a.input().val(e),a.preview().html(t),i.permalink=e})},"{input} keyup":function(e,t){var o=t.keyCode||t.which;return 27==o?(a.cancel().click(),!1):13==o?(t.stopPropagation(),t.preventDefault(),a.update().click(),!1):void 0},"{edit} click":function(e,t){a.form.show()},"{cancel} click":function(e,t){a.input().val(i.permalink),a.form.hide()},"{update} click":function(e,t){a.normalize(),a.wrapper().removeClass("is-editing")},"{self} composerTitleChanged":function(e,t,o,n){if(""!=i.permalink)return!1;a.input().val(n),a.normalize(),a.wrapper().removeClass("is-empty")}}}),this.resolve()}),EasyBlog.module("composer/document/toolbar",function(a){EasyBlog.Controller("Composer.Document.Toolbar",{defaultOptions:{"{media}":"[data-eb-composer-media]","{embedVideo}":"[data-eb-composer-embed-video]","{button}":"[data-toolbar-view]","{closeDropdown}":"[data-toolbar-dropdown-close]","{actionsWrapper}":"[data-composer-toolbar-actions]","{actionButton}":"[data-composer-action-button]","{postsButton}":"[data-eb-composer-insert-post]","{revisionsButton}":"[data-composer-toolbar-revisions]","{coverButton}":"[data-composer-toolbar-cover]","{locationButton}":"[data-composer-toolbar-location]","{googleimportButton}":"[data-composer-toolbar-googleimport]","{toggleSidebarButton}":"[data-eb-composer-toggle-sidebar]","{appearanceWrapper}":"[data-composer-appearance]","{appearanceInput}":"[data-composer-appearance-input]","{blocks}":"[data-toolbar-blocks]"}},function(n,e,t,o){return{init:function(){o=n.document.composer},actions:{hide:function(){n.actionsWrapper().removeClass("open")},show:function(){n.actionsWrapper().addClass("open")},toggle:function(){n.actionsWrapper().toggleClass("open")}},appearance:{change:function(e){window.ezb.appearance=e,n.appearance.save(e),n.appearanceWrapper().switchClass("is-"+e),o.frame().switchClass("si-theme--"+e),a(document.documentElement).switchClass("si-theme--"+e)},save:function(e){EasyBlog.ajax("site/views/composer/saveComposerAppearance",{appearance:e})}},posts:{getParent:function(){return n.postsButton().parent("[data-type=posts]")},hide:function(){n.posts.getParent().removeClass("open"),n.postsButton().removeClass("is-active")},show:function(){o.views.hideAll(),o.views.show("posts"),n.posts.getParent().addClass("open"),n.postsButton().addClass("is-active")},toggle:function(){if(!0!==n.giDialog)return n.posts.getParent().hasClass("open")?n.posts.hide():n.posts.show()}},revisions:{getParent:function(){return n.revisionsButton().parent("[data-type=revisions]")},hide:function(){n.revisions.getParent().removeClass("open")},show:function(){o.views.hideAll(),n.revisions.getParent().addClass("open")},toggle:function(){if(!0!==n.giDialog)return n.revisions.getParent().hasClass("open")?n.revisions.hide():n.revisions.show()}},location:{getParent:function(){return n.locationButton().parent("[data-type=location]")},hide:function(){n.location.getParent().removeClass("open"),n.locationButton().removeClass("is-active")},show:function(){o.views.hideAll(),n.location.getParent().addClass("open"),n.locationButton().addClass("is-active")},toggle:function(){if(!0!==n.giDialog)return n.location.getParent().hasClass("open")?n.location.hide():n.location.show()}},googleimport:{getParent:function(){return n.googleimportButton().parent("[data-type=googleimport]")},hide:function(){var e;n.giDialog=!1,n.googleimportButton().length<=0||(n.googleimportButton().removeClass("is-active"),void 0!==(e=o.googleimport)&&e.closePopup())},show:function(){var e;o.views.hideAll(),n.googleimportButton().length<=0||(n.googleimportButton().addClass("is-active"),void 0!==(e=o.googleimport)&&(n.giDialog=!0,o.autosave.stop(),e.initGimport(),e.initOauthPopUp()))},toggle:function(){return n.googleimportButton().hasClass("is-active")?n.googleimport.hide():n.googleimport.show()}},cover:{getParent:function(){return n.coverButton().parent("[data-type=cover]")},hide:function(){n.cover.getParent().removeClass("open"),n.coverButton().removeClass("is-active")},show:function(){o.views.hideAll(),n.cover.getParent().addClass("open"),n.coverButton().addClass("is-active")},toggle:function(){if(!0!==n.giDialog)return n.cover.getParent().hasClass("open")?n.cover.hide():n.cover.show()}},activate:function(){},deactivate:function(){},isActive:function(){},hideBlocks:function(){n.blocks().parent().removeClass("open")},toggleSidebar:function(){var e=o.manager(),t=n.toggleSidebarButton();e.toggleClass("is-sidebar-open"),e.hasClass("is-sidebar-open")?t.addClass("is-active"):t.removeClass("is-active")},"{revisionsButton} click":function(){n.revisions.toggle()},"{locationButton} click":function(){n.location.toggle()},"{googleimportButton} click":function(){n.googleimport.toggle()},"{postsButton} click":function(e,t){n.posts.toggle()},"{coverButton} click":function(){n.cover.toggle()},"{actionButton} click":function(){n.actions.toggle()},"{self} composerSave":function(e,t,o){n.googleimportButton().remove()},"{self} composerViewHideAll":function(){n.cover.hide(),n.location.hide(),n.revisions.hide(),n.posts.hide(),n.actions.hide()},"{self} click":function(e,t){0<a(t.target).parents("[data-toolbar-view]").length||o.views.hideAll()},"{toggleSidebarButton} click":function(){n.toggleSidebar()},"{media} click":function(e,t){n.hideBlocks(),EasyBlog.MediaManager.open(e.data("uri"))},"{closeDropdown} click":function(e,t){t.stopPropagation();t=e.parents(n.button.selector),e=t.data("type");t.removeClass("open"),o.views.hide(e)},"{blocks} click":function(e,t){o.blocks.browser.isOpen()?e.removeClass("is-active"):e.addClass("is-active"),o.blocks.browser.toggle()},"{button} click":function(e,t){n.hideBlocks(),n.deactivate();e=e.data("type");o.views.show(e)},"{embedVideo} click":function(){EasyBlog.dialog({content:EasyBlog.ajax("site/views/composer/embedVideoDialog"),bindings:{"{insertButton} click":function(){var e,t,o,n=this.videoUrl().val();n&&(e=this.videoWidth().val(),t=this.videoHeight().val(),o=this.noCookie().val(),"same"==this.relatedSource().val()&&(n+="?rel=0"),EasyBlog.LegacyEditor.insert('[embed=videolink]{"video":"'+n+'","width":"'+e+'","height":"'+t+'","nocookie":"'+o+'"}[/embed]'),EasyBlog.dialog().close(),this.videoUrl().val(""))}}})},"{showDrawerButton} click":function(){a("[data-eb-composer-frame]").toggleClass("show-drawer")},"{appearanceInput} change":function(e){e=e.is(":checked")?"dark":"light";n.appearance.change(e)}}}),this.resolve()}),EasyBlog.module("composer/googleimport",function(s){EasyBlog.Controller("Composer.Googleimport",{defaultOptions:{retrieveMsg:"",importingMsg:"",selectfileMsg:"",authenMsg:"","{container}":"[data-eb-googleimport]","{gIframe}":"[data-eb-googleimport-iframe]","{content}":"[data-eb-googleimport-content]","{contentContainer}":"[data-eb-googleimport-container]","{mainMessage}":"[data-eb-googleimport-message]","{userInfoWrapper}":"[data-eb-googleimport-userinfo-wrapper]","{userInfoLoader}":"[data-eb-googleimport-userinfo-loader]","{userInfo}":"[data-eb-googleimport-userinfo]","{revokeBtn}":"[data-eb-googleimport-revoke]","{closeBtn}":"[data-eb-googleimport-close-popup]"}},function(i,r,e,o){return{init:function(){o=i.composer;var e=i.container().data("islegacy"),t=i.container().hasClass("t-hidden"),a=i.container().data("postid");0<i.container().length&&(r.retrieveMsg=i.container().data("retrieve-msg"),r.importingMsg=i.container().data("importing-msg"),r.selectfileMsg=i.container().data("selectfile-msg"),r.authenMsg=i.container().data("authentication-msg"),e||t||i.initOauthPopUp()),window.doneLogin=function(){i.mainMessage().html(r.retrieveMsg),i.initUserInfo(),i.initFileList()},window.selectGoogleFile=function(e,t,o,n){!0!==i.importing&&(i.importing=!0,i.mainMessage().html(r.importingMsg),EasyBlog.ajax("site/controllers/googleimport/import",{id:e,title:t,postId:a,importStyle:o}).done(function(e){window.location=e}).fail(function(e){n.trigger("composerGoogleImportFail"),EasyBlog.dialog({width:450,content:e})}).always(function(){i.importing=!1}))}},initGimport:function(){s("[data-eb-googleimport]").removeClass("t-hidden"),o.manager().addClass("show-googleimport")},initOauthPopUp:function(){i.mainMessage().html(r.authenMsg),i.contentContainer().addClass("is-loading");var e=i.container().data("url"),t=screen.width/2-300,o=screen.height/2-250;window.open(e,"","width=600,height=500,left="+t+",top="+o)},initUserInfo:function(){EasyBlog.ajax("site/controllers/googleimport/getUserInfo",{}).done(function(e){i.userInfo().html(e)}).fail(function(){i.userInfo().html("")}).always(function(){i.userInfoLoader().addClass("t-hidden")})},initFileList:function(){i.contentContainer().addClass("is-loading");var e=i.container().data("return");i.gIframe().removeClass("t-hidden"),i.gIframe().bind("load",function(){i.contentContainer().removeClass("is-loading"),i.mainMessage().html(r.selectfileMsg)}),i.gIframe().attr("src",e)},closePopup:function(){i.gIframe().attr("src","about:blank"),i.userInfo().html(""),i.userInfoLoader().removeClass("t-hidden"),o.manager().removeClass("show-googleimport"),s("[data-eb-googleimport]").addClass("t-hidden"),1<=s("div.eb-composer-templates.eb-composer-templates--template").length&&o.manager().addClass("show-templates")},"{closeBtn} click":function(e){!0!==i.importing&&(0<s('[data-toolbar-view][data-type="googleimport"]').length&&i.composer.document.toolbar.googleimport.toggle(),i.closePopup())},"{revokeBtn} click":function(e){!0!==i.importing&&EasyBlog.dialog({content:EasyBlog.ajax("site/controllers/googleimport/confirmRevoke",{}),bindings:{"{closeButton} click":function(){this.parent.close()},"{submitButton} click":function(){this.parent.close(),EasyBlog.ajax("site/controllers/googleimport/revoke",{}).done(function(e){1==e&&(i.gIframe().attr("src","about:blank"),i.contentContainer().removeClass("is-loading"),i.userInfo().html(""),i.userInfoLoader().removeClass("t-hidden"),i.initOauthPopUp())}).fail(function(e){EasyBlog.dialog({content:e})}).always(function(){})}}})}}}),EasyBlog.Controller("Composer.Googleimport.List",{defaultOptions:{"{searchContainer}":"[data-eb-googleimport-list-search]","{contentContainer}":"[data-eb-googleimport-list-contents]","{itemsContainer}":"[data-eb-googleimport-list-items]","{msgBar}":"[data-eb-googleimport-sub-message]","{listEmptyMsg}":"[data-eb-googleimport-list-emptymsg]","{item}":"[data-eb-googleimport-list-item]","{searchBtn}":"[data-eb-googleimport-search-button]","{searchInput}":"[data-eb-googleimport-search-input]","{pagination}":"[data-eb-googleimport-pagination]","{loadmoreBtn}":"[data-eb-googleimport-loadmore]","{pageTokenInput}":"[data-eb-googleimport-token-input]","{searchForm}":"[data-eb-googleimport-search-form]"}},function(a,e,t){return{init:function(){a.element.closest("body").css({overflow:"hidden",padding:"0px"}),a.element.closest("html").addClass("is-eb-content")},"{self} composerGoogleImportFail":function(e,t){a.toggleImportProcess(!1)},toggleSearch:function(e){!0===e&&a.searchContainer().removeClass("t-hidden"),!1===e&&a.searchContainer().addClass("t-hidden")},toggleListing:function(e){!0===e&&(a.itemsContainer().removeClass("t-hidden"),a.pagination().removeClass("t-hidden")),!1===e&&(a.itemsContainer().addClass("t-hidden"),a.pagination().addClass("t-hidden"))},toggleContents:function(e){!0===e&&a.contentContainer().removeClass("t-hidden"),!1===e&&a.contentContainer().addClass("t-hidden")},toggleImportProcess:function(e){e?(a.element.addClass("is-loading"),a.msgBar().removeClass("t-hidden"),a.toggleListing(!1),a.toggleContents(!1),a.toggleSearch(!1)):(a.element.removeClass("is-loading"),a.msgBar().addClass("t-hidden"),a.toggleListing(!0),a.toggleContents(!0),a.toggleSearch(!0))},"{loadmoreBtn} click":function(e,t){var o=s(e),e=o.data("token");!0!==a.loadmore&&(a.loadmore=!0,e&&(o.addClass("is-loading"),EasyBlog.ajax("site/controllers/googleimport/loadmore",{search:a.searchInput().val(),nextPageToken:e}).done(function(e,t){t||o.addClass("t-hidden"),o.data("token",t),a.itemsContainer().append(e)}).always(function(){a.loadmore=!1,o.removeClass("is-loading")})))},"{searchBtn} click":function(e,t){var o;!0!==a.loadmore&&!0!==a.searching&&(a.searching=!0,a.toggleListing(!1),a.contentContainer().addClass("is-loading"),a.contentContainer().removeClass("is-empty"),o=a.searchForm().serializeObject(),EasyBlog.ajax("site/controllers/googleimport/search",o).done(function(e,t,o){a.loadmoreBtn().removeClass("t-hidden"),t||a.loadmoreBtn().addClass("t-hidden"),a.loadmoreBtn().data("token",t),a.itemsContainer().html(e),o&&(a.contentContainer().addClass("is-empty"),a.listEmptyMsg().html(o))}).always(function(){a.searching=!1,a.toggleListing(!0),a.contentContainer().removeClass("is-loading")}))},"{searchInput} keyup":s.debounce(function(e,t){var o=a.searchInput().val();3<=(o=s.trim(o)).length&&a.searchBtn().click()},500),"{item} click":function(e,t){var o,n;!0!==a.loadmore&&(e=s(e),o=e.data("id"),n=e.data("title"),EasyBlog.dialog({content:EasyBlog.ajax("site/controllers/googleimport/confirmImportStyle",{}),bindings:{"{closeButton} click":function(){this.parent.close()},"{submitButton} click":function(){var e="inline";this.radioPlain().is(":checked")&&(e="plain"),this.parent.close(),a.toggleImportProcess(!0),parent.window.selectGoogleFile(o,n,e,a)}}}))}}}),this.resolve()}),EasyBlog.module("composer/layout/elements",function(i){i(document).on("keyup","[data-date-form] [data-date-day]",function(){var e,t,o,n;i.trim(i(this).val())&&(n=parseInt(i(this).siblings("[data-date-year]").val()||i(this).siblings("[data-date-year]").data("dateDefault")),e=parseInt(i(this).siblings("[data-date-month]").val()||i(this).siblings("[data-date-month]").data("dateDefault")),t=parseInt(i(this).val()||i(this).data("dateDefault")),o=/1|3|5|7|8|10|12/.test(e)?31:30,(o=2==e?(n=n)%400&&(!(n%100)||n%4)?28:29:o)<(t=t<1?1:t)&&(t=o),i.isNumeric(t)?i(this).val(t):i(this).val(""))}),i(document).on("keyup","[data-date-form] [data-date-year]",function(){var e;i.trim(i(this).val())&&(e=parseInt(i(this).val()),i.isNumeric(e=e<1?1:e)?i(this).val(e):i(this).val(""))}),i.fn.listbox=function(o){if(i.isPlainObject(o)||void 0===o)return this.each(function(){var e=i(this),t=r.get(e);if(t)return t.update(o),this;new r(e,o)}),this;if(i.isString(o)){var e,t=i(this[0]),n=r.get(t)||new r(t),t=n[o];return(e=i.isFunction(t)?t.apply(n,i.makeArray(arguments).slice(1)):e)||this}return this},i.fn.listboxitem=function(e){if(void 0===e)return this.each(function(){var e=i(this);r.Item.init(e)}),this;if(i.isString(e)){var t=i(this[0]);r.Item.init(t);var o,n=t.data("listboxitem"),t=n[e];return(o=i.isFunction(t)?t.apply(n,i.makeArray(arguments).slice(1)):o)||this}return this};var r=function(n,e,t){var a={};this.container=n,this.options={},n.data("listbox",this),i.each(r.defaultOptions,function(e,t){var o=n.attr("data-listbox-"+e);void 0!==o&&(a[e]=isNaN(parseInt(o))?o:parseInt(o))}),t&&this.extend(t),this.update(i.extend(!0,{},r.defaultOptions,a,e)),this.init()};r.defaultOptions={toggleDefault:!0,sortable:!0,allowAdd:!0,allowRemove:!0,allowInput:!1,editable:!0,max:0,min:1,customHTML:"",itemTitle:"Title"},r.get=function(e){e=i(e).data("listbox");if(e instanceof r)return e},i.extend(r.prototype,{addButton:function(){return this.container.find("[data-listbox-button-add]")},update:function(e){i.extend(!0,this.options,e)},extend:function(e){i.each(e,function(e,t){i.isFunction(t)&&(r.prototype[e]=t)})},getItems:function(e){var t=this.container.find("[data-listbox-item]");return e&&(t=t.filter(e)),r.Item.init(t),t},getParentItem:function(e){e=i(e).closest("[data-listbox-item]");return r.Item.init(e),e},init:function(){var e=this,t=e.container,o=t.find("[data-listbox-custom-html]");e.options.customHTML=o.html(),o.remove(),e.options.toggleDefault&&t.on("click.listbox.toggleDefault","[data-listbox-button-default]",function(){return e.toggleDefault(this)}),e.options.allowAdd&&t.on("click.listbox.addItem","[data-listbox-button-add]",function(){return e.add(this)}),e.options.allowRemove&&t.on("click.listbox.removeItem","[data-listbox-button-remove]",function(){return e.remove(this)}),e.options.sortable&&this.initSortable(),e.options.customHTML||this.getItems().find("[data-listbox-item-content]").editable(!0)},initSortable:function(){},toggleDefault:function(e){var t=this.getItems(),e=this.getParentItem(e);0!=e.length&&(this.container.trigger("listboxBeforeToggleDefault",[e]),e&&(t.removeClass("is-default"),e.addClass("is-default"),this.container.trigger("listboxAfterToggleDefault",[e])))},isDefault:function(e){return e.hasClass("is-default")},add:function(){var e=this.getItems();0<this.options.max&&e.length>=this.options.max||(e=r.Item.newItem(this.options),this.container.trigger("listboxBeforeAddItem",[e]),e&&(this.addButton().closest("[data-listbox-button-add-wrapper]").before(e),this.container.trigger("listboxAfterAddItem",[e]),0==this.getItems(".is-default").length&&this.toggleDefault(this.getItems(":first"))))},remove:function(e){var t=this.getItems();0<this.options.min&&t.length<=this.options.min||(e=this.getParentItem(e),this.container.trigger("listboxBeforeRemoveItem",[e]),e&&(e.remove(),this.container.trigger("listboxAfterRemoveItem",[e]),this.isDefault(e)&&this.toggleDefault(this.getItems(":first"))))},populate:function(e,n){var a=this;a.getItems().remove(),i.each(e,function(e,t){var o=r.Item.newItem(a.options);i.isFunction(n)&&n(o,t.content,t.id),t.default&&o.addClass("is-default"),a.container.trigger("listboxBeforePopulateItem",[t]),a.addButton().closest("[data-listbox-button-add-wrapper]").before(o),a.container.trigger("listboxAfterPopulateItem",[t])})},toData:function(){var o=[];return i.each(this.getItems(),function(e,t){o.push(i(t).listboxitem("toData"))}),o}}),r.Item=function(e){this.item=e,this.parent=e.parents("[data-listbox]").data("listbox")},r.Item.get=function(e){e=i(e).data("listboxitem");if(e instanceof r.Item)return e},r.Item.init=function(e){return e=i(e),i.each(e,function(e,t){t=i(t),r.Item.get(t)||t.data("listboxitem",new r.Item(t))}),e},r.Item.newItem=function(e){var t=i("<div></div>",{"data-listbox-item":"",class:"eb-composer-manage-tab row-table"}),o=i("<div></div>",{class:"col-cell eb-composer-manage-tab-handler"});e.sortable&&o.append('<i class="fdi fa fa-bars"></i>'),e.toggleDefault&&o.append(' <i class="fdi fa fa-star" data-listbox-button-default></i>'),t.append(o);o=i("<div></div>",{"data-listbox-item-content":"",class:"col-cell eb-composer-manage-tab-name"}).html(e.customHTML?i.buildHTML(e.customHTML):e.itemTitle);return e.allowInput&&o.html('<input type="text" class="eb-composer-manage-tab-name-input" placeholder="'+e.placeholder+'">'),e.editable&&(e.customHTML||o.editable(!0)),t.append(o),e.allowRemove&&t.append(i("<div></div>",{"data-listbox-button-remove":"",class:"col-cell eb-composer-manage-tab-remove"}).html("&times;")),r.Item.init(t),t},i.extend(r.Item.prototype,{isDefault:function(){return this.item.hasClass("is-default")},inputContent:function(e,t){var o=this.item.find("[data-listbox-item-content]");if(t&&this.item.attr("data-id",t),e)return o.find("input").val(e)},content:function(e){var t=this.item.find("[data-listbox-item-content]");return void 0!==e?(t.html(e),this):t.html()},getContent:function(){var e=this.item.find("[data-listbox-item-content]");return 0<e.find("input").length?e.find("input").val():e.html()},getId:function(){var e=this.item.data("id");return e||""},remove:function(){this.parent.remove(this.item)},setDefault:function(){this.parent.toggleDefault(this.item)},toData:function(){return{id:this.getId(),default:this.isDefault()?1:0,content:this.getContent()}}}),EasyBlog.UI=function(e){e=e.document;i(e).on("click.ebtabs",".eb-tabs-menu-item",function(){var e=i(this),t=e.closest(".eb-tabs"),o=t.find("> .eb-tabs-menu").find("> .eb-tabs-menu-item"),n=t.find("> .eb-tabs-content").find("> .eb-tabs-content-item");"toggle"==t.data("eb-tabs-mode")&&e.hasClass("active")?(o.removeClass("active"),n.removeClass("active")):(o.removeClass("active"),e.addClass("active"),n.removeClass("active").where("id",e.data("id")).addClass("active")),t[0<n.filter(".active").length?"addClassAfter":"removeClassAfter"]("is-open",1)})},EasyBlog.UI(window),this.resolve()}),EasyBlog.module("composer/media",function(e){var t=this;EasyBlog.require().library("plupload2","ui/draggable").script("composer/media/uploader","composer/media/editor","composer/vendors/dragselect","composer/vendors/cropper").done(function(d){var e=EasyBlog.Controller("MediaManager",{hostname:"mediaManager",pluginExtendsInstance:!0,elements:["[data-eb-mm-{folder-upload-current-file|folder-upload-stat|folder-upload-completed|folder-upload-total|folder-upload-progress-bar}]","[data-eb-mm-{pagination-previous|pagination-next|pagination-current|pagination-total}]"],defaultOptions:{types:{image:["jpg","jpeg","png","gif","webp","jfif"],video:["3gp","m4v","mp4","flv","wmv","mp3","webm","swf","mov"],imagevideo:["jpg","jpeg","png","gif","jfif","webp","3gp","m4v","mp4","flv","wmv","webm","swf","mov"],audio:["mp3","m4a","aac","ogg"],pdf:["pdf"]},templates:{},selections:{},"{frame}":"[data-mm-frame]","{body}":"[data-mm-body]","{place}":"[data-mm-place]","{browseButton}":"[data-eb-mm-browse-button]","{actions}":"[data-mm-actions]","{layout}":"[data-mm-layout]","{close}":"[data-mm-close]","{insert}":"[data-mm-insert]","{insertGallery}":"[data-mm-insert-gallery]","{loadMore}":"[data-mm-item-loadmore]","{delete}":"[data-mm-delete]","{insertPermalink}":"[data-mm-insert-permalink]","{panel}":"[data-mm-info-panel]","{infoPermalink}":"[data-mm-info-permalink]","{infoTitle}":"[data-mm-info-title]","{infoPreview}":"[data-mm-info-preview]","{form}":"[data-mm-form]","{formInput}":"[data-mm-form] [data-mm-panel-input]","{captionInput}":"[data-mm-form] [data-mm-panel-input]#caption_text","{imageSource}":"[data-mm-form] [data-mm-panel-input]#mm-preview-size","{infoPanel}":"[data-mm-info-panel-wrapper]","{infoPanelLoader}":"[data-mm-info-panel-loading]","{panelState}":"[data-mm-info-state]","{inputSearch}":"[data-mm-search]","{folderTitle}":"[data-mm-folder-title]","{breadcrumbs}":"[data-mm-breadcrumbs]","{breadcrumbBack}":"[data-mm-breadcrumb-back]","{breadcrumb}":"[data-mm-breadcrumb-item]","{breadcrumbSearch}":"[data-mm-breadcrumb-search]","{group}":"[data-group]","{groupList}":"[data-group-list]","{listing}":"[data-mm-listing]","{item}":"[data-mm-item]","{folder}":"[data-mm-folder]","{checkbox}":"[data-mm-item-checkbox]","{checkboxInput}":"[data-mm-item-checkbox-input]","{screens}":"[data-mm-screens]","{selectionCounter}":"[data-mm-selection-counter]","{selectionList}":"[data-mm-selection-list]","{selectionItem}":"[data-selection-wrapper]","{clearSelections}":"[data-mm-clear-selections]","{footer}":"[data-mm-footer]","{dropzoneWrapper}":"[data-dragzone-wrapper]","{dropzone}":"[data-mm-dropzone]","{uploadTemplate}":"[data-eb-mm-upload-template]","{uploadThumbnail}":"[data-eb-mm-upload-thumbnail]","{thumbnail}":"[data-eb-mm-file].type-image i[data-thumbnail]","{flickrButton}":"[data-flickr-login]","{createFolder}":"[data-mm-create-folder]","{selectionTemplate}":"[data-mm-selection-template]","{mobileClosePlaces}":"[data-mm-mobile-close-places]","{mobileOpenPlaces}":"[data-mm-mobile-open-places]","{mobileOpenPanel}":"[data-mm-mobile-panel-open]","{mobileHidePanel}":"[data-mm-mobile-panel-hide]","{errorMessage}":"[data-mm-error-message]"}},function(l,s,t,c,n,e){return{init:function(){l.disableDraggableItems(),s.templates.upload=l.uploadTemplate().detach().html(),s.templates.selection=l.selectionTemplate().detach().html(),n=s.templates,d.each(s.types,function(e,t){for(var o=0;t[o++];)l.types.file=e}),l.addPlugin("uploader"),l.addPlugin("editor");var e=(EasyBlog.MediaManager=l).frame(),t=e.data("uri");e.attr("data-key",t),l.requirementsMessages={width:e.data("requirements-width"),height:e.data("requirements-height")},1==e.data("acl-upload")&&l.uploader.register(e),s.mobile=1==e.data("mobile"),l.editor},bodyPerfectScrollbar:null,panelPerfectScrollbar:null,drag:{ds:null,running:!1,init:function(){if(!window.eb.mobile)return l.drag.ds?(l.drag.ds.start(),void l.drag.ds.setSelectables(document.getElementsByClassName("eb-nmm-content-listing__item"))):void(l.drag.ds=new DragSelect({selectables:document.getElementsByClassName("eb-nmm-content-listing__item"),area:d("[data-mm-body]")[0],multiSelectMode:!1,callback:function(e,t){var o,n=d(t.target);if(!(void 0!==n.data("mm-item-checkbox"))){if(void 0!==n.data("mm-mobile-panel-open"))return t.stopPropagation(),void n.click();if(l.clearSelections().click(),!(e.length<=0)){if("select"==l.mode&&!l.canSelectMultiple()){e=e[e.length-1],n=d(e);if(void 0!==n.data("mm-folder"))return;l.selectItem(n)}"select"==l.mode&&!l.canSelectMultiple()||(o=0,d(e).each(function(){void 0===d(this).data("mm-folder")&&o++}),d(e).each(function(){var e=d(this);void 0===e.data("mm-folder")&&l.selectItem(e,1<o)}))}}}}))},stop:function(){!window.eb.mobile&&l.drag.ds&&l.drag.ds.stop()}},disableDraggableItems:function(){l.find("[data-mm-disabledrag]").on("dragstart drop",function(e){return event.preventDefault(),!1})},open:function(e,t){"post"==e&&(e=l.getCurrentPostUri());var o=l.frame();o.removeClass("t-hidden show-local"),t&&(l.currentFilterType=t),o.removeClass("is-selecting is-browsing can-select-multiple");t="is-browsing";"select"==l.mode&&(t="is-selecting"),o.addClass(t),"gallery"!=l.currentBrowseType&&"thumbnails"!=l.currentBrowseType||o.addClass("can-select-multiple"),o.switchClass("filter-"+l.currentFilterType),l.currentUri&&"places"!=l.currentUri&&(e=l.currentUri),l.setActivePlace(e),e&&l.navigate(e)},hide:function(){l.pauseVideoObject(),l.frame().addClass("t-hidden"),l.selection.clear(),l.panel.hide(),l.currentFilterType="all",l.mode="standard",l.currentBrowseButton=null,l.currentBrowseType=null,l.disabledPanels=null},loading:function(){l.body().removeClass("is-empty").addClass("is-loading")},doneLoading:function(){l.body().removeClass("is-loading")},pauseVideoObject:function(){0<d("video").length&&d("video").get(0).pause()},"{self} composerReady":function(){(c=EasyBlog.Composer).perfectscrollbar.initPs(l.body.selector),c.perfectscrollbar.initPs(l.panel.selector)},"{self} onPerfectScrollbarAfterInit":function(e,t,o,n){const a=d(n);a.hasClass("eb-nmm-content")&&(l.bodyPerfectScrollbar||(l.bodyPerfectScrollbar=o)),a.hasClass("eb-nmm-info-panel__bd")&&(l.panelPerfectScrollbar||(l.panelPerfectScrollbar=o))},types:{"":"file"},getExtension:function(e,t){t=(e=l.getUri(e,t)).lastIndexOf(".");return-1<t?e.slice(t+1).toLowerCase():""},getType:function(e,t){return l.types[l.getExtension(e,t)]||"file"},getPlaceName:function(e){return e.split(":")[0]},getKey:function(e){var t=e;return"_"!==e.substring(0,1)&&(data="_"+d.moxie.btoa(e),data=data.replace(/\+/g,"."),data=data.replace(/\=/g,"-"),data=data.replace(/\//g,"~"),t=data),t},getUri:function(e,t){return e instanceof d&&(e=e.data("key")||""),firstKeyCharacter=e.substring(0,1),"_"!==firstKeyCharacter||t?e:(uri=e.slice(1),uri=uri.replace(/\./g,"+"),uri=uri.replace(/\-/g,"="),uri=uri.replace(/\~/g,"/"),uri=d.moxie.atob(uri,!0),uri)},getParent:function(e){var t=(e=l.getUri(e)).lastIndexOf("/");return-1<t?e.slice(0,t):null},getFilename:function(e){var t=(e=l.getUri(e)).lastIndexOf("/");return-1<t?e.slice(t+1):e},isOpen:function(){return!l.frame().hasClass("t-hidden")},isRoot:function(e){return l.getUri(e).indexOf("/")<0},canInsert:function(){return l.frame().hasClass("has-insertions")},canDelete:function(){return l.frame().hasClass("can-delete")},canSelectMultiple:function(){return"gallery"==l.currentBrowseType||"thumbnails"==l.currentBrowseType},canUpload:function(){return l.frame().hasClass("can-upload")},getCurrentPostUri:function(e){var t="post:"+EasyBlog.Composer.getPostId();return t=void 0!==e&&0<e.length?e+":"+EasyBlog.Composer.getPostId():t},medias:{},mediaLoaders:{},getMedia:function(e){var t=l.getKey(e),o=l.getCurrentPostUri(),e=l.mediaLoaders[e];return e||(l.infoPanelLoader().addClass("is-loading"),e=EasyBlog.ajax("site/views/mediamanager/info",{key:t,currentPostUri:o}).done(function(e){var t=e.uri;l.setMedia(t,e),l.infoPanelLoader().removeClass("is-loading")})),e},setMedia:function(e,t){l.medias[e]=t,l.mediaLoaders[e]=d.Deferred().resolve(t)},getVariations:function(e){e=l.medias[e];if(e)return e.meta.variations||{}},getVariation:function(e,t){if(d.isString(t)){var o=t;switch(o){case"icon":t=["system/icon","system/small","system/small 320","system/thumbnail","system/original"];break;case"small":t=["system/small","system/small 320","system/thumbnail","system/original"];break;case"medium":t=["system/medium","system/large","system/original"];break;case"thumbnail":t=["system/thumbnail","system/original"];break;case"large":t=["system/large","system/original"];break;case"original":t=["system/original"];break;default:t=[o,"system/original"]}}var n,a=l.getVariations(e);return d.each(t,function(e,t){if(d.has(a,t))return n=a[t],!1}),n},createVariation:function(t,e,o,n){var a=l.getKey(t);return EasyBlog.ajax("site/views/mediamanager/createVariation",{key:a,name:e,width:o,height:n}).done(function(e){l.setMedia(t,e)})},removeVariation:function(t,e){var o=l.getKey(t);return EasyBlog.ajax("site/views/mediamanager/deleteVariation",{key:o,name:e}).done(function(e){l.setMedia(t,e)})},mode:"standard",currentFilterType:"all",currentBrowseButton:null,currentFolderUri:null,currentUri:"places",selection:{getLastItem:function(){if(l.selection.total()<=0)return!1;var e=Object.keys(s.selections),e=e[e.length-1];return l.selection.getItem(e)},getItem:function(e){return s.selections[e]},getItems:function(){return s.selections},getKeys:function(){var o=[];return d.each(s.selections,function(e,t){o.push(e)}),o},total:function(){return Object.keys(s.selections).length},hasItems:function(){return!d.isEmptyObject(s.selections)},canCreateGallery:function(){var e=s.selections,o=!0;return d.each(e,function(e,t){if("image"!=t.meta.type)return o=!1}),o},insert:function(e,t){s.selections[e]=t,l.frame().addClass("has-selections"),template=l.getSelectionTemplate(t),l.selectionList().append(template),l.trigger("mediaSelectionUpdated",[s.selections,t])},remove:function(e){var t=l.selection.getItem(e);delete s.selections[e],l.selectionList().find('[data-key="'+e+'"]').remove(),l.trigger("mediaSelectionUpdated",[s.selections,t])},clear:function(){delete s.selections,l.folder().removeClass("is-selected"),l.selectionList().html(""),l.item().removeClass("is-selected"),l.checkboxInput().prop("checked",!1),l.frame().removeClass("has-selections"),l.panel.hide(),s.selections={},l.simulateMetakey=!1,l.trigger("mediaSelectionUpdated",[s.selections])}},setActivePlace:function(e){var t=l.getKey(e);l.currentPlace=e,l.frame().addClass("can-upload can-create-folder can-delete has-insertions"),"posts"!=l.currentPlace&&"users"!=l.currentPlace||l.frame().removeClass("can-upload can-create-folder can-delete"),"easysocial"!=l.currentPlace&&"jomsocial"!=l.currentPlace&&"flickr"!=l.currentPlace&&"unsplash"!=l.currentPlace||l.frame().removeClass("can-upload can-create-folder can-delete"),0<=l.currentPlace.indexOf("amazon")&&l.frame().removeClass("can-create-folder"),l.place().removeClass("is-active"),e==l.getCurrentPostUri()&&(t=l.getKey("post")),l.place('[data-key="'+t+'"]').addClass("is-active")},"{place} click":function(e,t){var o,n;0<l.place(".is-loading").length||(o=e.data("id"),n=e.data("key"),n=l.getUri(n),l.drag.stop(),"post"==o&&(n=l.getCurrentPostUri()),"amazon"==o&&(n=l.getCurrentPostUri(o)),l.currentUri!==n&&(l.breadcrumbData=[],l.selection.clear(),l.setActivePlace(n),e.addClass("is-loading"),s.mobile&&l.frame().removeClass("is-places-open"),c.perfectscrollbar.updatePs(l.bodyPerfectScrollbar,l.body()[0]),l.navigate(n).done(function(){e.removeClass("is-loading").addClass("is-active")})))},"{loadMore} click":function(t,e){var o=s.mobile?"eb-nmm-mobile-actionbar":"eb-nmm-actionbar";const n=l.find("."+o+"[data-mm-disabledrag]");var a=t.data("page"),i=l.getKey(l.currentPlace,!0),o=n.find('[data-mm-breadcrumb-item][data-uri="'+l.currentPlace+'"]').next("[data-mm-breadcrumb-search]").find("input").val();const r=t.find("[data-loadmore-container]");r.addClass("is-loading"),l.selection.clear(),EasyBlog.ajax("site/views/mediamanager/loadmore",{key:i,query:o,page:a}).done(function(e){t.remove(),l.groupList().append(e.contents),l.updateItems(),l.drag.init()})},reload:function(){l.drag.stop(),l.breadcrumbData=[],l.selection.clear(),l.navigate(l.currentUri,void 0,!0),l.panel.hide(),l.frame().removeClass("is-info-panel-open")},updateItems:function(){l.listing().find(l.item.selector).each(function(){var e,t=d(this),o=t.find("[data-cover]");"image"===t.data("type")?(e=o.data("source"),d("<img />").attr("src",e).on("load",function(){d(this).remove(),o.removeClass("is-loading"),o.css("background-image","url("+e+")")})):o.removeClass("is-loading")})},navigate:function(n,a,e,t){var i="";void 0===e&&(e=!1),void 0===a&&(a=!0),(t=void 0===t?!1:t)&&(i=t.query);l.currentUri;var o=l.currentUri,t=l.getKey(n);if(o!==n||e){l.currentUri=n,l.loading();var r=d.Deferred();return l.selection.clear(),l.frame().switchClass("place-"+l.getPlaceName(n)),EasyBlog.ajax("site/views/mediamanager/contents",{key:t,query:i}).done(function(e){l.doneLoading(),e.login?(l.screens().html(e.contents),l.frame().addClass("has-login")):(l.listing().html(e.contents),l.frame().removeClass("has-login"),l.updateItems()),l.uploader.updateUploaderUrl(e);var t=e.meta.items.folder.length,o=e.meta.items.file.length;0==t&&0==o?l.body().addClass("is-empty"):l.body().removeClass("is-empty"),0<t?l.body().addClass("has-folders"):l.body().removeClass("has-folders"),0<o?l.body().addClass("has-files"):l.body().removeClass("has-files"),a&&(t=l.isRoot(n),"easysocial"!=l.currentPlace&&"jomsocial"!=l.currentPlace||(t=e.meta.root),o="posts"!=l.currentPlace&&"users"!=l.currentPlace||"posts"==l.currentPlace&&"posts"==e.meta.place||"users"==l.currentPlace&&"users"==e.meta.place,l.breadcrumbData.push({uri:n,html:e.breadcrumb}),t&&o?(l.breadcrumbBack().addClass("t-hidden"),l.breadcrumbBack().removeAttr("data-uri")):l.breadcrumbBack().removeClass("t-hidden"),"unsplash"!=l.currentPlace&&l.breadcrumbSearch().remove(),l.breadcrumb().remove(),l.breadcrumbs().append(e.breadcrumb)),i&&(l.inputSearch().focus(),l.inputSearch().caret(i.length)),r.resolve(),l.drag.init(),c.perfectscrollbar.updatePs(l.bodyPerfectScrollbar,l.body()[0])}),r}l.uploader.updateUploaderUrl("",t)},getCurrentRequirements:function(e){return!!l.currentRequirements&&l.currentRequirements[e]},getSelectionTemplate:function(e){var t,o=d(n.selection);return o.attr("data-uri",e.uri),o.attr("data-key",e.meta.key),"image"==e.meta.type?(t=e.meta.preview+"?"+d.uid()+"=1",o.find("[data-selection-cover]").css("background-image","url("+t+")")):o.find("[data-selection-cover]").html('<i class="'+e.meta.icon+'"></i>'),o[0]},getUploadTemplate:function(e){var t=d(s.templates.upload);return t.attr("data-id",e.id),t.find("[data-eb-mm-upload-type]").addClass("type-"+e.type),t[0]},folder:{nodes:{},get:function(e){e=l.getKey(e),e=l.folder.selector+"[data-key='"+e+"']";return t.find(e)},remove:function(e){l.folder.get(e).remove(),0==l.folder().length&&l.body().removeClass("has-folders")},insert:function(e,t){l.mediaLoaders[e.uri]||l.setMedia(e.uri,e);e=l.group("[data-type=folder]"),e=l.groupList.inside(e);l.body().removeClass("is-empty"),l.body().addClass("has-folders"),e.prepend(t)},rename:function(e,t){l.getMedia(e).done(function(e){var o,n=e.meta;n.title!=t&&(o=l.folder.get(n.key),l.panelState().addClass("t-hidden"),EasyBlog.ajax("site/views/mediamanager/rename",{key:n.key,filename:t}).done(function(e){l.panelState().removeClass("t-hidden");var t=e.meta.filename;l.folderTitle().val(t),delete l.mediaLoaders[n.uri],l.setMedia(e.uri,e);t=d(e.file);o.replaceWith(t),l.panel().data("uri",e.uri);l.getKey(e.uri);l.selection.remove(n.key)}))})}},"{formInput} change":function(e,t){var o=e.parents(l.panel.selector),e=o.data("uri"),a={key:l.getKey(e)},o=l.formInput.inside(o);0<o.length&&d.each(o,function(e,t){var o=(t=d(t)).attr("name"),n=t.val();t.is("[data-mm-panel-title]")&&l.item("[data-key="+a.key+"]").trigger("mediaTitleChanged",[n]),a["params["+o+"]"]=n}),EasyBlog.ajax("site/views/mediamanager/updateItemMeta",a).done(function(e){l.panelState().removeClass("t-hidden");var t=e.uri;l.setMedia(t,e)})},"{folderTitle} keypress":function(e,t){var o;13!=(t.keyCode||t.which)||0!=(o=d.trim(e.val())).length&&(e=e.parents(l.panel.selector).data("uri"),l.folder.rename(e,o),t.stopPropagation(),t.preventDefault())},"{folderTitle} change":function(e,t){var o=d.trim(e.val());0!=o.length&&(e=e.parents(l.panel.selector).data("uri"),l.folder.rename(e,o))},folderLoading:!1,"{folder} click":function(e,t){var o,n,a,i;l.folderLoading||(o=e.data("uri"),n=e.data("key"),a=!e.hasClass("is-selected"),s.mobile?e.dblclick():((i=l.selection.getLastItem())&&"folder"!=i.meta.type&&delete l.mediaLoaders[o],l.selection.clear(),l.folder().removeClass("is-selected"),e.toggleClass("is-selected",a),a&&(l.folderLoading=!0,l.getMedia(o).done(function(e){l.selection.insert(n,e),l.panel.show(o),l.folderLoading=!1}))))},"{folder} dblclick":function(e,t){t.preventDefault();e=e.data("uri");l.navigate(e)},uploadItems:{},createUploadItem:function(e){var t,o=l.getUploadTemplate(e);return l.uploadItems[e.id]=o,e.type.match("image")&&((t=new d.moxie.Image).onload=function(){t.downsize(100),l.uploadThumbnail.inside(o).css("backgroundImage",d.cssUrl(t.getAsDataURL()))},t.load(e.getSource())),l.uploader.addItem(e,o),o},getFileGroup:function(e){return e=l.group("[data-type="+e+"]")},file:{active:d(),get:function(e){e=l.getKey(e),e=l.file.getSelector(e);return t.find(e)},getSelector:function(e){return l.item.selector+'[data-key="'+e+'"]'},activate:function(e){l.file.deactivate(),l.file.active=e.addClass("active")},deactivate:function(){l.file.active.removeClass("active")},insert:function(e){l.body().removeClass("is-empty"),l.body().addClass("has-files");var t=l.getFileGroup("file");l.groupList.inside(t).prepend(e)},remove:function(e){l.file.get(e).remove(),0==l.item().length&&l.body().removeClass("has-files")}},notice:{show:function(e){l.errorMessage().removeClass("t-hidden").html(e)},hide:function(){l.errorMessage().addClass("t-hidden")}},"{showAllFilesButton} click":function(e){l.folder.of(e).removeClass("filter-new")},panel:{save:function(){var e=l.panel().data("uri");e.length<=0||l.getMedia(e).done(function(e){var t=l.panel().find(">div");e.panel=t.detach()})},populate:function(e){},show:function(t){l.panelState().addClass("t-hidden"),l.panel.save(),l.panel().data("uri",t),l.getMedia(t).done(function(e){l.panel().html(e.panel),l.panel().removeClass("t-hidden"),l.frame().addClass("is-info-panel-open");e=JSON.parse(e.meta.params);t.includes("unsplash")&&(l.captionInput().val(e.attribution),l.imageSource().val("system/medium")),l.panel().find("[data-eb-mm-panel-type]").removeClass("t-hidden"),l.disabledPanels&&d(l.disabledPanels).each(function(){l.panel().find("[data-eb-mm-panel-type="+this+"]").addClass("t-hidden")})})},hide:function(){l.panel().data("uri",""),l.panel().addClass("t-hidden")}},"{flickrButton} click":function(e){var t=e.data("url"),o=screen.width/2-480,e=screen.height/2-325;window.doneLogin=function(){l.currentUri="flickrlogin",l.navigate("flickr")},window.open(t,"","scrollbars=no,resizable=no, width=960,height=650,left="+o+",top="+e)},"{createFolder} click":function(e,t){var n=l.getKey(l.currentUri);EasyBlog.dialog({content:EasyBlog.ajax("site/views/mediamanager/createFolderDialog"),bindings:{"{submitButton} click":function(){var e=this.folderName().val(),t=this.folderName(),o=this.alert();t.parent().removeClass("has-error"),""!=d.trim(e)?EasyBlog.ajax("site/views/mediamanager/createFolder",{key:n,folder:e}).done(function(e,t){l.folder.insert(e,t),EasyBlog.dialog().close()}).fail(function(e){t.parent().addClass("has-error"),o.html(e.message).removeClass("t-hidden")}):t.parent().addClass("has-error")}}})},"{clearSelections} click":function(e,t){t.stopPropagation(),l.selection.clear()},"{delete} click":function(e,t){var o;l.selection.hasItems()&&(o=l.selection.getItems(),EasyBlog.dialog({content:EasyBlog.ajax("site/views/mediamanager/confirmDelete"),bindings:{"{submitButton} click":function(){var e=l.selection.getKeys();EasyBlog.ajax("site/views/mediamanager/delete",{keys:e}).done(function(){d.each(o,function(e,t){e=l.getUri(e),t="folder"==t.meta.type;l.removeMedia(e,t)}),l.selection.clear(),EasyBlog.dialog().close()})}}}))},"{self} mediaRemove":function(e,t,o,n){o=l.getKey(o);n&&l.folder.remove(o),n||l.file.remove(o);n=l.item().length,o=l.folder().length;0==n&&0==o&&l.body().addClass("is-empty")},refreshMedia:function(e){e=l.getUri(e),delete l.medias[e],delete l.mediaLoaders[e]},removeMedia:function(e,t){l.getKey(e);l.selection.clear(),l.refreshMedia(e),l.trigger("mediaRemove",[e,t])},"{fileRenameButton} click":function(e){var e=l.info.of(e),t=e.data("key"),e=d.trim(l.infoFilename.inside(e).text());EasyBlog.dialog({content:EasyBlog.ajax("site/views/mediamanager/renameFileDialog",{current:e}),bindings:{"{submitButton} click":function(){var e=this.fileName().val();""!=d.trim(e)&&l.file.rename(t,e)}}})},"{paginationPrevious} click, {paginationNext} click":function(e){var e=e.data("page"),t=l.getHint("loading");EasyBlog.ajax("site/views/mediamanager/users",{page:e}).done(function(e){t.replaceWith(e)}),l.display(t)},dropzone:{show:function(){l.selection.clear(),l.frame().find("[data-dragzone]").removeClass("t-hidden")},hide:function(){l.frame().find("[data-dragzone]").addClass("t-hidden")}},dropActivated:!1,"{dropzoneWrapper} dragover":function(e,t){l.canUpload()&&(l.dropActivated||(l.dropActivated=!0,l.dropzone.show(),setTimeout(function(){l.dropzoneWrapper().on("dragleave",function(){l.dropzone.hide(),l.dropActivated=!1,l.dropzoneWrapper().off("dragleave")})},100)))},"{dropzoneWrapper} drop":function(){l.dropzone.hide()},"{selectionItem} click":function(e,t){e=e.data("uri");l.panel.show(e)},"{item} click":function(e,t){s.mobile&&e.find(l.checkbox.selector).click()},simulateMetakey:!1,"{checkbox} click":function(e,t){t.preventDefault(),t.stopPropagation();t=e.siblings(l.checkboxInput),e=e.parents(l.item.selector);l.simulateMetakey=!0,t.prop("checked",!t.is(":checked")).trigger("change"),l.selectItem(e)},"{checkboxInput} change":function(e,t){0==l.checkboxInput(":checked").length&&(l.simulateMetakey=!1)},selectItem:function(e,o){var n,a,t;o=void 0!==o&&o,e.hasClass("type-loadmore")||(l.notice.hide(),n=!e.hasClass("is-selected"),a=e.data("uri"),l.folder().removeClass("is-selected"),l.simulateMetakey=!0,(t=l.selection.getLastItem())&&"folder"==t.meta.type&&l.selection.clear(),"select"==l.mode&&"thumbnails"!=l.currentBrowseType&&"gallery"!=l.currentBrowseType&&l.selection.clear(),e.toggleClass("is-selected",n),e.find(l.checkboxInput).prop("checked",n).trigger("change"),l.getMedia(a).done(function(e){var t=l.getKey(e.uri);n?(l.selection.insert(t,e),s.mobile||o||(l.panel.show(a),c.perfectscrollbar.updatePs(l.panelPerfectScrollbar,l.panel()[0]))):(l.selection.remove(t),t=l.selection.hasItems(),l.panel.hide(),!t||s.mobile||o||(t=l.selection.getLastItem(),l.panel.show(t.uri),c.perfectscrollbar.updatePs(l.panelPerfectScrollbar,l.panel()[0])))}))},"{mobileClosePlaces} click":function(e,t){l.frame().removeClass("is-places-open")},"{mobileOpenPlaces} click":function(e,t){l.frame().addClass("is-places-open")},"{mobileOpenPanel} click":function(e,t){t.stopPropagation();e=e.data("uri");l.frame().addClass("is-info-panel-open"),l.panel.hide(),l.panel.show(e)},"{mobileHidePanel} click":function(e,t){t.stopPropagation(),l.panel.hide(),l.frame().removeClass("is-info-panel-open")},"{insertGallery} click":function(e,t){var o=l.selection.getItems();l.trigger("mediaInsertGallery",[o]),l.hide()},"{insertPermalink} click":function(e,t){var o=l.selection.getItems();l.trigger("mediaInsertPermalink",[o]),l.hide()},"{insert} click":function(e,t){var r=1<l.selection.total(),o=l.selection.getItems(),s=!0;d.each(o,function(e,t){var i=l.getUri(e);l.getMedia(i).done(function(o){var e=d("<div>");e.html(o.info);var t=e.find(EBD.standaloneBlock);if(l.pauseVideoObject(),l.panel().data("uri")==i&&(o.panel=l.panel().find("> div")),o.data=d(o.panel).find("[data-mm-form]").serializeObject(),"image"==o.meta.type){var n=o.meta.variations[o.data.variation],e=l.getCurrentRequirements("width"),a=l.getCurrentRequirements("height");if(e){e=parseInt(e);if(parseInt(n.width)<=e)return s=!1,void l.notice.show(l.requirementsMessages.width.replace("%i",e))}if(a){var a=parseInt(a);if(parseInt(n.height)<=a)return s=!1,void l.notice.show(l.requirementsMessages.height.replace("%i",a))}}d.map(o.data,function(e,t){0==e&&(o.data[t]=!1),1==e&&(o.data[t]=!0)}),"image"==o.meta.type&&"lightbox"==o.data.link&&(a=l.getVariation(o.data.uri,"original"),o.data.popup_url=a.url,o.data.popup_uri=a.uri),"select"==l.mode?l.currentBrowseButton.trigger("mediaSelect",[o,o.data]):l.trigger("mediaInsert",[o,t,o.data,r])})}),s&&l.hide()},"{layout} click":function(e,t){e=e.data("type");l.layout().removeClass("is-active"),l.layout("[data-type="+e+"]").addClass("is-active"),l.listing().removeClass("is-grid is-list").addClass("is-"+e)},"{close} click":function(e,t){l.hide()},breadcrumbData:[],"{breadcrumbBack} click":function(e,t){var o,n,a;"unsplash"!=l.currentPlace&&(l.drag.stop(),l.breadcrumbData.pop(),o=l.breadcrumbData.length-1,a=(n=l.breadcrumbData[o]).uri,0==o&&e.addClass("t-hidden"),n&&(l.breadcrumb().remove(),l.breadcrumbs().append(n.html)),l.drag.init(),l.navigate(a,!1))},"{breadcrumb} click":function(e,t){var o;"unsplash"!=l.currentPlace&&(o=e.data("uri"),e.nextAll().remove(),l.navigate(o,!1))},"{item} mediaTitleChanged":function(e,t,o){e.find("[data-item-title]").html(o)},"{self} keyup":function(e,t){27==t.keyCode&&l.isOpen()&&l.hide()},"{self} mediaUploaderFileFiltered":function(e,t,o,n){var a;l.canUpload()&&(a=l.uploadItems[n.id]||l.createUploadItem(n),l.getType(n.name,!0),l.file.insert(a))},"{self} mediaUploaderFileError":function(e,t,o,n){var a=n.file,a=d(l.uploadItems[a.id]),n=JSON.parse(n.response);a.addClass("is-failed");a=a.find("[data-eb-mm-failed-message]");a.attr("data-original-title",n.message),a.attr("data-eb-provide","tooltip")},"{self} mediaUploaderFileUploaded":function(e,t,o,n,a){var i=a.response.media;l.setMedia(i.uri,i),"image"==i.meta.type&&void 0!==i.meta.params&&(a=JSON.parse(i.meta.params),extension=void 0!==a.extension?a.extension:"","webp"==extension&&l.setMedia(i.meta.fallbackItem.uri,i.meta.fallbackItem)),setTimeout(function(){var e,t=l.uploadItems[n.id];t&&(e=d(i.file).addClass("is-new"),d(t).replaceWith(e),l.drag.init())},600)},"{self} mediaSelectionUpdated":function(e,t,o,n){var a,i,r=l.selection.total();l.selectionCounter().html(r),r<=0?l.actions().removeClass("show-insert show-gallery show-permalink"):(a=c.document.isLegacy(),i=l.selection.getLastItem().meta,n&&"undefined"!==n&&("folder"==(n=n.meta).type&&!a||("folder"==n.type&&a?l.actions().addClass("show-gallery"):(1<=r&&l.actions().addClass("show-insert"),1<r&&l.selection.canCreateGallery()?l.actions().addClass("show-gallery"):l.actions().removeClass("show-gallery"),a&&"pdf"==n.type&&n.id==i.id&&"pdf"==i.type||a&&"pdf"==i.type?l.actions().addClass("show-permalink"):l.actions().removeClass("show-permalink")))))},"{inputSearch} keyup":d.debounce(function(e,t){e=e.val();l.navigate(l.currentPlace,!1,!0,{query:e})},500),"{browseButton} click":function(e,t){var o=e.data("eb-mm-filter"),n=e.data("eb-mm-start-uri"),a=l.getUri(n),i=e.data("eb-mm-browse-place"),r=e.data("eb-mm-browse-type");"post"==a&&(a=l.getCurrentPostUri()),l.notice.hide();var s={width:e.data("min-width"),height:e.data("min-height")};s.width||s.height||(s=!1);n=e.data("eb-mm-disabled-panels")?e.data("eb-mm-disabled-panels"):[];n.length&&(n=n.split(",")),l.mode="select",l.currentBrowseType=r,l.currentBrowseButton=e,l.currentRequirements=s,l.disabledPanels=n,l.currentBrowseButton.trigger("mediaSelectStart",[l.currentBrowseButton]),l.open(a,o),"local"==i?l.frame().addClass("show-local"):l.frame().removeClass("show-local")}}});d("body").addController(e),t.resolve(e)})}),EasyBlog.module("composer/media/editor",function(i){EasyBlog.Controller("MediaManager.Editor",{defaultOptions:{"{editButton}":"[data-mm-edit]","{undoButton}":"[data-mm-editor-undo]","{cropButton}":"[data-mm-editor-crop]","{cropCancelButton}":"[data-mm-editor-crop-cancel]","{cropSaveButton}":"[data-mm-editor-crop-save]","{saveButton}":"[data-mm-editor-save]","{rotateButton}":"[data-mm-editor-rotate]","{flipHorizontalButton}":"[data-mm-editor-flip-horizontal]","{flipVerticalButton}":"[data-mm-editor-flip-vertical]","{wrapper}":"[data-mm-editor]","{closeButton}":"[data-mm-editor-close]","{imageElement}":"[data-mm-editor-image]","{fileName}":"[data-mm-editor-title]","{alert}":"[data-mm-editor-alert]"}},function(a,e,t,n){return{media:null,cropper:null,initialized:!1,isModified:!1,image:null,saving:!1,notify:function(e){a.alert().removeClass("t-d--none"),a.alert().find("[data-message]").html(e)},init:function(){n=a.mediaManager},getCurrentCanvas:function(){return a.cropper.getCroppedCanvas()},history:{snapshots:[],snapshot:function(e){void 0===e&&(e=a.getCurrentCanvas()),a.history.snapshots.push(e),0<=a.history.snapshots.length&&n.frame().addClass("has-changes")},get:function(){var e=a.history.snapshots.length-1;return a.history.snapshots.splice(e,1)[0]},undo:function(){var e=a.history.get();e&&(a.load(e.toDataURL()),a.history.snapshots.length<=0&&n.frame().removeClass("has-changes"))},reload:function(){a.history.actions=[]}},crop:{tmp:{data:null,get:function(){return a.crop.tmp.data},save:function(){a.crop.tmp.data=a.getCurrentCanvas()}},cancel:function(){a.cropper.clear(),a.wrapper().removeClass("is-cropping")},load:function(){a.wrapper().addClass("is-cropping"),a.crop.tmp.save(),a.cropper.crop()},save:function(){a.modified();var e=a.cropper.getCroppedCanvas().toDataURL();a.history.snapshot(a.crop.tmp.get()),a.load(e),a.wrapper().removeClass("is-cropping")}},load:function(e,t,o){if(o=void 0!==o&&o,n.frame().addClass("is-editing"),t&&a.fileName().html(t),a.cropper)return a.cropper.replace(e),o&&(a.history.reload(),a.history.snapshot()),a.cropper;a.image=i('<img crossorigin width="100%">'),a.image.attr("src",e),a.imageElement().append(a.image);e={autoCrop:!1,dragMode:"none",viewMode:1,restore:!1,movable:!1,zoomOnWheel:!1};return composer.options.mobile||(e.minContainerWidth=800,e.minContainerHeight=400),a.cropper=new Cropper(a.image[0],e),a.cropper},doneModified:function(){a.isModified=!1,a.saveButton().addClass("t--invisible")},modified:function(){a.isModified=!0,a.saveButton().removeClass("t--invisible")},flip:function(e){a.modified();var t,o=a.cropper,n=o.getData();a.history.snapshot(),"vertical"==e&&(t=-1*n.scaleY,o.scaleY(t)),"horizontal"==e&&(n=-1*n.scaleX,o.scaleX(n))},rotate:function(e){a.modified(),a.history.snapshot(),a.cropper.rotate(e)},setMedia:function(e){a.media=e},save:function(){var e=a.media;a.saving||(a.saving=!0,a.saveButton().addClass("is-loading"),EasyBlog.ajax("site/views/mediamanager/edit",{key:e.meta.key,image:a.getCurrentCanvas().toDataURL()}).done(function(e,t){a.saveButton().removeClass("is-loading"),a.doneModified(),a.saving=!1,i.map(e.meta.variations,function(e,t){e.url+="?"+i.uid()+"=1"}),n.refreshMedia(e.uri),n.setMedia(e.uri,e),n.reload(),a.notify(t)}))},"{closeButton} click":function(){n.frame().removeClass("is-editing")},"{undoButton} click":function(e,t){a.history.undo()},"{rotateButton} click":function(e,t){e=e.data("degrees");a.rotate(e)},"{flipHorizontalButton} click":function(e,t){a.flip("horizontal")},"{flipVerticalButton} click":function(e,t){a.flip("vertical")},"{cropCancelButton} click":function(e,t){a.crop.cancel()},"{cropSaveButton} click":function(e,t){a.crop.save()},"{cropButton} click":function(e,t){a.crop.load()},"{saveButton} click":function(e,t){a.save()},"{editButton} click":function(e,t){e=e.data("key"),e=n.getUri(e);a.alert().addClass("t-d--none"),n.getMedia(e).done(function(e){e.meta.editorUrl=e.meta.editorUrl+"?"+i.uid()+"=1",a.setMedia(e),a.load(e.meta.editorUrl,e.meta.title)})}}}),this.resolve()}),EasyBlog.module("composer/media/uploader",function(e){var t=this;EasyBlog.require().library("plupload2").done(function(l){EasyBlog.Controller("MediaManager.Uploader",{elements:["[data-eb-mm-{upload-progress|upload-name|upload-size|upload-progress-value|upload-progress-bar}]","[data-eb-mm-upload-{error-text|error-retry}]"],defaultOptions:{"{progressBar}":"[data-eb-mm-upload-progress-bar]"}},function(r,e,t,s){return{init:function(){var e=(s=r.mediaManager).frame().htmlData("mm-uploader");r.defaultUploadOptions=l.extend({runtimes:"html5, html4",autostart:!0},e)},instances:{},targetUrl:null,updateUploaderUrl:function(e,t){void 0===t&&(t=e.meta.key),r.targetUrl=l.uri(r.defaultUploadOptions.url).replaceQueryParam("key",t).toString()},register:function(o,e){var e=l.extend({},r.defaultUploadOptions,e),t=o.data("key");"post"==EasyBlog.MediaManager.getUri(t)&&(t=EasyBlog.MediaManager.getKey(EasyBlog.MediaManager.getCurrentPostUri()));var n=e.extensions.split(",");l.each(EasyBlog.MediaManager.options.types,function(e,t){l(t).filter(function(e,t){return l.inArray(t,n)})}),EasyBlog.MediaManager.options.types.file=n;var a=o.data("type")||"file";e.extensions=EasyBlog.MediaManager.options.types[a].join(","),r.targetUrl=e.url=l.uri(e.url).replaceQueryParam("key",t).toString();var i=o.plupload2(e,!1),e=i.id;return i.uri=s.getUri(t),i.container=o,r.instances[e]=i,l.each(r.plupload,function(e,t){i.bind(e,function(){t.apply(this,arguments),r.trigger("mediaUploader"+e,arguments),o.trigger("mediaUploader"+e,arguments)})}),i.init(),r.uploader=i},plupload:{FileFiltered:function(e,t){t.items=[],t.addedDate=(new Date).getTime()},FilesAdded:function(e,t){e.settings.autostart&&e.start()},BeforeUpload:function(e,t){r.updateAllItems(t)},UploadFile:function(e,t){r.targetUrl&&(e.settings.url=r.targetUrl),r.updateAllItems(t)},UploadProgress:function(e,t){r.updateAllItems(t)},ChunkUploaded:function(e,t){r.updateAllItems(t)},FileUploaded:function(e,t,o){try{var n=l.parseJSON(o.response);o.response=n}catch(e){}r.updateAllItems(t)},Error:function(e,t){var o=t.file;if(o){if("-600"==t.code)return o.status=4,o.error=t.message,EasyBlog.dialog({content:EasyBlog.ajax("site/views/composer/cancelFileSizeWarning")}),r.updateAllItems(o),r.trigger("mediaUploaderFileError",arguments),void e.container.trigger("mediaUploaderFileError",arguments);o.status=4,o.error=l.parseJSON(t.response),r.updateAllItems(o),r.trigger("mediaUploaderFileError",arguments),e.container.trigger("mediaUploaderFileError",arguments)}},FilesRemoved:function(e,t){t.status=6,r.updateAllItems(t)},Destroy:function(e){delete r.instances[e.id]},Init:l.noop,PostInit:l.noop,OptionChanged:l.noop,StateChanged:l.noop,QueueChanged:l.noop,Refresh:l.noop,UploadComplete:l.noop},getInstances:function(t){return l.map(r.instances,function(e){return e.uri==t?e:null})},status:{0:"idle",1:"queued",2:"uploading",3:"unused",4:"failed",5:"done",6:"removed"},addItem:function(e,t){e.items.push(t),r.updateItem(e,t)},updateItem:function(e,t){var o,n,t=l(t),a=r.status[e.status];t.switchClass("state-"+a),"uploading"===a&&r.progressBar().removeClass("t-hidden"),e.error?(t.find(r.errorText).html(e.error.message),t.find(r.errorRetry).off("click.mmupload.retry").on("click.mmupload.retry",function(){t.switchClass("state-idle")}),n=t.find(r.uploadProgressBar),r.updateProgressBar(n,100)):(t.find(r.uploadName).html(e.name),t.find(r.uploadSize).html(l.plupload2.formatSize(e.size)),t.find(r.uploadProgressValue).html(e.percent+"%"),o=e.percent,0==e.percent&&(o=5),a=0,(n=t.find(r.uploadProgressBar)).hasClass("progress-bar")?100<=(a=100*Math.ceil(o/5))&&5!=e.status&&(a=90):a=5*Math.ceil(o/5),r.updateProgressBar(n,a))},updateProgressBar:function(e,t){e.hasClass("progress-bar")?e.css("width",t+"%"):e.addClass("o-progress-radial--"+t)},updateAllItems:function(o){o.items&&l.each(o.items,function(e,t){r.updateItem(o,t)})},removeItem:function(e,t){l.pull(e.items,t)}}}),t.resolve()})}),EasyBlog.module("composer/mobile",function(e){EasyBlog.Controller("Composer.Mobile",{defaultOptions:{"{cover}":"[data-composer-mobile-cover]","{info}":"[data-composer-mobile-info]","{hideInfo}":"[data-composer-mobile-hide-info]","{exit}":"[data-composer-mobile-exit]","{options}":"[data-composer-mobile-options]","{optionScreen}":"[data-composer-mobile-options-screen]","{posts}":"[data-composer-mobile-posts]","{location}":"[data-composer-mobile-location]","{revisions}":"[data-composer-mobile-revisions]"}},function(o,e,n,t,a){return{init:function(){n=o.composer,a=n.manager(),n.blocks},hideMobileOptions:function(){a.removeClass("is-mobile-options-open")},"{exit} click":function(e,t){window.location=e.data("url")},"{cover} click":function(e,t){a.addClass("is-cover-open")},"{hideInfo} click":function(e,t){a.removeClass("is-sidebar-open")},"{info} click":function(e,t){a.addClass("is-sidebar-open")},"{posts} click":function(e,t){t.stopPropagation(),o.hideMobileOptions(),n.views.show("posts"),a.addClass("is-posts-open")},"{location} click":function(e,t){t.stopPropagation(),o.hideMobileOptions(),o.trigger("mobileLocationShow"),a.addClass("is-location-open")},"{revisions} click":function(e,t){t.stopPropagation(),o.hideMobileOptions(),a.addClass("is-revisions-open")},"{options} click":function(e,t){t.stopPropagation(),a.addClass("is-mobile-options-open")},"{optionScreen} click":function(e,t){o.hideMobileOptions()},"{self} composerViewShow":function(e,t,o){a.addClass("is-"+o+"-open")},"{self} composerViewHide":function(e,t,o){a.removeClass("is-"+o+"-open").addClass("xyzzz")},"{self} composerBlockDrop":function(){n.manager().removeClass("is-blocks-open")}}}),this.resolve()}),EasyBlog.module("composer/panels",function(e){EasyBlog.require().script().done(function(r){EasyBlog.Controller("Composer.Panels",{hostname:"panels",defaultOptions:{"{panelWrapper}":"[data-eb-composer-panels]","{panel}":"[data-eb-composer-panel]","{panelTab}":"[data-eb-composer-panel-tab]","{showDrawer}":"[data-eb-composer-panel-show-drawer]","{fieldset}":".eb-composer-fieldset","{fieldsetToggle}":".eb-composer-fieldset-toggle input","{customIdInput}":"[data-eb-composer-blocks-id]","{panelSectionHeader}":"[data-eb-composer-panels] [data-eb-composer-block-section-header]","{customCssInput}":"[data-eb-composer-blocks-css]"}},function(i,e,t){return{init:function(){r.each(["autopost","association","seo","post","category","authorship"],function(e,t){i.addPlugin(t)})},panels:[],panel:{get:r.memoize(function(e){return i.panel().where("id",e)})},panelTab:{get:r.memoize(function(e){return i.panelTab().where("id",e)})},allowedRememberPanelTabs:["post-options","fields","seo"],fieldset:{get:function(e,t){return void 0!==t?i.fieldset().where("name",e).where("type",t):i.fieldset().where("name",e)},enable:function(e,t){void 0===t&&(t=!0),i.fieldset.get(e).toggleClass("is-disabled",!t).find(i.fieldsetToggle).prop("checked",!!t)},disable:function(e,t){i.fieldset.enable(e,t=void 0===t?!1:t)},show:function(e){i.fieldset.get(e).removeClass("is-hidden")},hide:function(e){i.fieldset.get(e).addClass("is-hidden")},toggle:function(e,t){i.fieldset.get(e).toggleClass("is-hidden",void 0===t?void 0:!t)}},activate:function(e){i.deactivate(),i.panel.get(e).addClass("active"),i.panelTab.get(e).addClass("active"),i.trigger("composerPanelActivate",[e]),i.composer.perfectscrollbar.updatePs(i.panels[e],i.panelWrapper().find('[data-eb-composer-panel][data-id="'+e+'"]').find("[data-eb-composer-panel-content-viewport]")[0])},deactivate:function(e){e=e||i.panel(".active").data("id"),i.panel.get(e).removeClass("active"),i.panelTab.get(e).removeClass("active"),i.trigger("composerPanelDeactivate",[e])},"{self} composerReady":function(){i.panel().each(function(e,t){t=r(t),EasyBlog.Composer.perfectscrollbar.initPs(t[0].querySelector("[data-eb-composer-panel-content-viewport]"))})},"{self} onPerfectScrollbarAfterInit":function(e,t,o,n){const a=r(n).closest("[data-eb-composer-panel]");n=a.data("id");i.panels[n]=o},"{self} composerBlockExport":function(e,t,o,n){o=blocks.data(o);(o.custom_css||o.custom_id)&&(void 0===n.data&&(n.data={}),o.custom_css&&(n.data.custom_css=o.custom_css),o.custom_id&&(n.data.custom_id=o.custom_id))},"{self} composerBlockActivate":function(e,t,o,n){var a=blocks.data(o),o={id:composer.panels.fieldset.get("custom-id"),css:composer.panels.fieldset.get("custom-css")};o.id.show(),o.css.show(),i.customCssInput().val(""),i.customIdInput().val(""),a.custom_css&&i.customCssInput().val(a.custom_css),a.custom_id&&i.customIdInput().val(a.custom_id)},"{self} composerBlockDeactivate":function(e,t,o,n){o=blocks.data(o);o.custom_css=i.customCssInput().val(),o.custom_id=i.customIdInput().val(),i.customCssInput().val(""),i.customIdInput().val(""),composer.panels.fieldset.get("custom-css").hide(),composer.panels.fieldset.get("custom-id").hide()},"{self} composerBlockRemove":function(){composer.panels.fieldset.get("custom-css").hide(),composer.panels.fieldset.get("custom-id").hide()},"{panelTab} click":function(e){e=e.data("id");i.activate(e)},"{showDrawer} click":function(){r("[data-eb-composer-frame]").toggleClass("show-drawer")},"{fieldsetToggle} change":function(e){i.fieldset.of(e).toggleClass("is-disabled",!e.is(":checked"))},"{panelSectionHeader} click":function(e,t){var o=e.closest("[data-eb-composer-block-section]");o.toggleClass("is-open");var n=i.panelWrapper(),n=parseInt(n.data("remember-panel")),e=e.closest("[data-eb-composer-panel]").data("id");n&&-1!=r.inArray(e,i.allowedRememberPanelTabs)&&(e=o.data("name"),o=o.hasClass("is-open")?1:0,EasyBlog.ajax("site/views/composer/savePanelPreferences",{section:e,isOpen:o}))}}})}),this.resolve()}),EasyBlog.module("composer/panels/association",function(n){EasyBlog.Controller("Composer.Panels.Association",{defaultOptions:{"{selectButton}":"[data-assoc-select]","{clearButton}":"[data-assoc-clear]"}},function(e,t,o){return{"{clearButton} click":function(e,t){e=n(e).data("id");n("input#assoc-postname"+e).val(""),n("input#assoc-postid"+e).val("")},"{selectButton} click":function(e,t){var o=e.data("code"),e=e.data("id");EasyBlog.dialog({content:EasyBlog.ajax("site/views/composer/browsePosts",{id:e,code:o})})}}}),this.resolve()}),EasyBlog.module("composer/panels/authorship",function(n){EasyBlog.Controller("Composer.Panels.Authorship",{defaultOptions:{"{authorArea}":"[data-eb-composer-author]","{currentAuthor}":"[data-eb-composer-current-author]","{searchAssociates}":"[data-associates-search]","{cancelSearchAssociates}":"[data-associates-search-cancel]","{searchAuthor}":"[data-author-search]","{cancelSearchAuthor}":"[data-author-search-cancel]","{tab}":"[data-author-type]","{tabContent}":"[data-tab-content]","{changeAuthor}":"[data-eb-composer-switch-author]","{authorPicker}":"[data-eb-composer-author-picker]","{authorItem}":"[data-eb-author-item]","{authorList}":"[data-eb-composer-author-list]","{authorCheckbox}":"[data-eb-composer-authoritem]","{activeAuthorId}":"[data-eb-composer-authorid]","{activeAuthorAvatar}":"[data-eb-composer-authoravatar]","{activeAuthorName}":"[data-eb-composer-authorname]","{authorPrevBtn}":"[data-eb-author-prev]","{authorNextBtn}":"[data-eb-author-next]","{associatesList}":"[data-eb-composer-associates-list]","{associateItem}":"[data-associates-item]","{associateCheckbox}":"[data-associates-checkbox]","{activeAssociateName}":"[data-eb-composer-associatename]","{activeAssociateId}":"[data-eb-composer-associateid]","{activeAssociateType}":"[data-eb-composer-associatetype]","{activeAssociateAvatar}":"[data-eb-composer-associateavatar]"}},function(i,e,t){return{init:function(){},"{cancelSearchAssociates} click":function(){i.associateItem().removeClass("hide"),i.searchAssociates().val("")},"{cancelSearchAuthor} click":function(){i.authorItem().removeClass("hide");var e=n.trim(i.searchAuthor().val());i.searchAuthor().val(""),e&&i.loadAuthors(0,"")},"{searchAssociates} keydown":n.debounce(function(e,t){var o=n.trim(e.val()).toLowerCase();o?(e=i.associateItem().filter(function(){return 0==n.trim(n(this).data("title")).toLowerCase().indexOf(o)}))&&(i.associateItem().addClass("hide"),e.removeClass("hide")):i.associateItem().removeClass("hide")},300),"{searchAuthor} keydown":n.debounce(function(e,t){e=n.trim(e.val()).toLowerCase();""!=e&&i.loadAuthors(0,e)},300),associatesLoaded:!1,"{tab} click":function(e,t){e=e.data("type");"associates"==e&&i.loadAssociates(),i.tab().removeClass("active"),i.tab().where("type",e).addClass("active"),i.tabContent().removeClass("active"),i.tabContent().where("type",e).addClass("active")},"{changeAuthor} click":function(e,t){i.authorArea().toggleClass("is-opened"),i.authorPicker().toggleClass("pulled"),1!=i.tab().length?i.loadAuthors("0",""):i.loadAssociates()},"{authorPrevBtn} click":function(e,t){t.preventDefault();t=n.trim(i.searchAuthor().val()).toLowerCase(),e=n(e).data("start"),e=parseInt(e);i.loadAuthors(e=e<0?0:e,t)},"{authorNextBtn} click":function(e,t){t.preventDefault();t=n(e).data("start"),e=n.trim(i.searchAuthor().val()).toLowerCase();i.loadAuthors(t,e)},loadAuthors:function(e,t){var o=n("<div />",{class:"loading-authors"});o.html('<i class="fdi fa fa-circle-o-notch fa-spin"></i>'),i.authorList().html(o),EasyBlog.ajax("site/views/composer/listAuthors",{selected:i.activeAuthorId().val(),limitstart:e,search:t}).done(function(e){i.authorList().html(e)})},loadAssociates:function(){i.associatesLoaded||EasyBlog.ajax("site/views/composer/listAssociates",{source_id:i.activeAssociateId().val(),source_type:i.activeAssociateType().val()}).done(function(e){i.associatesLoaded=!0,i.associatesList().html(e)})},"{authorCheckbox} change":function(e,t){var o=e.parents(i.authorItem.selector).data("avatar"),n=e.parents(i.authorItem.selector).data("id"),e=e.parents(i.authorItem.selector).data("title");i.setActiveAuthor(n,e,o)},"{associateCheckbox} change":function(e,t){var o=e.parents(i.associateItem.selector).data("avatar"),n=e.parents(i.associateItem.selector).data("id"),a=e.parents(i.associateItem.selector).data("title"),e=e.parents(i.associateItem.selector).data("type");"easyblog.sitewide"!=e?i.setActiveAssociate(n,e,a,o):i.removeAssociate()},removeAssociate:function(){i.activeAssociateId().val(0),i.activeAssociateType().val("easyblog.sitewide"),i.activeAssociateName().addClass("hidden"),i.activeAssociateAvatar().addClass("hide")},setActiveAssociate:function(e,t,o,n){i.activeAssociateId().val(e),i.activeAssociateName().html(o).removeClass("hidden"),i.activeAssociateType().val(t),i.activeAssociateAvatar().attr("src",n).removeClass("hide")},setActiveAuthor:function(e,t,o){i.activeAuthorId().val(e),i.activeAuthorName().html(t),i.activeAuthorAvatar().attr("src",o),composer.options.authorId!=e?i.currentAuthor().removeClass("hide"):i.currentAuthor().addClass("hide")}}}),this.resolve()}),EasyBlog.module("composer/panels/autopost",function(n){EasyBlog.Controller("Composer.Panels.AutoPost",{defaultOptions:{"{twitterCheckbox}":"[data-autopost-twitter]","{facebookCheckbox}":"[data-autopost-facebook]","{linkedinCheckbox}":"[data-autopost-linkedin]"}},function(o,e,t){return{itemUpdated:function(e){n(e).is(":checked")?n(e).parent().addClass("checked"):n(e).parent().removeClass("checked")},"{twitterCheckbox} change":function(e,t){o.itemUpdated(e)},"{facebookCheckbox} change":function(e,t){o.itemUpdated(e)},"{linkedinCheckbox} change":function(e,t){o.itemUpdated(e)}}}),this.resolve()}),EasyBlog.module("composer/panels/category",function(n){EasyBlog.Controller("Composer.Panels.Category",{defaultOptions:{fields:null,templates:{},"{template}":"[data-category-primary-template]","{fieldsTab}":"[data-eb-composer-panel-tab][data-id=fields]","{fieldsPanel}":"[data-eb-composer-panel][data-id=fields]","{fieldsPanelForm}":"[data-eb-composer-panel][data-id=fields] [data-scrolly-viewport]","{fieldsForm}":"[data-eb-composer-panel-fields]","{empty}":"[data-eb-composer-fields-empty]","{setPrimaryCategory}":"[data-category-primary-item]","{categoryText}":"[data-title-text]","{primaryCategoryInput}":"[data-category-primary-input]","{primaryCategoryTitle}":"[data-category-primary-title]","{coverPreview}":'[data-toolbar-view][data-type="cover"] [data-cover-placeholder] [data-cover-preview]'}},function(i,e,t,r){return{init:function(){r=EasyBlog.Composer},removeCategory:function(e){var t,o;e.id==i.primaryCategoryInput().val()&&(t=r.category.selected[Object.keys(r.category.selected)[0]],t=(o=n(r.category.item.get(t)).find("[data-category-primary-item]")).data("id"),o=o.data("title"),i.assignPrimaryCategory(t,o)),r.form().find("[data-category="+e.id+"]").remove()},assignPrimaryCategory:function(e,t){i.primaryCategoryInput().val(e);t={id:e,title:t};i.trigger("categorysetprimary",t),i.coverPreview().trigger("onUpdateCategoryDefaultCover",[t])},"{setPrimaryCategory} click":function(e,t){var o=e.data("id"),n=e.data("title");e.parent().hasClass("selected")&&i.assignPrimaryCategory(o,n)},"{self} categorydeselect":function(e,t,o){var n=i.fieldsPanel().find('[data-category-id*="'+o.id+'"]');if(groupId=n.data("group-id"),groupId){categoryIds=n.attr("data-category-id");var a=categoryIds.split(",");if(1<a.length)return(a=jQuery.grep(a,function(e){return e!=o.id}))&&(categoryIds=a.join()),n.attr("data-category-id",categoryIds),void i.removeCategory(o)}n.remove(),0==i.fieldsPanel().find("[data-panel-field]").length&&(i.empty().show(),r.panels.panelTab.get("fields").addClass("hide")),i.removeCategory(o)},"{self} categoryselect":function(e,t,n){EasyBlog.ajax("site/views/categories/getCustomFields",{id:n.id,postId:EasyBlog.Composer.getPostId()}).done(function(e,t){if(0<e.length){if(t){var o=i.fieldsPanel().find('[data-group-id="'+t+'"]'),t=o.data("category-id");if(t)return void o.attr("data-category-id",t+","+n.id)}i.fieldsPanelForm().append(e),0<i.fieldsPanel().find("[data-panel-field]").length&&(r.panels.panelTab.get("fields").removeClass("hide"),i.empty().hide())}}),i.createHiddenInput(n).appendTo(r.form())},createHiddenInput:function(e){return n("<input>").attr("type","hidden").attr("value",e.id).attr("name","categories[]").attr("data-category",e.id)},"{self} composerSaveError":function(e,t,o){o.customCode&&-500==o.customCode?i.fieldsTab().addClass("has-error"):i.fieldsTab().removeClass("has-error")}}}),this.resolve()}),EasyBlog.module("composer/panels/post",function(a){EasyBlog.Controller("Composer.Panels.Post",{defaultOptions:{"{languageSelect}":"[data-composer-language]"}},function(e,t,o,n){return{"{languageSelect} change":function(e,t){var o=a(e).val();"*"!=o?(a("[data-composer-association]").removeClass("t-hidden"),a("[data-composer-association-item]").each(function(){var e=a(this),t=e.data("id");e.data("code")==o?(a(this).find("input#assoc-postname"+t).val(""),a(this).find("input#assoc-postid"+t).val(""),a(this).addClass("hide")):a(this).hasClass("hide")&&a(this).removeClass("hide")})):a("[data-composer-association]").addClass("t-hidden")}}}),this.resolve()}),EasyBlog.module("composer/panels/seo",function(e){var t=this;EasyBlog.require().library("textboxlist").done(function(r){EasyBlog.Controller("Composer.Panels.Seo",{defaultOptions:{"{keywordTemplate}":"[data-keyword-template]","{metaInput}":"[data-meta-description]","{metaCounter}":"[data-meta-counter]","{keywordCounter}":"[data-keyword-counter]","{textboxlist}":"[data-eb-composer-seo-keywords-textboxlist]","{autofillButton}":"[data-eb-composer-seo-keywords-autofill-button]","{jsondata}":"[data-eb-composer-keywords-jsondata]","{keywordsInput}":"[data-eb-keywords]"}},function(a,e,t,o,n,i){return{init:function(){var e;0!=a.metaInput().length&&(r.template("composer/textboxlist/keywords",a.keywordTemplate().detach().html()),a.textboxlist().textboxlist({component:"eb",view:{item:"composer/textboxlist/keywords"}}),a.tagger=a.textboxlist().textboxlist("controller"),e=JSON.parse(a.jsondata().val()),r.each(e,function(e,t){a.tagger.addItem(t)}))},"{textboxlist} listChange":r.debounce(function(){a.keywordCounter().html(a.tagger.getAddedItems().length)},15),"{metaInput} keyup":function(e,t){e=r(e).val().length;a.metaCounter().html(e)},"{autofillButton} click":function(e){var o=a.textboxlist().textboxlist("controller"),t=EasyBlog.Composer.document.getText(),n=r(e).parent();r(n).addClass("is-loading"),EasyBlog.ajax("site/views/composer/suggestKeywords",{data:t}).done(function(e){r(n).removeClass("is-loading"),e&&(r.each(e,function(e,t){o.addItem(t.title)}),a.metaCounter().text(e.length))}).fail(function(e){r(n).removeClass("is-loading"),EasyBlog.dialog({content:EasyBlog.ajax("site/views/composer/errorSuggestTagAutoFill",{errorMsg:e})})})},"{self} composerSave":function(e,t,o){0==a.metaInput().length?o.data.keywords="":o.data.keywords=r.pluck(a.tagger.getAddedItems(),"title").join(", "),a.keywordsInput().val(o.data.keywords)}}}),t.resolve()})}),EasyBlog.module("composer/perfectscrollbar",function(e){var t=this;EasyBlog.require().script().done(function(){EasyBlog.Controller("Composer.Perfectscrollbar",{defaultOptions:{}},function(o,e,t,n){return{init:function(){o.composer},initPs:function(t){jQuery(document).ready(function(e){FD.require().script("vendor/perfectscrollbar").done(function(){var e=new PerfectScrollbar(t,{suppressScrollX:!0});o.trigger("onPerfectScrollbarAfterInit",[e,t])})})},updatePs:(e,t)=>{e.update(),t.scrollTop=0}}}),t.resolve()})}),EasyBlog.module("composer/posts",function(n){EasyBlog.Controller("Composer.Posts",{defaultOptions:{"{container}":"[data-posts-container]","{listingContainer}":"[data-posts-listing-container]","{listing}":"[data-posts-listing]","{emptyMessage}":"[data-posts-empty-message]","{insert}":"[data-post-insert]","{wrapper}":"[data-eb-composer-posts]","{result}":"[data-eb-composer-posts-result]","{searchField}":"[data-posts-search]"}},function(a,e,t,i){return{loaded:!1,initialResult:null,initialEmpty:null,loading:!1,init:function(){i=a.composer,blocks=i.blocks,blocks.loadBlockHandler("post")},reset:function(){a.listingContainer().removeClass("is-loading is-empty"),a.listing().html(a.initialResult),a.emptyMessage().html(a.initialEmpty)},"{container} click":function(e,t){t.stopPropagation()},"{searchField} keydown":n.debounce(function(e){var o=a.listingContainer(),e=n.trim(e.val());e.length<1?a.reset():a.loading||(a.loading=!0,o.removeClass("is-empty"),o.addClass("is-loading"),a.listing().html(""),EasyBlog.ajax("site/views/search/search",{query:e}).done(function(e,t){return o.removeClass("is-loading"),a.loading=!1,0==t?(o.addClass("is-empty"),void a.emptyMessage().html(e)):void a.listing().append(e)}))},500),"{insert} click":function(e,t){var o=EasyBlog.Composer.getDoctype(),e=e.htmlData();"ebd"==o?(window.eb.mobile&&i.manager().removeClass("is-posts-open"),o=blocks.constructBlock("post",{title:e.title,url:e.permalink,image:e.image,intro:e.content}),blocks.addBlock(o)):(link=n.create("a").attr({href:e.permalink,title:e.title}).html(e.title),EasyBlog.LegacyEditor.insert(link.toHTML())),i.document.toolbar.posts.hide()},"{composer} composerViewShow":function(e,t,o){var n;void 0===a.initialEmpty&&(a.initialEmpty=a.emptyMessage().html()),"posts"!==o||a.loaded||a.loading||(a.loading=!0,(n=a.listingContainer()).addClass("is-loading"),EasyBlog.ajax("site/views/composer/listArticles",{exclude:i.getPostId()}).done(function(e){n.removeClass("is-loading"),a.loaded=!0,a.loading=!1,0!=e.length?(n.addClass("is-ready"),a.initialResult=e,a.listing().append(e)):n.addClass("is-empty")}))}}}),this.resolve()}),EasyBlog.module("composer/revisions",function(r){EasyBlog.Controller("Composer.Revisions",{defaultOptions:{"{container}":"[data-revisions-container]","{revisionsFieldset}":"[data-eb-revisions-fieldset]","{revisionToggle}":"[data-eb-revisions-dropdown-toggle]","{revisionDropdown}":"[data-eb-pilot-dropdown]","{revisionHandler}":"[data-eb-revisions-handler]","{revisionList}":"[data-eb-revisions-list]","{compareTitle}":"[data-revisions-comparison-title]","{closeComparison}":"[data-revisions-close-comparison]","{compareScreenWrapper}":"[data-eb-composer-revisions]","{compareScreen}":"[data-eb-composer-revisions-compare-screen]","{item}":"[data-eb-composer-revisions-item]","{compareRevision}":"[data-eb-composer-revisions-compare]","{openRevision}":"[data-eb-composer-revisions-open]","{useRevision}":"[data-eb-composer-revisions-use]","{deleteRevision}":"[data-eb-composer-revisions-delete]","{revisionBlocks}":".eb-composer-revisions .ebd-block","{revisionPurge}":"[data-eb-revision-purge]"}},function(a,e,t,i,o,n){return{init:function(){i=a.composer,i.panels,o=i.blocks,compareId=i.frame().data("composer-compare-id"),compareId&&a.initCompareRevision(compareId),a.preventParentScrolling()},preventParentScrolling:function(){a.revisionList().on("mousewheel",function(e){e.stopPropagation()})},"{container} click":function(e,t){t.stopPropagation()},"{item} click":function(e){var t=e.hasClass("active");e.hasClass("is-current")||(a.item().removeClass("active"),e.toggleClass("active",!t))},revisionsLoaded:!1,getRevisionItem:function(e){return r(e).parents(a.item.selector)},"{revisionBlocks} mouseover":function(e,t){e=r(e).data("uid"),e=o.getBlock(e);o.highlight(e)},"{revisionBlocks} mouseout":function(e,t){e=r(e).data("uid"),e=o.getBlock(e);o.unhighlight(e)},"{closeComparison} click":function(e,t){i.frame().switchClass("view-document"),i.views.show("document"),a.compareScreenWrapper().removeClass("active"),a.compareScreen().html("")},"{compareRevision} click":function(e,t){i.frame().switchClass("view-revisions"),i.views.show("revisions"),a.compareScreenWrapper().addClass("active");var o=a.getRevisionItem(e),e=r(o).data("id"),o=EasyBlog.Composer.getRevisionId();EasyBlog.ajax("site/views/revisions/compare",{current:o,target:e}).done(function(e,t){a.compareTitle().html(e),a.compareScreen().html(t)})},initCompareRevision:function(e){i.frame().switchClass("view-revisions"),i.views.show("revisions"),a.compareScreenWrapper().addClass("active");var t=EasyBlog.Composer.getRevisionId();EasyBlog.ajax("site/views/revisions/compare",{current:t,target:e}).done(function(e,t){a.compareTitle().html(e),a.compareScreen().html(t)})},"{useRevision} click":function(e,t){e=a.getRevisionItem(e),e=r(e).data("id");EasyBlog.dialog({content:EasyBlog.ajax("site/views/revisions/confirmUseRevision",{uid:EasyBlog.Composer.getPostId()+"."+e})})},"{deleteRevision} click":function(e,t){var o=r(e).parents(a.item.selector),n=r(o).data("id");EasyBlog.dialog({content:EasyBlog.ajax("site/views/revisions/deleteRevision",{id:n}),bindings:{"{submitButton} click":function(){EasyBlog.ajax("site/controllers/posts/deleteRevision",{id:n}).done(function(){r(o).remove(),EasyBlog.dialog().close()})}}})},"{revisionPurge} click":function(e,t){i.views.hide("revisions");var o=EasyBlog.Composer.getRevisionId(),n=EasyBlog.Composer.getPostId();EasyBlog.dialog({content:EasyBlog.ajax("site/views/revisions/purgeRevision",{id:n}),bindings:{"{submitButton} click":function(){EasyBlog.ajax("site/controllers/posts/purgeRevisions",{id:n,revisionid:o}).done(function(n,e){r("[data-eb-composer-revisions-item]").each(function(e,t){var o=r(t).data("id").toString();r.inArray(o,n)<0&&r(t).remove()}),EasyBlog.Composer.setMessage(e)}).fail(function(e){EasyBlog.Composer.setMessage(e)}).always(function(){EasyBlog.dialog().close()})}}})},"{revisionToggle} click":function(e){a.revisionsFieldset().toggleClass("show-revision-list"),EasyBlog.ajax("site/views/revisions/getRevisions",{uid:EasyBlog.Composer.getPostUid()}).done(function(e){a.revisionsLoaded=!0,a.revisionList().html(e)})},"{composer} composerSaveSuccess":function(){a.revisionsLoaded=!1}}}),this.resolve()}),EasyBlog.module("composer/shortcuts",function(e){EasyBlog.Controller("Composer.Shortcuts",{defaultOptions:{"{shortcutsButton}":"[data-composer-shortcuts-button]","{shortcutsPopup}":"[data-composer-shortcuts]","{closePopup}":"[data-shortcuts-close]"}},function(s,e,t,o,n,a){return{init:function(){this.initHelpScreen()},editor:function(e,t,o){if(!s.isHelpOpen()){var n=s.composer.document.toolbar;if(o&&220==t&&n.toggleSidebar(),o&&73==t)return event.preventDefault(),void s.composer.blocks.browser.toggle();o&&80==t&&n.posts.toggle(),o&&76==t&&n.location.toggle(),o&&72==t&&n.revisions.toggle(),o&&71==t&&n.googleimport.toggle()}},composerBlocks:function(e,t,o,n){var a=s.composer.blocks.toolbar,i=s.composer.blocks.getCurrentBlock();if(!(s.isHelpOpen()||i.length<=0))return e&&o&&8==t?(n.preventDefault(),void a.deleteCurrentBlock()):e&&68==t&&o?(n.preventDefault(),void a.duplicateBlock()):(e&&77==t&&o&&a.moveBlock(),e&&83==t&&o&&a.saveBlockAsTemplate(),void(e&&73==t&&o&&(n.preventDefault(),s.composer.blocks.browser.toggle())))},help:function(e,t,o){191==t&&o&&s.toggleHelpScreen(),27==event.keyCode&&s.isHelpOpen()&&s.hideHelpScreen()},media:function(e,t,o){var n,a,i;s.isHelpOpen()||(a=(n=s.composer).document.toolbar,i=EasyBlog.MediaManager,n.document.isLegacy()&&o&&86==t&&a.embedVideo().click(),o&&67==t&&a.cover.toggle(),o&&77==t&&(i.isOpen()?i.hide():i.open("post")))},isMac:function(){return/(Mac)/i.test(navigator.platform)},isWindows:function(){return/(Win)/i.test(navigator.platform)},isHelpOpen:function(){return"none"!=s.shortcutsPopup().css("display")},hideHelpScreen:function(){s.shortcutsPopup().hide()},toggleHelpScreen:function(){s.shortcutsPopup().toggle()},initHelpScreen:function(){s.element.on("keydown",function(e){var t=e.metaKey,o=e.shiftKey,n=e.keyCode,a=s.composer,i=s.composer.blocks.getCurrentBlock();s.isWindows()&&(t=e.ctrlKey);var r=e.target.tagName;if(i.length<=0&&"INPUT"!==r&&"TEXTAREA"!==r)return s.help(t,n,o,e),s.editor(t,n,o,e),void s.media(t,n,o,e);a.document.isLegacy()||s.composerBlocks(t,n,o,e)})},"{shortcutsButton} click":function(){s.toggleHelpScreen()},"{closePopup} click":function(){s.hideHelpScreen()}}}),this.resolve()}),EasyBlog.module("composer/tags",function(p){var e=this,r=40,s=13,m=27,f=37,h=39,g=38,v={38:"up",40:"down",37:"left",39:"right"};EasyBlog.require().library("textboxlist","scrollTo").script("composer/vendors/nearest").done(function(){EasyBlog.Controller("Composer.Tags",{elements:["[data-eb-composer-tags-{textboxlist|readonly}]"],defaultOptions:{templates:{},"{tagTemplate}":"[data-tag-template]",readOnly:!1,"{tags}":"[data-eb-composer-tags]","{tag}":".textboxlist-item","{total}":"[data-eb-composer-tags-total]","{count}":"[data-eb-composer-tags-count]","{suggestions}":".eb-composer-tags-suggestions","{selection}":".eb-composer-tags-selection","{toggleButton}":"[data-eb-composer-tags-toggle-button]","{autofillButton}":"[data-eb-composer-tags-autofill-button]","{itemgroup}":".eb-composer-tags-selection-itemgroup","{item}":".eb-composer-tags-selection-itemgroup > div","{textfield}":"[data-textboxlist-textField]","{jsondata}":"[data-eb-composer-tags-jsondata]","{defaulttags}":"[data-eb-composer-default-tags]","{tagsInput}":"[data-eb-tags]"}},function(l,i,e,c,d,u){return{init:function(){if("0"!=EasyBlog.Composer.options.tags.enabled){i.readOnly=0<l.readonly().length,p.template("composer/textboxlist/item",l.tagTemplate().detach().html()),d=l.selection,c=l.suggestions;var e=parseInt(l.tags().attr("data-eb-composer-tags-max"))||null;l.textboxlist().textboxlist({component:"eb",max:e,ignoreLocked:!0,view:{item:"composer/textboxlist/item"},filterItem:function(e){return p.isString(e)?u.sanitize(e):(e.title=u.sanitize(e.title),e)}}),u=l.tagger=p.extend(l.textboxlist().textboxlist("controller"),l.tagger),c.populate("",!0);for(var t=0,o=JSON.parse(l.jsondata().val());existingTag=o[t++];)"0"==existingTag.id?u.addItem(existingTag.title):u.addItem({id:existingTag.id,title:existingTag.title,key:u.getItemKey(existingTag.title),locked:!1});e=JSON.parse(l.defaulttags().val());p.each(e,function(e,t){u.addLockedItem(t)}),window.tagz=l}},tagger:{sanitize:function(e){return p.trim(e).replace(/,/g,"")},addLockedItem:function(e){e=p.trim(e);var t=u.get(e),o=t&&!t.locked;t&&u.deleteItem(t.id),u.addItem({id:p.uid("item-"),title:e,key:u.getItemKey(e),locked:!0,assigned:o},!0)}},"{textfield} keydown":function(e,t){var o=t.which,n=d.activeItem;switch(o){case g:case r:case f:case h:var a=v[o];(0<n.length||"down"==a)&&(c.navigate(a),t.preventDefault());break;case m:0<n.length?d.deactivate(n):l.suggestions().hasClass("is-showing")?c.collapse():e.val("");break;case s:if(0<n.length)return d.use(n),void t.preventDefault();i.readOnly&&t.preventDefault();break;default:c.populateFromTextfield()}},"{item} mouseover":function(e){d.deactivate(),d.activate(e)},"{item} mouseout":function(e){d.deactivate()},"{item} click":function(e){d.use(e)},"{textboxlist} addItem":function(e,t,o){p(d.get(o.title)).addClass("is-used")},"{textboxlist} removeItem":function(e,t,o){o.assigned?u.addItem(o.title):p(d.get(o.title)).removeClass("is-used")},"{textboxlist} listChange":p.debounce(function(){c.refresh();var e=l.tagger.getAddedItems().length;l.count().text(e)},15),"{self} categoryselect":function(e,t,o){o.tags.length<=0||(o=(o.tags||"").split(","),p.each(o,function(e,t){u.addLockedItem(t)}))},"{self} categorydeselect":function(e,t,o,n){o.tags.length<=0||(o=(o.tags||"").split(","),n=p.pluck(n,"tags").join(",").split(","),n=p.without.apply(null,[o].concat(n)),p.each(n,function(e,t){t=u.get(t);t&&u.removeItem(t.id)}))},"{toggleButton} click":function(e){c[l.suggestions().hasClass("is-showing")?"collapse":"expand"]()},"{autofillButton} click":function(e){var t=l.composer.document.getText(),o=p(e).parent();p(o).addClass("is-loading"),EasyBlog.ajax("site/views/composer/suggestKeywords",{data:t}).done(function(e){p(o).removeClass("is-loading"),e&&p.each(e,function(e,t){u.addItem(t.title)})}).fail(function(e){p(o).removeClass("is-loading"),EasyBlog.dialog({content:EasyBlog.ajax("site/views/composer/errorSuggestTagAutoFill",{errorMsg:e})})})},suggestions:{index:0,tags:[],expand:function(){c.tick++,l.suggestions().addClass("is-showing")},collapse:function(){c.tick++,l.suggestions().removeClass("is-showing")},refresh:function(){var e=l.item(":not(.is-used)");l.suggestions().toggleClass("is-empty",e.length<1),c.count()},show:function(){c.tick++,c.refresh(),c.expand()},hide:function(){var e=++c.tick;c.collapse(),setTimeout(function(){e===c.tick&&c.reset()},500)},set:function(e){e.length<1?(c.hide(),c.tags=[]):(c.reset(),c.tags=e)},reset:function(){c.tags=[],c.i=0,l.itemgroup().empty()},pid:0,tick:0,currentQuery:null,query:p.memoize(function(e){return EasyBlog.ajax("site/views/tags/suggest",{search:e}).fail(function(){c.query.cache.delete(e)})}),populate:function(e,t){c.tick++;var o=++c.pid;c.currentQuery&&c.currentQuery.abort(),e=u.sanitize(e),l.suggestions().addClass("is-busy"),c.currentQuery=c.query(e).done(function(e){c.pid===o&&(c.set(e),c.suggest(t))}).fail(function(){c.pid}).always(function(){l.suggestions().removeClass("is-busy"),c.currentQuery=null})},populateTimer:null,populateFromTextfield:function(){c.tick++,clearTimeout(c.populateTimer),setTimeout(function(){var e=l.textfield(),t=u.sanitize(e.val());""===t?(c.hide(),c.populate("",!0)):c.query.cache.hasOwnProperty(t)?c.populate(t):c.populateTimer=setTimeout(function(){c.populate(t)},250)},1)},suggest:function(e){var t=c.tags;if(!(t.length<1)){for(var o,n,a,i=0,r=t.length,s=[];i<r&&(o=t[c.i]);)n=o.title,a=d.get(n)||d.create(n),s.push(a),u.get(n)?p(a).addClass("is-used"):i++,c.i++;l.itemgroup().append(s),e?c.refresh():c.show()}},navigate:function(e){var t=l.item(),o=l.itemgroup(),n=d.activeItem,t=p(n[0]||l.textfield()[0]).nearest(t,e);0<t.length?(d.activate(t),o.scrollIntoView(t)):0<n.length&&("down"==e&&(c.suggest(),o.scrollIntoView(n)),"up"==e&&d.deactivate())},count:function(){var e=p.pluck(c.tags,"title"),t=p.keys(u.itemsByTitle),t=p.without.apply(null,[e].concat(t)).length;l.total().text(t+"")}},selection:{items:{},activeItem:p(),create:function(e){var t=document.createElement("div");return t.innerHTML=e,d.items[e]=t},get:function(e){return d.items[e]},activate:function(e){d.deactivate(),d.activeItem=e.addClass("active")},deactivate:function(e){d.activeItem.removeClass("active"),d.activeItem=p()},use:function(e){var t=(e=p(e)).text();u.addItem(t)&&(l.textfield().focus(),e.is(d.activeItem)&&(nextItem=e.next(l.item)[0]||e.prev(l.item)[0],d.deactivate(e),nextItem&&d.activate(p(nextItem))),c.refresh(),l.textfield().val(""))}},"{self} composerSave":function(e,t,o){var n;"0"!=EasyBlog.Composer.options.tags.enabled&&(n=l.tagger.getAddedItems(),o.data.tags=p.pluck(n,"title").join(","),l.tagsInput().val(o.data.tags))}}}),e.resolve()})}),EasyBlog.module("composer/templates",function(s){EasyBlog.Controller("Composer.Templates",{defaultOptions:{"{updateTemplate}":"[data-eb-composer-update-template-button]","{templateId}":"[data-eb-composer-template-id]","{saveNewTemplate}":"[data-eb-composer-save-template-button]","{closeTemplateSelector}":"[data-template-close-popup]","{selectTemplate}":"[data-template-item]","{templateBlocks}":"[data-template-blocks]","{deleteTemplate}":"[data-template-delete]","{selectGoogleImport}":"[data-template-googleimport]","{posts}":"[data-eb-composer-posts]","{searchTextfield}":"[data-eb-composer-posts-search-textfield]","{itemGroup}":"[data-eb-composer-posts-item-group]","{list}":"[data-eb-composer-templates-list]"}},function(i,e,t,r){return{init:function(){r=i.composer},"{selectGoogleImport} click":function(e){r.manager().removeClass("show-templates"),s("[data-eb-googleimport]").removeClass("t-hidden"),r.manager().addClass("show-googleimport"),r.googleimport.initOauthPopUp()},"{closeTemplateSelector} click":function(e){var t=i.selectTemplate("[data-blank=1]").data("uid");i.trigger("composerSelectTemplate",[t])},"{selectTemplate} click":function(e){var a=e.data("uid");e.data("blank")?i.trigger("composerSelectTemplate",[a,!1]):EasyBlog.ajax("site/views/composer/renderTemplate",{uid:a}).done(function(e,t,o,n){s("[data-eb-composer-views]").data("post-template-is-locked",n),s("[data-eb-composer-post-template-id]").val(a),o&&(r.document.isLegacy()?r.document.insertContent(o):r.document.loadDocument(o)),n&&(s("[data-toolbar-blocks-wrapper]").remove(),s("[data-eb-composer-media]").remove(),s('[data-toolbar-view][data-type="posts"]').remove()),i.trigger("composerSelectTemplate",[a,t])})},"{deleteTemplate} click":function(e,t){t.stopPropagation();var o=e.parents(i.selectTemplate.selector),n=o.data("uid");EasyBlog.dialog({content:EasyBlog.ajax("site/views/templates/confirmDelete",{id:n,deleteAction:"ajax"}),bindings:{"{submitButton} click":function(){EasyBlog.ajax("site/controllers/templates/delete",{ids:[n]}).done(function(){EasyBlog.dialog().close(),o.remove()})}}})}}}),this.resolve()}),EasyBlog.module("composer/vendors/colorpicker",function(p){var e=".colorpicker-h-panel",t=".colorpicker-sb-panel",o=".colorpicker-hex-input",n={color:"#000000",document:document};p.fn.colorpicker=function(e){var t=(t=this.data("colorpicker"))||new a(this,e);return p.isString(e)?t[e].apply(t,p.makeArray(arguments).slice(1)):this};var a=function(e,t){this.options=p.extend({},n,t),this.element=e,this.init(),e.data("colorpicker",this)};p.extend(a.prototype,{init:function(){this.initHPanel(),this.initSBPanel(),this.initHexInput(),this.silent=!0,this.setHex(this.options.color),this.silent=!1},initHPanel:function(){var l=this;l.generateHueColors(),l.element.on(p.ns("mousedown",".colorpicker.h"),e,function(e){e.preventDefault();function t(e){e=(p.getPointerPosition(e).y-i)/r,a.css({top:100*(e=1<(e=e<0?0:e)?1:e)+"%"}),e=l.getHsb(),l.setHsb(e)}var o=l.hsbPanel(),n=l.hPanel(),a=l.hHandle(),i=n.offset().top,r=n.height();o.addClass("adjusting-h"),t(e);var s=p(l.options.document);s.on(p.ns("mousemove touchmove",".colorpicker.h"),function(e){e.preventDefault(),t(e)}).on(p.ns("mouseup touchend",".colorpicker.h"),function(e){e.preventDefault(),o.removeClass("adjusting-h"),s.off(p.ns("mousemove mouseup touchend",".colorpicker.h"))})})},destroyHPanel:function(){this.element.off(p.ns("mousedown",".colorpicker.h"))},generateHueColors:function(){var e=this.hPanel(),t=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if(p.IE<=9)for(var o,n=0;n<=11;n++)o=p('<div class="colorpicker-hue-stop"></div>').attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+t[n]+", endColorstr="+t[n+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+t[n]+", endColorstr="+t[n+1]+')";'),e.append(o);else stopList=t.join(","),e.attr("style","background:-webkit-linear-gradient(top,"+stopList+"); background: -o-linear-gradient(top,"+stopList+"); background: -ms-linear-gradient(top,"+stopList+"); background:-moz-linear-gradient(top,"+stopList+"); -webkit-linear-gradient(top,"+stopList+"); background:linear-gradient(to bottom,"+stopList+"); ")},initSBPanel:function(){var u=this;u.element.on(p.ns("mousedown",".colorpicker.sb"),t,function(e){function t(e){var e=(t=p.getPointerPosition(e)).x-r,t=t.y-s,e=e/l,t=t/c;a.css({top:100*(t=1<(t=t<0?0:t)?1:t)+"%",left:100*(e=1<(e=e<0?0:e)?1:e)+"%"}),e=u.getHsb(),u.setHsb(e)}var o=u.hsbPanel(),n=u.sbPanel(),a=u.sbHandle(),i=n.offset(),r=i.left,s=i.top,l=n.width(),c=n.height();o.addClass("adjusting-sb"),t(e);var d=p(u.options.document);d.on(p.ns("mousemove touchmove",".colorpicker.sb"),function(e){e.preventDefault(),t(e)}).on(p.ns("mouseup touchend",".colorpicker.sb"),function(){e.preventDefault(),o.removeClass("adjusting-sb"),d.off(p.ns("mousemove mouseup touchend",".colorpicker.sb"))})})},destroySBPanel:function(){this.element.off(p.ns("mousedown",".colorpicker.sb"))},initHexInput:function(){var n=this;n.element.on("input",o,function(e){var t=p.fixHex(p.trim(n.hexInput().val().replace(/\#/g,"")));n.setHex(t)}).on("focusin",o,function(e){n.hexInput().addClass("is-focused")}).on("focusout",o,function(e){var t=n.hexInput(),o=t.data("value");t.removeClass("is-focused").val(o)})},setHsb:function(e){var t=this.hsbPanel();t.hasClass("adjusting-h")||t.hasClass("adjusting-sb")||this.hHandle().css({top:100*(1-e.h/360)+"%"}),t.hasClass("adjusting-sb")||this.sbPanel().css({background:"#"+p.hsbToHex({h:e.h,s:100,b:100})}),this.sbHandle().css({left:e.s+"%",top:100-e.b+"%"});var o="#"+p.hsbToHex(e),t=this.hexInput();t.data("value",o),t.hasClass("is-focused")||t.val(o),this.colorPreview().css("background",o),this.silent||this.element.trigger("colorpickerChange",o,e)},getHsb:function(){var e=this.hHandle();sbHandle=this.sbHandle();e={h:360*(1-parseFloat(e[0].style.top)/100),s:parseFloat(sbHandle[0].style.left),b:100-parseFloat(sbHandle[0].style.top)};return p.fixHsb(e)},setHex:function(e){e=e.replace(/\#/g,"");this.setHsb(p.hexToHsb(e))},getHex:function(){return"#"+p.hsbToHex(this.getHsb())},setRgb:function(e){var t;p.isString(e)&&(e={r:(t=e.match(/\d+/g))[0]||0,g:t[1]||0,b:t[2]||0}),this.setHsb(p.rgbToHsb(e))},getRgb:function(){return p.hsbToRgb(this.getHsb())},setColor:function(e){e.match(/^rgb/i)&&this.setRgb(e),e.match(/^\#/)&&this.setHex(e)},hsbPanel:function(){return this.element.find(".colorpicker-hsb-panel")},hPanel:function(){return this.element.find(e)},sbPanel:function(){return this.element.find(t)},hHandle:function(){return this.element.find(".colorpicker-h-handle")},sbHandle:function(){return this.element.find(".colorpicker-sb-handle")},colorPreview:function(){return this.element.find(".colorpicker-preview")},hexInput:function(){return this.element.find(o)},widget:function(){return this}}),this.resolve()}),EasyBlog.module("composer/vendors/cropper",function(e){var t,o,n=this;t=this,o=function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(t,e){var o,n=Object.keys(t);return Object.getOwnPropertySymbols&&(o=Object.getOwnPropertySymbols(t),e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)),n}function I(n){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach(function(e){var t,o;t=n,e=a[o=e],o in t?Object.defineProperty(t,o,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[o]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(a,e))})}return n}function E(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(o="Object"===o&&e.constructor?e.constructor.name:o)||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function p(e){return"number"==typeof e&&!re(e)}function i(e){return void 0===e}function r(e){return"object"===t(e)&&null!==e}function m(e){if(!r(e))return!1;try{var t=e.constructor,o=t.prototype;return t&&o&&se.call(o,"isPrototypeOf")}catch(e){return!1}}function c(e){return"function"==typeof e}function s(e){return Array.from?Array.from(e):le.call(e)}function T(o,n){return o&&c(n)&&(Array.isArray(o)||p(o.length)?s(o).forEach(function(e,t){n.call(o,e,t,o)}):r(o)&&Object.keys(o).forEach(function(e){n.call(o,o[e],e,o)})),o}function _(e,t){t=1<arguments.length&&void 0!==t?t:1e11;return de.test(e)?Math.round(e*t)/t:e}function f(e,t){var o=e.style;T(t,function(e,t){ue.test(t)&&p(e)&&(e="".concat(e,"px")),o[t]=e})}function d(e,t){var o;t&&(p(e.length)?T(e,function(e){d(e,t)}):e.classList?e.classList.add(t):(o=e.className.trim())?o.indexOf(t)<0&&(e.className="".concat(o," ").concat(t)):e.className=t)}function S(e,t){t&&(p(e.length)?T(e,function(e){S(e,t)}):e.classList?e.classList.remove(t):0<=e.className.indexOf(t)&&(e.className=e.className.replace(t,"")))}function l(e,t,o){t&&(p(e.length)?T(e,function(e){l(e,t,o)}):(o?d:S)(e,t))}function u(e){return e.replace(pe,"$1-$2").toLowerCase()}function h(e,t){return r(e[t])?e[t]:e.dataset?e.dataset[t]:e.getAttribute("data-".concat(u(t)))}function g(e,t,o){r(o)?e[t]=o:e.dataset?e.dataset[t]=o:e.setAttribute("data-".concat(u(t)),o)}function v(o,e,n,t){var a=3<arguments.length&&void 0!==t?t:{},i=n;e.trim().split(me).forEach(function(e){var t;fe||(t=o.listeners)&&t[e]&&t[e][n]&&(i=t[e][n],delete t[e][n],0===Object.keys(t[e]).length&&delete t[e],0===Object.keys(t).length&&delete o.listeners),o.removeEventListener(e,i,a)})}function b(i,e,r,t){var s=3<arguments.length&&void 0!==t?t:{},l=r;e.trim().split(me).forEach(function(n){var e,a;s.once&&!fe&&(e=i.listeners,l=function(){delete a[n][r],i.removeEventListener(n,l,s);for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];r.apply(i,t)},(a=void 0===e?{}:e)[n]||(a[n]={}),a[n][r]&&i.removeEventListener(n,a[n][r],s),a[n][r]=l,i.listeners=a),i.addEventListener(n,l,s)})}function y(e,t,o){var n;return c(Event)&&c(CustomEvent)?n=new CustomEvent(t,{detail:o,bubbles:!0,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,o),e.dispatchEvent(n)}function F(e){e=e.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}function k(e){e=e.match(ge);return null!==e&&(e[1]!==he.protocol||e[2]!==he.hostname||e[3]!==he.port)}function w(e){var t="timestamp=".concat((new Date).getTime());return e+(-1===e.indexOf("?")?"?":"&")+t}function C(e){var t=e.rotate,o=e.scaleX,n=e.scaleY,a=e.translateX,i=e.translateY,e=[];p(a)&&0!==a&&e.push("translateX(".concat(a,"px)")),p(i)&&0!==i&&e.push("translateY(".concat(i,"px)")),p(t)&&0!==t&&e.push("rotate(".concat(t,"deg)")),p(o)&&1!==o&&e.push("scaleX(".concat(o,")")),p(n)&&1!==n&&e.push("scaleY(".concat(n,")"));e=e.length?e.join(" "):"none";return{WebkitTransform:e,msTransform:e,transform:e}}function B(e,t){var o=e.pageX,n=e.pageY,e={endX:o,endY:n};return t?e:I({startX:o,startY:n},e)}function M(e,t){var o=e.aspectRatio,n=e.height,a=e.width,i=1<arguments.length&&void 0!==t?t:"contain",r=P(a),e=P(n);return r&&e?(t=n*o,"contain"===i&&a<t||"cover"===i&&t<a?n=a/o:a=n*o):r?n=a/o:e&&(a=n*o),{width:a,height:n}}function x(e){var t,o,n,a,i,r,s,l=new DataView(e);try{if(255===l.getUint8(0)&&216===l.getUint8(1))for(var c=l.byteLength,d=2;d+1<c;){if(255===l.getUint8(d)&&225===l.getUint8(d+1)){o=d;break}d+=1}if(o&&(a=o+10,"Exif"===function(e,t,o){var n="";o+=t;for(var a=t;a<o;a+=1)n+=ve(e.getUint8(a));return n}(l,o+4,4)&&(!(s=18761===(i=l.getUint16(a)))&&19789!==i||42!==l.getUint16(a+2,s)||8<=(r=l.getUint32(a+4,s))&&(n=a+r))),n)for(var u,p=l.getUint16(n,s),m=0;m<p;m+=1)if(u=n+12*m+2,274===l.getUint16(u,s)){u+=8,t=l.getUint16(u,s),l.setUint16(u,1,s);break}}catch(e){t=1}return t}function P(e){return 0<e&&e<1/0}var z,e,D="undefined"!=typeof window&&void 0!==window.document,L=D?window:{},A=!(!D||!L.document.documentElement)&&"ontouchstart"in L.document.documentElement,H=D&&"PointerEvent"in L,O="cropper",U="".concat(O,"-crop"),j="".concat(O,"-disabled"),$="".concat(O,"-hidden"),N="".concat(O,"-hide"),R="".concat(O,"-invisible"),W="".concat(O,"-modal"),V="".concat(O,"-move"),q="".concat(O,"Action"),G="".concat(O,"Preview"),Q="cropend",X="cropmove",K="cropstart",Y=H?"pointerdown":A?"touchstart":"mousedown",J=H?"pointermove":A?"touchmove":"mousemove",Z=H?"pointerup pointercancel":A?"touchend touchcancel":"mouseup",ee="image/jpeg",te=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,oe=/^data:/,ne=/^data:image\/jpeg;base64,/,ae=/^img|canvas$/i,ie={viewMode:0,dragMode:"crop",initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},re=Number.isNaN||L.isNaN,se=Object.prototype.hasOwnProperty,le=Array.prototype.slice,ce=Object.assign||function(o){for(var e=arguments.length,t=new Array(1<e?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return r(o)&&0<t.length&&t.forEach(function(t){r(t)&&Object.keys(t).forEach(function(e){o[e]=t[e]})}),o},de=/\.\d*(?:0|9){12}\d*$/,ue=/^width|height|left|top|marginLeft|marginTop$/,pe=/([a-z\d])([A-Z])/g,me=/\s\s*/,fe=(e=!1,D&&(z=!1,we=function(){},Be=Object.defineProperty({},"once",{get:function(){return e=!0,z},set:function(e){z=e}}),L.addEventListener("test",we,Be),L.removeEventListener("test",we,Be)),e),he=L.location,ge=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i,ve=String.fromCharCode,be=/^data:.*,/,ye={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,t=this.options,o=this.container,n=this.cropper,a=Number(t.minContainerWidth),t=Number(t.minContainerHeight);d(n,$),S(e,$);t={width:Math.max(o.offsetWidth,0<=a?a:200),height:Math.max(o.offsetHeight,0<=t?t:100)};f(n,{width:(this.containerData=t).width,height:t.height}),d(e,$),S(n,$)},initCanvas:function(){var e=this.containerData,t=this.imageData,o=this.options.viewMode,n=Math.abs(t.rotate)%180==90,a=n?t.naturalHeight:t.naturalWidth,i=n?t.naturalWidth:t.naturalHeight,r=a/i,n=e.width,t=e.height;e.height*r>e.width?3===o?n=e.height*r:t=e.width/r:3===o?t=e.width/r:n=e.height*r;t={aspectRatio:r,naturalWidth:a,naturalHeight:i,width:n,height:t};this.canvasData=t,this.limited=1===o||2===o,this.limitCanvas(!0,!0),t.width=Math.min(Math.max(t.width,t.minWidth),t.maxWidth),t.height=Math.min(Math.max(t.height,t.minHeight),t.maxHeight),t.left=(e.width-t.width)/2,t.top=(e.height-t.height)/2,t.oldLeft=t.left,t.oldTop=t.top,this.initialCanvasData=ce({},t)},limitCanvas:function(e,t){var o,n=this.options,a=this.containerData,i=this.canvasData,r=this.cropBoxData,s=n.viewMode,l=i.aspectRatio,c=this.cropped&&r;e&&(e=Number(n.minCanvasWidth)||0,o=Number(n.minCanvasHeight)||0,1<s?(e=Math.max(e,a.width),o=Math.max(o,a.height),3===s&&(e<o*l?e=o*l:o=e/l)):0<s&&(e?e=Math.max(e,c?r.width:0):o?o=Math.max(o,c?r.height:0):c&&((e=r.width)<(o=r.height)*l?e=o*l:o=e/l)),e=(l=M({aspectRatio:l,width:e,height:o})).width,o=l.height,i.minWidth=e,i.minHeight=o,i.maxWidth=1/0,i.maxHeight=1/0),t&&((c?0:1)<s?(o=a.width-i.width,t=a.height-i.height,i.minLeft=Math.min(0,o),i.minTop=Math.min(0,t),i.maxLeft=Math.max(0,o),i.maxTop=Math.max(0,t),c&&this.limited&&(i.minLeft=Math.min(r.left,r.left+(r.width-i.width)),i.minTop=Math.min(r.top,r.top+(r.height-i.height)),i.maxLeft=r.left,i.maxTop=r.top,2===s&&(i.width>=a.width&&(i.minLeft=Math.min(0,o),i.maxLeft=Math.max(0,o)),i.height>=a.height&&(i.minTop=Math.min(0,t),i.maxTop=Math.max(0,t))))):(i.minLeft=-i.width,i.minTop=-i.height,i.maxLeft=a.width,i.maxTop=a.height))},renderCanvas:function(e,t){var o,n,a=this.canvasData,i=this.imageData;t&&(o=(n=function(e){var t=e.width,o=e.height,n=e.degree;if(90==(n=Math.abs(n)%180))return{width:o,height:t};var a=n%90*Math.PI/180,i=Math.sin(a),e=Math.cos(a),a=t*e+o*i,e=t*i+o*e;return 90<n?{width:e,height:a}:{width:a,height:e}}({width:i.naturalWidth*Math.abs(i.scaleX||1),height:i.naturalHeight*Math.abs(i.scaleY||1),degree:i.rotate||0})).width,t=n.height,i=a.width*(o/a.naturalWidth),n=a.height*(t/a.naturalHeight),a.left-=(i-a.width)/2,a.top-=(n-a.height)/2,a.width=i,a.height=n,a.aspectRatio=o/t,a.naturalWidth=o,a.naturalHeight=t,this.limitCanvas(!0,!1)),(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCanvas(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,f(this.canvas,ce({width:a.width,height:a.height},C({translateX:a.left,translateY:a.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var t=this.canvasData,o=this.imageData,n=o.naturalWidth*(t.width/t.naturalWidth),a=o.naturalHeight*(t.height/t.naturalHeight);ce(o,{width:n,height:a,left:(t.width-n)/2,top:(t.height-a)/2}),f(this.image,ce({width:o.width,height:o.height},C(ce({translateX:o.left,translateY:o.top},o)))),e&&this.output()},initCropBox:function(){var e=this.options,t=this.canvasData,o=e.aspectRatio||e.initialAspectRatio,n=Number(e.autoCropArea)||.8,e={width:t.width,height:t.height};o&&(t.height*o>t.width?e.height=e.width/o:e.width=e.height*o),this.cropBoxData=e,this.limitCropBox(!0,!0),e.width=Math.min(Math.max(e.width,e.minWidth),e.maxWidth),e.height=Math.min(Math.max(e.height,e.minHeight),e.maxHeight),e.width=Math.max(e.minWidth,e.width*n),e.height=Math.max(e.minHeight,e.height*n),e.left=t.left+(t.width-e.width)/2,e.top=t.top+(t.height-e.height)/2,e.oldLeft=e.left,e.oldTop=e.top,this.initialCropBoxData=ce({},e)},limitCropBox:function(e,t){var o,n,a=this.options,i=this.containerData,r=this.canvasData,s=this.cropBoxData,l=this.limited,c=a.aspectRatio;e&&(o=Number(a.minCropBoxWidth)||0,n=Number(a.minCropBoxHeight)||0,e=l?Math.min(i.width,r.width,r.width+r.left,i.width-r.left):i.width,a=l?Math.min(i.height,r.height,r.height+r.top,i.height-r.top):i.height,o=Math.min(o,i.width),n=Math.min(n,i.height),c&&(o&&n?o<n*c?n=o/c:o=n*c:o?n=o/c:n&&(o=n*c),e<a*c?a=e/c:e=a*c),s.minWidth=Math.min(o,e),s.minHeight=Math.min(n,a),s.maxWidth=e,s.maxHeight=a),t&&(l?(s.minLeft=Math.max(0,r.left),s.minTop=Math.max(0,r.top),s.maxLeft=Math.min(i.width,r.left+r.width)-s.width,s.maxTop=Math.min(i.height,r.top+r.height)-s.height):(s.minLeft=0,s.minTop=0,s.maxLeft=i.width-s.width,s.maxTop=i.height-s.height))},renderCropBox:function(){var e=this.options,t=this.containerData,o=this.cropBoxData;(o.width>o.maxWidth||o.width<o.minWidth)&&(o.left=o.oldLeft),(o.height>o.maxHeight||o.height<o.minHeight)&&(o.top=o.oldTop),o.width=Math.min(Math.max(o.width,o.minWidth),o.maxWidth),o.height=Math.min(Math.max(o.height,o.minHeight),o.maxHeight),this.limitCropBox(!1,!0),o.left=Math.min(Math.max(o.left,o.minLeft),o.maxLeft),o.top=Math.min(Math.max(o.top,o.minTop),o.maxTop),o.oldLeft=o.left,o.oldTop=o.top,e.movable&&e.cropBoxMovable&&g(this.face,q,o.width>=t.width&&o.height>=t.height?"move":"all"),f(this.cropBox,ce({width:o.width,height:o.height},C({translateX:o.left,translateY:o.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),y(this.element,"crop",this.getData())}},ke={initPreview:function(){var e=this.element,o=this.crossOrigin,t=this.options.preview,n=o?this.crossOriginUrl:this.url,a=e.alt||"The image to preview",i=document.createElement("img");o&&(i.crossOrigin=o),i.src=n,i.alt=a,this.viewBox.appendChild(i),this.viewBoxImage=i,t&&("string"==typeof(i=t)?i=e.ownerDocument.querySelectorAll(t):t.querySelector&&(i=[t]),T(this.previews=i,function(e){var t=document.createElement("img");g(e,G,{width:e.offsetWidth,height:e.offsetHeight,html:e.innerHTML}),o&&(t.crossOrigin=o),t.src=n,t.alt=a,t.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',e.innerHTML="",e.appendChild(t)}))},resetPreview:function(){T(this.previews,function(e){var t=h(e,G);f(e,{width:t.width,height:t.height}),e.innerHTML=t.html,function(t,o){if(r(t[o]))try{delete t[o]}catch(e){t[o]=void 0}else if(t.dataset)try{delete t.dataset[o]}catch(e){t.dataset[o]=void 0}else t.removeAttribute("data-".concat(u(o)))}(e,G)})},preview:function(){var r=this.imageData,e=this.canvasData,t=this.cropBoxData,s=t.width,l=t.height,c=r.width,d=r.height,u=t.left-e.left-r.left,p=t.top-e.top-r.top;this.cropped&&!this.disabled&&(f(this.viewBoxImage,ce({width:c,height:d},C(ce({translateX:-u,translateY:-p},r)))),T(this.previews,function(e){var t=h(e,G),o=t.width,n=t.height,a=o,i=n,t=1;s&&(i=l*(t=o/s)),l&&n<i&&(a=s*(t=n/l),i=n),f(e,{width:a,height:i}),f(e.getElementsByTagName("img")[0],ce({width:c*t,height:d*t},C(ce({translateX:-u*t,translateY:-p*t},r))))}))}},H={bind:function(){var e=this.element,t=this.options,o=this.cropper;c(t.cropstart)&&b(e,K,t.cropstart),c(t.cropmove)&&b(e,X,t.cropmove),c(t.cropend)&&b(e,Q,t.cropend),c(t.crop)&&b(e,"crop",t.crop),c(t.zoom)&&b(e,"zoom",t.zoom),b(o,Y,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&b(o,"wheel",this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&b(o,"dblclick",this.onDblclick=this.dblclick.bind(this)),b(e.ownerDocument,J,this.onCropMove=this.cropMove.bind(this)),b(e.ownerDocument,Z,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&b(window,"resize",this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,t=this.options,o=this.cropper;c(t.cropstart)&&v(e,K,t.cropstart),c(t.cropmove)&&v(e,X,t.cropmove),c(t.cropend)&&v(e,Q,t.cropend),c(t.crop)&&v(e,"crop",t.crop),c(t.zoom)&&v(e,"zoom",t.zoom),v(o,Y,this.onCropStart),t.zoomable&&t.zoomOnWheel&&v(o,"wheel",this.onWheel,{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&v(o,"dblclick",this.onDblclick),v(e.ownerDocument,J,this.onCropMove),v(e.ownerDocument,Z,this.onCropEnd),t.responsive&&v(window,"resize",this.onResize)}},A={resize:function(){var e,t,o,n,a,i;this.disabled||(e=this.options,t=this.container,o=this.containerData,1==(n=t.offsetWidth/o.width)&&t.offsetHeight===o.height||(e.restore&&(a=this.getCanvasData(),i=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(T(a,function(e,t){a[t]=e*n})),this.setCropBoxData(T(i,function(e,t){i[t]=e*n})))))},dblclick:function(){var e,t;this.disabled||"none"===this.options.dragMode||this.setDragMode((e=this.dragBox,t=U,(e.classList?e.classList.contains(t):-1<e.className.indexOf(t))?"move":"crop"))},wheel:function(e){var t=this,o=Number(this.options.wheelZoomRatio)||.1,n=1;this.disabled||(e.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout(function(){t.wheeling=!1},50),e.deltaY?n=0<e.deltaY?1:-1:e.wheelDelta?n=-e.wheelDelta/120:e.detail&&(n=0<e.detail?1:-1),this.zoom(-n*o,e)))},cropStart:function(e){var t,o=e.buttons,n=e.button;this.disabled||("mousedown"===e.type||"pointerdown"===e.type&&"mouse"===e.pointerType)&&(p(o)&&1!==o||p(n)&&0!==n||e.ctrlKey)||(n=this.options,t=this.pointers,e.changedTouches?T(e.changedTouches,function(e){t[e.identifier]=B(e)}):t[e.pointerId||0]=B(e),n=1<Object.keys(t).length&&n.zoomable&&n.zoomOnTouch?"zoom":h(e.target,q),te.test(n)&&!1!==y(this.element,K,{originalEvent:e,action:n})&&(e.preventDefault(),this.action=n,this.cropping=!1,"crop"===n&&(this.cropping=!0,d(this.dragBox,W))))},cropMove:function(e){var t,o=this.action;!this.disabled&&o&&(t=this.pointers,e.preventDefault(),!1!==y(this.element,X,{originalEvent:e,action:o})&&(e.changedTouches?T(e.changedTouches,function(e){ce(t[e.identifier]||{},B(e,!0))}):ce(t[e.pointerId||0]||{},B(e,!0)),this.change(e)))},cropEnd:function(e){var t,o;this.disabled||(t=this.action,o=this.pointers,e.changedTouches?T(e.changedTouches,function(e){delete o[e.identifier]}):delete o[e.pointerId||0],t&&(e.preventDefault(),Object.keys(o).length||(this.action=""),this.cropping&&(this.cropping=!1,l(this.dragBox,W,this.cropped&&this.options.modal)),y(this.element,Q,{originalEvent:e,action:t})))}},D={change:function(e){var t=this.options,o=this.canvasData,n=this.containerData,a=this.cropBoxData,i=this.pointers,r=this.action,s=t.aspectRatio,l=a.left,c=a.top,d=a.width,u=a.height,p=l+d,m=c+u,f=0,h=0,g=n.width,v=n.height,b=!0;!s&&e.shiftKey&&(s=d&&u?d/u:1),this.limited&&(f=a.minLeft,h=a.minTop,g=f+Math.min(n.width,o.width,o.left+o.width),v=h+Math.min(n.height,o.height,o.top+o.height));function y(e){switch(e){case"e":p+x.x>g&&(x.x=g-p);break;case"w":l+x.x<f&&(x.x=f-l);break;case"n":c+x.y<h&&(x.y=h-c);break;case"s":m+x.y>v&&(x.y=v-m)}}var k,w,C,B=i[Object.keys(i)[0]],x={x:B.endX-B.startX,y:B.endY-B.startY};switch(r){case"all":l+=x.x,c+=x.y;break;case"e":if(0<=x.x&&(g<=p||s&&(c<=h||v<=m))){b=!1;break}y("e"),(d+=x.x)<0&&(r="w",l-=d=-d),s&&(c+=(a.height-(u=d/s))/2);break;case"n":if(x.y<=0&&(c<=h||s&&(l<=f||g<=p))){b=!1;break}y("n"),u-=x.y,c+=x.y,u<0&&(r="s",c-=u=-u),s&&(l+=(a.width-(d=u*s))/2);break;case"w":if(x.x<=0&&(l<=f||s&&(c<=h||v<=m))){b=!1;break}y("w"),d-=x.x,l+=x.x,d<0&&(r="e",l-=d=-d),s&&(c+=(a.height-(u=d/s))/2);break;case"s":if(0<=x.y&&(v<=m||s&&(l<=f||g<=p))){b=!1;break}y("s"),(u+=x.y)<0&&(r="n",c-=u=-u),s&&(l+=(a.width-(d=u*s))/2);break;case"ne":if(s){if(x.y<=0&&(c<=h||g<=p)){b=!1;break}y("n"),u-=x.y,c+=x.y,d=u*s}else y("n"),y("e"),!(0<=x.x)||p<g?d+=x.x:x.y<=0&&c<=h&&(b=!1),x.y<=0&&!(h<c)||(u-=x.y,c+=x.y);d<0&&u<0?(r="sw",c-=u=-u,l-=d=-d):d<0?(r="nw",l-=d=-d):u<0&&(r="se",c-=u=-u);break;case"nw":if(s){if(x.y<=0&&(c<=h||l<=f)){b=!1;break}y("n"),u-=x.y,c+=x.y,l+=a.width-(d=u*s)}else y("n"),y("w"),!(x.x<=0)||f<l?(d-=x.x,l+=x.x):x.y<=0&&c<=h&&(b=!1),x.y<=0&&!(h<c)||(u-=x.y,c+=x.y);d<0&&u<0?(r="se",c-=u=-u,l-=d=-d):d<0?(r="ne",l-=d=-d):u<0&&(r="sw",c-=u=-u);break;case"sw":if(s){if(x.x<=0&&(l<=f||v<=m)){b=!1;break}y("w"),d-=x.x,l+=x.x,u=d/s}else y("s"),y("w"),!(x.x<=0)||f<l?(d-=x.x,l+=x.x):0<=x.y&&v<=m&&(b=!1),0<=x.y&&!(m<v)||(u+=x.y);d<0&&u<0?(r="ne",c-=u=-u,l-=d=-d):d<0?(r="se",l-=d=-d):u<0&&(r="nw",c-=u=-u);break;case"se":if(s){if(0<=x.x&&(g<=p||v<=m)){b=!1;break}y("e"),u=(d+=x.x)/s}else y("s"),y("e"),!(0<=x.x)||p<g?d+=x.x:0<=x.y&&v<=m&&(b=!1),0<=x.y&&!(m<v)||(u+=x.y);d<0&&u<0?(r="nw",c-=u=-u,l-=d=-d):d<0?(r="sw",l-=d=-d):u<0&&(r="ne",c-=u=-u);break;case"move":this.move(x.x,x.y),b=!1;break;case"zoom":this.zoom((w=I({},k=i),C=0,T(k,function(a,e){delete w[e],T(w,function(e){var t=Math.abs(a.startX-e.startX),o=Math.abs(a.startY-e.startY),n=Math.abs(a.endX-e.endX),e=Math.abs(a.endY-e.endY),o=Math.sqrt(t*t+o*o),o=(Math.sqrt(n*n+e*e)-o)/o;Math.abs(o)>Math.abs(C)&&(C=o)})}),C),e),b=!1;break;case"crop":if(!x.x||!x.y){b=!1;break}k=F(this.cropper),l=B.startX-k.left,c=B.startY-k.top,d=a.minWidth,u=a.minHeight,0<x.x?r=0<x.y?"se":"ne":x.x<0&&(l-=d,r=0<x.y?"sw":"nw"),x.y<0&&(c-=u),this.cropped||(S(this.cropBox,$),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}b&&(a.width=d,a.height=u,a.left=l,a.top=c,this.action=r,this.renderCropBox()),T(i,function(e){e.startX=e.endX,e.startY=e.endY})}},we={crop:function(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&d(this.dragBox,W),S(this.cropBox,$),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=ce({},this.initialImageData),this.canvasData=ce({},this.initialCanvasData),this.cropBoxData=ce({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(ce(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),S(this.dragBox,W),d(this.cropBox,$)),this},replace:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&t&&(this.isImg&&(this.element.src=t),e?(this.url=t,this.image.src=t,this.ready&&(this.viewBoxImage.src=t,T(this.previews,function(e){e.getElementsByTagName("img")[0].src=t}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(t))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,S(this.cropper,j)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,d(this.cropper,j)),this},destroy:function(){var e=this.element;return e[O]&&(e[O]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate()),this},move:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,o=this.canvasData,n=o.left,o=o.top;return this.moveTo(i(e)?e:n+Number(e),i(t)?t:o+Number(t))},moveTo:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,o=this.canvasData,n=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.movable&&(p(e)&&(o.left=e,n=!0),p(t)&&(o.top=t,n=!0),n&&this.renderCanvas(!0)),this},zoom:function(e,t){var o=this.canvasData;return e=Number(e),this.zoomTo(o.width*(e=e<0?1/(1-e):1+e)/o.naturalWidth,null,t)},zoomTo:function(e,t,o){var n,a,i,r=this.options,s=this.canvasData,l=s.width,c=s.height,d=s.naturalWidth,u=s.naturalHeight;if(0<=(e=Number(e))&&this.ready&&!this.disabled&&r.zoomable){r=d*e,u=u*e;if(!1===y(this.element,"zoom",{ratio:e,oldRatio:l/d,originalEvent:o}))return this;o?(e=this.pointers,d=F(this.cropper),o=e&&Object.keys(e).length?(i=a=n=0,T(e,function(e){var t=e.startX,e=e.startY;n+=t,a+=e,i+=1}),{pageX:n/=i,pageY:a/=i}):{pageX:o.pageX,pageY:o.pageY},s.left-=(r-l)*((o.pageX-d.left-s.left)/l),s.top-=(u-c)*((o.pageY-d.top-s.top)/c)):m(t)&&p(t.x)&&p(t.y)?(s.left-=(r-l)*((t.x-s.left)/l),s.top-=(u-c)*((t.y-s.top)/c)):(s.left-=(r-l)/2,s.top-=(u-c)/2),s.width=r,s.height=u,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return p(e=Number(e))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var t=this.imageData.scaleY;return this.scale(e,p(t)?t:1)},scaleY:function(e){var t=this.imageData.scaleX;return this.scale(p(t)?t:1,e)},scale:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,o=this.imageData,n=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.scalable&&(p(e)&&(o.scaleX=e,n=!0),p(t)&&(o.scaleY=t,n=!0),n&&this.renderCanvas(!0,!0)),this},getData:function(){var o,n,e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this.options,a=this.imageData,i=this.canvasData,r=this.cropBoxData;return this.ready&&this.cropped?(o={x:r.left-i.left,y:r.top-i.top,width:r.width,height:r.height},n=a.width/a.naturalWidth,T(o,function(e,t){o[t]=e/n}),e&&(r=Math.round(o.y+o.height),e=Math.round(o.x+o.width),o.x=Math.round(o.x),o.y=Math.round(o.y),o.width=e-o.x,o.height=r-o.y)):o={x:0,y:0,width:0,height:0},t.rotatable&&(o.rotate=a.rotate||0),t.scalable&&(o.scaleX=a.scaleX||1,o.scaleY=a.scaleY||1),o},setData:function(e){var t,o=this.options,n=this.imageData,a=this.canvasData,i={};return this.ready&&!this.disabled&&m(e)&&(t=!1,o.rotatable&&p(e.rotate)&&e.rotate!==n.rotate&&(n.rotate=e.rotate,t=!0),o.scalable&&(p(e.scaleX)&&e.scaleX!==n.scaleX&&(n.scaleX=e.scaleX,t=!0),p(e.scaleY)&&e.scaleY!==n.scaleY&&(n.scaleY=e.scaleY,t=!0)),t&&this.renderCanvas(!0,!0),n=n.width/n.naturalWidth,p(e.x)&&(i.left=e.x*n+a.left),p(e.y)&&(i.top=e.y*n+a.top),p(e.width)&&(i.width=e.width*n),p(e.height)&&(i.height=e.height*n),this.setCropBoxData(i)),this},getContainerData:function(){return this.ready?ce({},this.containerData):{}},getImageData:function(){return this.sized?ce({},this.imageData):{}},getCanvasData:function(){var t=this.canvasData,o={};return this.ready&&T(["left","top","width","height","naturalWidth","naturalHeight"],function(e){o[e]=t[e]}),o},setCanvasData:function(e){var t=this.canvasData,o=t.aspectRatio;return this.ready&&!this.disabled&&m(e)&&(p(e.left)&&(t.left=e.left),p(e.top)&&(t.top=e.top),p(e.width)?(t.width=e.width,t.height=e.width/o):p(e.height)&&(t.height=e.height,t.width=e.height*o),this.renderCanvas(!0)),this},getCropBoxData:function(){var e,t=this.cropBoxData;return(e=this.ready&&this.cropped?{left:t.left,top:t.top,width:t.width,height:t.height}:e)||{}},setCropBoxData:function(e){var t,o,n=this.cropBoxData,a=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&m(e)&&(p(e.left)&&(n.left=e.left),p(e.top)&&(n.top=e.top),p(e.width)&&e.width!==n.width&&(t=!0,n.width=e.width),p(e.height)&&e.height!==n.height&&(o=!0,n.height=e.height),a&&(t?n.height=n.width/a:o&&(n.width=n.height*a)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var t,o,n,a,i,r,s,l,c,d,u,p,m,f=this.canvasData,r=(b=this.image,t=this.imageData,o=f,k=e,n=t.aspectRatio,a=t.naturalWidth,y=t.naturalHeight,i=void 0===(m=t.rotate)?0:m,r=void 0===(v=t.scaleX)?1:v,h=void 0===(u=t.scaleY)?1:u,s=o.aspectRatio,l=o.naturalWidth,c=o.naturalHeight,d=void 0===(p=k.fillColor)?"transparent":p,w=k.imageSmoothingEnabled,g=void 0===w||w,v=void 0===(m=k.imageSmoothingQuality)?"low":m,u=void 0===(t=k.maxWidth)?1/0:t,p=void 0===(o=k.maxHeight)?1/0:o,m=void 0===(w=k.minWidth)?0:w,o=void 0===(t=k.minHeight)?0:t,k=(w=document.createElement("canvas")).getContext("2d"),t=M({aspectRatio:s,width:u,height:p}),s=M({aspectRatio:s,width:m,height:o},"cover"),l=Math.min(t.width,Math.max(s.width,l)),c=Math.min(t.height,Math.max(s.height,c)),p=M({aspectRatio:n,width:u,height:p}),o=M({aspectRatio:n,width:m,height:o},"cover"),a=Math.min(p.width,Math.max(o.width,a)),y=Math.min(p.height,Math.max(o.height,y)),y=[-a/2,-y/2,a,y],w.width=_(l),w.height=_(c),k.fillStyle=d,k.fillRect(0,0,l,c),k.save(),k.translate(l/2,c/2),k.rotate(i*Math.PI/180),k.scale(r,h),k.imageSmoothingEnabled=g,k.imageSmoothingQuality=v,k.drawImage.apply(k,[b].concat(E(y.map(function(e){return Math.floor(_(e))})))),k.restore(),w);if(!this.cropped)return r;var h=this.getData(),g=h.x,v=h.y,b=h.width,y=h.height,k=r.width/Math.floor(f.naturalWidth);1!=k&&(g*=k,v*=k,b*=k,y*=k);var w=b/y,h=M({aspectRatio:w,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),f=M({aspectRatio:w,width:e.minWidth||0,height:e.minHeight||0},"cover"),w=M({aspectRatio:w,width:e.width||(1!=k?r.width:b),height:e.height||(1!=k?r.height:y)}),k=w.width,w=w.height,k=Math.min(h.width,Math.max(f.width,k)),w=Math.min(h.height,Math.max(f.height,w)),h=document.createElement("canvas"),f=h.getContext("2d");h.width=_(k),h.height=_(w),f.fillStyle=e.fillColor||"transparent",f.fillRect(0,0,k,w);w=e.imageSmoothingEnabled,e=e.imageSmoothingQuality;f.imageSmoothingEnabled=void 0===w||w,e&&(f.imageSmoothingQuality=e);var C,B,x,I,T,w=r.width,e=r.height,g=g,v=v;g<=-b||w<g?I=B=C=g=0:g<=0?(B=-g,g=0,I=C=Math.min(w,b+g)):g<=w&&(B=0,I=C=Math.min(b,w-g)),C<=0||v<=-y||e<v?T=x=S=v=0:v<=0?(x=-v,v=0,T=S=Math.min(e,y+v)):v<=e&&(x=0,T=S=Math.min(y,e-v));var S=[g,v,C,S];return 0<I&&0<T&&S.push(B*(b=k/b),x*b,I*b,T*b),f.drawImage.apply(f,[r].concat(E(S.map(function(e){return Math.floor(_(e))})))),h},setAspectRatio:function(e){var t=this.options;return this.disabled||i(e)||(t.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t,o,n=this.options,a=this.dragBox,i=this.face;return this.ready&&!this.disabled&&(o=n.movable&&"move"===e,n.dragMode=e=(t="crop"===e)||o?e:"none",g(a,q,e),l(a,U,t),l(a,V,o),n.cropBoxMovable||(g(i,q,e),l(i,U,t),l(i,V,o))),this}},Ce=L.Cropper,Be=function(){function o(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),!e||!ae.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=ce({},ie,m(t)&&t),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}var e,t,n;return e=o,n=[{key:"noConflict",value:function(){return window.Cropper=Ce,o}},{key:"setDefaults",value:function(e){ce(ie,m(e)&&e)}}],(t=[{key:"init",value:function(){var e,t=this.element,o=t.tagName.toLowerCase();if(!t[O]){if(t[O]=this,"img"===o){if(this.isImg=!0,e=t.getAttribute("src")||"",!(this.originalUrl=e))return;e=t.src}else"canvas"===o&&window.HTMLCanvasElement&&(e=t.toDataURL());this.load(e)}}},{key:"load",value:function(e){var t,o,n,a,i,r,s=this;e&&(this.url=e,this.imageData={},t=this.element,(o=this.options).rotatable||o.scalable||(o.checkOrientation=!1),o.checkOrientation&&window.ArrayBuffer?oe.test(e)?ne.test(e)?this.read((r=(r=e).replace(be,""),n=atob(r),r=new ArrayBuffer(n.length),T(a=new Uint8Array(r),function(e,t){a[t]=n.charCodeAt(t)}),r)):this.clone():(i=new XMLHttpRequest,r=this.clone.bind(this),this.reloading=!0,(this.xhr=i).onabort=r,i.onerror=r,i.ontimeout=r,i.onprogress=function(){i.getResponseHeader("content-type")!==ee&&i.abort()},i.onload=function(){s.read(i.response)},i.onloadend=function(){s.reloading=!1,s.xhr=null},o.checkCrossOrigin&&k(e)&&t.crossOrigin&&(e=w(e)),i.open("GET",e,!0),i.responseType="arraybuffer",i.withCredentials="use-credentials"===t.crossOrigin,i.send()):this.clone())}},{key:"read",value:function(e){var t=this.options,o=this.imageData,n=x(e),a=0,i=1,r=1;1<n&&(this.url=function(e,t){for(var o=[],n=new Uint8Array(e);0<n.length;)o.push(ve.apply(null,s(n.subarray(0,8192)))),n=n.subarray(8192);return"data:".concat(t,";base64,").concat(btoa(o.join("")))}(e,ee),a=(n=function(e){var t=0,o=1,n=1;switch(e){case 2:o=-1;break;case 3:t=-180;break;case 4:n=-1;break;case 5:t=90,n=-1;break;case 6:t=90;break;case 7:t=90,o=-1;break;case 8:t=-90}return{rotate:t,scaleX:o,scaleY:n}}(n)).rotate,i=n.scaleX,r=n.scaleY),t.rotatable&&(o.rotate=a),t.scalable&&(o.scaleX=i,o.scaleY=r),this.clone()}},{key:"clone",value:function(){var e=this.element,t=this.url,o=e.crossOrigin,n=t;this.options.checkCrossOrigin&&k(t)&&(o=o||"anonymous",n=w(t)),this.crossOrigin=o,this.crossOriginUrl=n;var a=document.createElement("img");o&&(a.crossOrigin=o),a.src=n||t,a.alt=e.alt||"The image to crop",(this.image=a).onload=this.start.bind(this),a.onerror=this.stop.bind(this),d(a,N),e.parentNode.insertBefore(a,e.nextSibling)}},{key:"start",value:function(){var o=this,e=this.image;e.onload=null,e.onerror=null,this.sizing=!0;function t(e,t){ce(o.imageData,{naturalWidth:e,naturalHeight:t,aspectRatio:e/t}),o.initialImageData=ce({},o.imageData),o.sizing=!1,o.sized=!0,o.build()}var n,a,i=L.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(L.navigator.userAgent);!e.naturalWidth||i?(n=document.createElement("img"),a=document.body||document.documentElement,(this.sizingImage=n).onload=function(){t(n.width,n.height),i||a.removeChild(n)},n.src=e.src,i||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",a.appendChild(n))):t(e.naturalWidth,e.naturalHeight)}},{key:"stop",value:function(){var e=this.image;e.onload=null,e.onerror=null,e.parentNode.removeChild(e),this.image=null}},{key:"build",value:function(){var e,t,o,n,a,i,r,s,l;this.sized&&!this.ready&&(e=this.element,t=this.options,o=this.image,n=e.parentNode,(l=document.createElement("div")).innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',i=(a=l.querySelector(".".concat(O,"-container"))).querySelector(".".concat(O,"-canvas")),r=a.querySelector(".".concat(O,"-drag-box")),l=(s=a.querySelector(".".concat(O,"-crop-box"))).querySelector(".".concat(O,"-face")),this.container=n,this.cropper=a,this.canvas=i,this.dragBox=r,this.cropBox=s,this.viewBox=a.querySelector(".".concat(O,"-view-box")),this.face=l,i.appendChild(o),d(e,$),n.insertBefore(a,e.nextSibling),this.isImg||S(o,N),this.initPreview(),this.bind(),t.initialAspectRatio=Math.max(0,t.initialAspectRatio)||NaN,t.aspectRatio=Math.max(0,t.aspectRatio)||NaN,t.viewMode=Math.max(0,Math.min(3,Math.round(t.viewMode)))||0,d(s,$),t.guides||d(s.getElementsByClassName("".concat(O,"-dashed")),$),t.center||d(s.getElementsByClassName("".concat(O,"-center")),$),t.background&&d(a,"".concat(O,"-bg")),t.highlight||d(l,R),t.cropBoxMovable&&(d(l,V),g(l,q,"all")),t.cropBoxResizable||(d(s.getElementsByClassName("".concat(O,"-line")),$),d(s.getElementsByClassName("".concat(O,"-point")),$)),this.render(),this.ready=!0,this.setDragMode(t.dragMode),t.autoCrop&&this.crop(),this.setData(t.data),c(t.ready)&&b(e,"ready",t.ready,{once:!0}),y(e,"ready"))}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),S(this.element,$))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}])&&a(e.prototype,t),n&&a(e,n),o}();return ce(Be.prototype,ye,ke,H,A,D,we),Be},"object"==typeof exports&&void 0!==n?n.exports=o():"function"==typeof define&&define.amd?define(o):(t="undefined"!=typeof globalThis?globalThis:t||self).Cropper=o(),n.resolve()}),EasyBlog.module("composer/vendors/dragselect",function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var t=function(){function y(e){var t=this,o=e.area,n=void 0===o?document:o,a=e.autoScrollSpeed,i=void 0===a?1:a,r=e.callback,s=void 0===r?function(){}:r,l=e.customStyles,c=void 0!==l&&l,d=e.hoverClass,u=void 0===d?"ds-hover":d,p=e.multiSelectKeys,m=void 0===p?["ctrlKey","shiftKey","metaKey"]:p,f=e.multiSelectMode,h=void 0!==f&&f,g=e.onDragMove,v=void 0===g?function(){}:g,b=e.onDragStart,o=void 0===b?function(){}:b,a=e.onDragStartBegin,r=void 0===a?function(){}:a,l=e.onElementSelect,d=void 0===l?function(){}:l,p=e.onElementUnselect,f=void 0===p?function(){}:p,g=e.selectableClass,b=void 0===g?"ds-selectable":g,a=e.selectables,l=void 0===a?[]:a,p=e.selectedClass,g=void 0===p?"ds-selected":p,a=e.selector,p=void 0===a?void 0:a,a=e.selectorClass,a=void 0===a?"ds-selector":a,e=e.zoom,e=void 0===e?1:e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),k(this,"_multiSelectKeyPressed",!1),k(this,"_initialCursorPos",{x:0,y:0}),k(this,"_newCursorPos",{x:0,y:0}),k(this,"_previousCursorPos",{x:0,y:0}),k(this,"_initialScroll",{x:0,y:0}),k(this,"_selected",[]),k(this,"_prevSelected",[]),k(this,"_lastTouch",void 0),k(this,"_onClick",function(e){return t.handleClick(e)}),k(this,"_startUp",function(e){return t.startUp(e)}),k(this,"_handleMove",function(e){return t.handleMove(e)}),k(this,"_end",function(e){return t.reset(e,!0)}),this.selectedClass=g,this.hoverClass=u,this.selectorClass=a,this.selectableClass=b,this.selectables=[],this._initialSelectables=this._toArray(l),this.multiSelectKeys=m,this.multiSelectMode=h,this.autoScrollSpeed=0===i?0:i,this.selectCallback=d,this.unselectCallback=f,this.onDragStartBegin=r,this.moveStartCallback=o,this.moveCallback=v,this.callback=s,this.area=this._handleArea(n),this.customStyles=c,this.zoom=e,this.selector=p||this._createSelector(),this.selector.classList.add(this.selectorClass),this.start()}var e,t,o;return e=y,(t=[{key:"_handleArea",value:function(e){if(e===document)return e;var t=getComputedStyle(e);e.computedBorder=parseInt(t.borderWidth);t=t.position;return"absolute"===t||"relative"===t||"fixed"===t||(e.style.position="relative"),e}},{key:"_handleSelectables",value:function(e,t,o){for(var n=0;n<e.length;n++){var a=e[n],i=this.selectables.indexOf(a);i<0&&!t?this._addSelectable(a,o):-1<i&&t&&this._removeSelectable(a,i,o)}}},{key:"_addSelectable",value:function(e,t){e.classList.add(this.selectableClass),e.addEventListener("click",this._onClick),this.selectables.push(e),t&&this._selected.indexOf(e)<0&&(e.classList.add(this.selectedClass),this._selected.push(e))}},{key:"_removeSelectable",value:function(e,t,o){e.classList.remove(this.hoverClass),e.classList.remove(this.selectableClass),e.removeEventListener("click",this._onClick),this.selectables.splice(t,1),o&&-1<this._selected.indexOf(e)&&(e.classList.remove(this.selectedClass),this._selected.splice(this._selected.indexOf(e),1))}},{key:"handleClick",value:function(e){var t;this.mouseInteraction||this._isRightClick(e)||(t=e.target,this._isMultiSelectKeyPressed(e)?this._prevSelected=this._selected.slice():this._prevSelected=[],this.checkIfInsideSelection(!0),-1<this.selectables.indexOf(t)&&this.toggle(t),this._end(e))}},{key:"_createSelector",value:function(){var e=document.createElement("div");return e.style.position="absolute",this.customStyles||(e.style.background="rgba(0, 0, 255, 0.1)",e.style.border="1px solid rgba(0, 0, 255, 0.45)",e.style.display="none",e.style.pointerEvents="none"),(this.area===document?document.body:this.area).appendChild(e),e}},{key:"start",value:function(){this._handleSelectables(this._initialSelectables),this.area.addEventListener("mousedown",this._startUp),this.area.addEventListener("touchstart",this._startUp,{passive:!1})}},{key:"startUp",value:function(e){if("touchstart"===e.type&&e.preventDefault(),!this._isRightClick(e)&&!this._isScrollbarClick(e,this.area))return this.onDragStartBegin(e),!this._breaked&&(this.mouseInteraction=!0,this.selector.style.display="block",this._isMultiSelectKeyPressed(e)?this._prevSelected=this._selected.slice():this._prevSelected=[],this._getStartingPositions(e),this.checkIfInsideSelection(!0),this.selector.style.display="none",this.moveStartCallback(e),!this._breaked&&(this.area.removeEventListener("mousedown",this._startUp),this.area.removeEventListener("touchstart",this._startUp,{passive:!1}),this.area.addEventListener("mousemove",this._handleMove),this.area.addEventListener("touchmove",this._handleMove,{passive:!1}),document.addEventListener("mouseup",this._end),void document.addEventListener("touchend",this._end)))}},{key:"_isMultiSelectKeyPressed",value:function(e){if(this._multiSelectKeyPressed=!1,this.multiSelectMode)this._multiSelectKeyPressed=!0;else for(var t=0;t<this.multiSelectKeys.length;t++)e[this.multiSelectKeys[t]]&&(this._multiSelectKeyPressed=!0);return this._multiSelectKeyPressed}},{key:"_getStartingPositions",value:function(e){this._initialCursorPos=this._newCursorPos=this._getCursorPos(e,this.area),this._initialScroll=this.getScroll(this.area);e={};e.x=this._initialCursorPos.x+this._initialScroll.x,e.y=this._initialCursorPos.y+this._initialScroll.y,e.w=0,e.h=0,this._updatePos(this.selector,e)}},{key:"handleMove",value:function(e){var t=this._getPosition(e);if(this.moveCallback(e),this._breaked)return!1;this.selector.style.display="block",this._updatePos(this.selector,t),this.checkIfInsideSelection(null),this._autoScroll(e)}},{key:"_getPosition",value:function(e){var t=this._getCursorPos(e,this.area),o=this.getScroll(this.area);this._newCursorPos=t;var n=o.x-this._initialScroll.x,a=o.y-this._initialScroll.y,e={};return t.x>this._initialCursorPos.x-n?(e.x=this._initialCursorPos.x+this._initialScroll.x,e.w=t.x-this._initialCursorPos.x+n):(e.x=t.x+o.x,e.w=this._initialCursorPos.x-t.x-n),t.y>this._initialCursorPos.y-a?(e.y=this._initialCursorPos.y+this._initialScroll.y,e.h=t.y-this._initialCursorPos.y+a):(e.y=t.y+o.y,e.h=this._initialCursorPos.y-t.y-a),e}},{key:"checkIfInsideSelection",value:function(e){for(var t=!1,o=0,n=this.selectables.length;o<n;o++){var a=this.selectables[o],i=this.getScroll(this.area),r={y:this.selector.getBoundingClientRect().top/this.zoom+i.y,x:this.selector.getBoundingClientRect().left/this.zoom+i.x,h:this.selector.offsetHeight,w:this.selector.offsetWidth};this._isElementTouching(a,r,i)?(this._handleSelection(a,e),t=!0):this._handleUnselection(a,e)}return t}},{key:"_handleSelection",value:function(e,t){if(e.classList.contains(this.hoverClass)&&!t)return!1;t=this._selected.indexOf(e);t<0?this.select(e):-1<t&&this._multiSelectKeyPressed&&this.unselect(e),e.classList.add(this.hoverClass)}},{key:"_handleUnselection",value:function(e,t){if(!e.classList.contains(this.hoverClass)&&!t)return!1;var o=this._selected.indexOf(e),t=this._prevSelected.indexOf(e);-1<o&&t<0?this.unselect(e):o<0&&-1<t&&this.select(e),e.classList.remove(this.hoverClass)}},{key:"select",value:function(e){return!(-1<this._selected.indexOf(e))&&(this._selected.push(e),e.classList.add(this.selectedClass),this.selectCallback(e),!this._breaked&&e)}},{key:"unselect",value:function(e){return!(this._selected.indexOf(e)<0)&&(this._selected.splice(this._selected.indexOf(e),1),e.classList.remove(this.selectedClass),this.unselectCallback(e),!this._breaked&&e)}},{key:"toggle",value:function(e){return-1<this._selected.indexOf(e)?this.unselect(e):this.select(e),e}},{key:"_isElementTouching",value:function(e,t,o){var n=e.getBoundingClientRect(),a=n.top/this.zoom+o.y,e=n.left/this.zoom+o.x,o=n.height/this.zoom,n=n.width/this.zoom;return t.x<e+n&&t.x+t.w>e&&t.y<a+o&&t.h+t.y>a}},{key:"_autoScroll",value:function(e){var t=this.isCursorNearEdge(e,this.area),e=document&&document.documentElement&&document.documentElement.scrollTop&&document.documentElement,e=this.area===document?e||document.body:this.area;"top"===t&&0<e.scrollTop?e.scrollTop-=+this.autoScrollSpeed:"bottom"===t?e.scrollTop+=+this.autoScrollSpeed:"left"===t&&0<e.scrollLeft?e.scrollLeft-=+this.autoScrollSpeed:"right"===t&&(e.scrollLeft+=+this.autoScrollSpeed)}},{key:"isCursorNearEdge",value:function(e,t){var o=this._getCursorPos(e,t),n=this.getAreaRect(t),e=Math.max(n.width/10,30),t=Math.max(n.height/10,30);return o.y<t?"top":n.height-o.y<t?"bottom":n.width-o.x<e?"right":o.x<e&&"left"}},{key:"reset",value:function(e,t){var o=this;if(this._previousCursorPos=this._getCursorPos(e,this.area),document.removeEventListener("mouseup",this._end),document.removeEventListener("touchend",this._end),this.area.removeEventListener("mousemove",this._handleMove),this.area.removeEventListener("touchmove",this._handleMove,{passive:!1}),this.area.addEventListener("mousedown",this._startUp),this.area.addEventListener("touchstart",this._startUp,{passive:!1}),t&&this.callback(this.getSelection(),e),this._breaked)return!1;this.selector.style.width="0",this.selector.style.height="0",this.selector.style.display="none",setTimeout(function(){return o.mouseInteraction=!1},100)}},{key:"break",value:function(){var e=this;this._breaked=!0,setTimeout(function(){return e._breaked=!1},100)}},{key:"stop",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],o=2<arguments.length?arguments[2]:void 0;this.reset(!1,o),this.area.removeEventListener("mousedown",this._startUp),this.area.removeEventListener("touchstart",this._startUp,{passive:!1}),document.removeEventListener("mouseup",this._end),document.removeEventListener("touchend",this._end),this._handleSelectables(a(this.selectables),e,t)}},{key:"getSelection",value:function(){return a(this._selected)}},{key:"getCursorPos",value:function(e,t,o){if(!e)return{x:0,y:0};t=t||!1!==t&&this.area,e=this._getCursorPos(e,t),t=o?{x:0,y:0}:this.getScroll(t);return{x:e.x+t.x,y:e.y+t.y}}},{key:"addSelection",value:function(e,t,o){for(var n=this._toArray(e),a=0,i=n.length;a<i;a++){var r=n[a];this.select(r)}return o||this.addSelectables(n),t&&this.callback(this._selected,!1),this._selected}},{key:"removeSelection",value:function(e,t,o){for(var n=this._toArray(e),a=0,i=n.length;a<i;a++){var r=n[a];this.unselect(r)}return o&&this.removeSelectables(n),t&&this.callback(this._selected,!1),this._selected}},{key:"toggleSelection",value:function(e,t,o){for(var n=this._toArray(e),a=0,i=n.length;a<i;a++){var r=n[a];this._selected.indexOf(r)<0?this.addSelection(r,t,o):this.removeSelection(r,t,o)}return this._selected}},{key:"setSelection",value:function(e,t,o){return this.clearSelection(),this.addSelection(e,t,o),this._selected}},{key:"clearSelection",value:function(e){for(var t=this._selected.slice(),o=0,n=t.length;o<n;o++){var a=t[o];this.unselect(a)}return e&&this.callback(this._selected,!1),this._selected}},{key:"addSelectables",value:function(e,t){var o=this._toArray(e);return this._handleSelectables(o,!1,t),e}},{key:"getSelectables",value:function(){return this.selectables}},{key:"setSelectables",value:function(e,t,o){return this.removeSelectables(this.getSelectables(),t),this.addSelectables(e,o)}},{key:"removeSelectables",value:function(e,t){var o=this._toArray(e);return this._handleSelectables(o,!0,t),e}},{key:"_isRightClick",value:function(e){var t=!1;return"which"in e?t=3===e.which:"button"in e&&(t=2===e.button),t}},{key:"_isScrollbarClick",value:function(e,t){var o=this._getCursorPos(e,t),e=this.getAreaRect(t),t=t.computedBorder||0;return e.width+t<=o.x||e.height+t<=o.y}},{key:"_toArray",value:function(e){if(!e)return[];if(!e.length&&this._isElement(e))return[e];for(var t=[],o=e.length-1;0<=o;o--)t[o]=e[o];return t}},{key:"_isElement",value:function(t){try{return t instanceof HTMLElement||t instanceof SVGElement}catch(e){return"object"===n(t)&&1===t.nodeType&&"object"===n(t.style)&&"object"===n(t.ownerDocument)}}},{key:"_getCursorPos",value:function(e,t){if(!e)return{x:0,y:0};e.touches&&"touchend"!==e.type&&(this._lastTouch=e);var o=(e=e.touches?this._lastTouch.touches[0]:e).pageX||e.clientX,n=e.pageY||e.clientY,e=this.getAreaRect(t||document),t=this.getScroll();return{x:(o-e.left-t.x)/this.zoom,y:(n-e.top-t.y)/this.zoom}}},{key:"getInitialCursorPosition",value:function(){return this._initialCursorPos}},{key:"getCurrentCursorPosition",value:function(){return this._newCursorPos}},{key:"getPreviousCursorPosition",value:function(){return this._previousCursorPos}},{key:"getCursorPositionDifference",value:function(e){var t=this.getCurrentCursorPosition(),e=e?this.getPreviousCursorPosition():this.getInitialCursorPosition();return{x:t.x-e.x,y:t.y-e.y}}},{key:"getScroll",value:function(e){var t={top:(0<document.body.scrollTop?document.body:document.documentElement).scrollTop,left:(0<document.body.scrollLeft?document.body:document.documentElement).scrollLeft};return{y:e&&0<=e.scrollTop?e.scrollTop:t.top,x:e&&0<=e.scrollLeft?e.scrollLeft:t.left}}},{key:"getAreaRect",value:function(e){if(e===document){var t=0<e.documentElement.clientHeight?e.documentElement.clientHeight:window.innerHeight;return{top:0,left:0,bottom:0,right:0,width:0<e.documentElement.clientWidth?e.documentElement.clientWidth:window.innerWidth,height:t}}t=e.getBoundingClientRect();return{top:t.top,left:t.left,bottom:t.bottom,right:t.right,width:e.clientWidth||t.width,height:e.clientHeight||t.height}}},{key:"_updatePos",value:function(e,t){return e.style.left=t.x+"px",e.style.top=t.y+"px",e.style.width=t.w+"px",e.style.height=t.h+"px",e}}])&&i(e.prototype,t),o&&i(e,o),y}();window.DragSelect=t,this.resolve()}),EasyBlog.module("composer/vendors/expanding",function(o){function i(){o(this).data("textareaClone").find("div").text(this.value.replace(/\r\n/g,"\n")+" "),o(this).trigger("resize.expanding")}o.expandingTextarea=o.extend({autoInitialize:!0,initialSelector:"textarea.expanding",opts:{resize:function(){}}},o.expandingTextarea||{});var r=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","wordWrap","word-break","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","boxSizing","webkitBoxSizing","mozBoxSizing","msBoxSizing"],s={position:"absolute",height:"100%",resize:"none"},l={visibility:"hidden",border:"0 solid",whiteSpace:"pre-wrap"},c={position:"relative"};o.fn.expandingTextarea=function(e){var t=o.extend({},o.expandingTextarea.opts,e);return"resize"===e?this.trigger("input.expanding"):("destroy"===e?this.filter(".expanding-init").each(function(){var e=o(this).removeClass("expanding-init");e.attr("style",e.data("expanding-styles")||"").removeData("expanding-styles")}):this.filter("textarea").not(".expanding-init").addClass("expanding-init").each(function(){var n=o(this),e=n.parent(),a=o(o.parseHTML("<pre class='textareaClone'><div></div></pre>"));n.after(a).data("textareaClone",a),e.css(c),n.data("expanding-styles",n.attr("style")),n.css(s),a.css(l),o.each(r,function(e,t){var o=n.css(t);a.css(t)!==o&&a.css(t,o)}),n.bind("input.expanding propertychange.expanding keyup.expanding",i),i.apply(this),t.resize&&n.bind("resize.expanding",t.resize)}),this)},o(function(){o.expandingTextarea.autoInitialize&&o(o.expandingTextarea.initialSelector).expandingTextarea()}),this.resolve()}),EasyBlog.module("composer/vendors/nearest",function(l){var v={left:[-1,0],up:[0,-1],right:[1,0],down:[0,1]};l.distance=function(e,t,o){o=v[o];var n,a,i,r,s=e.offset(),l=e.outerWidth(),c=e.outerHeight(),d=s.left,u=s.top,p=d+l,m=u+c,f=d+l/2,h=u+c/2,g=t.offset(),e=t.outerWidth(),s=t.outerHeight(),l=g.left,c=g.top,t=l+e,g=c+s,e=l+e/2,s=c+s/2;return 0==o[1]?(o[0]<0?(t<=d&&(n=d-t),e<=d&&(n=null!=n?Math.min(n,d-e):d-e),t<=d&&(n=null!=n?Math.min(n,d-t):d-t)):(p<=l&&(n=l-p),p<=e&&(n=null!=n?Math.min(n,e-p):e-p),d<l&&(n=null!=n?Math.min(n,l-d):l-d)),a=2*Math.min(Math.abs(h-c),Math.abs(h-s),Math.abs(h-g))):0==o[0]&&(o[1]<0?(g<=u&&(a=u-g),s<=u&&(a=null!=a?Math.min(a,u-s):u-s),g<=u&&(a=null!=a?Math.min(a,u-g):u-g)):(m<=c&&(a=c-m),m<=s&&(a=null!=a?Math.min(a,s-m):s-m),u<c&&(a=null!=a?Math.min(a,c-u):c-u)),n=2*Math.min(Math.abs(f-l),Math.abs(f-e),Math.abs(f-t))),null==n||null==a?-1:(i=n,r=a,Math.floor(Math.sqrt(i*i+r*r)))},l.fn.nearest=function(e,t){for(var o,n,a=l(),i=null,r=-1,s=e.length;++r<s;)o=l(e[r]),this[0]!=o[0]&&0<=(n=l.distance(this,o,t))&&(null===i||n<i)&&(i=n,a=o);return a},this.resolve()}),EasyBlog.module("composer/vendors/nouislider",function(e){!function(){"use strict";function b(e){return e.split("").reverse().join("")}function f(e,t){return e.substring(0,t.length)===t}function i(e,t,o){if((e[t]||e[o])&&e[t]===e[o])throw new Error(t)}function y(e){return"number"==typeof e&&isFinite(e)}function o(e,t,o,n,a,i,r,s,l,c,d,u){var p,m,f,h=u,g="",v="";return!!y(u=i?i(u):u)&&((u=!1!==e&&0===parseFloat(u.toFixed(e))?0:u)<0&&(p=!0,u=Math.abs(u)),!1!==e&&(i=u,f=e,e=Math.pow(10,f),u=(Math.round(i*e)/e).toFixed(f)),-1!==(u=u.toString()).indexOf(".")?(m=(f=u.split("."))[0],o&&(g=o+f[1])):m=u,t&&(m=b(m).match(/.{1,3}/g),m=b(m.join(b(t)))),p&&s&&(v+=s),n&&(v+=n),p&&l&&(v+=l),v+=m,v+=g,a&&(v+=a),c?c(v,h):v)}function n(e,t,o,n,a,i,r,s,l,c,d,u){var p,m="";return!(!(u=d?d(u):u)||"string"!=typeof u)&&(s&&f(u,s)&&(u=u.replace(s,""),p=!0),n&&f(u,n)&&(u=u.replace(n,"")),l&&f(u,l)&&(u=u.replace(l,""),p=!0),a&&(l=a,u.slice(-1*l.length)===l)&&(u=u.slice(0,-1*a.length)),t&&(u=u.split(t).join("")),p&&(m+="-"),""!==(m=(m+=u=o?u.replace(o,"."):u).replace(/[^0-9\.\-.]/g,""))&&(m=Number(m),!!y(m=r?r(m):m)&&m))}function a(e,t,o){for(var n=[],a=0;a<r.length;a+=1)n.push(e[r[a]]);return n.push(o),t.apply("",n)}var r=["decimals","thousand","mark","prefix","postfix","encoder","decoder","negativeBefore","negative","edit","undo"];window.wNumb=function e(t){if(!(this instanceof e))return new e(t);"object"==typeof t&&(t=function(e){for(var t,o,n={},a=0;a<r.length;a+=1)if(void 0===(o=e[t=r[a]]))"negative"!==t||n.negativeBefore?"mark"===t&&"."!==n.thousand?n[t]=".":n[t]=!1:n[t]="-";else if("decimals"===t){if(!(0<=o&&o<8))throw new Error(t);n[t]=o}else if("encoder"===t||"decoder"===t||"edit"===t||"undo"===t){if("function"!=typeof o)throw new Error(t);n[t]=o}else{if("string"!=typeof o)throw new Error(t);n[t]=o}return i(n,"mark","thousand"),i(n,"prefix","negative"),i(n,"prefix","negativeBefore"),n}(t),this.to=function(e){return a(t,o,e)},this.from=function(e){return a(t,n,e)})}}(),function(r){"use strict";function o(e){return e instanceof r||r.zepto&&r.zepto.isZ(e)}function i(o,n,e){var a=this,i=!1;if(this.changeHandler=function(e){var t=a.formatInstance.from(r(this).val());if(!1===t||isNaN(t))return r(this).val(a.lastSetValue),!1;a.changeHandlerMethod.call("",e,t)},this.el=!1,this.formatInstance=e,r.each(t,function(e,t){return!(i=t.call(a,o,n))}),!i)throw new RangeError("(Link) Invalid Link.")}function s(e){this.items=[],this.elements=[],this.origin=e}var t=[function(e,t){if("string"==typeof e&&0===e.indexOf("-inline-"))return this.method=t||"html",this.target=this.el=r(e.replace("-inline-","")||"<div/>"),!0},function(e){if("string"==typeof e&&0!==e.indexOf("-")){this.method="val";var t=document.createElement("input");return t.name=e,t.type="hidden",this.target=this.el=r(t),!0}},function(e){if("function"==typeof e)return this.target=!1,this.method=e,!0},function(e,t){if(o(e)&&!t)return e.is("input, select, textarea")?(this.method="val",this.target=e.on("change.liblink",this.changeHandler)):(this.target=e,this.method="html"),!0},function(e,t){if(o(e)&&("function"==typeof t||"string"==typeof t&&e[t]))return this.method=t,this.target=e,!0}];i.prototype.set=function(e){var t=Array.prototype.slice.call(arguments).slice(1);this.lastSetValue=this.formatInstance.to(e),t.unshift(this.lastSetValue),("function"==typeof this.method?this.method:this.target[this.method]).apply(this.target,t)},s.prototype.push=function(e,t){this.items.push(e),t&&this.elements.push(t)},s.prototype.reconfirm=function(e){for(var t=0;t<this.elements.length;t+=1)this.origin.LinkConfirm(e,this.elements[t])},s.prototype.remove=function(e){for(var t=0;t<this.items.length;t+=1)this.items[t].target.off(".liblink");for(t=0;t<this.elements.length;t+=1)this.elements[t].remove()},s.prototype.change=function(e){if(this.origin.LinkIsEmitting)return!1;this.origin.LinkIsEmitting=!0;var t,o=Array.prototype.slice.call(arguments,1);for(o.unshift(e),t=0;t<this.items.length;t+=1)this.items[t].set.apply(this.items[t],o);this.origin.LinkIsEmitting=!1},r.fn.Link=function(n){var a=this;if(!1===n)return a.each(function(){this.linkAPI&&(r.map(this.linkAPI,function(e){e.remove()}),delete this.linkAPI)});if(void 0===n)n=0;else if("string"!=typeof n)throw new Error("Flag must be string.");return{to:function(e,t,o){return a.each(function(){!function(e,t,o,n){0===e&&(e=this.LinkDefaultFlag),this.linkAPI||(this.linkAPI={}),this.linkAPI[e]||(this.linkAPI[e]=new s(this)),(n=new i(t,o,n||this.LinkDefaultFormatter)).target||(n.target=r(this)),n.changeHandlerMethod=this.LinkConfirm(e,n.el),this.linkAPI[e].push(n,n.el),this.LinkUpdate(e)}.call(this,n,e,t,o)})}}}}(e),function(x){"use strict";function r(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function I(e,t,o){e.addClass(t),setTimeout(function(){e.removeClass(t)},o)}function T(e){return Math.max(Math.min(e,100),0)}function S(e){return x.isArray(e)?e:[e]}function s(e,t){return 100/(t-e)}function l(e,t){return 100*t/(e[1]-e[0])}function c(e,t){for(var o=1;e>=t[o];)o+=1;return o}function t(e,t,o){if(o>=e.slice(-1)[0])return 100;var n=c(o,e),a=e[n-1],i=e[n],e=t[n-1],n=t[n];return e+(o=o,l(i=[a,i],i[0]<0?o+Math.abs(i[0]):o-i[0])/s(e,n))}function o(e,t,o,n){if(100===n)return n;var a,i=c(n,e);return o?(a=e[i-1],((o=e[i])-a)/2<n-a?o:a):t[i-1]?e[i-1]+(e=n-e[i-1],i=t[i-1],Math.round(e/i)*i):n}function n(e,t,o,n){this.xPct=[],this.xVal=[],this.xSteps=[n||!1],this.xNumSteps=[!1],this.snap=t,this.direction=o;var a,i=[];for(a in e)e.hasOwnProperty(a)&&i.push([e[a],a]);for(i.sort(function(e,t){return e[0]-t[0]}),a=0;a<i.length;a++)!function(e,t,o){if("number"==typeof t&&(t=[t]),"[object Array]"!==Object.prototype.toString.call(t))throw new Error("noUiSlider: 'range' contains invalid value.");if(!r(e="min"===e?0:"max"===e?100:parseFloat(e))||!r(t[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");o.xPct.push(e),o.xVal.push(t[0]),e?o.xSteps.push(!isNaN(t[1])&&t[1]):isNaN(t[1])||(o.xSteps[0]=t[1])}(i[a][1],i[a][0],this);for(this.xNumSteps=this.xSteps.slice(0),a=0;a<this.xNumSteps.length;a++)!function(e,t,o){if(!t)return;o.xSteps[e]=l([o.xVal[e],o.xVal[e+1]],t)/s(o.xPct[e],o.xPct[e+1])}(a,this.xNumSteps[a],this)}function i(e,t){if(!r(t))throw new Error("noUiSlider: 'step' is not numeric.");e.singleStep=t}function d(e,t){if("object"!=typeof t||x.isArray(t))throw new Error("noUiSlider: 'range' is not an object.");if(void 0===t.min||void 0===t.max)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");e.spectrum=new n(t,e.snap,e.dir,e.singleStep)}function u(e,t){if(t=S(t),!x.isArray(t)||!t.length||2<t.length)throw new Error("noUiSlider: 'start' option is incorrect.");e.handles=t.length,e.start=t}function p(e,t){if("boolean"!=typeof(e.snap=t))throw new Error("noUiSlider: 'snap' option must be a boolean.")}function m(e,t){if("boolean"!=typeof(e.animate=t))throw new Error("noUiSlider: 'animate' option must be a boolean.")}function f(e,t){if("lower"===t&&1===e.handles)e.connect=1;else if("upper"===t&&1===e.handles)e.connect=2;else if(!0===t&&2===e.handles)e.connect=3;else{if(!1!==t)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");e.connect=0}}function h(e,t){switch(t){case"horizontal":e.ort=0;break;case"vertical":e.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function g(e,t){if(!r(t))throw new Error("noUiSlider: 'margin' option must be numeric.");if(e.margin=e.spectrum.getMargin(t),!e.margin)throw new Error("noUiSlider: 'margin' option is only supported on linear sliders.")}function v(e,t){if(!r(t))throw new Error("noUiSlider: 'limit' option must be numeric.");if(e.limit=e.spectrum.getMargin(t),!e.limit)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders.")}function b(e,t){switch(t){case"ltr":e.dir=0;break;case"rtl":e.dir=1,e.connect=[0,2,1,3][e.connect];break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function y(e,t){if("string"!=typeof t)throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var o=0<=t.indexOf("tap"),n=0<=t.indexOf("drag"),a=0<=t.indexOf("fixed"),t=0<=t.indexOf("snap");e.events={tap:o||t,drag:n,fixed:a,snap:t}}function k(e,t){if("function"==typeof(e.format=t).to&&"function"==typeof t.from)return!0;throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.")}function E(e,t,o){for(var n,a,i,r,s=[],l=0;l<e;l+=1)s.push((n=t,a=l,r=i=void 0,i=x("<div><div/></div>").addClass(z[2]),r=["-lower","-upper"],n&&r.reverse(),i.children().addClass(z[3]+" "+z[3]+r[a]),i.appendTo(o)));return s}function w(e,l,t){function s(){return m[["width","height"][l.ort]]()}function c(e){for(var t=[y.val()],o=0;o<e.length;o+=1)y.trigger(e[o],t)}function o(e){return 1===e.length?e[0]:l.dir?e.reverse():e}function d(e){var t=x.inArray(e,B);y[0].linkAPI&&y[0].linkAPI[e]&&y[0].linkAPI[e].change(C[t],f[t].children(),y)}function n(e,t,o,n){return e=e.replace(/\s/g,M+" ")+M,t.on(e,function(e){return!y.attr("disabled")&&(!y.hasClass(z[14])&&((e=function(e){e.preventDefault();var t,o,n=0===e.type.indexOf("touch"),a=0===e.type.indexOf("mouse"),i=0===e.type.indexOf("pointer"),r=e;return 0===e.type.indexOf("MSPointer")&&(i=!0),e.originalEvent&&(e=e.originalEvent),n&&(t=e.changedTouches[0].pageX,o=e.changedTouches[0].pageY),(a||i)&&(i||void 0!==window.pageXOffset||(window.pageXOffset=document.documentElement.scrollLeft,window.pageYOffset=document.documentElement.scrollTop),t=e.clientX+window.pageXOffset,o=e.clientY+window.pageYOffset),r.points=[t,o],r.cursor=a,r}(e)).calcPoint=e.points[l.ort],void o(e,n)))})}function a(e,t){var o,n=t.handles||f,a=!1,i=100*(e.calcPoint-t.start)/s(),r=n[0][0]!==f[0][0]?1:0;o=t.positions,e=1<n.length,t=i+o[0],o=i+o[1],o=e?(t<0&&(o+=Math.abs(t)),100<o&&(t-=o-100),[T(t),T(o)]):[t,o],a=p(n[0],o[r],1===n.length),(a=1<n.length?p(n[1],o[r?0:1],!1)||a:a)&&c(["nouislide"])}function i(e){x("."+z[15]).removeClass(z[15]),e.cursor&&x("body").css("cursor","").off(M),b.off(M),y.removeClass(z[12]),c(["set","change"])}function r(e,t){1===t.handles.length&&t.handles[0].children().addClass(z[15]),e.stopPropagation(),n(P.move,b,a,{start:e.calcPoint,handles:t.handles,positions:[k[0],k[f.length-1]]}),n(P.end,b,i,null),e.cursor&&(x("body").css("cursor",x(e.target).css("cursor")),1<f.length&&y.addClass(z[12]),x("body").on("selectstart"+M,!1))}function u(e){var t=e.calcPoint,o=0;e.stopPropagation(),x.each(f,function(){o+=this.offset()[l.style]}),o=t<o/2||1===f.length?0:1,t=100*(t-=m.offset()[l.style])/s(),l.events.snap||I(y,z[14],300),p(f[o],t),c(["nouislide","set","change"]),l.events.snap&&r(e,{handles:[f[o]]})}function p(e,t,o){var n=e[0]!==f[0][0]?1:0,a=k[0]+l.margin,i=k[1]-l.margin,r=k[0]+l.limit,s=k[1]-l.limit;return 1<f.length&&(t=n?Math.max(t,a):Math.min(t,i)),!1!==o&&l.limit&&1<f.length&&(t=n?Math.min(t,r):Math.max(t,s)),t=w.getStep(t),(t=T(parseFloat(t.toFixed(7))))!==k[n]&&(e.css(l.style,t+"%"),e.is(":first-child")&&e.toggleClass(z[17],50<t),k[n]=t,C[n]=w.fromStepping(t),d(B[n]),!0)}var m,f,h,g,v,b=x(t.document||document),y=x(e),k=[-1,-1],w=l.spectrum,C=[],B=["lower","upper"].slice(0,l.handles);if(l.dir&&B.reverse(),e.LinkUpdate=d,e.LinkConfirm=function(e,t){var o,e=x.inArray(e,B);return t&&t.appendTo(f[e].children()),l.dir&&1<l.handles&&(e=1===e?0:1),o=e,function(e,t){y.val([o?null:t,o?t:null],!0)}},e.LinkDefaultFormatter=l.format,e.LinkDefaultFlag="lower",e.reappend=function(){for(var e,t=0;t<B.length;t+=1)this.linkAPI&&this.linkAPI[e=B[t]]&&this.linkAPI[e].reconfirm(e)},y.hasClass(z[0]))throw new Error("Slider was already initialized.");h=l.dir,g=l.ort,(v=y).addClass([z[0],z[8+h],z[4+g]].join(" ")),m=x("<div/>").appendTo(v).addClass(z[1]),f=E(l.handles,l.dir,m),function(e,t,o){switch(e){case 1:t.addClass(z[7]),o[0].addClass(z[6]);break;case 3:o[1].addClass(z[6]);case 2:o[0].addClass(z[7]);case 0:t.addClass(z[6])}}(l.connect,y,f),function(e){var t,o;if(!e.fixed)for(t=0;t<f.length;t+=1)n(P.start,f[t].children(),r,{handles:[f[t]]});e.tap&&n(P.start,m,u,{handles:f}),e.drag&&(o=m.find("."+z[7]).addClass(z[10]),e.fixed&&(o=o.add(m.children().not(o).children())),n(P.start,o,r,{handles:f}))}(l.events),e.vSet=function(e){if(y[0].LinkIsEmitting)return this;var t=S(e);return l.dir&&1<l.handles&&t.reverse(),l.animate&&-1!==k[0]&&I(y,z[14],300),e=1<f.length?3:1,function(e,t){var o,n,a;for(l.limit&&(e+=1),o=0;o<e;o+=1)null!==(a=t[n=o%2])&&!1!==a&&("number"==typeof a&&(a=String(a)),!1!==(a=l.format.from(a))&&!isNaN(a)&&!1!==p(f[n],w.toStepping(a),o===3-l.dir)||d(B[n]))}(e=1===t.length?1:e,t),this},e.vGet=function(){for(var e=[],t=0;t<l.handles;t+=1)e[t]=l.format.to(C[t]);return o(e)},e.destroy=function(){return x(this).off(M).removeClass(z.join(" ")).empty(),delete this.LinkUpdate,delete this.LinkConfirm,delete this.LinkDefaultFormatter,delete this.LinkDefaultFlag,delete this.reappend,delete this.vGet,delete this.vSet,delete this.getCurrentStep,delete this.getInfo,delete this.destroy,t},e.getCurrentStep=function(){return o(x.map(k,function(e,t){var o,n=w.getApplicableStep(e),a=1<(o=(o=String(n[2])).split(".")).length?o[1].length:0,o=C[t],t=100===e?null:n[2],a=Number((o-n[2]).toFixed(a));return[[0===e?null:a>=n[1]?n[2]:n[0]||!1,t]]}))},e.getOriginalOptions=function(){return t},e.getInfo=function(){return[w,l.style,l.ort]},y.val(l.start)}function a(e){var o,n,t,a=(o=e,t={step:{r:!(n={margin:0,limit:0,animate:!0,format:D}),t:i},start:{r:!0,t:u},connect:{r:!0,t:f},direction:{r:!0,t:b},snap:{r:!1,t:p},animate:{r:!1,t:m},range:{r:!0,t:d},orientation:{r:!1,t:h},margin:{r:!1,t:g},limit:{r:!1,t:v},behaviour:{r:!0,t:y},format:{r:!1,t:k}},o=x.extend({connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal"},o),x.each(t,function(e,t){if(void 0===o[e]){if(t.r)throw new Error("noUiSlider: '"+e+"' is required.");return!0}t.t(n,o[e])}),n.style=n.ort?"top":"left",n);return this.each(function(){w(this,a,e)})}function C(){return this[0][arguments.length?"vSet":"vGet"].apply(this[0],arguments)}function B(d,u,p,m){var o,e=d.direction,f={},t=d.xVal[0],n=d.xVal[d.xVal.length-1],h=!1,g=!1,v=0;return d.direction=0,o=m.slice().sort(function(e,t){return e-t}),(m=x.grep(o,function(e,t){return t===x.inArray(e,o)}))[0]!==t&&(m.unshift(t),h=!0),m[m.length-1]!==n&&(m.push(n),g=!0),x.each(m,function(e){var t,o,n,a,i,r,s=m[e],l=m[e+1],c=(c="steps"===p?d.xNumSteps[e]:c)||l-s;if(!1!==s&&void 0!==l)for(t=s;t<=l;t+=c){for(r=(a=(n=d.toStepping(t))-v)/(i=Math.round(a/u)),o=1;o<=i;o+=1)f[(v+o*r).toFixed(5)]=["x",0];a=-1<x.inArray(t,m)?1:"steps"===p?2:0,!e&&h&&(a=0),t===l&&g||(f[n.toFixed(5)]=[t,a]),v=n}}),d.direction=e,f}function _(n,e,o,t,a,i){function r(e,t,o){return'class="'+t+" "+t+"-"+s+" "+t+(t=o[1],o[0],["-normal","-large","-sub"][t])+'" style="'+n+": "+e+'%"'}var s=["horizontal","vertical"][e],l=x("<div/>");return l.addClass("noUi-pips noUi-pips-"+s),x.each(t,function(e,t){o&&(e=100-e),t[1]=t[1]&&a?a(t[0],t[1]):t[1],l.append("<div "+r(e,"noUi-marker",t)+"></div>"),t[1]&&l.append("<div "+r(e,"noUi-value",t)+">"+i.to(t[0])+"</div>")}),l}x(document);var F=x.fn.val,M=".nui",P=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},z=["noUi-target","noUi-base","noUi-origin","noUi-handle","noUi-horizontal","noUi-vertical","noUi-background","noUi-connect","noUi-ltr","noUi-rtl","noUi-dragable","","noUi-state-drag","","noUi-state-tap","noUi-active","","noUi-stacking"];n.prototype.getMargin=function(e){return 2===this.xPct.length&&l(this.xVal,e)},n.prototype.toStepping=function(e){return e=t(this.xVal,this.xPct,e),e=this.direction?100-e:e},n.prototype.fromStepping=function(e){return this.direction&&(e=100-e),t=function(e,t,o){if(100<=o)return e.slice(-1)[0];var n=c(o,t),a=e[n-1],i=e[n],e=t[n-1],n=t[n];return(o-e)*s(e,n)*((i=[a,i])[1]-i[0])/100+i[0]}(this.xVal,this.xPct,e),e=Math.pow(10,7),Number((Math.round(t*e)/e).toFixed(7));var t},n.prototype.getStep=function(e){return this.direction&&(e=100-e),e=o(this.xPct,this.xSteps,this.snap,e),e=this.direction?100-e:e},n.prototype.getApplicableStep=function(e){var t=c(e,this.xPct),e=100===e?2:1;return[this.xNumSteps[t-2],this.xVal[t-e],this.xNumSteps[t-e]]},n.prototype.convert=function(e){return this.getStep(this.toStepping(e))};var D={to:function(e){return e.toFixed(2)},from:Number};x.fn.val=function(n){function a(e){return e.hasClass(z[0])?C:F}if(!arguments.length){var e=x(this[0]);return a(e).call(e)}var i=x.isFunction(n);return this.each(function(e){var t=n,o=x(this);i&&(t=n.call(this,e,o.val())),a(o).call(o,t)})},x.fn.noUiSlider=function(e,t){switch(e){case"step":return this[0].getCurrentStep();case"options":return this[0].getOriginalOptions()}return(t?function(n){return this.each(function(){var e,t,o;this.hasOwnProperty("destroy")?(e=x(this).val(),t=this.destroy(),o=x.extend({},t,n),x(this).noUiSlider(o),this.reappend(),t.start===o.start&&x(this).val(e)):x(this).noUiSlider(n)})}:a).call(this,e)},x.fn.noUiSlider_pips=function(e){var o=e.mode,n=e.density||1,a=e.filter||!1,i=e.values||!1,r=e.format||{to:Math.round},s=e.stepped||!1;return this.each(function(){var e=this.getInfo(),t=function(t,e,o,n){if("range"===e||"steps"===e)return t.xVal;if("count"===e){var a,i=100/(o-1),r=0;for(o=[];(a=r++*i)<=100;)o.push(a);e="positions"}return"positions"===e?x.map(o,function(e){return t.fromStepping(n?t.getStep(e):e)}):"values"===e?n?x.map(o,function(e){return t.fromStepping(t.getStep(t.toStepping(e)))}):o:void 0}(e[0],o,i,s),t=B(e[0],n,o,t);return x(this).append(_(e[1],e[2],e[0].direction,t,a,r))})}}(e),this.resolve()}),EasyBlog.module("composer/vendors/selectionchange",function(e){var i,o,r;function s(e){e=e.getSelection();return e.rangeCount?e.getRangeAt(0):null}function t(e,t,o){e.addEventListener(t,o,!0)}function n(e,t,o){e.removeEventListener(t,o,!0)}function a(e){var t=e.keyCode;(65===t&&e[o]&&!e.shiftKey&&!e.altKey||t<=40&&37<=t&&e.shiftKey)&&setTimeout(p.bind(null,this),0)}function l(e){0===e.button&&(t(this,"mousemove",c),setTimeout(p.bind(null,this),0))}function c(e){1&e.buttons?p(this):n(this,"mousemove",c)}function d(e){0===e.button?setTimeout(p.bind(null,this),0):n(this,"mousemove",c)}function u(){setTimeout(p.bind(null,this.document),0)}function p(e){var t,o,n=i.get(e),a=s(e);(t=a)===(o=n)||t&&o&&r.every(function(e){return t[e]===o[e]})||(i.set(e,a),setTimeout(e.dispatchEvent.bind(e,new Event("selectionchange")),0))}e.selectionchange=(o=/^Mac/.test(navigator.platform)?"metaKey":"ctrlKey",r=["startContainer","startOffset","endContainer","endOffset"],{start:function(e){e=e||document;(i||!function(e){var t=e.onselectionchange;if(void 0!==t)try{return e.onselectionchange=0,null===e.onselectionchange}catch(e){}finally{e.onselectionchange=t}}(e)&&(i="undefined"!=typeof WeakMap?new WeakMap:(console.error("selectionchange: WeakMap not supported"),null)))&&(i.has(e)||(i.set(e,s(e)),t(e,"keydown",a),t(e,"mousedown",l),t(e,"mousemove",c),t(e,"mouseup",d),t(e.defaultView,"focus",u)))},stop:function(e){e=e||document;i&&i.has(e)&&(i.delete(e),n(e,"keydown",a),n(e,"mousedown",l),n(e,"mousemove",c),n(e,"mouseup",d),n(e.defaultView,"focus",u))}}),this.resolve()})});