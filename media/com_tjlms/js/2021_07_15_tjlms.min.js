jQuery(document).ready(function(){jQuery('[data-toggle="tooltip"]').tooltip()});var tjlms={courses:{init:function(e,t){jQuery(document).ready(function(){document.getElementById("tjlms_pin_container"),new Masonry(document.getElementById("tjlms_pin_container"),{columnWidth:t,itemSelector:".tjlmspin"});setTimeout(function(){document.getElementById("tjlms_pin_container"),new Masonry(document.getElementById("tjlms_pin_container"),{columnWidth:t,itemSelector:".tjlmspin"})},1e3),setTimeout(function(){document.getElementById("tjlms_pin_container"),new Masonry(document.getElementById("tjlms_pin_container"),{columnWidth:t,itemSelector:".tjlmspin"})},3e3)})}},course:{init:function(e,t,a){jQuery(document).ready(function(){void 0!==a&&jQuery("body").addClass(a),jQuery(window).width()<767&&jQuery(".enrollHtml").insertBefore(".tjlms_course_toc")}),jQuery(window).load(function(){if(e){var a=jQuery("#modlist_"+e+' [data-jstoggle="collapse"]');jQuery(a).removeClass("collapsed");var s=jQuery(a).attr("data-target");jQuery(s).addClass("in")}jQuery('[data-jstoggle="collapse"]').click(function(){jQuery(this).toggleClass("collapsed");var e=jQuery(this).attr("data-target");jQuery(e).toggleClass("in")}),jQuery("#paid_course_button").click(function(){try{var e=JSON.parse(t)}catch(s){var a=JSON.stringify(t);e=JSON.parse(a)}"undefined"!=typeof tjanalytics&&(tjanalytics.ga.addProduct(e),tjanalytics.ga.setAction(e[0]))})})}},lesson:{init:function(e){jQuery(window).load(function(){var t=localStorage.getItem("sidebarState");tjlms.lesson.hideRightPanel(),heighttominus="undefined"!=typeof heighttominus?heighttominus:46,iframeheighttominus=50;var a=jQuery(".tjlms_lesson_screen",top.document).height();if(a||(a=jQuery(document).height()),a||(a="400"),jQuery("[data-js-attr='tjlms-lesson']").css("height",a-heighttominus),jQuery("[data-js-attr='tjlms-lesson-iframe']").css("height",a-iframeheighttominus),"popup"==launchLessonFullScreen&&"preview"!=launchMode&&(window.parent.document.body.style.overflow="hidden"),jQuery(window).width()<768&&jQuery("[data-js-attr='lesson-toolbar-content']").insertBefore('[data-js-attr="lesson-player"]'),1==showLessonPlaylist){if(e){var s=jQuery("#modlist_"+e+' [data-jstoggle="collapse"]');jQuery(s).toggleClass("collapsed");var o=jQuery(s).attr("data-target");jQuery(o).toggleClass("in")}jQuery('[data-jstoggle="collapse"]').click(function(){jQuery(this).toggleClass("collapsed");var e=jQuery(this).attr("data-target");jQuery(e).toggleClass("in")}),null==t?(jQuery("[data-js-id='playlist-hide']").show(),jQuery("[data-js-attr='lesson-playlist']").removeClass("hidden"),tjlms.lesson.toggleLessonPanels()):jQuery("[data-js-id='playlist-open']").show(),jQuery("[data-js-attr='tjlms-lesson__playlist-toggle']").click(function(){jQuery("[data-js-attr='lesson-playlist']").toggle(),jQuery(window).width()<767?jQuery("[data-js-attr='lesson-playlist']").removeClass("hidden hidden-xs"):jQuery("[data-js-attr='lesson-playlist']").removeClass("hidden"),tjlms.lesson.toggleLessonPanels(),jQuery(".tjlms-lesson__playlist-container").is(":visible")?(jQuery("[data-js-id='playlist-open']").hide(),jQuery("[data-js-id='playlist-hide']").show(),localStorage.removeItem("sidebarState")):(jQuery("[data-js-id='playlist-hide']").hide(),jQuery("[data-js-id='playlist-open']").show(),localStorage.setItem("sidebarState","collapsed"))})}jQuery("[data-js-attr='toolbar_buttons']").click(function(){if(jQuery(this).hasClass("active"))return jQuery(this).removeClass("active"),tjlms.lesson.hideRightPanel(),void tjlms.lesson.toggleLessonPanels();jQuery(".toolbar_buttons").not("[data-ref='jliketoolbar-menu']").removeClass("active"),jQuery(this).addClass("active"),tjlms.lesson.showRightPanel(),jQuery(".toolbar-content").hide();var e=jQuery(this).data("ref");jQuery("#"+e).show(),"comments"==e&&jQuery("#divaddcomment a.jlike_comment_msg").trigger("click"),tjlms.lesson.toggleLessonPanels()}),jQuery("[data-ref='jliketoolbar-menu']").click(function(){jQuery(this).toggleClass("active"),jQuery("#jlikeToolbar").toggleClass("open"),jQuery(this).hasClass("active")||(jQuery(".toolbar_buttons").removeClass("active"),tjlms.lesson.hideRightPanel()),tjlms.lesson.toggleLessonPanels()}),jQuery("[data-js-attr='jlikeToolbar-close'][data-js-id!='test-premise-close'], .resumewindowclose[data-js-id!='test-premise-close']").click(function(){if("undefined"!=typeof lessonStartTime){var e=new Date-lessonStartTime,t=Math.round(e/1e3);plugdataObject.time_spent=t,updateData(plugdataObject)}else void 0!==jQuery.fn.onBeforeUnloadLessonPageUnload&&jQuery.fn.onBeforeUnloadLessonPageUnload();1==confirm(Joomla.JText._("COM_TJLMS_LESSON_CONFIRM_BOX"))&&closePopup(launchLessonFullScreen,returnUrl)}),jQuery("[data-js-id='test-premise-close']").click(function(){closePopup(launchLessonFullScreen,returnUrl)})})},toggleLessonPanels:function(){var e="col-sm-12";jQuery("[data-js-attr='lesson-playlist']").is(":hidden")&&!jQuery("[data-js-attr='lesson-toolbar-content']").is(":hidden")?e="col-sm-8":!jQuery("[data-js-attr='lesson-playlist']").is(":hidden")&&jQuery("[data-js-attr='lesson-toolbar-content']").is(":hidden")?e="col-sm-9":jQuery("[data-js-attr='lesson-playlist']").is(":hidden")||jQuery("[data-js-attr='lesson-toolbar-content']").is(":hidden")||(e="col-sm-5"),jQuery("[data-js-attr='lesson-player']").attr("class","tjlms_lesson__player tjlms-lesson-player "+e),jQuery(window).width()<768&&(jQuery("[data-js-attr='lesson-toolbar-content']").is(":hidden")?(jQuery("[data-js-attr='tjlms-lesson']").removeClass("y-scroll"),jQuery("[data-js-attr='lesson-player']").removeClass("hidden")):(jQuery("[data-js-attr='tjlms-lesson']").addClass("y-scroll"),jQuery("[data-js-attr='lesson-player']").addClass("hidden")))},showRightPanel:function(){jQuery("[data-js-attr='lesson-toolbar-content']").show()},hideRightPanel:function(){jQuery("[data-js-attr='lesson-toolbar-content']").hide()}},printDiv:function(){var e=document.getElementById("printDiv").innerHTML,t=document.body.innerHTML;document.body.innerHTML=e,window.print(),document.body.innerHTML=t},tjAdjustFormClass:function(){jQuery(window).width()<767?jQuery("#coupon-form, #payment-info").removeClass("form-horizontal"):jQuery("#coupon-form, #payment-info").addClass("form-horizontal"),jQuery("#characterLeft").text("250 characters left"),jQuery("#addr").keyup(function(){var e=jQuery(this).val().length;if(e>=250)jQuery("#characterLeft").text(" you have reached the limit");else{var t=250-e;jQuery("#characterLeft").text(t+" characters left")}})},resizeForm:function(){jQuery(document).ready(function(e){tjlms.tjAdjustFormClass(),jQuery(window).on("resize",function(){tjlms.tjAdjustFormClass()}),jQuery(document).on("changed","#MyWizard",function(e,t){tjlms.tjAdjustFormClass()})})},coupon:{init:function(){tjlms.resizeForm(),jQuery(".coupon-courses").change(function(){tjlms.coupon.loadSubscription()})},loadSubscription:function(){var e=jQuery("#jform_course_id").val();e&&jQuery.ajax({url:Joomla.getOptions("system.paths").root+"/index.php?option=com_tjlms&task=coupon.loadSubscription&format=json",type:"POST",data:{course_id:e},dataType:"json",beforeSend:function(){jQuery("#jform_subscription_id").empty()},success:function(e){if(e.data){var t=e.data;jQuery.each(t,function(e,t){var a=jQuery('<optgroup id="'+t.id+'" label="'+t.title+'" >');jQuery.each(t.subscription,function(e,t){var s=jQuery('<option value="'+t.id+'">'+t.name+"</option>");a.append(s)}),jQuery("#jform_subscription_id").append(a),jQuery("#jform_subscription_id").trigger("liszt:updated")})}}})}},subscription:{init:function(){jQuery("#coupon_chk").prop("checked",!1),jQuery("#total_amt_inputbox").val(0),jQuery("#net_amt_pay_inputbox").val(0),jQuery("#coupon_code").val(),jQuery("#order_tax").val(0),array_sub_plan=JSON.parse(array_sub_plan),tjlms.subscription.caltotal(jQuery("#coursesubsplan_radio").val()),jQuery("#coupon_code").keypress("input",function(e){"Enter"===e.key&&e.preventDefault()})},show_cop:function(){if(jQuery("#dis_amt").show(),jQuery("#net_amt_pay_inputbox").val(parseFloat(jQuery("#total_amt_inputbox").val())),jQuery("#net_amt_pay").html(parseFloat(jQuery("#total_amt_inputbox").val())),jQuery("#coupon_chk").is(":checked")){if(total_calc_amt2=0,get_selected_plan=jQuery("#coursesubsplan_radio").val(),get_selected_plan&&(total_calc_amt2=array_sub_plan[get_selected_plan].price),!total_calc_amt2)return alert(Joomla.JText._("TJLMS_SELECT_SUBS_PLAN")),void(document.getElementById("coupon_chk").checked=!1);document.getElementById("coup_button").removeAttribute("disabled"),jQuery("#cop_tr, #coupon_code, #coup_button").show()}else{var e=parseFloat(jQuery("#net_amt_pay_inputbox").val());1==jQuery("#allow_taxation").val()&&tjlms.subscription.calculatetax(e),jQuery("#cop_tr, #coupon_code, #coup_button, #dis_cop").hide(),jQuery("#dis_amt").show(),jQuery("#dis_cop_amt").html(),jQuery("#coupon_code").val("")}},applycoupon:function(){if(jQuery("#coupon_chk").is(":checked"))if(""==jQuery("#coupon_code").val())document.getElementById("coup_button").removeAttribute("disabled"),alert(Joomla.JText._("COM_TJLMS_ENTER_COP_COD")),jQuery("#net_amt_pay").html(parseFloat(jQuery("#total_amt_inputbox").val())),jQuery("#dis_cop").hide(),jQuery("#coupon_code").val(""),jQuery("#coupon_code").focus();else{var e=document.getElementById("coupon_code").value,t=document.getElementById("course_id").value,a=jQuery("#coursesubsplan_radio").val();jQuery.ajax({url:tjlms_baseurl+"?option=com_tjlms&task=buy.getcoupon&coupon_code="+document.getElementById("coupon_code").value,type:"POST",data:{coupon_code:e,course_id:t,selected_plan:a},dataType:"json",success:function(e){if(amt=0,val=0,1==parseInt(e[0].error))return alert(e[0].msg),jQuery("#net_amt_pay").html(parseFloat(jQuery("#total_amt_inputbox").val())),jQuery("#dis_cop").hide(),jQuery("#coupon_code").val(""),void jQuery("#coupon_code").focus();parseFloat(e[0].value)>0&&(1==e[0].val_type?value=e[0].value/100*document.getElementById("total_amt_inputbox").value:value=e[0].value,val=parseFloat(value).toFixed(2),finalvar=0,get_selected_plan=jQuery("#coursesubsplan_radio").val(),finalvar=array_sub_plan[get_selected_plan].price,amount=parseFloat(finalvar)-parseFloat(val),parseFloat(amount)<=0&&(amount=0),isNaN(finalvar)&&(amount=0),amt=parseFloat(amount).toFixed(2),jQuery("#net_amt_pay_inputbox").val(amt),jQuery("#net_amt_pay").html(amt),1==jQuery("#allow_taxation").val()&&tjlms.subscription.calculatetax(amt),jQuery("#dis_cop_amt").html(""+val),jQuery("#dis_amt, #dis_cop").show())}})}},calculatetax:function(e){jQuery.ajax({url:tjlms_baseurl+"?option=com_tjlms&task=buy.applytax&tmpl=component&total_calc_amt="+e,type:"GET",dataType:"json",success:function(t){if(null!=t&&parseFloat(t.taxvalue)>0){jQuery("#order_tax").val(parseFloat(t.taxvalue));var a=jQuery("#order_tax").val(),s=tjlms.subscription.round(a,2);jQuery("#tax_to_pay").html(s),jQuery("#tax_to_pay_inputbox").val(s);var o=parseFloat(s)+parseFloat(e),r=tjlms.subscription.round(o,2);jQuery("#net_amt_after_tax").html(r),jQuery("#net_amt_after_tax_inputbox").val(r),jQuery("#tax_tr").show()}else{jQuery("#order_tax").val(0),jQuery("#tax_to_pay").html(0),jQuery("#tax_to_pay_inputbox").val(0);r=parseFloat(e);jQuery("#net_amt_after_tax").html(e),jQuery("#net_amt_after_tax_inputbox").val(e),jQuery("#tax_tr").hide()}}})},caltotal:function(e){total_calc_amt=array_sub_plan[e].price;var t=0;0==parseInt(total_calc_amt)?jQuery("#cooupon_troption").hide():(t=1,jQuery("#cooupon_troption").show()),1==t&&jQuery("#coupon_chk").is(":checked")&&""!=jQuery("#coupon_code").val()&&tjlms.subscription.applycoupon(),isNaN(total_calc_amt)&&(total_calc_amt=0),jQuery("#total_amt").html("<b>"+total_calc_amt+currency),jQuery("#total_amt_inputbox").val(total_calc_amt),jQuery("#net_amt_pay").html(total_calc_amt),jQuery("#net_amt_pay_inputbox").val(total_calc_amt),1==jQuery("#allow_taxation").val()&&tjlms.subscription.calculatetax(total_calc_amt),document.getElementById("selected_plan").value=e},round:function(e){return Math.round(100*e+(1e3*e%10>4?1:0))/100}},billing:{init:function(e,t){tjlms.billing.generateState("country",e,t)},generateoption:function(e,t,a){var s,o;jQuery("#"+t).val();"country"==t&&(o=jQuery("#state"),default_opt="Select State"),o.find("option").remove().end(),selected='selected="selected"';var r="<option "+selected+' value="">'+default_opt+"</option>";if("country"==t&&jQuery("#state").append(r),e.length>0)for(jQuery("#state_star").text("*"),jQuery("#state").attr("required","required"),e.options,s=0;s<e.length;++s){var n=e[s].id;selected="",n==a&&(selected='selected="selected"');r="<option "+selected+' value="'+e[s].id+'">'+e[s].region+"</option>";"country"==t&&jQuery("#state").append(r)}else jQuery("#state_lbl").removeClass("invalid"),jQuery("#state_star").text(""),jQuery("#state").removeAttr("required","required")},generateState:function(e,t,a){var s=jQuery("#"+e).val();if(null==s||""==s)return!1;jQuery.ajax({url:root_url+"index.php?option=com_tjlms&task=buy.loadState&country="+s+"&tmpl=component",type:"GET",dataType:"json",success:function(a){"country"==e&&(statebackup=a),tjlms.billing.generateoption(a,e,t)}})}},gateway:{init:function(){tjlms.resizeForm()},gatewayHtml:function(e,t){var a='<div class="col-xs-12 col-sm-3 list-group-item-heading">';a+='<button id="btnWizardPrev1" onclick="jQuery(\'#MyWizard\').wizard(\'previous\');" type="button" class="col-xs-12 btn btn-prev pull-left">',a+='<i class="fa fa-arrow-circle-o-left"></i>',a+=" "+Joomla.JText._("COM_TJLMS_PREV_BUTTON"),a+="</button>",a+="</div>";jQuery.ajax({url:root_url+"index.php?option=com_tjlms&task=payment.changegateway&gateways="+e+"&order_id="+t,type:"POST",data:"",dataType:"text",success:function(e){e&&(jQuery("#tjlms-payHtmlDiv").html(e),jQuery("#tjlms-payHtmlDiv div.form-actions").append(a),jQuery('#tjlms-payHtmlDiv div.form-actions input[type="submit"]').addClass("pull-right").css("min-width","100%").wrap('<div class="col-xs-12 col-sm-3 pull-right list-group-item-heading">'),jQuery('#tjlms-payHtmlDiv div.form-actions input[type="submit"]').addClass("paymentButton"),jQuery(".paymentButton").click(function(){"undefined"!=typeof tjanalytics&&tjlms.gateway.addGatewayStep(t)}),jQuery("#tjlms-payHtmlDiv div.form-actions").addClass("tjlms-confirm-payment-div"),jQuery("#payment-info").find(".form-horizontal").removeClass("form-horizontal"))}})},addGatewayStep:function(e){jQuery.ajax({url:root_url+"index.php?option=com_tjlms&task=buy.generateOrderData&order_id="+e,type:"POST",data:"",dataType:"text",success:function(e){e&&(e=JSON.parse(e),tjanalytics.ga.addProduct(e),tjanalytics.ga.setAction(e[0]))}})}},utility:{inIframe:function(){try{return window.self!==window.top}catch(e){return!0}}},test:{autosaveTimeout:1e3,autosaveAnswers:1,totalQuestions:0,gradingType:"",currentPage:0,totalPages:0,inviteId:0,questionNumber:0,pagesVisited:[],init:function(e,t,a,s){a&&void 0!==a||(a="default");var o=this;jQuery(window).load(function(){if(jQuery("[data-js-id='test-premise-close']").click(function(){closePopup(e,t)}),"default"==a){const a=o.inviteId,c=o.testId,m=o.gradingType,j=o.currentPage;tjlms.test.showQuestionsList(c,a,j),jQuery("#tmt-page-selection").bootpag({total:tjlms.test.totalPages,page:j,maxVisible:5}).on("page",function(e,t){tjlms.test.saveEachPageQueAnswers(),tjlms.test.showQuestionsList(c,a,t),tjlms.test.checkNotAttemptedCompulsory()});var r=jQuery("#invite_id").val(),n=jQuery(".test__timer #countdown_timer"),i=jQuery('[data-js-id="form-token"]').attr("name"),l={};l[i]=1,l.ltId=r,l.testId=c,l.timeSpent=3,finalDate=new Date((new Date).valueOf()+testTimeremaning);var u,d=!0;0!=testTimeDuration&&(d=!1),n.countdown(finalDate,{elapse:d}).on("update.countdown",function(e){jQuery(this).html(e.strftime("%H:%M:%S")),0!=timeToShowFinishAlert&&e.strftime("%T")<timeToShowFinishAlert&&jQuery(this).addClass("text-error"),e.offset.seconds%3==0&&jQuery.ajax({url:root_url+"index.php?option=com_tmt&task=test.updateTimeSpent&format=json",dataType:"json",type:"POST",data:l,success:function(e){}})}).on("finish.countdown",function(e){var t={};t[i]=1,t.ltId=r,t.testId=c,jQuery.ajax({url:root_url+"index.php?option=com_tmt&task=test.updateTimeSpent&format=json",dataType:"json",type:"POST",data:t,success:function(e){}});tjlms.test.submitTest(1)&&(window.location=jQuery("#thankYouLink").val())}),jQuery(document).on("input propertychange","[data-js-id='test-question'][data-js-type='textarea'] textarea, [data-js-id='test-question'][data-js-type='text'] input, [data-js-id='test-question'][data-js-type='radio'] input, [data-js-id='test-question'][data-js-type='checkbox'] input,[data-js-id='test-question'][data-js-type='rating'] input",function(){if(1===parseInt(tjlms.test.autosaveAnswers)){var e=jQuery(this);"radio"==jQuery(this).attr("type")||"checkbox"==jQuery(this).attr("type")?tjlms.test.saveEachAnswer(e):(clearTimeout(u),u=setTimeout(function(){tjlms.test.validateQuestionAnswer(e)&&tjlms.test.saveEachAnswer(e)},3e3))}}),jQuery("[data-js-id='test-close']").click(function(){let a=0;if(tjlms.test.checkNotAttemptedCompulsory(),a=jQuery("#unAttemptedCompulsoryCnt").val(),parseInt(a)>0)alert(Joomla.JText._("COM_TMT_TEST_SUBMIT_VALIDATION_FOR_COMPULSORY_MSG"));else if(1==confirm(Joomla.JText._("COM_TJLMS_QUIZ_CONFIRM_BOX"))){var o=1;0==s&&(o=0,tjlms.test.submitTest()&&(o=1)),1==o&&("popup"==e?window.parent.SqueezeBox.close():"tab"==e?(opener&&opener.location.reload(),window.close()):window.location=t)}}),jQuery("[data-js-id='submittest']").click(function(){var e="";switch(m){case"exercise":e="COM_TMT_TEST_APPEAR_FINISH_EXERCISE";break;case"feedback":e="COM_TMT_TEST_APPEAR_FINISH_FEEDBACK";break;case"quiz":e="COM_TMT_TEST_APPEAR_FINISH_QUIZ"}let t=0;tjlms.test.checkNotAttemptedCompulsory(),t=jQuery("#unAttemptedCompulsoryCnt").val(),parseInt(t)>0?alert(Joomla.JText._("COM_TMT_TEST_SUBMIT_VALIDATION_FOR_COMPULSORY_MSG")):1==confirm(Joomla.JText._(e))&&tjlms.test.submitTest()&&(window.location=jQuery("#thankYouLink").val())}),jQuery("[data-js-id='toolbar'] [data-js-id='toolbar-next'] button, [data-js-id='toolbar'] [data-js-id='toolbar-prev'] button").click(function(){tjlms.test.saveEachPageQueAnswers();let e=0;"toolbar-next"==jQuery(this).closest(".toolbar__span").attr("data-js-id")?e=parseInt(tjlms.test.currentPage)+1:"toolbar-prev"==jQuery(this).closest(".toolbar__span").attr("data-js-id")&&(e=parseInt(tjlms.test.currentPage)-1),jQuery("#tmt-page-selection").bootpag({page:e}),tjlms.test.showQuestionsList(c,a,e)}),jQuery("[data-js-id='drafttest']").click(function(){1==confirm(Joomla.JText._("COM_TMT_TEST_DRAFT_CONFIRM_BOX"))&&tjlms.test.saveEachPageQueAnswers(jQuery("#thankYouLink").val())}),jQuery(document).on("change","[data-js-type='file_upload'] input[type='file']",function(){thisfile=jQuery(this);var e=jQuery(thisfile)[0].files[0];if(!e)return!1;tjlms.test.checkNotAttemptedCompulsory(),parseInt(jQuery("#unAttemptedCompulsoryCnt").val())>0&&jQuery(".tmt_test__footer__navbutton").attr("disabled","disabled");var t=new FormData;t.append("FileInput",e);var a=jQuery(this).closest('[data-js-id="test-question"]').attr("data-js-itemid"),s=jQuery('[name="test[id]"]').val(),o=jQuery('[name="invite_id"]').val();t.append("mediaformat","quiz"),t.append("subformat","answer"),t.append("formatData[quiz][answer][qid]",a),t.append("formatData[quiz][answer][testid]",s),t.append("formatData[quiz][answer][ltid]",o),tjLmsCommon.file.$file=thisfile,tjLmsCommon.file.formData=t,tjLmsCommon.file.allowedSize=lessonUploadSize;let r=jQuery("[name='testqparam["+a+"][file_size]']");r.length&&r.val()>0&&(tjLmsCommon.file.allowedSize=r.val()),tjLmsCommon.file.showstatusbar=!0;let n=jQuery("[name='testqparam["+a+"][file_count]']");var i=jQuery('[data-js-itemid="'+a+'"] [data-js-id="uploaded-file-list"] > div[data-js-id="each-file"]').length;if(n.length&&""!=n.val()&&i>=n.val())return jQuery("#msg_"+a).attr("class","alert alert-error").text(Joomla.JText._("COM_TJLMS_MAX_NUMBER_OF_FILE_UPLOAD_ERROR_MSG").replace("%s",n.val())),jQuery(".tmt_test__footer__navbutton").removeAttr("disabled"),!1;tjLmsCommon.file.upload()}),jQuery(document).on("click","[data-js-type='file_upload'] [data-js-id='delete']",function(){if(1==confirm("Are you sure you want to delete this uploaded file?")){var e=jQuery(this).closest('[data-js-id="each-file"]'),t=jQuery(this).closest('[data-js-id="test-question"]').attr("data-js-itemid"),a=jQuery(this).closest('[data-js-id="each-file"]').attr("data-js-answerid"),s=jQuery(this).closest('[data-js-id="each-file"]').attr("data-js-itemid"),o=jQuery('[data-js-id="form-token"]').attr("name"),r=rootUrl+"index.php?option=com_tmt&task=test.removeFileuploadAnswer&tmpl=component&format=json",n={};n[o]=1,n.answerId=a,n.answerMediaId=s,tjService.postData(r,n).fail(function(e){var a=[];a.error="1",a.msg=e.responseText,tjlms.test.eachQuestionSaveMsg(t,a)}).done(function(a){var o=[];o.error="0",a.success?(jQuery(e).remove(),jQuery('input[name="questions[upload]['+t+'][]"][value="'+s+'"]').remove(),0==jQuery('[data-js-itemid="'+t+'"] [data-js-id="uploaded-file-list"] > div[data-js-id="each-file"]').length&&jQuery('[data-js-itemid="'+t+'"] .test-question__answers').find('[data-js-id="uploaded-file-list-header"]').addClass("d-none")):o.error="1",o.msg=a.message,tjlms.test.eachQuestionSaveMsg(t,o)})}return!0}),jQuery(document).on("keyup","[data-js-type='textarea'] textarea",function(){let e=parseInt(jQuery(this).val().length),t=parseInt(jQuery(this).attr("maxlength")),a=parseInt(jQuery(this).attr("minlength")),s=t-e;jQuery(this).closest("[data-js-type='textarea']").find(".charscontainer_remaining").text(s),jQuery(this).closest("[data-js-type='textarea']").find(".charscontainer").removeClass("invalid"),a>0&&0==e&&jQuery(this).closest("[data-js-type='textarea']").find(".charscontainer").addClass("invalid"),t>0&&e>t&&jQuery(this).closest("[data-js-type='textarea']").find(".charscontainer").addClass("invalid"),0!=e&&e<a?(jQuery(this).closest("[data-js-type='textarea']").find(".charscontainer").addClass("invalid"),jQuery(".tmt_test__footer__navbutton").attr("disabled","disabled")):jQuery(this).closest("[data-js-type='textarea']").find(".charscontainer").removeClass("invalid")})}})},validateQuestionAnswer:function(e){if(e.is("textarea")){let t=parseInt(e.val().length),a=parseInt(e.attr("maxlength")),s=parseInt(e.attr("minlength"));if(s>0&&t<s&&0!==t||a>0&&t>a)return jQuery(".tmt_test__footer__navbutton").attr("disabled","disabled"),!1;(s||a)&&jQuery(".tmt_test__footer__navbutton").removeAttr("disabled")}return!0},resetAnswerOptions:function(e,t){let a="";switch(e){case"checkbox":case"radio":jQuery('input[name="questions[mcqs]['+t+'][]"]').attr("checked",!1),a=jQuery('input[name="questions[mcqs]['+t+'][]"]');break;case"rating":jQuery('input[name="questions[rating]['+t+']"]').attr("checked",!1),a=jQuery('input[name="questions[rating]['+t+']"]');break;case"text":case"textarea":jQuery("#questions"+t).val("").change(),a=jQuery("#questions"+t)}tjlms.test.validateQuestionAnswer(a)&&tjlms.test.saveEachAnswer(a)},flagQuestion:function(e,t){let a,s=rootUrl+"index.php?option=com_tmt&task=test.flagQuestion&format=json",o={testId:testId,qId:t,invite_id:inviteId},r=tjService.postData(s,o),n=!1;return r.fail(function(e){var t={error:[e]};Joomla.renderMessages(t)}).done(function(s){if(!s.success&&s.message){var o={error:[s.message]};Joomla.renderMessages(o),n=!1}s.messages&&Joomla.renderMessages(s.messages),s.success&&(n=!0,a=s.data,jQuery("#question"+t+" > span").hasClass("fa fa-flag")?(jQuery("#question"+t+" > span").removeClass("fa fa-flag"),jQuery(e).text(Joomla.JText._("COM_TMT_QUESTION_FLAG"))):(jQuery("#question"+t+" > span").addClass("fa fa-flag"),jQuery(e).text(Joomla.JText._("COM_TMT_QUESTION_UNFLAG"))))}),n?a:n},showQuestionsList:function(e,t,a=1){if("-1"!=tjlms.test.pagesVisited.indexOf(a))return jQuery(".questions_container .tjlms-test-page").hide(),jQuery(".questions_container .tjlms-test-page#testPage"+a).show(),tjlms.test.currentPage=a,void tjlms.test.testactions();let s=tjlms.test.getTestSectionsQuestions(e,t,a);if(tjlms.test.questionNumber=a*testPaginationLimit-testPaginationLimit+1,s.sections.length<1)return!1;jQuery(s.sections).each(function(e,t){if(t.questions.length>0){const e=jQuery("<div class='tjlms-test-page' id='testPage"+a+"'></div>"),o=jQuery("<div class='tjlms-test-section'></div>");jQuery('<h3 class="tjlms-test-section__title"></h3>').appendTo(o).text(t.title),jQuery(o).appendTo(e),jQuery(".questions_container").append(e),jQuery("#attempted_qlist_container").append('<div class="clearfix center"><strong>'+t.title+"</strong></div>");t.questions;jQuery(t.questions).each(function(t,a){doProcess=!0,""==a.userAnswer?qClass="":qClass="tmt-circle--attempted",jQuery("#attempted_qlist_container").append('<a href="'+currentPageUrl+"#question-"+a.question_id+'">  <div id="question'+a.question_id+'" class="tmt-circle tmt-circle--margin pull-left '+qClass+'"> <span class="tmt-circle--flag">&nbsp;</span>'+tjlms.test.questionNumber+" </div> </a>"),1==a.flagged&&(qClass="fa fa-flag",jQuery("#question"+a.question_id+" > span").addClass("fa fa-flag"));var o=Joomla.getOptions("system.paths").root+"/index.php?option=com_tmt&task=test.getQuestionHtml&format=json";tjService.postData(o,{test:s.test,question:a,qNo:tjlms.test.questionNumber}).fail(function(e){doProcess=!1;var t={error:[e]};Joomla.renderMessages(t)}).done(function(t){if(!t.success&&t.message){var a={error:[t.message]};Joomla.renderMessages(a),doProcess=!1}t.messages&&Joomla.renderMessages(response.messages),doProcess=!0,t.data&&(jQuery(t.data).appendTo(e),tjlms.test.questionNumber++)})})}SqueezeBox.assign(jQuery("a.tjmodal"),{parse:"rel"})}),jQuery(".questions_container .tjlms-test-page").hide(),jQuery(".questions_container .tjlms-test-page#testPage"+a).show(),tjlms.test.currentPage=a,tjlms.test.testactions(),tjlms.test.pagesVisited.push(parseInt(a))},getTestSectionsQuestions:function(e,t,a){let s,o=Joomla.getOptions("system.paths").root+"/index.php?option=com_tmt&task=test.getTestSectionsQuestions&format=json",r={id:e,invite_id:t,pageNo:a},n=tjService.postData(o,r),i=!1;return n.fail(function(e){var t={error:[e]};Joomla.renderMessages(t)}).done(function(e){if(!e.success&&e.message){var t={error:[e.message]};Joomla.renderMessages(t),i=!1}e.messages&&Joomla.renderMessages(e.messages),e.success&&(i=!0,s=e.data,jQuery(".quiz_content").scrollTop("0"))}),i?s:i},saveEachAnswer:function(e){var t=jQuery(e).closest('[data-js-id="test-question"]').attr("data-js-itemid"),a=jQuery('[name="test[id]"]').val(),s=jQuery('[name="invite_id"]').val(),o=jQuery(e).val(),r=jQuery('[data-js-id="form-token"]').attr("name");if("radio"===jQuery(e).attr("type")||"checkbox"===jQuery(e).attr("type")){var n=[];jQuery(e).closest('[data-js-id="test-question"]').find(":"+jQuery(e).attr("type")).each(function(){this.checked&&n.push(jQuery(this).val())}),o=n.join()}else if("file"===jQuery(e).attr("type")){n=[];jQuery(e).closest('[data-js-id="test-question"]').find('[data-js-id="each-file"]').each(function(){n.push(jQuery(this).attr("data-js-itemid"))}),o=n.join()}var i=!0,l={};l.testId=a,l.ltId=s,l.questionId=t,l.answer=o,l[r]=1;var u=rootUrl+"index.php?option=com_tmt&task=test.saveQuestionAnswer&tmpl=component&format=json";return tjService.postData(u,l).fail(function(e){var a=[];a.error="1",a.msg=e.responseText,tjlms.test.eachQuestionSaveMsg(t,a),i=!1}).done(function(e){var r=[];if(r.msg=e.message,r.error="0",e.success){i=!0;var n=tjlms.test.getAttemptedQuestionsCnt(a,s),l=100*n/tjlms.test.totalQuestions,u=Joomla.JText._("COM_TMT_TEST_APPEAR_ATTEMPTED_OF").replace("%s",n).replace("%s",tjlms.test.totalQuestions);jQuery('[data-js-id="test-controls"] .progress .progress-bar').width(l+"%").attr("aria-valuenow",l),jQuery('[data-js-id="test-controls"] .progress .progress-bar .progress_bar_text').text(u),tjlms.test.checkNotAttemptedCompulsory(),""!==o?jQuery("#question"+t).addClass("tmt-circle--attempted"):""==o&&jQuery("#question"+t).removeClass("tmt-circle--attempted")}else r.error="1",tjlms.test.eachQuestionSaveMsg(t,r),i=!1}),i},getAttemptedQuestionsCnt:function(e,t){var a={testId:e,ltId:t},s=rootUrl+"index.php?option=com_tmt&task=test.getTotalAttemptedQuestion&tmpl=component&format=json",o=tjService.postData(s,a),r=0;return o.fail(function(e){r=0}).done(function(e){r=e.data}),r},showFileinUploadlist:function(e){var t='<div class="col-sm-6" data-js-id="each-file" data-js-itemid="'+e.media_id+'" data-js-answerid="'+e.answer_id+'"><a class="mr-5" href="'+e.path+'">'+e.org_filename+'</a><a href="javascript:void(0)" data-js-id="delete" title="'+Joomla.JText._("COM_TMT_DELETE_ITEM")+'"><i class="fa fa-trash" aria-hidden="true"></i></a></div><input type="hidden" name="questions[upload]['+e.qid+'][]" value="'+e.media_id+'"/>';jQuery('[data-js-itemid="'+e.qid+'"] [ data-js-id="uploaded-file-list-header"]').removeClass("d-none"),jQuery(t).appendTo(jQuery('[data-js-itemid="'+e.qid+'"] [data-js-id="uploaded-file-list"]')),tjlms.test.saveEachAnswer(jQuery('[data-js-itemid="'+e.qid+'"] input[type="file"]'))&&jQuery(".tmt_test__footer__navbutton").removeAttr("disabled");var a=jQuery('[data-js-itemid="'+e.qid+'"] [data-js-id="uploaded-file-list"] > div[data-js-id="each-file"]').length;let s=jQuery("[name='testqparam["+e.qid+"][file_format]']");s.length&&""!=s.val()&&a>=s.val()&&jQuery('[data-js-itemid="'+e.qid+'"].fileupload .btn-file').attr("disabled")},eachQuestionSaveMsg:function(e,t){var a=jQuery('[data-js-id="test-question"][data-js-itemid="'+e+'"]');"1"==t.error?(jQuery('[data-js-id="test-question-msg"] .alert',a).addClass("alert-error"),jQuery('[data-js-id="test-question-msg"] .alert',a).html(t.msg),jQuery('[data-js-id="test-question-msg"]',a).removeClass("d-none")):(jQuery('[data-js-id="test-question-msg"] .alert',a).addClass("alert-success"),jQuery('[data-js-id="test-question-msg"] .alert',a).html(t.msg),jQuery('[data-js-id="test-question-msg"]',a).removeClass("d-none"))},checkNotAttemptedCompulsory:function(){let e=0;jQuery(".questions_container .tjlms-test-page").each(function(){const t=jQuery(this),a=jQuery(this).attr("id").replace("testPage","");let s=0;jQuery(t).find("[data-js-compulsory='1']").each(function(){let e="";if("text"==jQuery(this).attr("data-js-type")&&(e=jQuery(this).find("input").val()),"textarea"==jQuery(this).attr("data-js-type")&&(e=jQuery(this).find("textarea").val()),"radio"===jQuery(this).attr("data-js-type")||"checkbox"===jQuery(this).attr("data-js-type")||"rating"===jQuery(this).attr("data-js-type")){var t=[],a=jQuery(this).attr("data-js-type");"rating"===jQuery(this).attr("data-js-type")&&(a="radio"),jQuery(this).find(":"+a).each(function(){this.checked&&t.push(jQuery(this).val())}),e=t.join()}else if("file_upload"===jQuery(this).attr("data-js-type")){t=[];jQuery(this).find('[data-js-id="each-file"]').each(function(){t.push(jQuery(this).attr("data-js-itemid"))}),e=t.join()}""==e&&s++}),jQuery("#tmt-page-selection [data-lp='"+a+"'] .mandatory-notification").remove(),e+=s,jQuery("#unAttemptedCompulsoryCnt").val(e),s>0&&jQuery("#tmt-page-selection [data-lp='"+a+"']").not(".prev").not(".next").append("<span class='mandatory-notification'>"+s+"</span>")})},saveEachPageQueAnswers:function(){var e=jQuery("#adminForm").serialize(),t=rootUrl+"index.php?option=com_tmt&task=test.saveEachPageQueAnswers&tmpl=component&format=json";tjService.postData(t,e).fail(function(e){var t={error:[e.responseText]};Joomla.renderMessages(t)}).done(function(e){if(!e.success&&e.message){var t={error:[e.message]};Joomla.renderMessages(t)}e.messages&&Joomla.renderMessages(e.messages),e.success})},submitTest:function(e){var t=jQuery("#adminForm").serialize(),a=rootUrl+"index.php?option=com_tmt&task=test.saveEachPageQueAnswers&tmpl=component&format=json",s=tjService.postData(a,t),o=!0;return s.fail(function(e){o=!1;var t={error:[e.responseText]};Joomla.renderMessages(t)}).done(function(t){if(!t.success&&t.message){o=!1;var a={error:[t.message]};Joomla.renderMessages(a)}if(t.messages&&Joomla.renderMessages(t.messages),t.success){let t=0;if(e||(tjlms.test.checkNotAttemptedCompulsory(),t=jQuery("#unAttemptedCompulsoryCnt").val()),parseInt(t)>0)alert(Joomla.JText._("COM_TMT_TEST_SUBMIT_VALIDATION_FOR_COMPULSORY_MSG")),o=!1;else{var s=jQuery('[data-js-id="form-token"]').attr("name"),r=jQuery('[name="test[id]"]').val(),n=jQuery('[name="invite_id"]').val(),i={};i.testId=r,i.ltId=n,i[s]=1;var l=rootUrl+"index.php?option=com_tmt&task=test.submitTest&tmpl=component&format=json";tjService.postData(l,i).fail(function(e){o=!1;var t={error:[e.responseText]};Joomla.renderMessages(t)}).done(function(e){if(!e.success&&e.message){o=!1;var t={error:[e.message]};Joomla.renderMessages(t)}!e.success&&e.messages&&Joomla.renderMessages(e.messages),o=!0})}}}),o},checkcount:function(e,t,a,s){var o=[];jQuery('input[name="questions[mcqs]['+t+'][]"]:checked').length>e&&"feedback"!=s&&(jQuery('input[value="'+a+'"]').removeAttr("checked"),o.error="1",o.msg=Joomla.JText._("COM_TMT_TEST_MAX_OPTION_ATTEMPT_VALIDATION"),tjlms.test.eachQuestionSaveMsg(t,o))},testactions:function(){let e=1==this.currentPage?1:0,t=parseInt(this.totalPages),a=parseInt(this.gradingType),s=t==this.currentPage?1:0;jQuery("[data-js-id='toolbar']").addClass("d-inline-block").removeClass("d-none"),jQuery(".toolbar__span").hide(),(1==t||s)&&(jQuery("[data-js-id='toolbar'] [data-js-id='toolbar-final']").show(),"exercise"===a&&jQuery("[data-js-id='toolbar'] [data-js-id='toolbar-final']").show()),t>1&&!e&&!s&&(jQuery("[data-js-id='toolbar'] [data-js-id='toolbar-prev']").show(),jQuery("[data-js-id='toolbar'] [data-js-id='toolbar-next']").show()),t>1&&e&&!s&&jQuery("[data-js-id='toolbar'] [data-js-id='toolbar-next']").show(),t>1&&!e&&s&&jQuery("[data-js-id='toolbar'] [data-js-id='toolbar-prev']").show(),jQuery(".quiz_content").scrollTop("0")}},assessment:{$form:null,getUrl:function(){return("undefined"==typeof root_url?"":root_url)+"index.php?option=com_tjlms&task=assessment.submit&format=json"},init:function(e){jQuery(window).load(function(){height=jQuery(document).height(),jQuery("[data-js-attr='tjlms-lesson']").css("height",height-46),jQuery("[data-js-attr='tjlms-lesson-iframe']").css("height",height-50),jQuery("[data-js-id='tjlms-sidebar']").css("height",height-46),jQuery(window).width()<768&&jQuery("[data-js-attr='lesson-toolbar-content']").insertBefore('[data-js-attr="lesson-player"]'),jQuery(".closeBtn").click(function(){1==confirm(Joomla.JText._("COM_TJLMS_QUIZ_CONFIRM_BOX"))&&(window.location=e)}),jQuery(".collapse:first").addClass("in"),jQuery('[data-jstoggle="collapse"]').click(function(){jQuery(this).toggleClass("collapsed");var e=jQuery(this).attr("data-target");jQuery(e).toggleClass("in")}),tjlms.assessment.limitScoreInput()}),jQuery(document).ready(function(){jQuery("#assessment-form.noEditAccess input, #assessment-form.noEditAccess select, #assessment-form.noEditAccess textarea, #assessment-form.noEditAccess button:not(.closeBtn)").prop("disabled",!0)})},limitScoreInput:function(){var e=/^[0-9]*(?:\.[0-9]*)?$/;jQuery("#assessment-form").find(".textinput").on("keyup",function(t){if(!(!jQuery(this).val()||jQuery(this).val().match(e))||jQuery(this).val()>jQuery(this).data("maxval"))return jQuery(this).parents(".assessment_field").find(".msg").show().removeClass("hide"),jQuery(this).val(""),!1;jQuery(this).parents(".assessment_field").find(".msg").hide().addClass("hide")})},validate:function(e){if(1==parseInt(e)){var t=/^[0-9]*(?:\.[0-9]*)?$/,a=jQuery("input[name='gradingtype']").val(),s=!0;if("quiz"==a){if(this.$form.find("[data-js-id='test-review-question']").each(function(){var e=jQuery("[data-js-id='test-review-marks']",jQuery(this)).val(),a=parseInt(jQuery("[data-js-id='test-review-qmarks']",jQuery(this)).val(),10);if(jQuery("[data-js-id='test-review-msg']",jQuery(this)).addClass("hide"),!e.match(t)||isNaN(e)||e>a)return 1==s&&(s=!1),jQuery("[data-js-id='test-review-msg']",jQuery(this)).show().removeClass("hide"),void jQuery("[data-js-id='test-review-marks']",jQuery(this)).val("")}),!s)return!1}else{s=!0;if(this.$form.find(".assessment_field").each(function(e,t){if(jQuery(t).find("[name$='[rating_value]']").length&&!(s=(s=(s=(s=(s=!1)||!!jQuery(t).find("input[type='radio'][name$='[rating_value]']:checked").length)||!!jQuery(t).find("input[type='checkbox'][name$='[rating_value]']").length)||!!jQuery(t).find("input[type='text'][name$='[rating_value]']").val())||!!jQuery(t).find("select[name$='[rating_value]']").val()))return!1}),!s){var o=Joomla.JText._("COM_TJLMS_ASSESSMENTS_ARE_YOU_SURE");return confirm(o)}}}return!0},submit:function(e,t){if(this.$form=jQuery("#assessment-form"),!this.validate(e))return!1;var a=this;this.$form.find("button").prop("disabled",!0);var s=this.$form.serializeArray();s.push({name:"review_status",value:e}),tjService.postData(this.getUrl(),s).fail(function(e){jQuery(".assessment-form_msg .alert").removeClass("hide").removeClass("alert-success").addClass("alert-error").html(e.responseText),a.$form.find("button").prop("disabled",!1)}).done(function(t){if(a.$form.find("button").prop("disabled",!1),t.success){t.message;a.$form.find(".assessment-form_msg .alert").removeClass("hide").removeClass("alert-error").addClass("alert-success").html(t.message),a.$form.find(".assessment-form_score label strong").text(Joomla.JText._("COM_TJLMS_ASSESSMENTS_SCORE").replace("%s",t.data)),1==parseInt(e)&&(window.location=onSuceessredirectUrl)}else{t.message;a.$form.find(".assessment-form_msg .alert").removeClass("hide").removeClass("alert-success").addClass("alert-error").html(t.message)}})}}};function toggleexpand(e){jQuery(e).hasClass("tjcollapsed")?(jQuery(e).removeClass("tjcollapsed"),jQuery(e).addClass("tjexpanded")):jQuery(e).hasClass("tjexpanded")&&(jQuery(e).removeClass("tjexpanded"),jQuery(e).addClass("tjcollapsed")),togglestate()}function togglestate(){jQuery(".tjcollapsed").each(function(){var e=jQuery(this).attr("parentfor");jQuery("tr[childof="+e+"]").hide(),jQuery("i",this).addClass("icon-folder-close"),jQuery("i",this).removeClass("icon-folder-open")}),jQuery(".tjexpanded").each(function(){var e=jQuery(this).attr("parentfor");jQuery("tr[childof="+e+"]").show(),jQuery("i",this).addClass("icon-folder-open"),jQuery("i",this).removeClass("icon-folder-close")})}function redirect(e){window.location=e}function redirect_course(e,t,a){document.getElementById("course_id").value=t,document.getElementById("scorm_type").value=a,document.adminForm.submit()}function generate_reports(e,t){jQuery.ajax({url:root_url+"index.php?option=com_tjlms&controller=course&task="+e+"&course_id="+t,type:"POST",dataType:"json",timeout:3500,error:function(){console.log("Problem with AJAX Request in LMSCommit()")},success:function(e){if(jQuery("#course_report").find("tr:gt(0)").remove(),0!=e.length)for(var t=0;t<e.length;t++){var a="<tr>";a+='<td class="center">'+(t+1)+"</td>",a+='<td class="center">'+e[t].username+"</td>",a+='<td class="center">'+e[t].attempts+"</td>",a+='<td class="center">'+e[t].grade_score+"</td>",a+="</tr>",jQuery("#course_report").append(a)}else{a="<tr>";a+='<td class="center" colspan="3">No data to display</td>',a+="</tr>",jQuery("#course_report").append(a)}}})}function generate_myreports(e,t,a){jQuery.ajax({url:root_url+"index.php?option=com_tjlms&controller=course&task="+e+"&course_id="+t+"&userid="+a,type:"POST",dataType:"html",timeout:3500,error:function(){console.log("ERROR_IN_GENERATING_REPORT")},success:function(e){jQuery("#course_myreport").html(e)}})}function generate_nonscormreport(e){jQuery.ajax({url:root_url+"index.php?option=com_tjlms&controller=course&task=getnonscorm_coursereport&course_id="+e,type:"POST",dataType:"json",timeout:3500,error:function(){console.log("ERROR_IN_GENERATING_MY_COURSE_REPORT")},success:function(e){if(jQuery("#nonscormcourse_report").find("tr:gt(0)").remove(),0!=e.length)for(var t=0;t<e.length;t++){var a="<tr>";a+='<td class="center">'+(t+1)+"</td>",a+='<td class="center">'+e[t].username+"</td>",a+='<td class="center">'+e[t].start_date+"</td>",a+='<td class="center">'+e[t].stage_page+"</td>",a+='<td class="center">'+e[t].score+"</td>",a+="</tr>",jQuery("#nonscormcourse_report").append(a)}else{a="<tr>";a+='<td class="center" colspan="3">No data to display</td>',a+="</tr>",jQuery("#nonscormcourse_report").append(a)}}})}function showloading(e){}function loadingImage(e,t){void 0===t&&(t=0),e=e?"#"+e:"body",1==t?(imgwidth=jQuery(document).width(),imgheight=jQuery(document).height()):(imgwidth=jQuery(e).width(),imgheight=jQuery(e).height()),jQuery("<div id='appsloading'></div>").css("background","rgba(255, 255, 255, 1) url('"+root_url+"/components/com_tjlms/assets/images/ajax.gif') 50% 45% no-repeat").css("top",jQuery(e).position().top-jQuery(e).scrollTop()).css("width",imgwidth).css("height",imgheight).css("position","fixed").css("z-index","1000").css("opacity","1").css("-ms-filter","progid:DXImageTransform.Microsoft.Alpha(Opacity = 80)").css("filter","alpha(opacity = 80)").appendTo(e)}function hideImage(){jQuery("#appsloading").remove()}function open_lessonforattempt(e,t,a,s){"0"!=a&&"1"!=s?jQuery.ajax({url:root_url+"index.php?option=com_tjlms&task=course.userEnrollAction",type:"POST",data:{cId:a},success:function(a){console.log(Joomla.JText._("COM_TJLMS_ENROL_SUCCESS")),"tab"==t?window.open(e,"_blank"):window.location=e}}):"tab"==t?window.open(e,"_blank"):window.location=e,"tab"==t?window.open(e,"_blank"):window.location=e}function open_scoforattempt(e,t,a,s,o,r){var n="index.php?option=com_tjlms&view=lesson&lesson_id="+t+"&attempt="+(0==a?1:"completed"==o||"passed"==o||"failed"==o?s>0?a<s?Number(a)+1:a:Number(a)+1:a)+"&sco_id="+e;if("popup"==r){var i=jQuery(window).width()-100,l=jQuery(window).height()-80;n+="&tmpl=component&fs=1",SqueezeBox.open(n,{handler:"iframe",size:{x:i,y:l},onClose:function(){window.parent.document.location.reload(!0)}})}else window.location=n}function updateData(e){jQuery.ajax({url:root_url+"index.php?option=com_tjlms&task=callSysPlgin&plgType="+e.plgtype+"&plgName="+e.plgname+"&plgtask="+e.plgtask+"&mode="+e.mode,dataType:"json",type:"POST",data:{lesson_status:e.lesson_status,lesson_id:e.lesson_id,attempt:e.attempt,total_content:e.total_content,current_position:e.current_position,lesson_status:e.lesson_status,time_spent:e.time_spent},success:function(e){return e},error:function(e){console.log("something went wrong")}})}function closePopup(e,t){"tab"==e?(opener&&opener.location.reload(),window.close()):"preview_popup"==e||"popup"==e?window.parent.SqueezeBox.close():window.location=t}function enrollUser(e){var t="adminFormToc"+e;jQuery("#free_course_button").attr("disabled","disabled"),jQuery("#"+t).submit()}function askforaction(e,t,a,s,o){jQuery.ajax({url:root_url+"index.php?option=com_tjlms&task=lesson.askforaction",type:"POST",async:!1,data:{action:e,lesson_id:t,attempt:s,lessonformat:o},dataType:"json",timeout:3500,error:function(){alert("COM_TJLMS_ERROR_IN_SETTING_ATTEMPT")},beforeSend:function(){jQuery("#askforattempt").hide(),showloading(1)},success:function(e){1==e&&(window.location=a)}})}function togglePaylistSidebar(e){jQuery("#playlist-container").toggleClass("playlist-hidden"),jQuery(".lesson-left-panel-header").toggleClass("playlist-hidden"),"close"==e?jQuery("#lesson-main-container").removeClass("span9").addClass("span12 expanded"):jQuery("#lesson-main-container").removeClass("span12 expanded").addClass("span9")}function toggleJlikePanel(){jQuery(".main-lesson").toggleClass("span8"),jQuery(".right-panel").toggleClass("right-panel-hidden")}function printcertificate(e){var t=document.getElementById(e).innerHTML,a=document.body.innerHTML;document.body.innerHTML=t,window.print(),document.body.innerHTML=a}function closeModalPopup(){jQuery('.modal-header button[data-dismiss="modal"]',window.parent.document).click()}function courseAssignRecommend(e,t){if("assign"==e){var a=jQuery("#start_date"),s=jQuery("#due_date"),o=a.val(),r=s.val();if(""==o||""==r)return alert(Joomla.JText._("COM_TJLMS_SELECT_FILL_DATES")),""==o?a.focus():""==r&&s.focus(),!1;if(0==checkDateFormat(o))return alert(Joomla.JText._("COM_TJLMS_INVALID_DATE_FORMAT")+o),a.val(""),!1;if(0==checkDateFormat(r))return alert(Joomla.JText._("COM_TJLMS_INVALID_DATE_FORMAT")+r),a.val(""),!1;if(o>r)return alert(Joomla.JText._("COM_TJLMS_START_DATE_GT_THAN_DUE_DATE")),!1;if(""!=r){var n=new Date;if(n.setHours(0,0,0,0),assignEndDate=new Date(r),assignEndDate.setHours(0,0,0,0),assignEndDate<n)return alert(Joomla.JText._("COM_TJLMS_START_DATE_GT_THAN_TODAY")),!1}}jQuery("#task").val(t),document.adminForm.submit()}function openAssignRecommendPopups(e){var t=jQuery(window).width()-50,a=jQuery(window).height()-50;SqueezeBox.open(e,{handler:"iframe",closable:!1,size:{x:t,y:a},sizeLoading:{x:t,y:a},classWindow:"tjlms_lesson_screen",classOverlay:"tjlms_lesson_screen_overlay"})}function closeAssignRecommendPopups(){window.parent.document.location.reload(!0),window.parent.SqueezeBox.close()}jQuery(document).ready(function(){var e=jQuery(".progress-pie-chart"),t=parseInt(e.data("percent")),a=360*t/100;t>50&&e.addClass("gt-50"),jQuery(".ppc-progress-fill").css("transform","rotate("+a+"deg)"),jQuery(".ppc-percents span").html(t+"%"),jQuery(".r-more").click(function(){var e=jQuery(this).closest(".long_desc"),t=jQuery(e).siblings(".long_desc_extend");jQuery(e).hide(),jQuery(".r-more",e).hide(),jQuery(t).show(),jQuery(".r-less",t).show()}),jQuery(".r-less").click(function(){var e=jQuery(this).closest(".long_desc_extend"),t=jQuery(e).siblings(".long_desc");jQuery(e).hide(),jQuery(".r-less",e).hide(),jQuery(t).show(),jQuery(".r-more",t).show()}),jQuery(".tjlms_section_title").click(function(){var e=jQuery(this).parent().attr("id").replace("modlist_","");toggleModuleAccordion(e)}),jQuery(".tjlms_playlist_mod_title").click(function(){var e=jQuery(this).parent().attr("id").replace("modlist_","");jQuery(this).toggleClass("open"),jQuery("div.module_container_"+e).toggle()}),togglestate(),jQuery(".tjlms_enrolUsers").on("shown.bs.tab","#myTabTabs.nav-tabs li a",function(e){var t=jQuery(this).attr("href");t=t.replace("#","");var a=jQuery("#tjlms-assign .modal-footer .assign-footer"),s=jQuery("#tjlms-assign #select-option").prop("checked");"groups"==t&&1==s?(jQuery(".assign-groups-btn",a).show(),jQuery(".enroll-groups-btn, .enroll-btn, .assign-btn",a).hide()):"groups"==t?(jQuery(".enroll-groups-btn",a).show(),jQuery(".assign-groups-btn, .enroll-btn, .assign-btn",a).hide()):"users"==t&&1==s?(jQuery(".assign-btn",a).show(),jQuery(".assign-groups-btn, .enroll-groups-btn, .enroll-btn",a).hide()):(jQuery(".enroll-btn",a).show(),jQuery(".assign-groups-btn, .enroll-groups-btn, .assign-btn",a).hide()),adjustModalHeight()})});var assignUser=function(e,t){var a=jQuery("#start_date").val(),s=jQuery("#due_date").val(),o=(jQuery("#sender_msg").val(),jQuery("#start_date")),r=jQuery("#due_date");if("enroll"==t||"enrollGroup"==t){if(!jQuery("#selectedcourse").val())return alert(Joomla.JText._("COM_TJLMS_SELECT_COURSE_TO_ENROLL")),!1;if("enroll"==t){if(0==document.adminForm.boxchecked.value)return alert(Joomla.JText._("COM_TJLMS_MESSAGE_SELECT_ENROLL_ITEMS")),!1}else if("enrollGroup"==t&&!jQuery("#enrollusers").find(".tjlms_enrolUsers input.user_groups:checked").length)return alert(Joomla.JText._("COM_TJLMS_SELECT_GROUP_TO_ASSIGN")),!1;jQuery("#enrollusers #type").val(t),Joomla.submitform("enrolluser."+e)}else if("assign"==t||"assignGroup"==t){if(!jQuery("#selectedcourse").val())return alert(Joomla.JText._("COM_TJLMS_SELECT_COURSE_TO_ENROLL")),!1;if(0==document.adminForm.boxchecked.value&&"assign"==t)return alert(Joomla.JText._("COM_TJLMS_MESSAGE_SELECT_ASSIGN_ITEMS")),!1;if(!jQuery("#enrollusers").find(".tjlms_enrolUsers input.user_groups:checked").length&&"assignGroup"==t)return alert(Joomla.JText._("COM_TJLMS_SELECT_GROUP_TO_ASSIGN")),!1;if(0==checkDateFormat(a))return alert(Joomla.JText._("COM_TJLMS_INVALID_START_DATE_FORMAT")),o.focus(),!1;if(0==checkDateFormat(s))return alert(Joomla.JText._("COM_TJLMS_INVALID_DUE_DATE_FORMAT")),r.focus(),!1;if(a>s)return alert(Joomla.JText._("COM_TJLMS_START_DATE_GT_THAN_DUE_DATE")),!1;if(""!=s){var n=new Date;if(n.setHours(0,0,0,0),assignEndDate=new Date(s),assignEndDate.setHours(0,0,0,0),assignEndDate<n)return alert(Joomla.JText._("COM_TJLMS_START_DATE_GT_THAN_TODAY")),!1}1==jQuery(".assign-groups-btn #update_existing_users").prop("checked")&&jQuery(".assign-groups-btn #update_existing_users").val(1),jQuery("#enrollusers #type").val(t),Joomla.submitform("enrolluser."+e)}else if("reco"==t){if(0==document.adminForm.boxchecked.value)return alert(Joomla.JText._("COM_TJLMS_MESSAGE_SELECT_RECO_ITEMS")),!1;jQuery("#enrollusers #type").val(t),Joomla.submitform("enrolluser."+e)}},checkDateFormat=function(e){return regExp=/^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/,!(!e||!e.match(regExp))},showAssign=function(e){1==jQuery(".tjlms_enrolUsers .nav-tabs li:first-child").hasClass("active")?(jQuery(".show-assignment-fields, .assign-btn, .enroll-btn, .tjmodal-enroll-title, .tjmodal-assign-title").toggle(),jQuery(".assign-groups-btn, .enroll-groups-btn").hide()):jQuery(".assign-groups-btn, .enroll-groups-btn, .show-assignment-fields, .tjmodal-enroll-title, .tjmodal-assign-title").toggle(),adjustModalHeight()},adjustModalHeight=function(){if(jQuery("#recommend-table-container").length){var e=jQuery("html").height()-jQuery(".modal-footer").outerHeight()-jQuery("#recommend-table-container").offset().top;jQuery("#recommend-table-container").css("height",e)}if(jQuery("#assign-table-container").length){e=jQuery("html").height()-jQuery(".modal-footer").outerHeight()-jQuery("#myTabContent").offset().top;jQuery("#myTabContent").css("height",e)}};jQuery(document).ready(function(){jQuery("#tjlms-assign").length&&tjlms.utility.inIframe()&&(jQuery(".modal-body").prepend(jQuery("#system-message-container")),jQuery("html").addClass("popuphtml"),jQuery(".modal-header",".popuphtml").parents().each(function(e,t){jQuery(t).addClass("fullheight")}),jQuery(".field-calendar button").on("click",function(){jQuery(".calendar-container > table.table").removeClass("table")}))});var tjlmsfilter={init:function(){jQuery(document).ready(function(){jQuery("#creator_filter").val()>0&&jQuery("#creator_filter_chzn").addClass("filterActive"),jQuery("#category_filter").val()>0&&jQuery("#category_filter_chzn").addClass("filterActive"),jQuery("#course_type").val()>=0&&jQuery("#course_type_chzn").addClass("filterActive"),jQuery(window).width()<767&&(jQuery('[data-id="filter-category"]').addClass("col-xxs-6"),jQuery('[data-id="filter-type"]').addClass("col-xxs-6"),jQuery('[data-id="filter-author"]').addClass("col-xxs-6"),jQuery('[data-id="filter-tag"]').addClass("col-xxs-6")),(jQuery('[data-id="filter-search"]').hasClass("filterActive")||jQuery('[data-id="filter-type"]').hasClass("filterActive")||jQuery('[data-id="filter-category"]').hasClass("filterActive")||jQuery('[data-id="filter-author"]').hasClass("filterActive")||jQuery('[data-id="filter-tag"]').hasClass("filterActive"))&&(jQuery(".tjlms-filters").show(),jQuery('[data-identifier="tjlms-filters-menu"]').find("i").addClass("fa-angle-down").removeClass("fa-angle-right"))})},reset:function(){jQuery("#course_cat, #course_type, #creator_filter, #course_status, #filter_tag").prop("selectedIndex",0),jQuery(".course-fields").prop("selectedIndex",0),jQuery("#filter_search").val("")},toggle:function(e){jQuery(".tjlms-filters").toggle(),jQuery(".tjlms-filters").is(":hidden")?jQuery(e).children("i").addClass("fa-angle-right").removeClass("fa-angle-down"):jQuery(e).children("i").addClass("fa-angle-down").removeClass("fa-angle-right")},toggleDiv:function(e){jQuery("#"+e).toggleClass("active hide"),jQuery("#displayFilter .plusminusIcon").toggleClass("fa-plus fa-minus")}};
