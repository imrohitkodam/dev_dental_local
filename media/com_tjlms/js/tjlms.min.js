jQuery(document).ready(function(){jQuery('[data-bs-toggle="tooltip"]').tooltip()});var tjlms={courses:{init:function(t,e){jQuery(document).ready(function(){document.getElementById("tjlms_pin_container"),new Masonry(document.getElementById("tjlms_pin_container"),{columnWidth:e,itemSelector:".tjlmspin"}),setTimeout(function(){document.getElementById("tjlms_pin_container"),new Masonry(document.getElementById("tjlms_pin_container"),{columnWidth:e,itemSelector:".tjlmspin"})},1e3),setTimeout(function(){document.getElementById("tjlms_pin_container"),new Masonry(document.getElementById("tjlms_pin_container"),{columnWidth:e,itemSelector:".tjlmspin"})},3e3)})}},course:{init:function(t,e,s){jQuery(document).ready(function(){if(void 0!==s&&jQuery("body").addClass(s),767>jQuery(window).width()&&jQuery(".enrollHtml").insertBefore(".tjlms_course_toc"),t){var a=jQuery("#modlist_"+t+' [data-jstoggle="collapse"]');jQuery(a).removeClass("collapsed");var o=jQuery(a).attr("data-target");jQuery(o).addClass("in")}jQuery('[data-jstoggle="collapse"]').click(function(){jQuery(this).toggleClass("collapsed");var t=jQuery(this).attr("data-target");jQuery(t).toggleClass("in")}),jQuery("#paid_course_button").click(function(){try{var t=JSON.parse(e)}catch(s){t=JSON.parse(JSON.stringify(e))}"undefined"!=typeof tjanalytics&&(tjanalytics.ga.addProduct(t),tjanalytics.ga.setAction(t["0"]))})})},retakeCourse:function(t,e){jQuery.ajax({url:Joomla.getOptions("system.paths").root+"/index.php?option=com_tjlms&task=course.expireCertificate&format=json",type:"POST",data:{course_id:t,user_id:e},dataType:"json",beforeSend:function(){jQuery.LoadingOverlay("show",{image:"media/com_tjlms/images/loader/loader.gif"})},complete:function(){jQuery("#ajax_loader").hide()},success:function(t){location.reload()}})}},lesson:{init:function(t){jQuery(document).ready(function(){var e=localStorage.getItem("sidebarState");tjlms.lesson.hideRightPanel(),heighttominus="undefined"!=typeof heighttominus?heighttominus:46,iframeheighttominus=50;var s=jQuery(".tjlms_lesson_screen",top.document).height();if(s||(s=jQuery(document).height()),s||(s="400"),jQuery("[data-js-attr='tjlms-lesson']").css("height",s-heighttominus),jQuery("[data-js-attr='tjlms-lesson-iframe']").css("height",s-iframeheighttominus),"popup"==launchLessonFullScreen&&"preview"!=launchMode&&(window.parent.document.body.style.overflow="hidden"),768>jQuery(window).width()&&jQuery("[data-js-attr='lesson-toolbar-content']").insertBefore('[data-js-attr="lesson-player"]'),1==showLessonPlaylist){if(t){var a=jQuery("#modlist_"+t+' [data-jstoggle="collapse"]');jQuery(a).toggleClass("collapsed");var o=jQuery(a).attr("data-target");jQuery(o).toggleClass("in")}jQuery('[data-jstoggle="collapse"]').click(function(){jQuery(this).toggleClass("collapsed");var t=jQuery(this).attr("data-target");jQuery(t).toggleClass("in")}),null==e?(jQuery("[data-js-id='playlist-hide']").show(),jQuery("[data-js-attr='lesson-playlist']").removeClass("hidden"),tjlms.lesson.toggleLessonPanels()):jQuery("[data-js-id='playlist-open']").show(),jQuery("[data-js-attr='tjlms-lesson__playlist-toggle']").click(function(){jQuery("[data-js-attr='lesson-playlist']").toggle(),767>jQuery(window).width()?jQuery("[data-js-attr='lesson-playlist']").removeClass("hidden hidden-xs"):jQuery("[data-js-attr='lesson-playlist']").removeClass("hidden"),tjlms.lesson.toggleLessonPanels(),jQuery(".tjlms-lesson__playlist-container").is(":visible")?(jQuery("[data-js-id='playlist-open']").hide(),jQuery("[data-js-id='playlist-hide']").show(),localStorage.removeItem("sidebarState")):(jQuery("[data-js-id='playlist-hide']").hide(),jQuery("[data-js-id='playlist-open']").show(),localStorage.setItem("sidebarState","collapsed"))})}jQuery("[data-js-attr='toolbar_buttons']").click(function(){if(jQuery(this).hasClass("active")){jQuery(this).removeClass("active"),tjlms.lesson.hideRightPanel(),tjlms.lesson.toggleLessonPanels();return}jQuery(".toolbar_buttons").not("[data-ref='jliketoolbar-menu']").removeClass("active"),jQuery(this).addClass("active"),tjlms.lesson.showRightPanel(),jQuery(".toolbar-content").hide();var t=jQuery(this).data("ref");jQuery("#"+t).show(),"comments"==t&&jQuery("#divaddcomment a.jlike_comment_msg").trigger("click"),tjlms.lesson.toggleLessonPanels()}),jQuery("[data-ref='jliketoolbar-menu']").click(function(){jQuery(this).toggleClass("active"),jQuery("#jlikeToolbar").toggleClass("open"),jQuery(this).hasClass("active")||(jQuery(".toolbar_buttons").removeClass("active"),tjlms.lesson.hideRightPanel()),tjlms.lesson.toggleLessonPanels()}),jQuery("[data-js-attr='jlikeToolbar-close'][data-js-id!='test-premise-close'], .resumewindowclose[data-js-id!='test-premise-close']").click(function(){if(!0==confirm(Joomla.JText._("COM_TJLMS_LESSON_CONFIRM_BOX"))){if("undefined"!=typeof lessonStartTime){var t=new Date-lessonStartTime;plugdataObject.time_spent=Math.round(t/1e3),updateData(plugdataObject,!0)}else void 0!==jQuery.fn.onBeforeUnloadLessonPageUnload&&jQuery.fn.onBeforeUnloadLessonPageUnload(),closePopup(launchLessonFullScreen,returnUrl)}}),jQuery("[data-js-id='test-premise-close']").click(function(){closePopup(launchLessonFullScreen,returnUrl)})})},toggleLessonPanels:function(){var t="col-sm-12";jQuery("[data-js-attr='lesson-playlist']").is(":hidden")&&!jQuery("[data-js-attr='lesson-toolbar-content']").is(":hidden")?t="col-sm-8":!jQuery("[data-js-attr='lesson-playlist']").is(":hidden")&&jQuery("[data-js-attr='lesson-toolbar-content']").is(":hidden")?t="col-sm-9":jQuery("[data-js-attr='lesson-playlist']").is(":hidden")||jQuery("[data-js-attr='lesson-toolbar-content']").is(":hidden")||(t="col-sm-5"),jQuery("[data-js-attr='lesson-player']").attr("class","tjlms_lesson__player tjlms-lesson-player "+t),768>jQuery(window).width()&&(jQuery("[data-js-attr='lesson-toolbar-content']").is(":hidden")?(jQuery("[data-js-attr='tjlms-lesson']").removeClass("y-scroll"),jQuery("[data-js-attr='lesson-player']").removeClass("hidden")):(jQuery("[data-js-attr='tjlms-lesson']").addClass("y-scroll"),jQuery("[data-js-attr='lesson-player']").addClass("hidden")))},showRightPanel:function(){jQuery("[data-js-attr='lesson-toolbar-content']").show()},hideRightPanel:function(){jQuery("[data-js-attr='lesson-toolbar-content']").hide()}},printDiv:function(){var t=document.getElementById("printDiv").innerHTML,e=document.body.innerHTML;document.body.innerHTML=t,window.print(),document.body.innerHTML=e},tjAdjustFormClass:function(){767>jQuery(window).width()?jQuery("#coupon-form, #payment-info").removeClass("form-horizontal"):jQuery("#coupon-form, #payment-info").addClass("form-horizontal"),jQuery("#characterLeft").text("250 characters left"),jQuery("#addr").keyup(function(){var t=jQuery(this).val().length;t>=250?jQuery("#characterLeft").text(" you have reached the limit"):jQuery("#characterLeft").text(250-t+" characters left")})},resizeForm:function(){jQuery(document).ready(function(t){tjlms.tjAdjustFormClass(),jQuery(window).on("resize",function(){tjlms.tjAdjustFormClass()}),jQuery(document).on("changed","#MyWizard",function(t,e){tjlms.tjAdjustFormClass()})})},coupon:{init:function(){tjlms.resizeForm(),jQuery(".coupon-courses").change(function(){tjlms.coupon.loadSubscription()})},loadSubscription:function(){var t=jQuery("#jform_course_id").val();t&&jQuery.ajax({url:Joomla.getOptions("system.paths").root+"/index.php?option=com_tjlms&task=coupon.loadSubscription&format=json",type:"POST",data:{course_id:t},dataType:"json",beforeSend:function(){jQuery("#jform_subscription_id").empty()},success:function(t){if(t.data){var e=t.data;jQuery.each(e,function(t,e){var s=jQuery('<optgroup id="'+e.id+'" label="'+e.title+'" ></optgroup>');jQuery.each(e.subscription,function(t,e){var a=jQuery('<option value="'+e.id+'">'+e.name+"</option>");s.append(a)}),jQuery("#jform_subscription_id").append(s),jQuery("#jform_subscription_id").trigger("liszt:updated"),jQuery("#jform_subscription_id").trigger("chosen:updated")})}}})}},subscription:{init:function(){jQuery("#coupon_chk").prop("checked",!1),jQuery("#total_amt_inputbox").val(0),jQuery("#net_amt_pay_inputbox").val(0),jQuery("#coupon_code").val(),jQuery("#order_tax").val(0),array_sub_plan=JSON.parse(array_sub_plan),tjlms.subscription.caltotal(jQuery("#coursesubsplan_radio").val()),jQuery("#coupon_code").keypress("input",function(t){"Enter"===t.key&&t.preventDefault()})},show_cop:function(){if(jQuery("#dis_amt").show(),jQuery("#net_amt_pay_inputbox").val(parseFloat(jQuery("#total_amt_inputbox").val())),jQuery("#net_amt_pay").html(parseFloat(jQuery("#total_amt_inputbox").val())),jQuery("#coupon_chk").is(":checked")){if(total_calc_amt2=0,(get_selected_plan=jQuery("#coursesubsplan_radio").val())&&(total_calc_amt2=array_sub_plan[get_selected_plan].price),!total_calc_amt2){alert(Joomla.JText._("TJLMS_SELECT_SUBS_PLAN")),document.getElementById("coupon_chk").checked=!1;return}document.getElementById("coup_button").removeAttribute("disabled"),jQuery("#cop_tr, #coupon_code, #coup_button").show()}else{var t=parseFloat(jQuery("#net_amt_pay_inputbox").val());1==jQuery("#allow_taxation").val()&&tjlms.subscription.calculatetax(t),jQuery("#cop_tr, #coupon_code, #coup_button, #dis_cop").hide(),jQuery("#dis_amt").show(),jQuery("#dis_cop_amt").html(),jQuery("#coupon_code").val("")}},applycoupon:function(){if(jQuery("#coupon_chk").is(":checked")){if(""==jQuery("#coupon_code").val())document.getElementById("coup_button").removeAttribute("disabled"),alert(Joomla.JText._("COM_TJLMS_ENTER_COP_COD")),jQuery("#net_amt_pay").html(parseFloat(jQuery("#total_amt_inputbox").val())),jQuery("#dis_cop").hide(),jQuery("#coupon_code").val(""),jQuery("#coupon_code").focus();else{var t=document.getElementById("coupon_code").value,e=document.getElementById("course_id").value,s=jQuery("#coursesubsplan_radio").val();jQuery.ajax({url:tjlms_baseurl+"?option=com_tjlms&task=buy.getcoupon&coupon_code="+document.getElementById("coupon_code").value,type:"POST",data:{coupon_code:t,course_id:e,selected_plan:s},dataType:"json",success:function(t){if(amt=0,val=0,1==parseInt(t[0].error)){alert(t[0].msg),jQuery("#net_amt_pay").html(parseFloat(jQuery("#total_amt_inputbox").val())),jQuery("#dis_cop").hide(),jQuery("#coupon_code").val(""),jQuery("#coupon_code").focus();return}parseFloat(t[0].value)>0&&(val=parseFloat(value=1==t[0].val_type?t[0].value/100*document.getElementById("total_amt_inputbox").value:t[0].value).toFixed(2),finalvar=0,get_selected_plan=jQuery("#coursesubsplan_radio").val(),amount=parseFloat(finalvar=array_sub_plan[get_selected_plan].price)-parseFloat(val),0>=parseFloat(amount)&&(amount=0),isNaN(finalvar)&&(amount=0),amt=parseFloat(amount).toFixed(2),jQuery("#net_amt_pay_inputbox").val(amt),jQuery("#net_amt_pay").html(amt),1==jQuery("#allow_taxation").val()&&tjlms.subscription.calculatetax(amt),jQuery("#dis_cop_amt").html(""+val),jQuery("#dis_amt, #dis_cop").show())}})}}},calculatetax:function(t){jQuery.ajax({url:tjlms_baseurl+"?option=com_tjlms&task=buy.applytax&tmpl=component&total_calc_amt="+t,type:"GET",dataType:"json",success:function(e){if(null!=e&&parseFloat(e.taxvalue)>0){jQuery("#order_tax").val(parseFloat(e.taxvalue));var s=jQuery("#order_tax").val(),a=tjlms.subscription.round(s,2);jQuery("#tax_to_pay").html(a),jQuery("#tax_to_pay_inputbox").val(a);var o=parseFloat(a)+parseFloat(t),n=tjlms.subscription.round(o,2);jQuery("#net_amt_after_tax").html(n),jQuery("#net_amt_after_tax_inputbox").val(n),jQuery("#tax_tr").show()}else{jQuery("#order_tax").val(0),jQuery("#tax_to_pay").html(0),jQuery("#tax_to_pay_inputbox").val(0);var n=parseFloat(t);jQuery("#net_amt_after_tax").html(t),jQuery("#net_amt_after_tax_inputbox").val(t),jQuery("#tax_tr").hide()}}})},caltotal:function(t){total_calc_amt=array_sub_plan[t].price;var e=0;0==parseInt(total_calc_amt)?jQuery("#cooupon_troption").hide():(e=1,jQuery("#cooupon_troption").show()),1==e&&jQuery("#coupon_chk").is(":checked")&&""!=jQuery("#coupon_code").val()&&tjlms.subscription.applycoupon(),isNaN(total_calc_amt)&&(total_calc_amt=0),jQuery("#total_amt").html("<b>"+total_calc_amt+currency),jQuery("#total_amt_inputbox").val(total_calc_amt),jQuery("#net_amt_pay").html(total_calc_amt),jQuery("#net_amt_pay_inputbox").val(total_calc_amt),1==jQuery("#allow_taxation").val()&&tjlms.subscription.calculatetax(total_calc_amt),document.getElementById("selected_plan").value=t},round:function(t){return Math.round(100*t+(1e3*t%10>4?1:0))/100}},billing:{init:function(t,e){tjlms.billing.generateState("country",t,e)},generateoption:function(t,e,s){jQuery("#"+e).val(),"country"==e&&(n=jQuery("#state"),default_opt="Select State"),n.find("option").remove().end();var a,o,n,i="<option "+(selected='selected="selected"')+' value="">'+default_opt+"</option>";if("country"==e&&jQuery("#state").append(i),t.length>0)for(jQuery("#state_star").text("*"),jQuery("#state").attr("required","required"),a=t.options,o=0;o<t.length;++o){selected="",t[o].id==s&&(selected='selected="selected"');var l,i="<option "+selected+' value="'+t[o].id+'">'+t[o].region+"</option>";"country"==e&&jQuery("#state").append(i)}else jQuery("#state_lbl").removeClass("invalid"),jQuery("#state_star").text(""),jQuery("#state").removeAttr("required","required")},generateState:function(t,e,s){var a=jQuery("#"+t).val();if(void 0==a||""==a)return!1;jQuery.ajax({url:root_url+"index.php?option=com_tjlms&task=buy.loadState&country="+a+"&tmpl=component",type:"GET",dataType:"json",success:function(s){"country"==t&&(statebackup=s),tjlms.billing.generateoption(s,t,e)}})}},gateway:{init:function(){tjlms.resizeForm()},gatewayHtml:function(t,e){var s='<div class="col-xs-12 col-sm-3 list-group-item-heading">';s+='<button id="btnWizardPrev1" onclick="jQuery(\'#MyWizard\').wizard(\'previous\');" type="button" class="col-xs-12 btn btn-prev pull-left">',s+='<i class="fa fa-arrow-circle-o-left"></i>',s+=" "+Joomla.JText._("COM_TJLMS_PREV_BUTTON"),s+="</button>",s+="</div>",jQuery.ajax({url:root_url+"index.php?option=com_tjlms&task=payment.changegateway&gateways="+t+"&order_id="+e,type:"POST",data:"",dataType:"text",success:function(t){t&&(jQuery("#tjlms-payHtmlDiv").html(t),jQuery("#tjlms-payHtmlDiv div.form-actions").append(s),jQuery('#tjlms-payHtmlDiv div.form-actions input[type="submit"]').addClass("pull-right").css("min-width","100%").wrap('<div class="col-xs-12 col-sm-3 pull-right list-group-item-heading">'),jQuery('#tjlms-payHtmlDiv div.form-actions input[type="submit"]').addClass("paymentButton"),jQuery(".paymentButton").click(function(){"undefined"!=typeof tjanalytics&&tjlms.gateway.addGatewayStep(e)}),jQuery("#tjlms-payHtmlDiv div.form-actions").addClass("tjlms-confirm-payment-div"),jQuery("#payment-info").find(".form-horizontal").removeClass("form-horizontal"))}})},addGatewayStep:function(t){jQuery.ajax({url:root_url+"index.php?option=com_tjlms&task=buy.generateOrderData&order_id="+t,type:"POST",data:"",dataType:"text",success:function(t){t&&(t=JSON.parse(t),tjanalytics.ga.addProduct(t),tjanalytics.ga.setAction(t["0"]))}})}},utility:{inIframe:function(){try{return window.self!==window.top}catch(t){return!0}}},test:{autosaveTimeout:1e3,autosaveAnswers:1,totalQuestions:0,gradingType:"",currentPage:0,totalPages:0,inviteId:0,questionNumber:0,pagesVisited:[],init:function(t,e,s,a){s&&void 0!==s||(s="default");var o=this;jQuery(window).on("load",function(){if(jQuery("[data-js-id='test-premise-close']").click(function(){closePopup(t,e)}),"default"==s){let n=o.inviteId,i=o.testId,l=o.gradingType,r=o.currentPage;tjlms.test.showQuestionsList(i,n,r),jQuery("#tmt-page-selection").bootpag({total:tjlms.test.totalPages,page:r,maxVisible:5}).on("page",function(t,e){tjlms.test.saveEachPageQueAnswers(),tjlms.test.showQuestionsList(i,n,e),tjlms.test.checkNotAttemptedCompulsory()});var d,c=jQuery("#invite_id").val(),u=jQuery(".test__timer #countdown_timer"),p=jQuery('[data-js-id="form-token"]').attr("name"),m={};m[p]=1,m.ltId=c,m.testId=i,m.timeSpent=3,finalDate=new Date(new Date().valueOf()+testTimeremaning);var f=!0;0!=testTimeDuration&&(f=!1),u.countdown(finalDate,{elapse:f}).on("update.countdown",function(t){jQuery(this).html(t.strftime("%H:%M:%S")),0!=timeToShowFinishAlert&&t.strftime("%T")<timeToShowFinishAlert&&jQuery(this).addClass("text-error"),t.offset.seconds%3==0&&jQuery.ajax({url:root_url+"index.php?option=com_tmt&task=test.updateTimeSpent&format=json",dataType:"json",type:"POST",data:m,success:function(t){}})}).on("finish.countdown",function(t){var e={};e[p]=1,e.ltId=c,e.testId=i,jQuery.ajax({url:root_url+"index.php?option=com_tmt&task=test.updateTimeSpent&format=json",dataType:"json",type:"POST",data:e,success:function(t){}}),tjlms.test.submitTest(1)&&(window.location=jQuery("#thankYouLink").val())}),jQuery(document).on("input propertychange","[data-js-id='test-question'][data-js-type='textarea'] textarea, [data-js-id='test-question'][data-js-type='text'] input, [data-js-id='test-question'][data-js-type='radio'] input, [data-js-id='test-question'][data-js-type='checkbox'] input,[data-js-id='test-question'][data-js-type='rating'] input",function(){if(1===parseInt(tjlms.test.autosaveAnswers)){var t=jQuery(this);"radio"==jQuery(this).attr("type")||"checkbox"==jQuery(this).attr("type")?tjlms.test.saveEachAnswer(t):(clearTimeout(d),d=setTimeout(function(){tjlms.test.validateQuestionAnswer(t)&&tjlms.test.saveEachAnswer(t)},3e3))}}),jQuery("[data-js-id='test-close']").click(function(){let s=0;if(tjlms.test.checkNotAttemptedCompulsory(),s=jQuery("#unAttemptedCompulsoryCnt").val(),parseInt(s)>0)alert(Joomla.JText._("COM_TMT_TEST_SUBMIT_VALIDATION_FOR_COMPULSORY_MSG"));else if(!0==confirm(Joomla.JText._("COM_TJLMS_QUIZ_CONFIRM_BOX"))){var o=1;0==a&&(o=0,tjlms.test.submitTest()&&(o=1)),1==o&&("popup"==t?window.parent.SqueezeBox.close():"tab"==t?(opener&&opener.location.reload(),window.close()):window.location=e)}}),jQuery("[data-js-id='submittest']").click(function(){var t="";switch(l){case"exercise":t="COM_TMT_TEST_APPEAR_FINISH_EXERCISE";break;case"feedback":t="COM_TMT_TEST_APPEAR_FINISH_FEEDBACK";break;case"quiz":t="COM_TMT_TEST_APPEAR_FINISH_QUIZ"}let e=0;tjlms.test.checkNotAttemptedCompulsory(),e=jQuery("#unAttemptedCompulsoryCnt").val(),parseInt(e)>0?alert(Joomla.JText._("COM_TMT_TEST_SUBMIT_VALIDATION_FOR_COMPULSORY_MSG")):!0==confirm(Joomla.JText._(t))&&tjlms.test.submitTest()&&(window.location=jQuery("#thankYouLink").val())}),jQuery("[data-js-id='toolbar'] [data-js-id='toolbar-next'] button, [data-js-id='toolbar'] [data-js-id='toolbar-prev'] button").click(function(){tjlms.test.saveEachPageQueAnswers();let t=0;"toolbar-next"==jQuery(this).closest(".toolbar__span").attr("data-js-id")?t=parseInt(tjlms.test.currentPage)+1:"toolbar-prev"==jQuery(this).closest(".toolbar__span").attr("data-js-id")&&(t=parseInt(tjlms.test.currentPage)-1),jQuery("#tmt-page-selection").bootpag({page:t}),tjlms.test.showQuestionsList(i,n,t)}),jQuery("[data-js-id='drafttest']").click(function(){!0==confirm(Joomla.JText._("COM_TMT_TEST_DRAFT_CONFIRM_BOX"))&&tjlms.test.saveEachPageQueAnswers(jQuery("#thankYouLink").val())}),jQuery(document).on("change","[data-js-type='file_upload'] input[type='file']",function(){thisfile=jQuery(this);var t=jQuery(thisfile)[0].files[0];if(!t)return!1;tjlms.test.checkNotAttemptedCompulsory(),parseInt(jQuery("#unAttemptedCompulsoryCnt").val())>0&&jQuery(".tmt_test__footer__navbutton").attr("disabled","disabled");var e=new FormData;e.append("FileInput",t);var s=jQuery(this).closest('[data-js-id="test-question"]').attr("data-js-itemid"),a=jQuery('[name="test[id]"]').val(),o=jQuery('[name="invite_id"]').val();e.append("mediaformat","quiz"),e.append("subformat","answer"),e.append("formatData[quiz][answer][qid]",s),e.append("formatData[quiz][answer][testid]",a),e.append("formatData[quiz][answer][ltid]",o),tjLmsCommon.file.$file=thisfile,tjLmsCommon.file.formData=e,tjLmsCommon.file.allowedSize=lessonUploadSize;let n=jQuery("[name='testqparam["+s+"][file_size]']");n.length&&n.val()>0&&(tjLmsCommon.file.allowedSize=n.val()),tjLmsCommon.file.showstatusbar=!0;let i=jQuery("[name='testqparam["+s+"][file_count]']");var l=jQuery('[data-js-itemid="'+s+'"] [data-js-id="uploaded-file-list"] > div[data-js-id="each-file"]').length;if(i.length&&""!=i.val()&&l>=i.val())return jQuery("#msg_"+s).attr("class","alert alert-error").text(Joomla.JText._("COM_TJLMS_MAX_NUMBER_OF_FILE_UPLOAD_ERROR_MSG").replace("%s",i.val())),jQuery(".tmt_test__footer__navbutton").removeAttr("disabled"),!1;tjLmsCommon.file.upload()}),jQuery(document).on("click","[data-js-type='file_upload'] [data-js-id='delete']",function(){if(!0==confirm("Are you sure you want to delete this uploaded file?")){var t=jQuery(this).closest('[data-js-id="each-file"]'),e=jQuery(this).closest('[data-js-id="test-question"]').attr("data-js-itemid"),s=jQuery(this).closest('[data-js-id="each-file"]').attr("data-js-answerid"),a=jQuery(this).closest('[data-js-id="each-file"]').attr("data-js-itemid"),o=jQuery('[data-js-id="form-token"]').attr("name"),n=rootUrl+"index.php?option=com_tmt&task=test.removeFileuploadAnswer&tmpl=component&format=json",i={};i[o]=1,i.answerId=s,i.answerMediaId=a,tjService.postData(n,i).fail(function(t){var s=[];s.error="1",s.msg=t.responseText,tjlms.test.eachQuestionSaveMsg(e,s)}).done(function(s){var o=[];o.error="0",s.success?(jQuery(t).remove(),jQuery('input[name="questions[upload]['+e+'][]"][value="'+a+'"]').remove(),0==jQuery('[data-js-itemid="'+e+'"] [data-js-id="uploaded-file-list"] > div[data-js-id="each-file"]').length&&jQuery('[data-js-itemid="'+e+'"] .test-question__answers').find('[data-js-id="uploaded-file-list-header"]').addClass("d-none")):o.error="1",o.msg=s.message,tjlms.test.eachQuestionSaveMsg(e,o)})}return!0}),jQuery(document).on("keyup","[data-js-type='textarea'] textarea",function(){let t=parseInt(jQuery(this).val().length),e=parseInt(jQuery(this).attr("maxlength")),s=parseInt(jQuery(this).attr("minlength"));jQuery(this).closest("[data-js-type='textarea']").find(".charscontainer_remaining").text(e-t),jQuery(this).closest("[data-js-type='textarea']").find(".charscontainer").removeClass("invalid"),s>0&&0==t&&jQuery(this).closest("[data-js-type='textarea']").find(".charscontainer").addClass("invalid"),e>0&&t>e&&jQuery(this).closest("[data-js-type='textarea']").find(".charscontainer").addClass("invalid"),0!=t&&t<s?(jQuery(this).closest("[data-js-type='textarea']").find(".charscontainer").addClass("invalid"),jQuery(".tmt_test__footer__navbutton").attr("disabled","disabled")):jQuery(this).closest("[data-js-type='textarea']").find(".charscontainer").removeClass("invalid")})}})},validateQuestionAnswer:function(t){if(t.is("textarea")){let e=parseInt(t.val().length),s=parseInt(t.attr("maxlength")),a=parseInt(t.attr("minlength"));if(a>0&&e<a&&0!==e||s>0&&e>s)return jQuery(".tmt_test__footer__navbutton").attr("disabled","disabled"),!1;(a||s)&&jQuery(".tmt_test__footer__navbutton").removeAttr("disabled")}return!0},resetAnswerOptions:function(t,e){let s="";switch(t){case"checkbox":case"radio":jQuery('input[name="questions[mcqs]['+e+'][]"]').attr("checked",!1),s=jQuery('input[name="questions[mcqs]['+e+'][]"]');break;case"rating":jQuery('input[name="questions[rating]['+e+']"]').attr("checked",!1),s=jQuery('input[name="questions[rating]['+e+']"]');break;case"text":case"textarea":jQuery("#questions"+e).val("").change(),s=jQuery("#questions"+e)}tjlms.test.validateQuestionAnswer(s)&&tjlms.test.saveEachAnswer(s)},flagQuestion:function(t,e){let s=rootUrl+"index.php?option=com_tmt&task=test.flagQuestion&format=json",a={testId:testId,qId:e,invite_id:inviteId},o=tjService.postData(s,a),n=!1,i;return(o.fail(function(t){Joomla.renderMessages({error:[t]})}).done(function(s){if(!s.success&&s.message){var a={error:[s.message]};Joomla.renderMessages(a),n=!1}s.messages&&Joomla.renderMessages(s.messages),s.success&&(n=!0,i=s.data,jQuery("#question"+e+" > span").hasClass("fa fa-flag")?(jQuery("#question"+e+" > span").removeClass("fa fa-flag"),jQuery(t).text(Joomla.JText._("COM_TMT_QUESTION_FLAG"))):(jQuery("#question"+e+" > span").addClass("fa fa-flag"),jQuery(t).text(Joomla.JText._("COM_TMT_QUESTION_UNFLAG"))))}),n)?i:n},showQuestionsList:function(t,e,s=1){if("-1"!=tjlms.test.pagesVisited.indexOf(s)){jQuery(".questions_container .tjlms-test-page").hide(),jQuery(".questions_container .tjlms-test-page#testPage"+s).show(),tjlms.test.currentPage=s,tjlms.test.testactions();return}let a=tjlms.test.getTestSectionsQuestions(t,e,s);if(tjlms.test.questionNumber=s*testPaginationLimit-testPaginationLimit+1,a.sections.length<1)return!1;jQuery(a.sections).each(function(t,e){if(e.questions.length>0){let o=jQuery("<div class='tjlms-test-page' id='testPage"+s+"'></div>"),n=jQuery("<div class='tjlms-test-section'></div>"),i=jQuery('<h3 class="tjlms-test-section__title"></h3>').appendTo(n);i.text(e.title),jQuery(n).appendTo(o),jQuery(".questions_container").append(o),jQuery("#attempted_qlist_container").append('<div class="clearfix center"><strong>'+e.title+"</strong></div>"),e.questions,jQuery(e.questions).each(function(t,e){doProcess=!0,qClass=""==e.userAnswer?"":"tmt-circle--attempted",jQuery("#attempted_qlist_container").append('<a href="'+currentPageUrl+"#question-"+e.question_id+'">  <div id="question'+e.question_id+'" class="tmt-circle tmt-circle--margin pull-left '+qClass+'"> <span class="tmt-circle--flag">&nbsp;</span>'+tjlms.test.questionNumber+" </div> </a>"),1==e.flagged&&(qClass="fa fa-flag",jQuery("#question"+e.question_id+" > span").addClass("fa fa-flag"));var s=Joomla.getOptions("system.paths").root+"/index.php?option=com_tmt&task=test.getQuestionHtml&format=json";tjService.postData(s,{test:a.test,question:e,qNo:tjlms.test.questionNumber}).fail(function(t){doProcess=!1,Joomla.renderMessages({error:[t]})}).done(function(t){if(!t.success&&t.message){var e={error:[t.message]};Joomla.renderMessages(e),doProcess=!1}t.messages&&Joomla.renderMessages(response.messages),doProcess=!0,t.data&&(jQuery(t.data).appendTo(o),tjlms.test.questionNumber++)})})}SqueezeBox.assign(jQuery("a.tjmodal"),{parse:"rel"})}),jQuery(".questions_container .tjlms-test-page").hide(),jQuery(".questions_container .tjlms-test-page#testPage"+s).show(),tjlms.test.currentPage=s,tjlms.test.testactions(),tjlms.test.pagesVisited.push(parseInt(s))},getTestSectionsQuestions:function(t,e,s){let a=Joomla.getOptions("system.paths").root+"/index.php?option=com_tmt&task=test.getTestSectionsQuestions&format=json",o=tjService.postData(a,{id:t,invite_id:e,pageNo:s}),n=!1,i;return(o.fail(function(t){Joomla.renderMessages({error:[t]})}).done(function(t){if(!t.success&&t.message){var e={error:[t.message]};Joomla.renderMessages(e),n=!1}t.messages&&Joomla.renderMessages(t.messages),t.success&&(n=!0,i=t.data,jQuery(".quiz_content").scrollTop("0"))}),n)?i:n},saveEachAnswer:function(t){var e=jQuery(t).closest('[data-js-id="test-question"]').attr("data-js-itemid"),s=jQuery('[name="test[id]"]').val(),a=jQuery('[name="invite_id"]').val(),o=jQuery(t).val(),n=jQuery('[data-js-id="form-token"]').attr("name");if("radio"===jQuery(t).attr("type")||"checkbox"===jQuery(t).attr("type")){var i=[];jQuery(t).closest('[data-js-id="test-question"]').find(":"+jQuery(t).attr("type")).each(function(){this.checked&&i.push(jQuery(this).val())}),o=i.join()}else if("file"===jQuery(t).attr("type")){var i=[];jQuery(t).closest('[data-js-id="test-question"]').find('[data-js-id="each-file"]').each(function(){i.push(jQuery(this).attr("data-js-itemid"))}),o=i.join()}var l=!0,r={};r.testId=s,r.ltId=a,r.questionId=e,r.answer=o,r[n]=1;var d=rootUrl+"index.php?option=com_tmt&task=test.saveQuestionAnswer&tmpl=component&format=json";return tjService.postData(d,r).fail(function(t){var s=[];s.error="1",s.msg=t.responseText,tjlms.test.eachQuestionSaveMsg(e,s),l=!1}).done(function(t){var n=[];if(n.msg=t.message,n.error="0",t.success){l=!0;var i=tjlms.test.getAttemptedQuestionsCnt(s,a),r=100*i/tjlms.test.totalQuestions,d=Joomla.JText._("COM_TMT_TEST_APPEAR_ATTEMPTED_OF").replace("%s",i).replace("%s",tjlms.test.totalQuestions);jQuery('[data-js-id="test-controls"] .progress .progress-bar').width(r+"%").attr("aria-valuenow",r),jQuery('[data-js-id="test-controls"] .progress .progress-bar .progress_bar_text').text(d),tjlms.test.checkNotAttemptedCompulsory(),""!==o?jQuery("#question"+e).addClass("tmt-circle--attempted"):""==o&&jQuery("#question"+e).removeClass("tmt-circle--attempted")}else n.error="1",tjlms.test.eachQuestionSaveMsg(e,n),l=!1}),l},getAttemptedQuestionsCnt:function(t,e){var s=rootUrl+"index.php?option=com_tmt&task=test.getTotalAttemptedQuestion&tmpl=component&format=json",a=tjService.postData(s,{testId:t,ltId:e}),o=0;return a.fail(function(t){o=0}).done(function(t){o=t.data}),o},showFileinUploadlist:function(t){var e='<div class="col-sm-6" data-js-id="each-file" data-js-itemid="'+t.media_id+'" data-js-answerid="'+t.answer_id+'"><a class="mr-5" href="'+t.path+'">'+t.org_filename+'</a><a href="javascript:void(0)" data-js-id="delete" title="'+Joomla.JText._("COM_TMT_DELETE_ITEM")+'"><i class="fa fa-trash" aria-hidden="true"></i></a></div><input type="hidden" name="questions[upload]['+t.qid+'][]" value="'+t.media_id+'"/>';jQuery('[data-js-itemid="'+t.qid+'"] [ data-js-id="uploaded-file-list-header"]').removeClass("d-none"),jQuery(e).appendTo(jQuery('[data-js-itemid="'+t.qid+'"] [data-js-id="uploaded-file-list"]')),tjlms.test.saveEachAnswer(jQuery('[data-js-itemid="'+t.qid+'"] input[type="file"]'))&&jQuery(".tmt_test__footer__navbutton").removeAttr("disabled");var s=jQuery('[data-js-itemid="'+t.qid+'"] [data-js-id="uploaded-file-list"] > div[data-js-id="each-file"]').length;let a=jQuery("[name='testqparam["+t.qid+"][file_format]']");a.length&&""!=a.val()&&s>=a.val()&&jQuery('[data-js-itemid="'+t.qid+'"].fileupload .btn-file').attr("disabled")},eachQuestionSaveMsg:function(t,e){var s=jQuery('[data-js-id="test-question"][data-js-itemid="'+t+'"]');"1"==e.error?(jQuery('[data-js-id="test-question-msg"] .alert',s).addClass("alert-error"),jQuery('[data-js-id="test-question-msg"] .alert',s).html(e.msg),jQuery('[data-js-id="test-question-msg"]',s).removeClass("d-none")):(jQuery('[data-js-id="test-question-msg"] .alert',s).addClass("alert-success"),jQuery('[data-js-id="test-question-msg"] .alert',s).html(e.msg),jQuery('[data-js-id="test-question-msg"]',s).removeClass("d-none"))},checkNotAttemptedCompulsory:function(){let t=0;jQuery(".questions_container .tjlms-test-page").each(function(){let e=jQuery(this),s=jQuery(this).attr("id").replace("testPage",""),a=0;jQuery(e).find("[data-js-compulsory='1']").each(function(){let t="";if("text"==jQuery(this).attr("data-js-type")&&(t=jQuery(this).find("input").val()),"textarea"==jQuery(this).attr("data-js-type")&&(t=jQuery(this).find("textarea").val()),"radio"===jQuery(this).attr("data-js-type")||"checkbox"===jQuery(this).attr("data-js-type")||"rating"===jQuery(this).attr("data-js-type")){var e=[],s=jQuery(this).attr("data-js-type");"rating"===jQuery(this).attr("data-js-type")&&(s="radio"),jQuery(this).find(":"+s).each(function(){this.checked&&e.push(jQuery(this).val())}),t=e.join()}else if("file_upload"===jQuery(this).attr("data-js-type")){var e=[];jQuery(this).find('[data-js-id="each-file"]').each(function(){e.push(jQuery(this).attr("data-js-itemid"))}),t=e.join()}""==t&&a++}),jQuery("#tmt-page-selection [data-lp='"+s+"'] .mandatory-notification").remove(),t+=a,jQuery("#unAttemptedCompulsoryCnt").val(t),a>0&&jQuery("#tmt-page-selection [data-lp='"+s+"']").not(".prev").not(".next").append("<span class='mandatory-notification'>"+a+"</span>")})},saveEachPageQueAnswers:function(){var t=jQuery("#adminForm").serialize(),e=rootUrl+"index.php?option=com_tmt&task=test.saveEachPageQueAnswers&tmpl=component&format=json";tjService.postData(e,t).fail(function(t){var e={error:[t.responseText]};Joomla.renderMessages(e)}).done(function(t){if(!t.success&&t.message){var e={error:[t.message]};Joomla.renderMessages(e)}t.messages&&Joomla.renderMessages(t.messages),t.success})},submitTest:function(t){var e=jQuery("#adminForm").serialize(),s=rootUrl+"index.php?option=com_tmt&task=test.saveEachPageQueAnswers&tmpl=component&format=json",a=tjService.postData(s,e),o=!0;return a.fail(function(t){o=!1;var e={error:[t.responseText]};Joomla.renderMessages(e)}).done(function(e){if(!e.success&&e.message){o=!1;var s={error:[e.message]};Joomla.renderMessages(s)}if(e.messages&&Joomla.renderMessages(e.messages),e.success){let a=0;if(t||(tjlms.test.checkNotAttemptedCompulsory(),a=jQuery("#unAttemptedCompulsoryCnt").val()),parseInt(a)>0)alert(Joomla.JText._("COM_TMT_TEST_SUBMIT_VALIDATION_FOR_COMPULSORY_MSG")),o=!1;else{var n=jQuery('[data-js-id="form-token"]').attr("name"),i=jQuery('[name="test[id]"]').val(),l=jQuery('[name="invite_id"]').val(),r={};r.testId=i,r.ltId=l,r[n]=1;var d=rootUrl+"index.php?option=com_tmt&task=test.submitTest&tmpl=component&format=json";tjService.postData(d,r).fail(function(t){o=!1;var e={error:[t.responseText]};Joomla.renderMessages(e)}).done(function(t){if(!t.success&&t.message){o=!1;var e={error:[t.message]};Joomla.renderMessages(e)}!t.success&&t.messages&&Joomla.renderMessages(t.messages),o=!0})}}}),o},checkcount:function(t,e,s,a){var o=jQuery('input[name="questions[mcqs]['+e+'][]"]:checked').length,n=[];o>t&&"feedback"!=a&&(jQuery('input[value="'+s+'"]').removeAttr("checked"),n.error="1",n.msg=Joomla.JText._("COM_TMT_TEST_MAX_OPTION_ATTEMPT_VALIDATION"),tjlms.test.eachQuestionSaveMsg(e,n))},testactions:function(){let t=1==this.currentPage?1:0,e=parseInt(this.totalPages),s=parseInt(this.gradingType),a=e==this.currentPage?1:0;jQuery("[data-js-id='toolbar']").addClass("d-inline-block").removeClass("d-none"),jQuery(".toolbar__span").hide(),(1==e||a)&&(jQuery("[data-js-id='toolbar'] [data-js-id='toolbar-final']").show(),"exercise"===s&&jQuery("[data-js-id='toolbar'] [data-js-id='toolbar-final']").show()),!(e>1)||t||a||(jQuery("[data-js-id='toolbar'] [data-js-id='toolbar-prev']").show(),jQuery("[data-js-id='toolbar'] [data-js-id='toolbar-next']").show()),e>1&&t&&!a&&jQuery("[data-js-id='toolbar'] [data-js-id='toolbar-next']").show(),e>1&&!t&&a&&jQuery("[data-js-id='toolbar'] [data-js-id='toolbar-prev']").show(),jQuery(".quiz_content").scrollTop("0")}},assessment:{$form:null,getUrl:function(){return("undefined"==typeof root_url?"":root_url)+"index.php?option=com_tjlms&task=assessment.submit&format=json"},init:function(t){jQuery(window).on("load",function(){height=jQuery(document).height(),jQuery("[data-js-attr='tjlms-lesson']").css("height",height-46),jQuery("[data-js-attr='tjlms-lesson-iframe']").css("height",height-50),jQuery("[data-js-id='tjlms-sidebar']").css("height",height-46),768>jQuery(window).width()&&jQuery("[data-js-attr='lesson-toolbar-content']").insertBefore('[data-js-attr="lesson-player"]'),jQuery(".closeBtn").click(function(){!0==confirm(Joomla.JText._("COM_TJLMS_QUIZ_CONFIRM_BOX"))&&(window.location=t)}),jQuery(".collapse:first").addClass("in"),jQuery('[data-jstoggle="collapse"]').click(function(){jQuery(this).toggleClass("collapsed");var t=jQuery(this).attr("data-target");jQuery(t).toggleClass("in")}),tjlms.assessment.limitScoreInput()}),jQuery(document).ready(function(){jQuery("#assessment-form.noEditAccess input, #assessment-form.noEditAccess select, #assessment-form.noEditAccess textarea, #assessment-form.noEditAccess button:not(.closeBtn)").prop("disabled",!0)})},limitScoreInput:function(){var t=/^[0-9]*(?:\.[0-9]*)?$/;jQuery("#assessment-form").find(".textinput").on("keyup",function(e){if(!(!jQuery(this).val()||jQuery(this).val().match(t))||jQuery(this).val()>jQuery(this).data("maxval"))return jQuery(this).parents(".assessment_field").find(".msg").show().removeClass("hide"),jQuery(this).val(""),!1;jQuery(this).parents(".assessment_field").find(".msg").hide().addClass("hide")})},validate:function(t){if(1==parseInt(t)){var e=/^[0-9]*(?:\.[0-9]*)?$/,s=jQuery("input[name='gradingtype']").val(),a=!0;if("quiz"==s){if(this.$form.find("[data-js-id='test-review-question']").each(function(){var t=jQuery("[data-js-id='test-review-marks']",jQuery(this)).val(),s=parseInt(jQuery("[data-js-id='test-review-qmarks']",jQuery(this)).val(),10);if(jQuery("[data-js-id='test-review-msg']",jQuery(this)).addClass("hide"),!t.match(e)||isNaN(t)||t>s){!0==a&&(a=!1),jQuery("[data-js-id='test-review-msg']",jQuery(this)).show().removeClass("hide"),jQuery("[data-js-id='test-review-marks']",jQuery(this)).val("");return}}),!a)return!1}else{var a=!0;if(this.$form.find(".assessment_field").each(function(t,e){if(jQuery(e).find("[name$='[rating_value]']").length&&!(a=(a=(a=(a=(a=!1,!!jQuery(e).find("input[type='radio'][name$='[rating_value]']:checked").length))||!!jQuery(e).find("input[type='checkbox'][name$='[rating_value]']").length)||!!jQuery(e).find("input[type='text'][name$='[rating_value]']").val())||!!jQuery(e).find("select[name$='[rating_value]']").val()))return!1}),!a)return confirm(Joomla.JText._("COM_TJLMS_ASSESSMENTS_ARE_YOU_SURE"))}}return!0},submit:function(t,e){if(this.$form=jQuery("#assessment-form"),!this.validate(t))return!1;var s=this;this.$form.find("button").prop("disabled",!0);var a=this.$form.serializeArray();a.push({name:"review_status",value:t}),tjService.postData(this.getUrl(),a).fail(function(t){jQuery(".assessment-form_msg .alert").removeClass("hide").removeClass("alert-success").addClass("alert-error").html(t.responseText),s.$form.find("button").prop("disabled",!1)}).done(function(e){s.$form.find("button").prop("disabled",!1),e.success?(e.message,s.$form.find(".assessment-form_msg .alert").removeClass("hide").removeClass("alert-error").addClass("alert-success").html(e.message),s.$form.find(".assessment-form_score label strong").text(Joomla.JText._("COM_TJLMS_ASSESSMENTS_SCORE").replace("%s",e.data)),1==parseInt(t)&&(window.location=onSuceessredirectUrl)):(e.message,s.$form.find(".assessment-form_msg .alert").removeClass("hide").removeClass("alert-success").addClass("alert-error").html(e.message))})}}};function toggleexpand(t){jQuery(t).hasClass("tjcollapsed")?(jQuery(t).removeClass("tjcollapsed"),jQuery(t).addClass("tjexpanded")):jQuery(t).hasClass("tjexpanded")&&(jQuery(t).removeClass("tjexpanded"),jQuery(t).addClass("tjcollapsed")),togglestate()}function togglestate(){jQuery(".tjcollapsed").each(function(){var t=jQuery(this).attr("parentfor");jQuery("tr[childof="+t+"]").hide(),jQuery("i",this).addClass("icon-folder-close"),jQuery("i",this).removeClass("icon-folder-open")}),jQuery(".tjexpanded").each(function(){var t=jQuery(this).attr("parentfor");jQuery("tr[childof="+t+"]").show(),jQuery("i",this).addClass("icon-folder-open"),jQuery("i",this).removeClass("icon-folder-close")})}function redirect(t){window.location=t}function redirect_course(t,e,s){document.getElementById("course_id").value=e,document.getElementById("scorm_type").value=s,document.adminForm.submit()}function generate_reports(t,e){jQuery.ajax({url:root_url+"index.php?option=com_tjlms&controller=course&task="+t+"&course_id="+e,type:"POST",dataType:"json",timeout:3500,error:function(){console.log("Problem with AJAX Request in LMSCommit()")},success:function(t){if(jQuery("#course_report").find("tr:gt(0)").remove(),0!=t.length)for(var e=0;e<t.length;e++){var s="<tr>";s+='<td class="center">'+(e+1)+"</td>",s+='<td class="center">'+t[e].username+"</td>",s+='<td class="center">'+t[e].attempts+"</td>",s+='<td class="center">'+t[e].grade_score+"</td>",s+="</tr>",jQuery("#course_report").append(s)}else{var s="<tr>";s+='<td class="center" colspan="3">No data to display</td>',s+="</tr>",jQuery("#course_report").append(s)}}})}function generate_myreports(t,e,s){jQuery.ajax({url:root_url+"index.php?option=com_tjlms&controller=course&task="+t+"&course_id="+e+"&userid="+s,type:"POST",dataType:"html",timeout:3500,error:function(){console.log("ERROR_IN_GENERATING_REPORT")},success:function(t){jQuery("#course_myreport").html(t)}})}function generate_nonscormreport(t){jQuery.ajax({url:root_url+"index.php?option=com_tjlms&controller=course&task=getnonscorm_coursereport&course_id="+t,type:"POST",dataType:"json",timeout:3500,error:function(){console.log("ERROR_IN_GENERATING_MY_COURSE_REPORT")},success:function(t){if(jQuery("#nonscormcourse_report").find("tr:gt(0)").remove(),0!=t.length)for(var e=0;e<t.length;e++){var s="<tr>";s+='<td class="center">'+(e+1)+"</td>",s+='<td class="center">'+t[e].username+"</td>",s+='<td class="center">'+t[e].start_date+"</td>",s+='<td class="center">'+t[e].stage_page+"</td>",s+='<td class="center">'+t[e].score+"</td>",s+="</tr>",jQuery("#nonscormcourse_report").append(s)}else{var s="<tr>";s+='<td class="center" colspan="3">No data to display</td>',s+="</tr>",jQuery("#nonscormcourse_report").append(s)}}})}function showloading(t){}function loadingImage(t,e){void 0===e&&(e=0),t=t?"#"+t:"body",1==e?(imgwidth=jQuery(document).width(),imgheight=jQuery(document).height()):(imgwidth=jQuery(t).width(),imgheight=jQuery(t).height()),jQuery("<div id='appsloading'></div>").css("background","rgba(255, 255, 255, 1) url('"+root_url+"/components/com_tjlms/assets/images/ajax.gif') 50% 45% no-repeat").css("top",jQuery(t).position().top-jQuery(t).scrollTop()).css("width",imgwidth).css("height",imgheight).css("position","fixed").css("z-index","1000").css("opacity","1").css("-ms-filter","progid:DXImageTransform.Microsoft.Alpha(Opacity = 80)").css("filter","alpha(opacity = 80)").appendTo(t)}function hideImage(){jQuery("#appsloading").remove()}function open_lessonforattempt(t,e,s,a){"0"!=s&&"1"!=a?jQuery.ajax({url:root_url+"index.php?option=com_tjlms&task=course.userEnrollAction",type:"POST",data:{cId:s},success:function(s){console.log(Joomla.JText._("COM_TJLMS_ENROL_SUCCESS")),"tab"==e?window.open(t,"_blank"):window.location=t}}):"tab"==e?window.open(t,"_blank"):window.location=t}function open_scoforattempt(t,e,s,a,o,n){var i=1,l="index.php?option=com_tjlms&view=lesson&lesson_id="+e+"&attempt="+(i=0==s?1:"completed"==o||"passed"==o||"failed"==o?a>0?s<a?Number(s)+1:s:Number(s)+1:s)+"&sco_id="+t;if("popup"==n){var r=jQuery(window).width()-100,d=jQuery(window).height()-80;l+="&tmpl=component&fs=1",SqueezeBox.open(l,{handler:"iframe",size:{x:r,y:d},onClose:function(){window.parent.document.location.reload(!0)}})}else window.location=l}function updateData(t,e){jQuery.ajax({url:root_url+"index.php?option=com_tjlms&task=callSysPlgin&plgType="+t.plgtype+"&plgName="+t.plgname+"&plgtask="+t.plgtask+"&mode="+t.mode,dataType:"json",type:"POST",data:{lesson_status:t.lesson_status,lesson_id:t.lesson_id,attempt:t.attempt,total_content:t.total_content,current_position:t.current_position,lesson_status:t.lesson_status,time_spent:t.time_spent},success:function(t){return t},error:function(t){console.log("something went wrong")},complete:function(t){!0===e&&closePopup(launchLessonFullScreen,returnUrl)}})}function closePopup(t,e){"tab"==t?(opener&&opener.location.reload(),window.close()):"preview_popup"==t||"popup"==t?window.parent.SqueezeBox.close():window.location=e}function enrollUser(t){jQuery("#free_course_button").attr("disabled","disabled"),jQuery("#adminFormToc"+t).submit()}function askforaction(t,e,s,a,o){jQuery.ajax({url:root_url+"index.php?option=com_tjlms&task=lesson.askforaction",type:"POST",async:!1,data:{action:t,lesson_id:e,attempt:a,lessonformat:o},dataType:"json",timeout:3500,error:function(){alert("COM_TJLMS_ERROR_IN_SETTING_ATTEMPT")},beforeSend:function(){jQuery("#askforattempt").hide(),showloading(1)},success:function(t){1==t&&(window.location=s)}})}function togglePaylistSidebar(t){jQuery("#playlist-container").toggleClass("playlist-hidden"),jQuery(".lesson-left-panel-header").toggleClass("playlist-hidden"),"close"==t?jQuery("#lesson-main-container").removeClass("span9").addClass("span12 expanded"):jQuery("#lesson-main-container").removeClass("span12 expanded").addClass("span9")}function toggleJlikePanel(){jQuery(".main-lesson").toggleClass("span8"),jQuery(".right-panel").toggleClass("right-panel-hidden")}function printcertificate(t){var e=document.getElementById(t).innerHTML,s=document.body.innerHTML;document.body.innerHTML=e,window.print(),document.body.innerHTML=s}function closeModalPopup(){jQuery('.modal-header button[data-dismiss="modal"]',window.parent.document).click()}function courseAssignRecommend(t,e){if("assign"==t){var s=jQuery("#start_date"),a=jQuery("#due_date"),o=s.val(),n=a.val();if(""==o||""==n)return alert(Joomla.JText._("COM_TJLMS_SELECT_FILL_DATES")),""==o?s.focus():""==n&&a.focus(),!1;if(!1==checkDateFormat(o))return alert(Joomla.JText._("COM_TJLMS_INVALID_DATE_FORMAT")+o),s.val(""),!1;if(!1==checkDateFormat(n))return alert(Joomla.JText._("COM_TJLMS_INVALID_DATE_FORMAT")+n),s.val(""),!1;if(o>n)return alert(Joomla.JText._("COM_TJLMS_START_DATE_GT_THAN_DUE_DATE")),!1;if(""!=n){var i=new Date;if(i.setHours(0,0,0,0),(assignEndDate=new Date(n)).setHours(0,0,0,0),assignEndDate<i)return alert(Joomla.JText._("COM_TJLMS_START_DATE_GT_THAN_TODAY")),!1}}jQuery("#task").val(e),document.adminForm.submit()}function openAssignRecommendPopups(t,e="assigntabModal",s=null){jQuery(window).width(),jQuery(window).height(),jQuery("#"+e+s).modal("show")}function closeAssignRecommendPopups(){window.parent.document.location.reload(!0),window.parent.SqueezeBox.close()}jQuery(document).ready(function(){var t=jQuery(".progress-pie-chart"),e=parseInt(t.data("percent"));e>50&&t.addClass("gt-50"),jQuery(".ppc-progress-fill").css("transform","rotate("+360*e/100+"deg)"),jQuery(".ppc-percents span").html(e+"%"),jQuery(".r-more").click(function(){var t=jQuery(this).closest(".long_desc"),e=jQuery(t).siblings(".long_desc_extend");jQuery(t).hide(),jQuery(".r-more",t).hide(),jQuery(e).show(),jQuery(".r-less",e).show()}),jQuery(".r-less").click(function(){var t=jQuery(this).closest(".long_desc_extend"),e=jQuery(t).siblings(".long_desc");jQuery(t).hide(),jQuery(".r-less",t).hide(),jQuery(e).show(),jQuery(".r-more",e).show()}),jQuery(".tjlms_section_title").click(function(){var t=jQuery(this).parent().attr("id").replace("modlist_","");toggleModuleAccordion(t)}),jQuery(".tjlms_playlist_mod_title").click(function(){var t=jQuery(this).parent().attr("id").replace("modlist_","");jQuery(this).toggleClass("open"),jQuery("div.module_container_"+t).toggle()}),togglestate(),jQuery(".tjlms_enrolUsers").on("shown.bs.tab","#myTabTabs.nav-tabs li a",function(t){var e=jQuery(this).attr("href");e=e.replace("#","");var s=jQuery("#tjlms-assign .modal-footer .assign-footer"),a=jQuery("#tjlms-assign #select-option").prop("checked");"groups"==e&&!0==a?(jQuery(".assign-groups-btn",s).show(),jQuery(".enroll-groups-btn, .enroll-btn, .assign-btn",s).hide()):"groups"==e?(jQuery(".enroll-groups-btn",s).show(),jQuery(".assign-groups-btn, .enroll-btn, .assign-btn",s).hide()):"users"==e&&!0==a?(jQuery(".assign-btn",s).show(),jQuery(".assign-groups-btn, .enroll-groups-btn, .enroll-btn",s).hide()):(jQuery(".enroll-btn",s).show(),jQuery(".assign-groups-btn, .enroll-groups-btn, .assign-btn",s).hide()),adjustModalHeight()})});var assignUser=function(t,e){var s=jQuery("#start_date").val(),a=jQuery("#due_date").val();jQuery("#sender_msg").val();var o=jQuery("#start_date"),n=jQuery("#due_date");if("enroll"==e||"enrollGroup"==e){if(""==jQuery("#selectedcourse").val())return alert(Joomla.JText._("COM_TJLMS_SELECT_COURSE_TO_ENROLL")),!1;if("enroll"==e){if(0==document.adminForm.boxchecked.value)return alert(Joomla.JText._("COM_TJLMS_MESSAGE_SELECT_ENROLL_ITEMS")),!1}else if("enrollGroup"==e&&!jQuery("#enrollusers").find(".tjlms_enrolUsers input.user_groups:checked").length)return alert(Joomla.JText._("COM_TJLMS_SELECT_GROUP_TO_ASSIGN")),!1;jQuery("#enrollusers #type").val(e),Joomla.submitform("enrolluser."+t)}else if("assign"==e||"assignGroup"==e){if(""==jQuery("#selectedcourse").val())return alert(Joomla.JText._("COM_TJLMS_SELECT_COURSE_TO_ENROLL")),!1;if(0==document.adminForm.boxchecked.value&&"assign"==e)return alert(Joomla.JText._("COM_TJLMS_MESSAGE_SELECT_ASSIGN_ITEMS")),!1;if(!jQuery("#enrollusers").find(".tjlms_enrolUsers input.user_groups:checked").length&&"assignGroup"==e)return alert(Joomla.JText._("COM_TJLMS_SELECT_GROUP_TO_ASSIGN")),!1;if(!1==checkDateFormat(s))return alert(Joomla.JText._("COM_TJLMS_INVALID_START_DATE_FORMAT")),o.focus(),!1;if(!1==checkDateFormat(a))return alert(Joomla.JText._("COM_TJLMS_INVALID_DUE_DATE_FORMAT")),n.focus(),!1;if(s>a)return alert(Joomla.JText._("COM_TJLMS_START_DATE_GT_THAN_DUE_DATE")),!1;if(""!=a){var i=new Date;if(i.setHours(0,0,0,0),(assignEndDate=new Date(a)).setHours(0,0,0,0),assignEndDate<i)return alert(Joomla.JText._("COM_TJLMS_START_DATE_GT_THAN_TODAY")),!1}!0==jQuery(".assign-groups-btn #update_existing_users").prop("checked")&&jQuery(".assign-groups-btn #update_existing_users").val(1),jQuery("#enrollusers #type").val(e),Joomla.submitform("enrolluser."+t)}else if("reco"==e){if(0==document.adminForm.boxchecked.value)return alert(Joomla.JText._("COM_TJLMS_MESSAGE_SELECT_RECO_ITEMS")),!1;jQuery("#enrollusers #type").val(e),Joomla.submitform("enrolluser."+t)}},checkDateFormat=function(t){return regExp=/^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/,!!(t&&t.match(regExp))},showAssign=function(t){!0==jQuery(".tjlms_enrolUsers .nav-tabs li:first-child").hasClass("active")?(jQuery(".show-assignment-fields, .assign-btn, .enroll-btn, .tjmodal-enroll-title, .tjmodal-assign-title").toggle(),jQuery(".assign-groups-btn, .enroll-groups-btn").hide()):jQuery(".assign-groups-btn, .enroll-groups-btn, .show-assignment-fields, .tjmodal-enroll-title, .tjmodal-assign-title").toggle(),adjustModalHeight()},adjustModalHeight=function(){if(jQuery("#recommend-table-container").length){var t=jQuery("html").height()-jQuery(".modal-footer").outerHeight()-jQuery("#recommend-table-container").offset().top;jQuery("#recommend-table-container").css("height",t)}if(jQuery("#assign-table-container").length){var t=jQuery("html").height()-jQuery(".modal-footer").outerHeight()-jQuery("#myTabContent").offset().top;jQuery("#myTabContent").css("height",t)}};jQuery(document).ready(function(){jQuery("#tjlms-assign").length&&tjlms.utility.inIframe()&&(jQuery(".modal-body").prepend(jQuery("#system-message-container")),jQuery("html").addClass("popuphtml"),jQuery(".modal-header",".popuphtml").parents().each(function(t,e){jQuery(e).addClass("fullheight")}),jQuery(".field-calendar button").on("click",function(){jQuery(".calendar-container > table.table").removeClass("table")}))});var tjlmsfilter={init:function(){jQuery(document).ready(function(){jQuery("#creator_filter").val()>0&&jQuery("#creator_filter_chzn").addClass("filterActive"),jQuery("#category_filter").val()>0&&jQuery("#category_filter_chzn").addClass("filterActive"),jQuery("#course_type").val()>=0&&jQuery("#course_type_chzn").addClass("filterActive"),767>jQuery(window).width()&&(jQuery('[data-id="filter-category"]').addClass("col-xxs-6"),jQuery('[data-id="filter-type"]').addClass("col-xxs-6"),jQuery('[data-id="filter-author"]').addClass("col-xxs-6"),jQuery('[data-id="filter-tag"]').addClass("col-xxs-6")),(jQuery('[data-id="filter-search"]').hasClass("filterActive")||jQuery('[data-id="filter-type"]').hasClass("filterActive")||jQuery('[data-id="filter-category"]').hasClass("filterActive")||jQuery('[data-id="filter-author"]').hasClass("filterActive")||jQuery('[data-id="filter-tag"]').hasClass("filterActive"))&&(jQuery(".tjlms-filters").show(),jQuery('[data-identifier="tjlms-filters-menu"]').find("i").addClass("fa-angle-down").removeClass("fa-angle-right"))})},reset:function(){jQuery("#course_cat, #course_type, #creator_filter, #course_status, #filter_tag").prop("selectedIndex",0),jQuery(".course-fields").prop("selectedIndex",0),jQuery("#filter_search").val("")},toggle:function(t){jQuery(".tjlms-filters").toggle(),jQuery(".tjlms-filters").is(":hidden")?jQuery(t).children("i").addClass("fa-angle-right").removeClass("fa-angle-down"):jQuery(t).children("i").addClass("fa-angle-down").removeClass("fa-angle-right")},toggleDiv:function(t){jQuery("#"+t).toggleClass("active hide"),jQuery("#displayFilter .plusminusIcon").toggleClass("fa-plus fa-minus")}};