"use strict";angular.module("starter.helper",[]).factory("ItemEditorHelper",function(){var templateRender=null;var view=null;var ItemEditorHelper={POSTTHIS_DEFAULT:1,POSTTHIS_NO:2,POSTTHIS_YES:3,POSTTHIS_ONLYONCE:5,setHtmlAdvancedAttrs:function(message){var $form,element;element=view.document.getElementById("autotweet_advanced_attrs");if(element){message=JSON.stringify(message);element.value=message;return true}message=_.escape(JSON.stringify(message));element='<input type="hidden" id="autotweet_advanced_attrs" name="autotweet_advanced_attrs" value="'+message+'">';$form=view.jQuery("form[name=adminForm]");if(!$form.length){$form=view.jQuery("form[name=submissionForm]");if(!$form.length){$form=view.jQuery("form[name=composer]")}}if($form.length==1){$form.append(element)}else{alert("Joocial - Form not found or more than one.")}return true},getHtmlAdvancedAttrs:function(){var input,message;input=view.document.getElementById("autotweet_advanced_attrs");if(input&&!_.isEmpty(input.value)){message=input.value;message=JSON.parse(_.unescape(message));return message}return null},getHtmlEditorText:function(){var editor,text;if(view.tinymce&&view.tinymce.activeEditor){text=view.tinymce.activeEditor.getContent();if(_.isEmpty(text)){text=view.tinymce.editors[0].getContent()}return text}else if(editor=view.document.getElementById("jform_articletext")){return editor.value}return null},setHtmlPanel:function(panel,title){var element,tabs;element=view.jQuery("#item-form #myTabContent");if(element.length){ItemEditorHelper.addHtmlTab(title);ItemEditorHelper.addHtmlPanel(element,panel);return true}element=view.jQuery(".item-page #adminForm .tab-content");if(element.length){ItemEditorHelper.addHtmlTab(title);ItemEditorHelper.addHtmlPanel(element,panel);return true}element=view.jQuery("#item-form #myTab");if(element.length){ItemEditorHelper.addHtmlTab(title);ItemEditorHelper.addHtmlPanel(element,panel);return true}element=view.jQuery(".request-edit #qContent");if(element.length){const jversion=view.jQuery(".request-edit #qTypeTabs").hasClass("xt-nav-tabs-joomla3")?3:4;ItemEditorHelper.addHtmlTab(title,jversion);ItemEditorHelper.addHtmlPanel(element,panel);tabs=view.jQuery("#filterconditions-tab a");if(tabs.length){tabs.show()}return true}element=view.jQuery("#adminFormK2Sidebar");if(element.length){ItemEditorHelper.addHtmlPanel(element,panel);return true}element=view.jQuery("#parameter-accordion");if(element.length){ItemEditorHelper.addHtmlPanel(element,panel);return true}element=view.jQuery("#item-submission");if(element.length){ItemEditorHelper.addHtmlPanel(element,panel);return true}element=view.jQuery("form[name=composer]");if(element.length){ItemEditorHelper.addHtmlPanel(element,panel);return true}element=view.jQuery("#eblog-wrapper #options");if(element.length){ItemEditorHelper.addHtmlPanel(element,panel);return true}element=view.jQuery("#widget-writepost .ui-modbody");if(element.length){ItemEditorHelper.addHtmlPanel(element,panel);return true}element=view.jQuery("#fcform_tabset_0");if(element.length){ItemEditorHelper.addHtmlPanel(element,panel);element.height("100%");return true}element=view.jQuery(".jr-tabs");if(element.length){ItemEditorHelper.addHtmlPanel(element,panel);return true}element=view.jQuery("#JCalProEventTabContent");if(element.length){ItemEditorHelper.addHtmlTab(title);ItemEditorHelper.addHtmlPanel(element,panel);return true}element=view.jQuery("#content");if(element.length){ItemEditorHelper.addHtmlPanel(element,panel);return true}element=view.jQuery("#element-box div.m");if(element.length){ItemEditorHelper.addHtmlPanel(element,panel);return true}return false},addHtmlPanel:function(sidebar,panel){var elem;elem=view.document.getElementById("autotweet-advanced-attrs");if(elem){elem.parentNode.removeChild(elem)}sidebar.append(panel)},loadPanel:function(advancedAttrs){if(_.isEmpty(advancedAttrs)){advancedAttrs=view.autotweetAdvancedAttrs}if(_.isEmpty(advancedAttrs)){return false}},updatePanel:function(advancedAttrs){var panel,tplAttrs;tplAttrs=_.clone(advancedAttrs);tplAttrs.autotweetUrlRoot=view.autotweetUrlRoot;panel=templateRender(tplAttrs);ItemEditorHelper.setHtmlPanel(panel,advancedAttrs.editorTitle);parent.jQuery("ul.nav-tabs li a:first").show()},addHtmlTab:function(title){let tabs;tabs=view.jQuery("#myTabTabs");if(tabs.length){ItemEditorHelper.addHtmlTabForJoomla3(title,tabs);return true}tabs=view.jQuery("#myTab div[role=tablist]:first");if(tabs.length){ItemEditorHelper.addHtmlTabForJoomla4(title,tabs);return true}tabs=view.jQuery("#JCalProEventTabTabs");if(tabs.length){ItemEditorHelper.addHtmlTabForJoomla3(title,tabs);return true}tabs=view.jQuery(".request-edit #qTypeTabs");if(tabs.length){joomlaVersion===3?ItemEditorHelper.addHtmlTabForJoomla3(title,tabs):ItemEditorHelper.addHtmlTabForJoomla4(title,tabs);return true}return false},addHtmlTabForJoomla3:function(title,tabs){var img='<img width="16" height="16" src="'+view.autotweetUrlRoot+'media/com_autotweet/images/perfectpub-logo.svg">',tab;if(!view.jQuery("#myAutoTweetTab").length){tab=view.jQuery('<li id="myAutoTweetTab" class=""><a id="myAutoTweetTabToogle" href="#autotweet-advanced-attrs" data-toggle="tab">'+img+" "+title+"</a></li>");tabs.append(tab);view.jQuery("#myAutoTweetTabToogle").click(function(e){e.preventDefault();if(_.isFunction(jQuery(this).tab)){jQuery(this).show()}})}},addHtmlTabForJoomla4:function(title,tabs){var img='<img width="16" height="16" src="'+view.autotweetUrlRoot+'media/com_autotweet/images/perfectpub-logo.svg">',tab;if(view.jQuery("#myAutoTweetTab").length){return}tab=view.jQuery(`<a href="#autotweet-advanced-attrs" aria-controls="autotweet-advanced-attrs" class="btn" id="myAutoTweetTab">${img} ${title}</a>`);tabs.append(tab)},retrieveTitle:function(){var title;title=view.jQuery("#jform_title").val();if(!_.isEmpty(title)){return title}title=view.jQuery("#title").val();if(!_.isEmpty(title)){return title}title=view.jQuery("textarea[name=title]").val();if(!_.isEmpty(title)){return title}title=view.jQuery("#name").val();if(!_.isEmpty(title)){return title}return""},retrieveFulltext:function(){var text=ItemEditorHelper.getHtmlEditorText();var tmp=document.createElement("DIV");tmp.innerHTML=text;text=tmp.textContent||tmp.innerText||"";if(text.length>300){text=text.substr(0,300)+"..."}return text},retrieveImages:function(){var text,$dummyNode,imgs,img,$i,imgsrc,imgalt;text=ItemEditorHelper.getHtmlEditorText();text=text.replace(/src/g,"data_src");$dummyNode=jQuery(text),imgs=[];_.each($dummyNode.find("img"),function(i){$i=jQuery(i);img={src:$i.attr("data_src"),alt:$i.attr("alt")};imgs.push(img)});imgsrc=view.jQuery("#jform_images_image_intro").val();if(!_.isEmpty(imgsrc)){imgalt=view.jQuery("#jform_images_image_intro_alt").val()||view.jQuery("#jform_images_image_intro_caption").val();img={src:imgsrc,alt:imgalt};imgs.push(img)}imgsrc=view.jQuery("#jform_images_image_fulltext").val();if(!_.isEmpty(imgsrc)){imgalt=view.jQuery("#jform_images_image_fulltext_alt").val()||view.jQuery("#jform_images_image_fulltext_caption").val();img={src:imgsrc,alt:imgalt};imgs.push(img)}imgsrc=view.jQuery(".k2AdminImage").attr("src");if(!_.isEmpty(imgsrc)){if(-1!==imgsrc.indexOf("?t=")){imgsrc=imgsrc.slice(0,imgsrc.indexOf("?t="));imgsrc=imgsrc.slice(0,imgsrc.indexOf("_Generic.jpg"))}if(-1!==imgsrc.indexOf("_S.jpg")){imgsrc=imgsrc.slice(0,imgsrc.indexOf("_S.jpg"))}imgalt=view.jQuery("input[name=image_caption]").val();img={src:imgsrc+"_XS.jpg",alt:imgalt+" XS"};imgs.push(img);img={src:imgsrc+"_S.jpg",alt:imgalt+" S"};imgs.push(img);img={src:imgsrc+"_Generic.jpg",alt:imgalt+" Generic"};imgs.push(img);img={src:imgsrc+"_M.jpg",alt:imgalt+" M"};imgs.push(img);img={src:imgsrc+"_L.jpg",alt:imgalt};imgs.push(img);img={src:imgsrc+"_XL.jpg",alt:imgalt+" XL"};imgs.push(img);imgs.reverse()}imgsrc=view.jQuery(".image-preview img");if(imgsrc.length){_.each(imgsrc,function(source){img={src:source.src};if(source.src.toLowerCase().match(/\.(jpg|jpeg|png|gif)$/)){imgs.push(img)}})}imgsrc=view.jQuery(".imageData").val();if(!_.isEmpty(imgsrc)){imgsrc=JSON.parse(_.unescape(imgsrc));img={src:imgsrc.url,alt:imgsrc.title};imgs.push(img)}imgsrc=view.jQuery("input[name=product_image]+img").attr("src");if(!_.isEmpty(imgsrc)){imgs.push({src:imgsrc})}imgsrc=view.jQuery("#product_images_area img");if(imgsrc.length){_.each(imgsrc,function(source){img={src:source.src};imgs.push(img)})}return imgs},setYesNo:function(v,$field){var dataValue;if(v&&v!=$field.val()){dataValue=$field.parent().find("a[data-value="+v+"]");if(dataValue.length){dataValue.click()}else{$field.val(v);$field.trigger("liszt:updated")}}}};if(window.parent.autotweetAdvancedAttrs){view=window.parent}else{if(window.autotweetAdvancedAttrs){view=window}}ItemEditorHelper.loadPanel();if(view){ItemEditorHelper.setHtmlAdvancedAttrs(view.autotweetAdvancedAttrs)}return ItemEditorHelper});"use strict";angular.module("starter",["starter.helper"]).config(function($logProvider,$compileProvider){$logProvider.debugEnabled(false);$compileProvider.debugInfoEnabled(false)}).run(["ItemEditorHelper",function(ItemEditorHelper){}]);angular.element(document).ready(function(){angular.bootstrap(document,["starter"])});
