define("channel",["extlycore"],function(Core){"use strict";"use strict";var appParamsHelper={get:function(scope){var canvas_page=null,app_id="My-App-ID",secret="My-App-Secret",access_token="My-Access-Token",ownApp=scope.$("#use_own_api").val(),token=scope.$("#XTtoken").attr("name"),channelTypeId=scope.$("#channeltype_id").val();if(ownApp==="1"){canvas_page=scope.$("#canvas_page").val().trim();app_id=scope.$("#app_id").val().trim();secret=scope.$("#secret").val().trim();scope.$("#canvas_page").val(canvas_page);scope.$("#app_id").val(app_id);scope.$("#secret").val(secret)}else if(ownApp==="2"){app_id=scope.$("#app_id").val().trim();secret=scope.$("#secret").val().trim();scope.$("#app_id").val(app_id);scope.$("#secret").val(secret)}access_token=scope.$("#access_token").val().trim();scope.$("#access_token").val(access_token);var params={p_own_app:ownApp,p_canvas_page:canvas_page,p_encoded_canvas_page:encodeURIComponent(canvas_page),p_app_id:encodeURIComponent(app_id),p_secret:encodeURIComponent(secret),p_access_token:encodeURIComponent(access_token),p_token:encodeURIComponent(token),p_channelTypeId:channelTypeId};var url_params="app_id="+params.p_app_id+"&secret="+params.p_secret+"&access_token="+params.p_access_token+"&ownapp="+params.p_own_app+"&canvas_page="+params.p_encoded_canvas_page+"&token="+params.p_token;params.p_url_params=url_params;return params},getLi:function(scope){var api_key=scope.$("#api_key").val(),secret_key=scope.$("#secret_key").val(),oauth_user_token=scope.$("#oauth_user_token").val(),oauth_user_secret=scope.$("#oauth_user_secret").val(),token=scope.$("#XTtoken").attr("name");var params={p_api_key:api_key,p_secret_key:encodeURIComponent(secret_key),p_oauth_user_token:encodeURIComponent(oauth_user_token),p_oauth_user_secret:encodeURIComponent(oauth_user_secret),p_token:encodeURIComponent(token)};var url_params="api_key="+params.p_api_key+"&secret_key="+params.p_secret_key+"&oauth_user_token="+params.p_oauth_user_token+"&oauth_user_secret="+params.p_oauth_user_secret+"&token="+params.p_token;params.p_url_params=url_params;return params}};var validationHelper={showSuccess:function(scope,userId,socialIcon,socialUrl){scope.$("#user_id").val(userId);this.assignSocialUrl(scope,"social_url",socialIcon,socialUrl);scope.$("#validation-notchecked").hide();scope.$("#validation-error").hide();scope.$("#validation-errormsg").hide();scope.$("#validation-success").show()},assignSocialUrl:function(scope,target,socialIcon,socialUrl){if(socialUrl){scope.$("#"+target).val(socialUrl);scope.$("."+target).html(this.formatUrl(socialIcon,socialUrl))}},showError:function(scope,msg){scope.$("#user_id").val("");scope.$("#validation-notchecked").hide();scope.$("#validation-success").hide();scope.$("#validation-theerrormsg").html(msg);scope.$("#validation-error").show();scope.$("#validation-errormsg").show()},formatUrl:function(socialIcon,socialUrl){return'<p><a href="'+socialUrl+'" target="_blank">'+socialIcon+" "+socialUrl+"</a></p>"}};var BloggerValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getBloggerValidation")}});var BskyValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getBskyValidation")}});var Channel=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getParamsForm&toolbar=none")}});var FbChannel=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getFbChannels")}});var FbChValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getFbChValidation")}});var FbExtend=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getFbExtend")}});var FbValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getFbValidation")}});var LiOAuth2Company=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getLiOAuth2Companies")}});var LiOAuth2Validation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getLiOAuth2Validation")}});var MediumValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getMediumValidation")}});var MyBusinessValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getMyBusinessValidation")}});var OneSignalValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getOneSignalValidation")}});var PageSpeedValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getPageSpeedValidation")}});var PinterestValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getPinterestValidation")}});var PushAlertValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getPushAlertValidation")}});var PushwooshValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getPushwooshValidation")}});var ScoopitTopic=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getScoopitTopics")}});var ScoopitValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getScoopitValidation")}});var TelegramValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getTelegramValidation")}});var TumblrValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getTumblrValidation")}});var TwitterV2Validation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getTwitterV2Validation")}});var TwValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getTwValidation")}});var WebpushrValidation=Core.ExtlyModel.extend({url:function(){return Core.SefHelper.route("index.php?option=com_autotweet&view=channels&task=getWebpushrValidation")}});var BloggerValidations=Backbone.Collection.extend({model:BloggerValidation});var BskyValidations=Backbone.Collection.extend({model:BskyValidation});var Channels=Backbone.Collection.extend({model:Channel});var FbChannels=Backbone.Collection.extend({model:FbChannel});var FbChValidations=Backbone.Collection.extend({model:FbChValidation});var FbExtends=Backbone.Collection.extend({model:FbExtend});var FbValidations=Backbone.Collection.extend({model:FbValidation});var LiOAuth2Companies=Backbone.Collection.extend({model:LiOAuth2Company});var LiOAuth2Validations=Backbone.Collection.extend({model:LiOAuth2Validation});var MediumValidations=Backbone.Collection.extend({model:MediumValidation});var MyBusinessValidations=Backbone.Collection.extend({model:MyBusinessValidation});var OneSignalValidations=Backbone.Collection.extend({model:OneSignalValidation});var PageSpeedValidations=Backbone.Collection.extend({model:PageSpeedValidation});var PinterestValidations=Backbone.Collection.extend({model:PinterestValidation});var PushAlertValidations=Backbone.Collection.extend({model:PushAlertValidation});var PushwooshValidations=Backbone.Collection.extend({model:PushwooshValidation});var ScoopitTopics=Backbone.Collection.extend({model:ScoopitTopic});var ScoopitValidations=Backbone.Collection.extend({model:ScoopitValidation});var TelegramValidations=Backbone.Collection.extend({model:TelegramValidation});var TumblrValidations=Backbone.Collection.extend({model:TumblrValidation});var TwitterV2Validations=Backbone.Collection.extend({model:TwitterV2Validation});var TwValidations=Backbone.Collection.extend({model:TwValidation});var WebpushrValidations=Backbone.Collection.extend({model:WebpushrValidation});"use strict";var BloggerValidationView=Backbone.View.extend({events:{"click #bloggervalidationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this)},onValidationReq:function(){var view=this,channelId=view.$("#channel_id").val().trim(),clientSecret=view.$("#client_secret").val().trim(),developerKey=view.$("#developer_key").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#channel_id").val(channelId);view.$("#client_secret").val(clientSecret);view.$("#developer_key").val(developerKey);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{channel_id:channelId,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),errorMessage=resp.get("message"),user=resp.get("user"),socialIcon=resp.get("social_icon"),socialUrl=resp.get("social_url");this.$(".loaderspinner").removeClass("loading");if(status){validationHelper.showSuccess(this,user.id,socialIcon,socialUrl)}else{validationHelper.showError(this,errorMessage)}}});"use strict";var BskyValidationView=Backbone.View.extend({events:{"click #bskyvalidationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this)},onValidationReq:function onValidationReq(){var view=this,identifier=view.$("#identifier").val().trim(),password=view.$("#password").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#identifier").val(identifier);view.$("#password").val(password);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{identifier:identifier,password:password,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),error_message=resp.get("message"),user=resp.get("user"),icon=resp.get("icon"),url=resp.get("url");this.$(".loaderspinner").removeClass("loading");if(status){validationHelper.showSuccess(this,user,icon,url)}else{validationHelper.showError(this,error_message)}}});"use strict";var ChannelView=Backbone.View.extend({events:{"change #channeltype_id":"onChangeChannelType"},initialize:function(){var view=this;var selectedScope=view.$("#selectedScope").val();this.collection.on("add",this.loadchannel,this);if(selectedScope=="U"){jQuery("#toolbar-save,#toolbar-apply,#toolbar-save-new").addClass("disabled").attr("onclick","return false;")}},onChangeChannelType:function onChangeChannelType(e){var view=this,channelTypeId=this.$("#channeltype_id").val();view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{channelId:this.$("#channel_id").val(),channelTypeId:channelTypeId,token:this.$("#XTtoken").attr("name")},wait:true,dataType:"text",success:function(model,resp,options){view.$("#channel_data").html(model.get("message"));view.refresh()},error:function(model,fail,xhr){view.$("#channel_data").html(fail.responseText)}})},loadchannel:function loadchannel(paramsform){var msg=paramsform.get("message");this.$("#channel_data").html(msg);this.refresh()},refresh:function refresh(){const channelDataSelect=this.$("#channel_data select");if(channelDataSelect.chosen){channelDataSelect.chosen({disable_search_threshold:10,allow_single_deselect:true})}this.$("#channel_data .nav-tabs a").tab();this.$("#channel_data .nav-tabs a").click(function(e){e.preventDefault()});this.$("#channel_data .nav-tabs a:first").show();this.$("#channelTabs a").tab();this.$("#channelTabs a").click(function(e){e.preventDefault()});this.$("#channelTabs a:first").show()},submitbutton:function submitbutton(task){var isValid,domform=this.el;if(task==="channel.cancel"){Joomla.submitform(task,domform)}isValid=document.formvalidator.isValid(domform);if(isValid){Joomla.submitform(task,domform)}}});"use strict";var FbChannelView=Backbone.View.extend({events:{"change #xtformfbchannel_id":"onChangeChannel"},initialize:function(){this.attributes.dispatcher.on("fbapp:channelschanged",this.onAccessTokenChanged,this);this.collection.on("add",this.loadFbChannel,this);this.fbchannellist="#xtformfbchannel_id";this.fbChannelSelected=null},onAccessTokenChanged:function(){var thisView=this,messagesview=this.attributes.messagesview,params=appParamsHelper.get(thisView);Core.UiHelper.listReset(thisView.$(this.fbchannellist));this.collection.create(this.collection.model,{attrs:{own_app:params.p_own_app,app_id:params.p_app_id,secret:params.p_secret,access_token:params.p_access_token,token:params.p_token,channeltype_id:params.p_channelTypeId},wait:true,dataType:"text",error:function(model,fail,xhr){validationHelper.showError(messagesview,fail.responseText)}})},onChangeChannel:function(){var accessToken,channelType,oselected,socialIcon,socialUrl,xtformshowUrl;xtformshowUrl=this.$("#xtformshow_url");xtformshowUrl.val("off");xtformshowUrl.trigger("liszt:updated");this.fbChannelSelected=null;accessToken=this.getFbChannelAccessToken();channelType=this.getFbChannelType();oselected=this.getFbChannelSelected();socialIcon=oselected.attr("social_icon");socialUrl=oselected.attr("social_url");this.$("#fbchannel_access_token").val(accessToken);validationHelper.assignSocialUrl(this,"social_url",socialIcon,socialUrl);if(channelType==="User"){this.$(".open_graph_features").fadeIn()}else{this.$(".open_graph_features").fadeOut()}this.$(".channel-type").val(channelType)},getFbChannelSelected:function(){if(!this.fbChannelSelected){this.fbChannelSelected=this.$(this.fbchannellist+" option:selected")}return this.fbChannelSelected},getFbChannelAccessToken:function(){var oselected=this.getFbChannelSelected(),access_token="INVALID";if(oselected){access_token=oselected.attr("access_token")}return access_token},getFbChannelType:function(){var oselected=this.getFbChannelSelected(),channelType="INVALID";if(oselected){channelType=oselected.attr("data_type")}return channelType},getFbChannelId:function(){return this.getFbChannelSelected().val()},loadFbChannel:function(message){var fbchannellist=this.$(this.fbchannellist),channels,socialIcon,first=true;fbchannellist.empty();this.fbChannelSelected=null;if(message.get("status")){channels=message.get("channels");socialIcon=message.get("icon");_.each(channels,function(channel){var opt=new Option;opt.value=channel.id;opt.text=channel.type+": "+channel.name;jQuery(opt).attr("access_token",channel.access_token).attr("data_type",channel.type).attr("social_icon",socialIcon).attr("social_url",channel.url);if(first){first=false;opt.selected=true}fbchannellist.append(opt)});this.onChangeChannel();fbchannellist.trigger("liszt:updated")}else{validationHelper.showError(this.attributes.messagesview,message.get("message"))}}});"use strict";var FbChValidationView=Backbone.View.extend({events:{"click #fbchvalidationbutton":"onValidationReq"},initialize:function(){var view=this;this.collection.on("add",this.loadvalidation,this);this.$el.ajaxStart(function(){view.$(".loaderspinner72").addClass("loading72")}).ajaxStop(function(){view.$(".loaderspinner72").removeClass("loading72")})},onValidationReq:function(){var view=this,params=appParamsHelper.get(view),fbchannel_access_token=this.$("#fbchannel_access_token").val();this.$("#channel_issued_at").val("...");this.$("#channel_expires_at").val("...");this.collection.create(this.collection.model,{attrs:{own_app:params.p_own_app,app_id:params.p_app_id,secret:params.p_secret,access_token:params.p_access_token,token:params.p_token,fbchannel_access_token:fbchannel_access_token},wait:true,dataType:"text",error:function(model,fail,xhr){validationHelper.showError(view,fail.responseText)}})},loadvalidation:function(resp){var status=resp.get("status"),error_message=resp.get("message"),tokenInfo=resp.get("tokenInfo"),issued_at=tokenInfo.issued_at,expires_at=tokenInfo.expires_at;if(status){this.$("#channel_issued_at").val(issued_at);this.$("#channel_expires_at").val(expires_at)}else{this.$("#channel_issued_at").val(error_message);this.$("#channel_expires_at").val("")}}});"use strict";var FbExtendView=Backbone.View.extend({events:{"click #fbextendbutton":"onExtendReq"},initialize:function(){var view=this;this.collection.on("add",this.loadExtend,this);this.$el.ajaxStart(function(){view.$(".loaderspinner72").addClass("loading72")}).ajaxStop(function(){view.$(".loaderspinner72").removeClass("loading72")})},onExtendReq:function(){var view=this,params=appParamsHelper.get(view);if(params.p_access_token.trim()===""){console.warn("Empty Access Token, rechecking...");FB.getLoginStatus(function(response){console.info("FB.getLoginStatus",response);view.fbStatusChangeCallback(response)});return}view.validateParams()},validateParams:function(){var view=this,params=appParamsHelper.get(view);this.$("#user_id").val("...");this.$("#issued_at").val("...");this.$("#expires_at").val("...");this.collection.create(this.collection.model,{attrs:{own_app:params.p_own_app,app_id:params.p_app_id,secret:params.p_secret,access_token:params.p_access_token,token:params.p_token},wait:true,dataType:"text",error:function(model,fail,xhr){validationHelper.showError(view,fail.responseText)}})},fbStatusChangeCallback:function(response){const view=this;if(response.status!=="connected"){document.getElementById("fbStatus").innerHTML="Please, log in to the app. Check the Business Integration.";return}FB.api("/me",function(response){const authResponse=FB.getAuthResponse();const name=response.name||response.userID;const msg=`Thanks for logging in, ${name}!`;console.info(msg);document.getElementById("fbStatus").innerHTML=msg;view.$("#access_token").val(authResponse.accessToken);view.validateParams()})},loadExtend:function(resp){var status=resp.get("status"),error_message=resp.get("message"),user,extended_token,tokenInfo,issued_at,expires_at;if(status){user=resp.get("user");extended_token=resp.get("extended_token");tokenInfo=resp.get("tokenInfo");issued_at=tokenInfo.issued_at;expires_at=tokenInfo.expires_at;if(user){validationHelper.showSuccess(this,user.id)}else{validationHelper.showSuccess(this,tokenInfo.data.user_id)}this.$("#access_token").val(extended_token);this.$("#issued_at").val(issued_at);this.$("#expires_at").val(expires_at);this.attributes.dispatcher.trigger("fbapp:channelschanged")}else{validationHelper.showError(this,error_message)}}});"use strict";var FbValidationView=Backbone.View.extend({events:{"click #fbauth-tab":"onFbAsyncInit","click #fbvalidationbutton":"onValidationReq","click #fbchannel-tab":"onCheckFbApp","input #app_id":"onCheckFbApp","input #secret":"onCheckFbApp"},initialize:function(){var view=this;this.attributes.dispatcher.on("change:use_own_api",this.onChangeOwnApi,this);this.attributes.dispatcher.on("change:og_features",this.onChangeOgFeatures,this);this.collection.on("add",this.loadvalidation,this);this.$el.ajaxStart(function(){view.$(".loaderspinner72").addClass("loading72")}).ajaxStop(function(){view.$(".loaderspinner72").removeClass("loading72");view.onCheckFbApp()});this.onChangeOwnApi()},onChangeOwnApi:function(e){var ownApp=this.$("#use_own_api").val();var authorizeCanvas=ownApp!="2";if(authorizeCanvas){this.$("#canvas_page").addClass("required").addClass("validate-facebookapp");this.$("#authextendbutton").fadeOut(0);this.$("#authbutton").fadeIn(0);this.$("#fbextendbutton").fadeOut(0);this.$("#fbvalidationbutton").fadeIn(0)}else{this.$("#canvas_page").removeClass("required").removeClass("validate-facebookapp");this.$("#authextendbutton").fadeIn(0);this.$("#authbutton").fadeOut(0);this.$("#fbextendbutton").fadeIn(0);this.$("#fbvalidationbutton").fadeOut(0)}if(ownApp==="0"){this.$("#own-app-testing").fadeIn();this.$("#own-app-details").fadeOut();this.$("#app_id").removeClass("required");this.$("#secret").removeClass("required");this.$("#canvas_page").removeClass("required")}else if(ownApp==="1"){this.$("#own-app-testing").fadeOut();this.$("#own-app-details-canvas-page").fadeIn(0);this.$("#own-app-details").fadeIn();this.$("#app_id").addClass("required");this.$("#secret").addClass("required");this.$("#canvas_page").addClass("required")}else{this.$("#own-app-testing").fadeOut();this.$("#own-app-details-canvas-page").fadeOut(0);this.$("#own-app-details").fadeIn();this.$("#app_id").addClass("required");this.$("#secret").addClass("required");this.$("#canvas_page").removeClass("required")}},onChangeOgFeatures:function(){var ogFeatures=this.$("#og_features").val();if(ogFeatures==="1"){this.$("#og-fields").fadeIn()}else{this.$("#og-fields").fadeOut()}},onCheckFbApp:function(){var view=this;var fbappTab=view.$("#fbapp-tab");var fbauthTab=view.$("#fbauth-tab");var fbchannelTab=view.$("#fbchannel-tab");var appId=view.$("#app_id");var secret=view.$("#secret");var id=appId.val();var s=secret.val();if(!_.isEmpty(id)&&!_.isEmpty(s)&&s.length>30){fbauthTab.removeClass("disabled");fbchannelTab.removeClass("disabled")}if(fbauthTab.hasClass("disabled")){setTimeout(function(){fbappTab.show()},100);return false}return true},getPermsScope:function(view){var requireGroupsPerms=view.$("#fb_api_perms_groups").val()==="1";var requireInstagramPerms=view.$("#fb_api_perms_instagram").val()==="1";if(requireGroupsPerms){return view.$("#fb_api7_perms_groups_detail").val()}if(requireInstagramPerms){return view.$("#fb_perms_instagram_detail").val()}return view.$("#fb_api7_perms").val()},onFbAsyncInit:function(){var view=this;if(!view.onCheckFbApp())return;var params=appParamsHelper.get(this);var fbScope=view.getPermsScope(view);view.$("#fbLoginButton").attr("scope",fbScope);window.fbValidationView=view;window.fbAsyncInit=function(){FB.init({xfbml:1,appId:params.p_app_id,version:"v19.0"});FB.getLoginStatus(function(response){console.info("FB.getLoginStatus",response);view.fbStatusChangeCallback(response)})};(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="https://connect.facebook.net/en_US/sdk.js";fjs.parentNode.insertBefore(js,fjs)})(document,"script","facebook-jssdk")},fbStatusChangeCallback:function(response){const view=this;if(response.status!=="connected"){document.getElementById("fbStatus").innerHTML="Please, log in to the app.";return}FB.api("/me",function(response){const authResponse=FB.getAuthResponse();const name=response.name||response.userID;const msg=`Thanks for logging in, ${name}!`;console.info(msg);document.getElementById("fbStatus").innerHTML=msg;view.$("#access_token").val(authResponse.accessToken)})},onValidationReq:function(){var view=this;var params=appParamsHelper.get(view);this.$("#user_id").val("...");this.$("#issued_at").val("...");this.$("#expires_at").val("...");this.collection.create(this.collection.model,{attrs:{own_app:params.p_own_app,app_id:params.p_app_id,secret:params.p_secret,access_token:params.p_access_token,token:params.p_token},wait:true,dataType:"text",error:function(model,fail){validationHelper.showError(view,fail.responseText)}})},loadvalidation:function(resp){var status=resp.get("status");var errorMessage=resp.get("message");var user;var tokenInfo;var issuedAt;var expiresAt;if(status){user=resp.get("user");tokenInfo=resp.get("tokenInfo");issuedAt=tokenInfo.issued_at;expiresAt=tokenInfo.expires_at;validationHelper.showSuccess(this,user.id);this.$("#issued_at").val(issuedAt);this.$("#expires_at").val(expiresAt);this.attributes.dispatcher.trigger("fbapp:channelschanged")}else{validationHelper.showError(this,errorMessage)}}});"use strict";var LiOAuth2CompanyView=Backbone.View.extend({events:{"click #lioauth2companyloadbutton":"onChangeChannel","change #xtformcompany_id":"onChangeCompany"},initialize:function(){this.collection.on("add",this.loadLiCompany,this);this.lioauth2companylist="#xtformcompany_id";this.$(".group-warn").fadeOut()},onChangeChannel:function(){var xtformshowUrl=this.$("#xtformshow_url");xtformshowUrl.val("off");xtformshowUrl.trigger("liszt:updated");var thisView=this,channel_id=thisView.$("#channel_id").val().trim(),token=thisView.$("#XTtoken").attr("name");Core.UiHelper.listReset(thisView.$(this.lioauth2companylist));this.collection.create(this.collection.model,{attrs:{channel_id:channel_id,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){validationHelper.showError(this,fail.responseText)}})},loadLiCompany:function(message){var lioauth2companylist=this.$(this.lioauth2companylist),channels,socialIcon,first=true;lioauth2companylist.empty();if(message.get("status")){channels=message.get("channels");socialIcon=message.get("icon");_.each(channels,function(channel){var opt=new Option;opt.value=channel.id;opt.text=channel.name;jQuery(opt).attr("social_icon",socialIcon).attr("social_url",channel.url);if(first){first=false;opt.selected=true}lioauth2companylist.append(opt)});this.onChangeCompany();validationHelper.showSuccess(this,"");lioauth2companylist.trigger("liszt:updated")}else{validationHelper.showError(this,message.get("message"))}},onChangeCompany:function(){var oselected=this.$("#xtformcompany_id option:selected"),socialIcon=oselected.attr("social_icon"),socialUrl=oselected.attr("social_url");validationHelper.assignSocialUrl(this,"social_url_lioauth2company",socialIcon,socialUrl)}});"use strict";var LiOAuth2ValidationView=Backbone.View.extend({events:{"click #lioauth2validationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this)},onValidationReq:function onValidationReq(){var view=this,channel_id=view.$("#channel_id").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#channel_id").val(channel_id);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{channel_id:channel_id,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),error_message=resp.get("message"),user=resp.get("user"),icon=resp.get("icon"),url=resp.get("url");this.$(".loaderspinner").removeClass("loading");if(status){validationHelper.showSuccess(this,user.id,icon,url)}else{validationHelper.showError(this,error_message)}}});"use strict";var MediumValidationView=Backbone.View.extend({events:{"click #mediumvalidationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this)},onValidationReq:function onValidationReq(){var view=this,botToken=view.$("#integration_token").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#integration_token").val(botToken);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{integration_token:botToken,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),errorMessage=resp.get("message"),user=resp.get("user"),icon=resp.get("icon"),url=resp.get("url");this.$(".loaderspinner").removeClass("loading");if(status){validationHelper.showSuccess(this,user,icon,url)}else{validationHelper.showError(this,errorMessage)}}});"use strict";var MyBusinessValidationView=Backbone.View.extend({events:{"click #mybusinessvalidationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this)},onValidationReq:function(){var view=this,channelId=view.$("#channel_id").val().trim(),developerKey=view.$("#client_id").val().trim(),clientSecret=view.$("#client_secret").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#channel_id").val(channelId);view.$("#client_id").val(developerKey);view.$("#client_secret").val(clientSecret);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{channel_id:channelId,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),errorMessage=resp.get("message"),user=resp.get("user"),socialIcon=resp.get("social_icon"),socialUrl=resp.get("social_url");this.$(".loaderspinner").removeClass("loading");if(status){validationHelper.showSuccess(this,user.id,socialIcon,socialUrl)}else{validationHelper.showError(this,errorMessage)}}});var OneSignalValidationView=Backbone.View.extend({events:{"click #oneSignalvalidationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this)},onValidationReq:function onValidationReq(){"use strict";var view=this,appId=view.$("#app_id").val().trim(),appApiAuthenticationKey=view.$("#app_api_authentication_key").val().trim(),orgApiAuthenticationKey=view.$("#org_api_authentication_key").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#app_id").val(appId);view.$("#app_api_authentication_key").val(appApiAuthenticationKey);view.$("#org_api_authentication_key").val(orgApiAuthenticationKey);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{app_id:appId,app_api_authentication_key:appApiAuthenticationKey,org_api_authentication_key:orgApiAuthenticationKey,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),errorMessage=resp.get("message");this.$(".loaderspinner").removeClass("loading");if(status){validationHelper.showSuccess(this)}else{validationHelper.showError(this,errorMessage)}}});"use strict";var PageSpeedValidationView=Backbone.View.extend({events:{"click #pagespeedvalidationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this)},onValidationReq:function(){var view=this,channelId=view.$("#channel_id").val().trim(),apiKey=view.$("#api_key").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#channel_id").val(channelId);view.$("#api_key").val(apiKey);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{channel_id:channelId,api_key:apiKey,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),errorMessage=resp.get("message");this.$(".loaderspinner").removeClass("loading");if(status){validationHelper.showSuccess(this,null,null,null)}else{validationHelper.showError(this,errorMessage)}}});"use strict";var PinterestValidationView=Backbone.View.extend({events:{"click #pinterestvalidationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this)},onValidationReq:function(){var view=this,channelId=view.$("#channel_id").val().trim(),appId=view.$("#app_id").val().trim(),appSecret=view.$("#app_secret").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#channel_id").val(channelId);view.$("#app_id").val(appId);view.$("#app_secret").val(appSecret);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{channel_id:channelId,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),errorMessage=resp.get("message"),user=resp.get("user"),socialIcon=resp.get("social_icon"),socialUrl=resp.get("social_url");this.$(".loaderspinner").removeClass("loading");if(status){validationHelper.showSuccess(this,user.id,socialIcon,socialUrl)}else{validationHelper.showError(this,errorMessage)}}});var PushAlertValidationView=Backbone.View.extend({events:{"click #pushalertvalidationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this)},onValidationReq:function onValidationReq(){"use strict";var view=this,restApiKey=view.$("#rest_api_key").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#rest_api_key").val(restApiKey);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{rest_api_key:restApiKey,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),errorMessage=resp.get("message");this.$(".loaderspinner").removeClass("loading");if(status){validationHelper.showSuccess(this)}else{validationHelper.showError(this,errorMessage)}}});var PushwooshValidationView=Backbone.View.extend({events:{"click #pushwooshvalidationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this)},onValidationReq:function onValidationReq(){"use strict";var view=this,applicationId=view.$("#application_id").val().trim(),accessToken=view.$("#access_token").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#application_id").val(applicationId);view.$("#access_token").val(accessToken);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{application_id:applicationId,access_token:accessToken,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),errorMessage=resp.get("message");this.$(".loaderspinner").removeClass("loading");if(status){validationHelper.showSuccess(this)}else{validationHelper.showError(this,errorMessage)}}});"use strict";var ScoopitTopicView=Backbone.View.extend({events:{"click #submit_topic_search":"onTopicsSearch","change #topic_select_id":"onChangeTopic"},initialize:function(){this.collection.on("add",this.load,this);this.topiclist="#topic_select_id"},onTopicsSearch:function onTopicsSearch(){var thisView=this,list=thisView.$(this.topiclist),channelId=thisView.$("#channel_id").val(),channelToken=thisView.$("#XTtoken").attr("name"),search_topic=thisView.$("#search_topic").val();Core.UiHelper.listReset(list);this.collection.create(this.collection.model,{attrs:{channel_id:channelId,token:channelToken,search:search_topic},wait:true,dataType:"text",error:function(model,fail,xhr){validationHelper.showError(thisView,fail.responseText)}})},load:function load(message){var thisView=this,topiclist=this.$(this.topiclist),items;topiclist.empty();if(message.get("status")){items=message.get("topics");_.each(items,function(item){var opt=new Option;opt.value=item.id;opt.text=item.name;topiclist.append(opt)});topiclist.trigger("liszt:updated")}else{validationHelper.showError(thisView,message.get("message"))}},onChangeTopic:function(){var topic_id=this.$("#topic_select_id").val();this.$("#topic_id").val(topic_id)}});"use strict";var ScoopitValidationView=Backbone.View.extend({events:{"click #scoopitvalidationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this)},onValidationReq:function onValidationReq(){var view=this,channel_id=view.$("#channel_id").val().trim(),consumer_key=view.$("#consumer_key").val().trim(),consumer_secret=view.$("#consumer_secret").val().trim(),access_token=view.$("#access_token").val().trim(),access_secret=view.$("#access_secret").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#channel_id").val(channel_id);view.$("#consumer_key").val(consumer_key);view.$("#consumer_secret").val(consumer_secret);view.$("#access_token").val(access_token);view.$("#access_secret").val(access_secret);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{channel_id:channel_id,consumer_key:consumer_key,consumer_secret:consumer_secret,access_token:access_token,access_secret:access_secret,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),error_message=resp.get("message"),user=resp.get("user"),icon=resp.get("icon"),url=resp.get("url");this.$(".loaderspinner").removeClass("loading");if(status){validationHelper.showSuccess(this,user.id_str,icon,url)}else{validationHelper.showError(this,error_message)}}});"use strict";var TelegramValidationView=Backbone.View.extend({events:{"click #telegramvalidationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this)},onValidationReq:function onValidationReq(){var view=this,botToken=view.$("#bot_token").val().trim(),chatId=view.$("#chat_id").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#bot_token").val(botToken);view.$("#chat_id").val(chatId);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{bot_token:botToken,chat_id:chatId,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),errorMessage=resp.get("message"),user=resp.get("user"),icon=resp.get("icon"),url=resp.get("url");this.$(".loaderspinner").removeClass("loading");if(status){validationHelper.showSuccess(this,user,icon,url)}else{validationHelper.showError(this,errorMessage)}}});"use strict";var TumblrValidationView=Backbone.View.extend({events:{"click #tumblrvalidationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this);this.bloglist="#blogs"},onValidationReq:function onValidationReq(){var view=this,consumer_key=view.$("#consumer_key").val().trim(),consumer_secret=view.$("#consumer_secret").val().trim(),access_token=view.$("#access_token").val().trim(),access_secret=view.$("#access_secret").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#consumer_key").val(consumer_key);view.$("#consumer_secret").val(consumer_secret);view.$("#access_token").val(access_token);view.$("#access_secret").val(access_secret);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{consumer_key:consumer_key,consumer_secret:consumer_secret,access_token:access_token,access_secret:access_secret,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),error_message=resp.get("message"),user=resp.get("user"),icon=resp.get("icon"),url=resp.get("url"),list=this.$(this.bloglist);this.$(".loaderspinner").removeClass("loading");if(status){list.empty();_.each(user.blogs,function(item){var opt=new Option;opt.value=item.id;opt.text=item.name;list.append(opt)});list.trigger("liszt:updated");validationHelper.showSuccess(this,user.name,icon,url)}else{validationHelper.showError(this,error_message)}}});"use strict";var TwitterV2ValidationView=Backbone.View.extend({events:{"click #twitterv2validationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this)},onValidationReq:function onValidationReq(){var view=this,channel_id=view.$("#channel_id").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#channel_id").val(channel_id);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{channel_id:channel_id,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),error_message=resp.get("message"),user=resp.get("user"),icon=resp.get("icon"),url=resp.get("url");this.$(".loaderspinner").removeClass("loading");if(status){validationHelper.showSuccess(this,user.id,icon,url)}else{validationHelper.showError(this,error_message)}}});"use strict";var TwValidationView=Backbone.View.extend({events:{"click #twvalidationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this)},onValidationReq:function onValidationReq(){var view=this,consumer_key=view.$("#consumer_key").val().trim(),consumer_secret=view.$("#consumer_secret").val().trim(),access_token=view.$("#access_token").val().trim(),access_token_secret=view.$("#access_token_secret").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#consumer_key").val(consumer_key);view.$("#consumer_secret").val(consumer_secret);view.$("#access_token").val(access_token);view.$("#access_token_secret").val(access_token_secret);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{consumer_key:consumer_key,consumer_secret:consumer_secret,access_token:access_token,access_token_secret:access_token_secret,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),error_message=resp.get("message"),user=resp.get("user"),icon=resp.get("icon"),url=resp.get("url");this.$(".loaderspinner").removeClass("loading");if(status){validationHelper.showSuccess(this,user.id_str,icon,url)}else{validationHelper.showError(this,error_message)}}});var WebpushrValidationView=Backbone.View.extend({events:{"click #webpushrvalidationbutton":"onValidationReq"},initialize:function(){this.collection.on("add",this.loadvalidation,this)},onValidationReq:function onValidationReq(){"use strict";var view=this,restApiKey=view.$("#rest_api_key").val().trim(),restAuthenticationToken=view.$("#rest_authentication_token").val().trim(),token=view.$("#XTtoken").attr("name");view.$("#rest_api_key").val(restApiKey);view.$("#rest_authentication_token").val(restAuthenticationToken);view.$(".loaderspinner").addClass("loading");this.collection.create(this.collection.model,{attrs:{rest_api_key:restApiKey,rest_authentication_token:restAuthenticationToken,token:token},wait:true,dataType:"text",error:function(model,fail,xhr){view.$(".loaderspinner").removeClass("loading");validationHelper.showError(view,fail.responseText)}})},loadvalidation:function loadvalidation(resp){var status=resp.get("status"),errorMessage=resp.get("message");this.$(".loaderspinner").removeClass("loading");if(status){validationHelper.showSuccess(this)}else{validationHelper.showError(this,errorMessage)}}});var $adminForm=jQuery("#adminForm");new ChannelView({el:$adminForm,collection:new Channels}).onChangeChannelType();var twValidationView=new TwValidationView({el:$adminForm,collection:new TwValidations});var twitterV2ValidationView=new TwitterV2ValidationView({el:$adminForm,collection:new TwitterV2Validations});var liOAuth2ValidationView=new LiOAuth2ValidationView({el:$adminForm,collection:new LiOAuth2Validations});var eventsDispatcher=_.clone(Backbone.Events);var fbValidationView=new FbValidationView({el:$adminForm,collection:new FbValidations,attributes:{dispatcher:eventsDispatcher}});var fbChannelView=new FbChannelView({el:$adminForm,collection:new FbChannels,attributes:{dispatcher:eventsDispatcher,messagesview:fbValidationView}});var fbChValidationView=new FbChValidationView({el:$adminForm,collection:new FbChValidations});var fbExtendView=new FbExtendView({el:$adminForm,collection:new FbExtends,attributes:{dispatcher:eventsDispatcher}});var liOAuth2CompanyView=new LiOAuth2CompanyView({el:$adminForm,collection:new LiOAuth2Companies});var scoopitValidationView=new ScoopitValidationView({el:$adminForm,collection:new ScoopitValidations});var scoopitTopicView=new ScoopitTopicView({el:$adminForm,collection:new ScoopitTopics});var tumblrValidationView=new TumblrValidationView({el:$adminForm,collection:new TumblrValidations});var bloggerValidationView=new BloggerValidationView({el:$adminForm,collection:new BloggerValidations});var telegramValidationView=new TelegramValidationView({el:$adminForm,collection:new TelegramValidations});var mediumValidationView=new MediumValidationView({el:$adminForm,collection:new MediumValidations});var pushwooshValidationView=new PushwooshValidationView({el:$adminForm,collection:new PushwooshValidations});var oneSignalValidationView=new OneSignalValidationView({el:$adminForm,collection:new OneSignalValidations});var pushAlertValidationView=new PushAlertValidationView({el:$adminForm,collection:new PushAlertValidations});var webpushrValidationView=new WebpushrValidationView({el:$adminForm,collection:new WebpushrValidations});var pagespeedValidationView=new PageSpeedValidationView({el:$adminForm,collection:new PageSpeedValidations});var pinterestValidationView=new PinterestValidationView({el:$adminForm,collection:new PinterestValidations});var mybusinessValidationView=new MyBusinessValidationView({el:$adminForm,collection:new MyBusinessValidations});var bskyValidationView=new BskyValidationView({el:$adminForm,collection:new BskyValidations});window.xtAppDispatcher=eventsDispatcher;try{if(!window.punycode&&typeof define=="function"&&typeof define.amd=="object"&&define.amd){require(["punycode"],function(punycode){window.punycode=punycode})}}catch(e){}});
